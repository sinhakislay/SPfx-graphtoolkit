define("cd01a788-6e01-4fdb-a39a-db7c7b2df455_0.0.1", ["@microsoft/sp-property-pane","SpfxMgtWebPartStrings","@microsoft/sp-webpart-base"], function(__WEBPACK_EXTERNAL_MODULE__26ea__, __WEBPACK_EXTERNAL_MODULE_BKw3__, __WEBPACK_EXTERNAL_MODULE_br4S__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "wJ6+");
/******/ })
/************************************************************************/
/******/ ({

/***/ "+O9S":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/Client.js ***!
  \*************************************************************************************************************/
/*! exports provided: Client */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Client", function() { return Client; });
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Constants */ "/FJK");
/* harmony import */ var _CustomAuthenticationProvider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CustomAuthenticationProvider */ "3/+1");
/* harmony import */ var _GraphRequest__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GraphRequest */ "T1gI");
/* harmony import */ var _HTTPClient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./HTTPClient */ "h8e6");
/* harmony import */ var _HTTPClientFactory__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./HTTPClientFactory */ "9mdp");
/* harmony import */ var _ValidatePolyFilling__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ValidatePolyFilling */ "iCud");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module Client
 */






class Client {
    /**
     * @private
     * @constructor
     * Creates an instance of Client
     * @param {ClientOptions} clientOptions - The options to instantiate the client object
     */
    constructor(clientOptions) {
        /**
         * @private
         * A member which stores the Client instance options
         */
        this.config = {
            baseUrl: _Constants__WEBPACK_IMPORTED_MODULE_0__["GRAPH_BASE_URL"],
            debugLogging: false,
            defaultVersion: _Constants__WEBPACK_IMPORTED_MODULE_0__["GRAPH_API_VERSION"],
        };
        try {
            Object(_ValidatePolyFilling__WEBPACK_IMPORTED_MODULE_5__["validatePolyFilling"])();
        }
        catch (error) {
            throw error;
        }
        for (const key in clientOptions) {
            if (clientOptions.hasOwnProperty(key)) {
                this.config[key] = clientOptions[key];
            }
        }
        let httpClient;
        if (clientOptions.authProvider !== undefined && clientOptions.middleware !== undefined) {
            const error = new Error();
            error.name = "AmbiguityInInitialization";
            error.message = "Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both";
            throw error;
        }
        else if (clientOptions.authProvider !== undefined) {
            httpClient = _HTTPClientFactory__WEBPACK_IMPORTED_MODULE_4__["HTTPClientFactory"].createWithAuthenticationProvider(clientOptions.authProvider);
        }
        else if (clientOptions.middleware !== undefined) {
            httpClient = new _HTTPClient__WEBPACK_IMPORTED_MODULE_3__["HTTPClient"](...[].concat(clientOptions.middleware));
        }
        else {
            const error = new Error();
            error.name = "InvalidMiddlewareChain";
            error.message = "Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain";
            throw error;
        }
        this.httpClient = httpClient;
    }
    /**
     * @public
     * @static
     * To create a client instance with options and initializes the default middleware chain
     * @param {Options} options - The options for client instance
     * @returns The Client instance
     */
    static init(options) {
        const clientOptions = {};
        for (const i in options) {
            if (options.hasOwnProperty(i)) {
                clientOptions[i] = i === "authProvider" ? new _CustomAuthenticationProvider__WEBPACK_IMPORTED_MODULE_1__["CustomAuthenticationProvider"](options[i]) : options[i];
            }
        }
        return Client.initWithMiddleware(clientOptions);
    }
    /**
     * @public
     * @static
     * To create a client instance with the Client Options
     * @param {ClientOptions} clientOptions - The options object for initializing the client
     * @returns The Client instance
     */
    static initWithMiddleware(clientOptions) {
        try {
            return new Client(clientOptions);
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * @public
     * Entry point to make requests
     * @param {string} path - The path string value
     * @returns The graph request instance
     */
    api(path) {
        return new _GraphRequest__WEBPACK_IMPORTED_MODULE_2__["GraphRequest"](this.httpClient, this.config, path);
    }
}
//# sourceMappingURL=Client.js.map

/***/ }),

/***/ "+syW":
/*!**********************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-teams-provider/dist/es6/index.js ***!
  \**********************************************************************/
/*! exports provided: TeamsProvider, MgtTeamsProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _TeamsProvider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TeamsProvider */ "Yol3");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TeamsProvider", function() { return _TeamsProvider__WEBPACK_IMPORTED_MODULE_0__["TeamsProvider"]; });

/* harmony import */ var _mgt_teams_provider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mgt-teams-provider */ "AWSq");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtTeamsProvider", function() { return _mgt_teams_provider__WEBPACK_IMPORTED_MODULE_1__["MgtTeamsProvider"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


//# sourceMappingURL=index.js.map

/***/ }),

/***/ "+xZ/":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/error/ServerError.js ***!
  \**************************************************************************************************/
/*! exports provided: ServerErrorMessage, ServerError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerErrorMessage", function() { return ServerErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerError", function() { return ServerError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuthError */ "UrvO");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var ServerErrorMessage = {
    serverUnavailable: {
        code: "server_unavailable",
        desc: "Server is temporarily unavailable."
    },
    unknownServerError: {
        code: "unknown_server_error"
    },
};
/**
 * Error thrown when there is an error with the server code, for example, unavailability.
 */
var ServerError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ServerError, _super);
    function ServerError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ServerError";
        Object.setPrototypeOf(_this, ServerError.prototype);
        return _this;
    }
    ServerError.createServerUnavailableError = function () {
        return new ServerError(ServerErrorMessage.serverUnavailable.code, ServerErrorMessage.serverUnavailable.desc);
    };
    ServerError.createUnknownServerError = function (errorDesc) {
        return new ServerError(ServerErrorMessage.unknownServerError.code, errorDesc);
    };
    return ServerError;
}(_AuthError__WEBPACK_IMPORTED_MODULE_1__["AuthError"]));

//# sourceMappingURL=ServerError.js.map

/***/ }),

/***/ "/1+S":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/tasks/OneDriveLargeFileUploadTaskUtil.js ***!
  \********************************************************************************************************/
/*! exports provided: getValidRangeSize */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getValidRangeSize", function() { return getValidRangeSize; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module OneDriveLargeFileUploadTaskUtil
 */
/**
 * @constant
 * Default value for the rangeSize
 * Recommended size is between 5 - 10 MB {@link https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/driveitem_createuploadsession#best-practices}
 */
const DEFAULT_FILE_SIZE = 5 * 1024 * 1024;
/**
 * @constant
 * Rounds off the given value to a multiple of 320 KB
 * @param {number} value - The value
 * @returns The rounded off value
 */
const roundTo320KB = (value) => {
    if (value > 320 * 1024) {
        value = Math.floor(value / (320 * 1024)) * 320 * 1024;
    }
    return value;
};
/**
 * @constant
 * Get the valid rangeSize for a file slicing (validity is based on the constrains mentioned in here
 * {@link https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/driveitem_createuploadsession#upload-bytes-to-the-upload-session})
 *
 * @param {number} [rangeSize = DEFAULT_FILE_SIZE] - The rangeSize value.
 * @returns The valid rangeSize
 */
const getValidRangeSize = (rangeSize = DEFAULT_FILE_SIZE) => {
    const sixtyMB = 60 * 1024 * 1024;
    if (rangeSize > sixtyMB) {
        rangeSize = sixtyMB;
    }
    return roundTo320KB(rangeSize);
};
//# sourceMappingURL=OneDriveLargeFileUploadTaskUtil.js.map

/***/ }),

/***/ "/5+p":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-tasks-base/mgt-tasks-base.js ***!
  \*****************************************************************************************************/
/*! exports provided: MgtTasksBase */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtTasksBase", function() { return MgtTasksBase; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./strings */ "eyTa");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * The foundation for creating task based components.
 *
 * @export
 * @class MgtTasksBase
 * @extends {MgtTemplatedComponent}
 */
class MgtTasksBase extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["MgtTemplatedComponent"] {
    constructor() {
        super();
        this.clearState();
        this._previousMediaQuery = this.mediaQuery;
        this.onResize = this.onResize.bind(this);
    }
    /**
     * The name of a potential new task
     *
     * @readonly
     * @protected
     * @type {string}
     * @memberof MgtTasksBase
     */
    get newTaskName() {
        return this._newTaskName;
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_3__["strings"];
    }
    /**
     * Synchronizes property values when attributes change.
     *
     * @param {*} name
     * @param {*} oldValue
     * @param {*} newValue
     * @memberof MgtTasks
     */
    attributeChangedCallback(name, oldVal, newVal) {
        super.attributeChangedCallback(name, oldVal, newVal);
        switch (name) {
            case 'target-id':
            case 'initial-id':
                this.clearState();
                this.requestStateUpdate();
                break;
        }
    }
    /**
     * updates provider state
     *
     * @memberof MgtTasks
     */
    connectedCallback() {
        super.connectedCallback();
        window.addEventListener('resize', this.onResize);
    }
    /**
     * removes updates on provider state
     *
     * @memberof MgtTasks
     */
    disconnectedCallback() {
        window.removeEventListener('resize', this.onResize);
        super.disconnectedCallback();
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["Providers"].globalProvider;
        if (!provider || provider.state !== _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["ProviderState"].SignedIn) {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
        }
        if (this.isLoadingState) {
            return this.renderLoadingTask();
        }
        const headerTemplate = !this.hideHeader ? this.renderHeader() : null;
        const newTaskTemplate = this._isNewTaskVisible ? this.renderNewTaskPanel() : null;
        const tasksTemplate = this.isLoadingState ? this.renderLoadingTask() : this.renderTasks();
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      ${headerTemplate} ${newTaskTemplate}
      <div class="Tasks" dir=${this.direction}>
        ${tasksTemplate}
      </div>
    `;
    }
    /**
     * Render the header part of the component.
     *
     * @protected
     * @returns
     * @memberof MgtTodo
     */
    renderHeader() {
        const headerContentTemplate = this.renderHeaderContent();
        const addClasses = Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({
            AddBarItem: true,
            NewTaskButton: true,
            hidden: this.readOnly || this._isNewTaskVisible
        });
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="Header" dir=${this.direction}>
        ${headerContentTemplate}
        <button class="${addClasses}" @click="${() => this.showNewTaskPanel()}">
          <span class="TaskIcon"></span>
          <span>${this.strings.addTaskButtonSubtitle}</span>
        </button>
      </div>
    `;
    }
    /**
     * Render a task in a loading state.
     *
     * @protected
     * @returns
     * @memberof MgtTodo
     */
    renderLoadingTask() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `;
    }
    /**
     * Render the panel for creating a new task
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtTasksBase
     */
    renderNewTaskPanel() {
        const newTaskName = this._newTaskName;
        const taskTitle = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <input
        type="text"
        placeholder="${this.strings.newTaskPlaceholder}"
        .value="${newTaskName}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="input"
        @input="${(e) => {
            this._newTaskName = e.target.value;
            this.requestUpdate();
        }}"
      />
    `;
        const taskAddClasses = Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({
            Disabled: !this._isNewTaskBeingAdded && (!newTaskName || !newTaskName.length),
            TaskAddButtonContainer: true
        });
        const taskAddTemplate = !this._isNewTaskBeingAdded
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <div class="TaskIcon TaskCancel" @click="${() => this.hideNewTaskPanel()}">
            <span>${this.strings.cancelNewTaskSubtitle}</span>
          </div>
          <div class="TaskIcon TaskAdd" @click="${() => this.addTask()}">
            <span></span>
          </div>
        `
            : null;
        const newTaskDetailsTemplate = this.renderNewTaskDetails();
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div dir=${this.direction} class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${taskTitle}
            </div>
            <div class="TaskDetails">
              ${newTaskDetailsTemplate}
            </div>
          </div>
        </div>
        <div class="${taskAddClasses}">
          ${taskAddTemplate}
        </div>
      </div>
    `;
    }
    /**
     * Render a bucket icon.
     *
     * @protected
     * @returns
     * @memberof MgtTodo
     */
    renderBucketIcon() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `;
    }
    /**
     * Create a new todo task and add it to the list
     *
     * @protected
     * @returns
     * @memberof MgtTasksBase
     */
    addTask() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this._isNewTaskBeingAdded || !this.newTaskName) {
                return;
            }
            this._isNewTaskBeingAdded = true;
            yield this.requestUpdate();
            try {
                yield this.createNewTask();
            }
            finally {
                this._isNewTaskBeingAdded = false;
                this._isNewTaskVisible = false;
                this.requestUpdate();
            }
        });
    }
    /**
     * Clear the form data from the new task panel.
     *
     * @protected
     * @memberof MgtTasksBase
     */
    clearNewTaskData() {
        this._newTaskName = '';
    }
    /**
     * Clear the component state.
     *
     * @protected
     * @memberof MgtTasksBase
     */
    clearState() {
        this.clearNewTaskData();
        this._isNewTaskVisible = false;
        this.requestUpdate();
    }
    /**
     * Handle when a task is clicked
     *
     * @protected
     * @param {Event} e
     * @param {TodoTask} task
     * @memberof MgtTasksBase
     */
    handleTaskClick(e, task) {
        this.fireCustomEvent('taskClick', { task });
    }
    /**
     * Convert a date to a properly formatted string
     *
     * @protected
     * @param {Date} date
     * @returns
     * @memberof MgtTasksBase
     */
    dateToInputValue(date) {
        if (date) {
            return new Date(date.getTime() - date.getTimezoneOffset() * 60000).toISOString().split('T')[0];
        }
        return null;
    }
    showNewTaskPanel() {
        this._isNewTaskVisible = true;
        this.requestUpdate();
    }
    hideNewTaskPanel() {
        this._isNewTaskVisible = false;
        this.clearNewTaskData();
        this.requestUpdate();
    }
    onResize() {
        if (this.mediaQuery !== this._previousMediaQuery) {
            this._previousMediaQuery = this.mediaQuery;
            this.requestUpdate();
        }
    }
}
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'read-only', type: Boolean }),
    __metadata("design:type", Boolean)
], MgtTasksBase.prototype, "readOnly", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'hide-header', type: Boolean }),
    __metadata("design:type", Boolean)
], MgtTasksBase.prototype, "hideHeader", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'hide-options', type: Boolean }),
    __metadata("design:type", Boolean)
], MgtTasksBase.prototype, "hideOptions", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'target-id', type: String }),
    __metadata("design:type", String)
], MgtTasksBase.prototype, "targetId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'initial-id', type: String }),
    __metadata("design:type", String)
], MgtTasksBase.prototype, "initialId", void 0);
//# sourceMappingURL=mgt-tasks-base.js.map

/***/ }),

/***/ "/AMX":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/UserAgentApplication.js ***!
  \*****************************************************************************************************/
/*! exports provided: UserAgentApplication */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserAgentApplication", function() { return UserAgentApplication; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _cache_AccessTokenKey__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cache/AccessTokenKey */ "NBYW");
/* harmony import */ var _cache_AccessTokenValue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./cache/AccessTokenValue */ "s8CV");
/* harmony import */ var _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ServerRequestParameters */ "b91I");
/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./authority/Authority */ "Si2r");
/* harmony import */ var _ClientInfo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ClientInfo */ "Exx9");
/* harmony import */ var _IdToken__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./IdToken */ "eb1H");
/* harmony import */ var _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./cache/AuthCache */ "I+Kz");
/* harmony import */ var _Account__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Account */ "K6T8");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ScopeSet */ "aX9C");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./utils/StringUtils */ "k+Uk");
/* harmony import */ var _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./utils/WindowUtils */ "gaiY");
/* harmony import */ var _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./utils/TokenUtils */ "Ptj7");
/* harmony import */ var _utils_TimeUtils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./utils/TimeUtils */ "JUi9");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./utils/UrlUtils */ "j0B3");
/* harmony import */ var _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./utils/RequestUtils */ "yEX1");
/* harmony import */ var _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./utils/ResponseUtils */ "TxoH");
/* harmony import */ var _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./authority/AuthorityFactory */ "sQma");
/* harmony import */ var _Configuration__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Configuration */ "b+AD");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./error/ClientConfigurationError */ "SRUK");
/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./error/AuthError */ "UrvO");
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./error/ClientAuthError */ "n82g");
/* harmony import */ var _error_ServerError__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./error/ServerError */ "+xZ/");
/* harmony import */ var _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./error/InteractionRequiredAuthError */ "vhOk");
/* harmony import */ var _AuthResponse__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./AuthResponse */ "dYzh");
/* harmony import */ var _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./telemetry/TelemetryManager */ "IBxc");
/* harmony import */ var _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./telemetry/ApiEvent */ "jxkD");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./utils/Constants */ "/pXG");
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./utils/CryptoUtils */ "RDZQ");
/* harmony import */ var _authority_TrustedAuthority__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./authority/TrustedAuthority */ "9FZN");
/* harmony import */ var _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./utils/AuthCacheUtils */ "CLp/");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */































// default authority
var DEFAULT_AUTHORITY = "https://login.microsoftonline.com/common";
/**
 * UserAgentApplication class
 *
 * Object Instance that the developer can use to make loginXX OR acquireTokenXX functions
 */
var UserAgentApplication = /** @class */ (function () {
    /**
     * @constructor
     * Constructor for the UserAgentApplication used to instantiate the UserAgentApplication object
     *
     * Important attributes in the Configuration object for auth are:
     * - clientID: the application ID of your application.
     * You can obtain one by registering your application with our Application registration portal : https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredAppsPreview
     * - authority: the authority URL for your application.
     *
     * In Azure AD, authority is a URL indicating the Azure active directory that MSAL uses to obtain tokens.
     * It is of the form https://login.microsoftonline.com/&lt;Enter_the_Tenant_Info_Here&gt;.
     * If your application supports Accounts in one organizational directory, replace "Enter_the_Tenant_Info_Here" value with the Tenant Id or Tenant name (for example, contoso.microsoft.com).
     * If your application supports Accounts in any organizational directory, replace "Enter_the_Tenant_Info_Here" value with organizations.
     * If your application supports Accounts in any organizational directory and personal Microsoft accounts, replace "Enter_the_Tenant_Info_Here" value with common.
     * To restrict support to Personal Microsoft accounts only, replace "Enter_the_Tenant_Info_Here" value with consumers.
     *
     *
     * In Azure B2C, authority is of the form https://&lt;instance&gt;/tfp/&lt;tenant&gt;/&lt;policyName&gt;/
     *
     * @param {@link (Configuration:type)} configuration object for the MSAL UserAgentApplication instance
     */
    function UserAgentApplication(configuration) {
        // callbacks for token/error
        this.authResponseCallback = null;
        this.tokenReceivedCallback = null;
        this.errorReceivedCallback = null;
        // Set the Configuration
        this.config = Object(_Configuration__WEBPACK_IMPORTED_MODULE_18__["buildConfiguration"])(configuration);
        this.logger = this.config.system.logger;
        this.clientId = this.config.auth.clientId;
        this.inCookie = this.config.cache.storeAuthStateInCookie;
        this.telemetryManager = this.getTelemetryManagerFromConfig(this.config.system.telemetry, this.clientId);
        _authority_TrustedAuthority__WEBPACK_IMPORTED_MODULE_29__["TrustedAuthority"].setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority, this.config.auth.knownAuthorities);
        _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromConfig(this.config.auth.authority, this.config.auth.authorityMetadata);
        // if no authority is passed, set the default: "https://login.microsoftonline.com/common"
        this.authority = this.config.auth.authority || DEFAULT_AUTHORITY;
        // cache keys msal - typescript throws an error if any value other than "localStorage" or "sessionStorage" is passed
        this.cacheStorage = new _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"](this.clientId, this.config.cache.cacheLocation, this.inCookie);
        // Initialize window handling code
        window.activeRenewals = {};
        window.renewStates = [];
        window.callbackMappedToRenewStates = {};
        window.promiseMappedToRenewStates = {};
        window.msal = this;
        var urlHash = window.location.hash;
        var urlContainsHash = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlContainsHash(urlHash);
        // check if back button is pressed
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].checkIfBackButtonIsPressed(this.cacheStorage);
        // On the server 302 - Redirect, handle this
        if (urlContainsHash) {
            var stateInfo = this.getResponseState(urlHash);
            if (stateInfo.method === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
                this.handleRedirectAuthenticationResponse(urlHash);
            }
        }
    }
    Object.defineProperty(UserAgentApplication.prototype, "authority", {
        /**
         * Method to manage the authority URL.
         *
         * @returns {string} authority
         */
        get: function () {
            return this.authorityInstance.CanonicalAuthority;
        },
        /**
         * setter for the authority URL
         * @param {string} authority
         */
        // If the developer passes an authority, create an instance
        set: function (val) {
            this.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(val, this.config.auth.validateAuthority);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Get the current authority instance from the MSAL configuration object
     *
     * @returns {@link Authority} authority instance
     */
    UserAgentApplication.prototype.getAuthorityInstance = function () {
        return this.authorityInstance;
    };
    UserAgentApplication.prototype.handleRedirectCallback = function (authOrTokenCallback, errorReceivedCallback) {
        if (!authOrTokenCallback) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createInvalidCallbackObjectError(authOrTokenCallback);
        }
        // Set callbacks
        if (errorReceivedCallback) {
            this.tokenReceivedCallback = authOrTokenCallback;
            this.errorReceivedCallback = errorReceivedCallback;
            this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).");
        }
        else {
            this.authResponseCallback = authOrTokenCallback;
        }
        if (this.redirectError) {
            this.authErrorHandler(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, this.redirectError, this.redirectResponse);
        }
        else if (this.redirectResponse) {
            this.authResponseHandler(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, this.redirectResponse);
        }
    };
    /**
     * Public API to verify if the URL contains the hash with known properties
     * @param hash
     */
    UserAgentApplication.prototype.urlContainsHash = function (hash) {
        this.logger.verbose("UrlContainsHash has been called");
        return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlContainsHash(hash);
    };
    UserAgentApplication.prototype.authResponseHandler = function (interactionType, response, resolve) {
        this.logger.verbose("AuthResponseHandler has been called");
        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
            this.logger.verbose("Interaction type is redirect");
            if (this.errorReceivedCallback) {
                this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response");
                this.tokenReceivedCallback(response);
            }
            else if (this.authResponseCallback) {
                this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response");
                this.authResponseCallback(null, response);
            }
        }
        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup) {
            this.logger.verbose("Interaction type is popup, resolving");
            resolve(response);
        }
        else {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidInteractionTypeError();
        }
    };
    UserAgentApplication.prototype.authErrorHandler = function (interactionType, authErr, response, reject) {
        this.logger.verbose("AuthErrorHandler has been called");
        // set interaction_status to complete
        this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
            this.logger.verbose("Interaction type is redirect");
            if (this.errorReceivedCallback) {
                this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback");
                this.errorReceivedCallback(authErr, response.accountState);
            }
            else if (this.authResponseCallback) {
                this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error");
                this.authResponseCallback(authErr, response);
            }
            else {
                this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error");
                throw authErr;
            }
        }
        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup) {
            this.logger.verbose("Interaction type is popup, rejecting");
            reject(authErr);
        }
        else {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidInteractionTypeError();
        }
    };
    // #endregion
    /**
     * Use when initiating the login process by redirecting the user's browser to the authorization endpoint.
     * @param {@link (AuthenticationParameters:type)}
     */
    UserAgentApplication.prototype.loginRedirect = function (userRequest) {
        this.logger.verbose("LoginRedirect has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, true, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect);
        this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, true, request, null, null);
    };
    /**
     * Use when you want to obtain an access_token for your API by redirecting the user's browser window to the authorization endpoint.
     * @param {@link (AuthenticationParameters:type)}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     */
    UserAgentApplication.prototype.acquireTokenRedirect = function (userRequest) {
        this.logger.verbose("AcquireTokenRedirect has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect);
        this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, false, request, null, null);
    };
    /**
     * Use when initiating the login process via opening a popup window in the user's browser
     *
     * @param {@link (AuthenticationParameters:type)}
     *
     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object
     */
    UserAgentApplication.prototype.loginPopup = function (userRequest) {
        var _this = this;
        this.logger.verbose("LoginPopup has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, true, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup);
        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].LoginPopup);
        return new Promise(function (resolve, reject) {
            _this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup, true, request, resolve, reject);
        })
            .then(function (resp) {
            _this.logger.verbose("Successfully logged in");
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);
            return resp;
        })
            .catch(function (error) {
            _this.cacheStorage.resetTempCacheItems(request.state);
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);
            throw error;
        });
    };
    /**
     * Use when you want to obtain an access_token for your API via opening a popup window in the user's browser
     * @param {@link AuthenticationParameters}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object
     */
    UserAgentApplication.prototype.acquireTokenPopup = function (userRequest) {
        var _this = this;
        this.logger.verbose("AcquireTokenPopup has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup);
        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].AcquireTokenPopup);
        return new Promise(function (resolve, reject) {
            _this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup, false, request, resolve, reject);
        })
            .then(function (resp) {
            _this.logger.verbose("Successfully acquired token");
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);
            return resp;
        })
            .catch(function (error) {
            _this.cacheStorage.resetTempCacheItems(request.state);
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);
            throw error;
        });
    };
    // #region Acquire Token
    /**
     * Use when initiating the login process or when you want to obtain an access_token for your API,
     * either by redirecting the user's browser window to the authorization endpoint or via opening a popup window in the user's browser.
     * @param {@link (AuthenticationParameters:type)}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     */
    UserAgentApplication.prototype.acquireTokenInteractive = function (interactionType, isLoginCall, request, resolve, reject) {
        var _this = this;
        this.logger.verbose("AcquireTokenInteractive has been called");
        // block the request if made from the hidden iframe
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].blockReloadInHiddenIframes();
        var interactionProgress = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].REDIRECT_REQUEST, "" + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].resourceDelimiter + request.state);
        }
        // If already in progress, do not proceed
        if (interactionProgress === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress) {
            var thrownError = isLoginCall ? _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createLoginInProgressError() : _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createAcquireTokenInProgressError();
            var stateOnlyResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(this.getAccountState(request.state));
            this.cacheStorage.resetTempCacheItems(request.state);
            this.authErrorHandler(interactionType, thrownError, stateOnlyResponse, reject);
            return;
        }
        // Get the account object if a session exists
        var account;
        if (request && request.account && !isLoginCall) {
            account = request.account;
            this.logger.verbose("Account set from request");
        }
        else {
            account = this.getAccount();
            this.logger.verbose("Account set from MSAL Cache");
        }
        // If no session exists, prompt the user to login.
        if (!account && !_ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].isSSOParam(request)) {
            if (isLoginCall) {
                // extract ADAL id_token if exists
                var adalIdToken = this.extractADALIdToken();
                // silent login if ADAL id_token is retrieved successfully - SSO
                if (adalIdToken && !request.scopes) {
                    this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");
                    var tokenRequest = this.buildIDTokenRequest(request);
                    this.silentLogin = true;
                    this.acquireTokenSilent(tokenRequest).then(function (response) {
                        _this.silentLogin = false;
                        _this.logger.info("Unified cache call is successful");
                        _this.authResponseHandler(interactionType, response, resolve);
                        return;
                    }, function (error) {
                        _this.silentLogin = false;
                        _this.logger.error("Error occurred during unified cache ATS: " + error);
                        // proceed to login since ATS failed
                        _this.acquireTokenHelper(null, interactionType, isLoginCall, request, resolve, reject);
                    });
                }
                // No ADAL token found, proceed to login
                else {
                    this.logger.verbose("Login call but no token found, proceed to login");
                    this.acquireTokenHelper(null, interactionType, isLoginCall, request, resolve, reject);
                }
            }
            // AcquireToken call, but no account or context given, so throw error
            else {
                this.logger.verbose("AcquireToken call, no context or account given");
                this.logger.info("User login is required");
                var stateOnlyResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(this.getAccountState(request.state));
                this.cacheStorage.resetTempCacheItems(request.state);
                this.authErrorHandler(interactionType, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createUserLoginRequiredError(), stateOnlyResponse, reject);
                return;
            }
        }
        // User session exists
        else {
            this.logger.verbose("User session exists, login not required");
            this.acquireTokenHelper(account, interactionType, isLoginCall, request, resolve, reject);
        }
    };
    /**
     * @hidden
     * @ignore
     * Helper function to acquireToken
     *
     */
    UserAgentApplication.prototype.acquireTokenHelper = function (account, interactionType, isLoginCall, request, resolve, reject) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var requestSignature, serverAuthenticationRequest, acquireTokenAuthority, popUpWindow, responseType, loginStartPage, urlNavigate, hash, error_1, navigate, err_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.logger.verbose("AcquireTokenHelper has been called");
                        this.logger.verbose("Interaction type: " + interactionType + ". isLoginCall: " + isLoginCall);
                        // Track the acquireToken progress
                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress);
                        requestSignature = request.scopes ? request.scopes.join(" ").toLowerCase() : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes.join(" ");
                        this.logger.verbosePii("Request signature: " + requestSignature);
                        acquireTokenAuthority = (request && request.authority) ? _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata) : this.authorityInstance;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 11, , 12]);
                        if (!!acquireTokenAuthority.hasCachedMetadata()) return [3 /*break*/, 3];
                        this.logger.verbose("No cached metadata for authority");
                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromNetwork(acquireTokenAuthority, this.telemetryManager, request.correlationId)];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.logger.verbose("Cached metadata found for authority");
                        _a.label = 4;
                    case 4:
                        responseType = isLoginCall ? _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ResponseTypes"].id_token : this.getTokenType(account, request.scopes);
                        loginStartPage = request.redirectStartPage || window.location.href;
                        serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"](acquireTokenAuthority, this.clientId, responseType, this.getRedirectUri(request && request.redirectUri), request.scopes, request.state, request.correlationId);
                        this.logger.verbose("Finished building server authentication request");
                        this.updateCacheEntries(serverAuthenticationRequest, account, isLoginCall, loginStartPage);
                        this.logger.verbose("Updating cache entries");
                        // populate QueryParameters (sid/login_hint) and any other extraQueryParameters set by the developer
                        serverAuthenticationRequest.populateQueryParams(account, request);
                        this.logger.verbose("Query parameters populated from account");
                        urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].createNavigateUrl(serverAuthenticationRequest) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].response_mode_fragment;
                        // set state in cache
                        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
                            if (!isLoginCall) {
                                this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_ACQ_TOKEN, request.state), serverAuthenticationRequest.state, this.inCookie);
                                this.logger.verbose("State cached for redirect");
                                this.logger.verbosePii("State cached: " + serverAuthenticationRequest.state);
                            }
                            else {
                                this.logger.verbose("Interaction type redirect but login call is true. State not cached");
                            }
                        }
                        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup) {
                            window.renewStates.push(serverAuthenticationRequest.state);
                            window.requestType = isLoginCall ? _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
                            this.logger.verbose("State saved to window");
                            this.logger.verbosePii("State saved: " + serverAuthenticationRequest.state);
                            // Register callback to capture results from server
                            this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);
                        }
                        else {
                            this.logger.verbose("Invalid interaction error. State not cached");
                            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidInteractionTypeError();
                        }
                        if (!(interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup)) return [3 /*break*/, 9];
                        this.logger.verbose("Interaction type is popup. Generating popup window");
                        // Generate a popup window
                        try {
                            popUpWindow = this.openPopup(urlNavigate, "msal", _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].popUpWidth, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].popUpHeight);
                            // Push popup window handle onto stack for tracking
                            _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].trackPopup(popUpWindow);
                        }
                        catch (e) {
                            this.logger.info(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.code + ":" + _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.desc);
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.code);
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.desc);
                            if (reject) {
                                reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createPopupWindowError());
                                return [2 /*return*/];
                            }
                        }
                        if (!popUpWindow) return [3 /*break*/, 8];
                        _a.label = 5;
                    case 5:
                        _a.trys.push([5, 7, , 8]);
                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].monitorPopupForHash(popUpWindow, this.config.system.loadFrameTimeout, urlNavigate, this.logger)];
                    case 6:
                        hash = _a.sent();
                        this.handleAuthenticationResponse(hash);
                        // Request completed successfully, set to completed
                        this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
                        this.logger.info("Closing popup window");
                        // TODO: Check how this can be extracted for any framework specific code?
                        if (this.config.framework.isAngular) {
                            this.broadcast("msal:popUpHashChanged", hash);
                        }
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].closePopups();
                        return [3 /*break*/, 8];
                    case 7:
                        error_1 = _a.sent();
                        if (reject) {
                            reject(error_1);
                        }
                        if (this.config.framework.isAngular) {
                            this.broadcast("msal:popUpClosed", error_1.errorCode + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].resourceDelimiter + error_1.errorMessage);
                        }
                        else {
                            // Request failed, set to canceled
                            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
                            popUpWindow.close();
                        }
                        return [3 /*break*/, 8];
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        // If onRedirectNavigate is implemented, invoke it and provide urlNavigate
                        if (request.onRedirectNavigate) {
                            this.logger.verbose("Invoking onRedirectNavigate callback");
                            navigate = request.onRedirectNavigate(urlNavigate);
                            // Returning false from onRedirectNavigate will stop navigation
                            if (navigate !== false) {
                                this.logger.verbose("onRedirectNavigate did not return false, navigating");
                                this.navigateWindow(urlNavigate);
                            }
                            else {
                                this.logger.verbose("onRedirectNavigate returned false, stopping navigation");
                            }
                        }
                        else {
                            // Otherwise, perform navigation
                            this.logger.verbose("Navigating window to urlNavigate");
                            this.navigateWindow(urlNavigate);
                        }
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        err_1 = _a.sent();
                        this.logger.error(err_1);
                        this.cacheStorage.resetTempCacheItems(request.state);
                        this.authErrorHandler(interactionType, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createEndpointResolutionError(err_1.toString), Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(request.state), reject);
                        if (popUpWindow) {
                            popUpWindow.close();
                        }
                        return [3 /*break*/, 12];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * API interfacing idToken request when applications already have a session/hint acquired by authorization client applications
     * @param request
     */
    UserAgentApplication.prototype.ssoSilent = function (request) {
        this.logger.verbose("ssoSilent has been called");
        // throw an error on an empty request
        if (!request) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createEmptyRequestError();
        }
        // throw an error on no hints passed
        if (!request.sid && !request.loginHint) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createSsoSilentError();
        }
        return this.acquireTokenSilent(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, request, { scopes: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes }));
    };
    /**
     * Use this function to obtain a token before every call to the API / resource provider
     *
     * MSAL return's a cached token when available
     * Or it send's a request to the STS to obtain a new token using a hidden iframe.
     *
     * @param {@link AuthenticationParameters}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object
     *
     */
    UserAgentApplication.prototype.acquireTokenSilent = function (userRequest) {
        var _this = this;
        this.logger.verbose("AcquireTokenSilent has been called");
        // validate the request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeSilent);
        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].AcquireTokenSilent);
        var requestSignature = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].createRequestSignature(request);
        return new Promise(function (resolve, reject) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
            var scope, account, adalIdToken, responseType, serverAuthenticationRequest, adalIdTokenObject, userContainedClaims, authErr, cacheResultResponse, logMessage, err_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        // block the request if made from the hidden iframe
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].blockReloadInHiddenIframes();
                        scope = request.scopes.join(" ").toLowerCase();
                        this.logger.verbosePii("Serialized scopes: " + scope);
                        if (request.account) {
                            account = request.account;
                            this.logger.verbose("Account set from request");
                        }
                        else {
                            account = this.getAccount();
                            this.logger.verbose("Account set from MSAL Cache");
                        }
                        adalIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].adalIdToken);
                        // In the event of no account being passed in the config, no session id, and no pre-existing adalIdToken, user will need to log in
                        if (!account && !(request.sid || request.loginHint) && _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(adalIdToken)) {
                            this.logger.info("User login is required");
                            // The promise rejects with a UserLoginRequiredError, which should be caught and user should be prompted to log in interactively
                            return [2 /*return*/, reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createUserLoginRequiredError())];
                        }
                        responseType = this.getTokenType(account, request.scopes);
                        this.logger.verbose("Response type: " + responseType);
                        serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"](_authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata), this.clientId, responseType, this.getRedirectUri(request.redirectUri), request.scopes, request.state, request.correlationId);
                        this.logger.verbose("Finished building server authentication request");
                        // populate QueryParameters (sid/login_hint) and any other extraQueryParameters set by the developer
                        if (_ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].isSSOParam(request) || account) {
                            serverAuthenticationRequest.populateQueryParams(account, request, null, true);
                            this.logger.verbose("Query parameters populated from existing SSO or account");
                        }
                        // if user didn't pass login_hint/sid and adal's idtoken is present, extract the login_hint from the adalIdToken
                        else if (!account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(adalIdToken)) {
                            adalIdTokenObject = _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__["TokenUtils"].extractIdToken(adalIdToken);
                            this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters");
                            serverAuthenticationRequest.populateQueryParams(account, null, adalIdTokenObject, true);
                        }
                        else {
                            this.logger.verbose("No additional query parameters added");
                        }
                        userContainedClaims = request.claimsRequest || serverAuthenticationRequest.claimsValue;
                        // If request.forceRefresh is set to true, force a request for a new token instead of getting it from the cache
                        if (!userContainedClaims && !request.forceRefresh) {
                            try {
                                cacheResultResponse = this.getCachedToken(serverAuthenticationRequest, account);
                            }
                            catch (e) {
                                authErr = e;
                            }
                        }
                        if (!cacheResultResponse) return [3 /*break*/, 1];
                        this.logger.verbose("Token found in cache lookup");
                        this.logger.verbosePii("Scopes found: " + JSON.stringify(cacheResultResponse.scopes));
                        resolve(cacheResultResponse);
                        return [2 /*return*/, null];
                    case 1:
                        if (!authErr) return [3 /*break*/, 2];
                        this.logger.infoPii(authErr.errorCode + ":" + authErr.errorMessage);
                        reject(authErr);
                        return [2 /*return*/, null];
                    case 2:
                        logMessage = void 0;
                        if (userContainedClaims) {
                            logMessage = "Skipped cache lookup since claims were given";
                        }
                        else if (request.forceRefresh) {
                            logMessage = "Skipped cache lookup since request.forceRefresh option was set to true";
                        }
                        else {
                            logMessage = "No valid token found in cache lookup";
                        }
                        this.logger.verbose(logMessage);
                        // Cache result can return null if cache is empty. In that case, set authority to default value if no authority is passed to the API.
                        if (!serverAuthenticationRequest.authorityInstance) {
                            serverAuthenticationRequest.authorityInstance = request.authority ?
                                _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata)
                                : this.authorityInstance;
                        }
                        this.logger.verbosePii("Authority instance: " + serverAuthenticationRequest.authority);
                        _a.label = 3;
                    case 3:
                        _a.trys.push([3, 7, , 8]);
                        if (!!serverAuthenticationRequest.authorityInstance.hasCachedMetadata()) return [3 /*break*/, 5];
                        this.logger.verbose("No cached metadata for authority");
                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromNetwork(serverAuthenticationRequest.authorityInstance, this.telemetryManager, request.correlationId)];
                    case 4:
                        _a.sent();
                        this.logger.verbose("Authority has been updated with endpoint discovery response");
                        return [3 /*break*/, 6];
                    case 5:
                        this.logger.verbose("Cached metadata found for authority");
                        _a.label = 6;
                    case 6:
                        /*
                         * refresh attempt with iframe
                         * Already renewing for this scope, callback when we get the token.
                         */
                        if (window.activeRenewals[requestSignature]) {
                            this.logger.verbose("Renewing token in progress. Registering callback");
                            // Active renewals contains the state for each renewal.
                            this.registerCallback(window.activeRenewals[requestSignature], requestSignature, resolve, reject);
                        }
                        else {
                            if (request.scopes && _ScopeSet__WEBPACK_IMPORTED_MODULE_9__["ScopeSet"].onlyContainsOidcScopes(request.scopes)) {
                                /*
                                 * App uses idToken to send to api endpoints
                                 * Default scope is tracked as OIDC scopes to store this token
                                 */
                                this.logger.verbose("OpenID Connect scopes only, renewing idToken");
                                this.silentLogin = true;
                                this.renewIdToken(requestSignature, resolve, reject, account, serverAuthenticationRequest);
                            }
                            else {
                                // renew access token
                                this.logger.verbose("Renewing access token");
                                this.renewToken(requestSignature, resolve, reject, account, serverAuthenticationRequest);
                            }
                        }
                        return [3 /*break*/, 8];
                    case 7:
                        err_2 = _a.sent();
                        this.logger.error(err_2);
                        reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createEndpointResolutionError(err_2.toString()));
                        return [2 /*return*/, null];
                    case 8: return [2 /*return*/];
                }
            });
        }); })
            .then(function (res) {
            _this.logger.verbose("Successfully acquired token");
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);
            return res;
        })
            .catch(function (error) {
            _this.cacheStorage.resetTempCacheItems(request.state);
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);
            throw error;
        });
    };
    // #endregion
    // #region Popup Window Creation
    /**
     * @hidden
     *
     * Configures popup window for login.
     *
     * @param urlNavigate
     * @param title
     * @param popUpWidth
     * @param popUpHeight
     * @ignore
     * @hidden
     */
    UserAgentApplication.prototype.openPopup = function (urlNavigate, title, popUpWidth, popUpHeight) {
        this.logger.verbose("OpenPopup has been called");
        try {
            /**
             * adding winLeft and winTop to account for dual monitor
             * using screenLeft and screenTop for IE8 and earlier
             */
            var winLeft = window.screenLeft ? window.screenLeft : window.screenX;
            var winTop = window.screenTop ? window.screenTop : window.screenY;
            /**
             * window.innerWidth displays browser window"s height and width excluding toolbars
             * using document.documentElement.clientWidth for IE8 and earlier
             */
            var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            var height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
            var left = ((width / 2) - (popUpWidth / 2)) + winLeft;
            var top_1 = ((height / 2) - (popUpHeight / 2)) + winTop;
            // open the window
            var popupWindow = window.open(urlNavigate, title, "width=" + popUpWidth + ", height=" + popUpHeight + ", top=" + top_1 + ", left=" + left + ", scrollbars=yes");
            if (!popupWindow) {
                throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createPopupWindowError();
            }
            if (popupWindow.focus) {
                popupWindow.focus();
            }
            return popupWindow;
        }
        catch (e) {
            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createPopupWindowError(e.toString());
        }
    };
    // #endregion
    // #region Iframe Management
    /**
     * @hidden
     * Calling _loadFrame but with a timeout to signal failure in loadframeStatus. Callbacks are left.
     * registered when network errors occur and subsequent token requests for same resource are registered to the pending request.
     * @ignore
     */
    UserAgentApplication.prototype.loadIframeTimeout = function (urlNavigate, frameName, requestSignature) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var expectedState, iframe, _a, hash, error_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        expectedState = window.activeRenewals[requestSignature];
                        this.logger.verbosePii("Set loading state to pending for: " + requestSignature + ":" + expectedState);
                        this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, expectedState), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress);
                        if (!this.config.system.navigateFrameWait) return [3 /*break*/, 2];
                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].loadFrame(urlNavigate, frameName, this.config.system.navigateFrameWait, this.logger)];
                    case 1:
                        _a = _b.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        _a = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].loadFrameSync(urlNavigate, frameName, this.logger);
                        _b.label = 3;
                    case 3:
                        iframe = _a;
                        _b.label = 4;
                    case 4:
                        _b.trys.push([4, 6, , 7]);
                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].monitorIframeForHash(iframe.contentWindow, this.config.system.loadFrameTimeout, urlNavigate, this.logger)];
                    case 5:
                        hash = _b.sent();
                        if (hash) {
                            this.handleAuthenticationResponse(hash);
                        }
                        return [3 /*break*/, 7];
                    case 6:
                        error_2 = _b.sent();
                        if (this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, expectedState)) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress) {
                            // fail the iframe session if it's in pending state
                            this.logger.verbose("Loading frame has timed out after: " + (this.config.system.loadFrameTimeout / 1000) + " seconds for scope/authority " + requestSignature + ":" + expectedState);
                            // Error after timeout
                            if (expectedState && window.callbackMappedToRenewStates[expectedState]) {
                                window.callbackMappedToRenewStates[expectedState](null, error_2);
                            }
                            this.cacheStorage.removeItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, expectedState));
                        }
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].removeHiddenIframe(iframe);
                        throw error_2;
                    case 7:
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].removeHiddenIframe(iframe);
                        return [2 /*return*/];
                }
            });
        });
    };
    // #endregion
    // #region General Helpers
    /**
     * @hidden
     * Used to redirect the browser to the STS authorization endpoint
     * @param {string} urlNavigate - URL of the authorization endpoint
     */
    UserAgentApplication.prototype.navigateWindow = function (urlNavigate, popupWindow) {
        // Navigate if valid URL
        if (urlNavigate && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(urlNavigate)) {
            var navigateWindow = popupWindow ? popupWindow : window;
            var logMessage = popupWindow ? "Navigated Popup window to:" + urlNavigate : "Navigate to:" + urlNavigate;
            this.logger.infoPii(logMessage);
            navigateWindow.location.assign(urlNavigate);
        }
        else {
            this.logger.info("Navigate url is empty");
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Navigate url is empty");
        }
    };
    /**
     * @hidden
     * Used to add the developer requested callback to the array of callbacks for the specified scopes. The updated array is stored on the window object
     * @param {string} expectedState - Unique state identifier (guid).
     * @param {string} scope - Developer requested permissions. Not all scopes are guaranteed to be included in the access token returned.
     * @param {Function} resolve - The resolve function of the promise object.
     * @param {Function} reject - The reject function of the promise object.
     * @ignore
     */
    UserAgentApplication.prototype.registerCallback = function (expectedState, requestSignature, resolve, reject) {
        var _this = this;
        // track active renewals
        window.activeRenewals[requestSignature] = expectedState;
        // initialize callbacks mapped array
        if (!window.promiseMappedToRenewStates[expectedState]) {
            window.promiseMappedToRenewStates[expectedState] = [];
        }
        // indexing on the current state, push the callback params to callbacks mapped
        window.promiseMappedToRenewStates[expectedState].push({ resolve: resolve, reject: reject });
        // Store the server response in the current window??
        if (!window.callbackMappedToRenewStates[expectedState]) {
            window.callbackMappedToRenewStates[expectedState] = function (response, error) {
                // reset active renewals
                window.activeRenewals[requestSignature] = null;
                // for all promiseMappedtoRenewStates for a given 'state' - call the reject/resolve with error/token respectively
                for (var i = 0; i < window.promiseMappedToRenewStates[expectedState].length; ++i) {
                    try {
                        if (error) {
                            window.promiseMappedToRenewStates[expectedState][i].reject(error);
                        }
                        else if (response) {
                            window.promiseMappedToRenewStates[expectedState][i].resolve(response);
                        }
                        else {
                            _this.cacheStorage.resetTempCacheItems(expectedState);
                            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Error and response are both null");
                        }
                    }
                    catch (e) {
                        _this.logger.warning(e);
                    }
                }
                // reset
                window.promiseMappedToRenewStates[expectedState] = null;
                window.callbackMappedToRenewStates[expectedState] = null;
            };
        }
    };
    // #endregion
    // #region Logout
    /**
     * Use to log out the current user, and redirect the user to the postLogoutRedirectUri.
     * Default behaviour is to redirect the user to `window.location.href`.
     */
    UserAgentApplication.prototype.logout = function (correlationId) {
        this.logger.verbose("Logout has been called");
        this.logoutAsync(correlationId);
    };
    /**
     * Async version of logout(). Use to log out the current user.
     * @param correlationId Request correlationId
     */
    UserAgentApplication.prototype.logoutAsync = function (correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var requestCorrelationId, apiEvent, correlationIdParam, postLogoutQueryParam, urlNavigate, error_3;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        requestCorrelationId = correlationId || _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_28__["CryptoUtils"].createNewGuid();
                        apiEvent = this.telemetryManager.createAndStartApiEvent(requestCorrelationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].Logout);
                        this.clearCache();
                        this.account = null;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 5, , 6]);
                        if (!!this.authorityInstance.hasCachedMetadata()) return [3 /*break*/, 3];
                        this.logger.verbose("No cached metadata for authority");
                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromNetwork(this.authorityInstance, this.telemetryManager, correlationId)];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.logger.verbose("Cached metadata found for authority");
                        _a.label = 4;
                    case 4:
                        correlationIdParam = "client-request-id=" + requestCorrelationId;
                        postLogoutQueryParam = void 0;
                        if (this.getPostLogoutRedirectUri()) {
                            postLogoutQueryParam = "&post_logout_redirect_uri=" + encodeURIComponent(this.getPostLogoutRedirectUri());
                            this.logger.verbose("redirectUri found and set");
                        }
                        else {
                            postLogoutQueryParam = "";
                            this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty");
                        }
                        urlNavigate = void 0;
                        if (this.authorityInstance.EndSessionEndpoint) {
                            urlNavigate = this.authorityInstance.EndSessionEndpoint + "?" + correlationIdParam + postLogoutQueryParam;
                            this.logger.verbose("EndSessionEndpoint found and urlNavigate set");
                            this.logger.verbosePii("urlNavigate set to: " + this.authorityInstance.EndSessionEndpoint);
                        }
                        else {
                            urlNavigate = this.authority + "oauth2/v2.0/logout?" + correlationIdParam + postLogoutQueryParam;
                            this.logger.verbose("No endpoint, urlNavigate set to default");
                        }
                        this.telemetryManager.stopAndFlushApiEvent(requestCorrelationId, apiEvent, true);
                        this.logger.verbose("Navigating window to urlNavigate");
                        this.navigateWindow(urlNavigate);
                        return [3 /*break*/, 6];
                    case 5:
                        error_3 = _a.sent();
                        this.telemetryManager.stopAndFlushApiEvent(requestCorrelationId, apiEvent, false, error_3.errorCode);
                        return [3 /*break*/, 6];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * @hidden
     * Clear all access tokens and ID tokens in the cache.
     * @ignore
     */
    UserAgentApplication.prototype.clearCache = function () {
        this.logger.verbose("Clearing cache");
        window.renewStates = [];
        var tokenCacheItems = this.cacheStorage.getAllTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].homeAccountIdentifier);
        for (var i = 0; i < tokenCacheItems.length; i++) {
            this.cacheStorage.removeItem(JSON.stringify(tokenCacheItems[i].key));
        }
        this.cacheStorage.resetCacheItems();
        this.cacheStorage.clearMsalCookie();
        this.logger.verbose("Cache cleared");
    };
    /**
     * @hidden
     * Clear a given access token from the cache.
     *
     * @param accessToken
     */
    UserAgentApplication.prototype.clearCacheForScope = function (accessToken) {
        this.logger.verbose("Clearing access token from cache");
        var accessTokenItems = this.cacheStorage.getAllAccessTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].homeAccountIdentifier);
        for (var i = 0; i < accessTokenItems.length; i++) {
            var token = accessTokenItems[i];
            if (token.value.accessToken === accessToken) {
                this.cacheStorage.removeItem(JSON.stringify(token.key));
                this.logger.verbosePii("Access token removed: " + token.key);
            }
        }
    };
    // #endregion
    // #region Response
    /**
     * @hidden
     * @ignore
     * Checks if the redirect response is received from the STS. In case of redirect, the url fragment has either id_token, access_token or error.
     * @param {string} hash - Hash passed from redirect page.
     * @returns {Boolean} - true if response contains id_token, access_token or error, false otherwise.
     */
    UserAgentApplication.prototype.isCallback = function (hash) {
        this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0.");
        this.logger.verbose("isCallback has been called");
        return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlContainsHash(hash);
    };
    /**
     * @hidden
     * Used to call the constructor callback with the token/error
     * @param {string} [hash=window.location.hash] - Hash fragment of Url.
     */
    UserAgentApplication.prototype.processCallBack = function (hash, stateInfo, parentCallback) {
        this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");
        // get the state info from the hash
        if (!stateInfo) {
            this.logger.verbose("StateInfo is null, getting stateInfo from hash");
            stateInfo = this.getResponseState(hash);
        }
        var response;
        var authErr;
        // Save the token info from the hash
        try {
            response = this.saveTokenFromHash(hash, stateInfo);
        }
        catch (err) {
            authErr = err;
        }
        try {
            // Clear the cookie in the hash
            this.cacheStorage.clearMsalCookie(stateInfo.state);
            var accountState = this.getAccountState(stateInfo.state);
            if (response) {
                if ((stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken) || response.accessToken) {
                    if (window.parent !== window) {
                        this.logger.verbose("Window is in iframe, acquiring token silently");
                    }
                    else {
                        this.logger.verbose("Acquiring token interactive in progress");
                    }
                    this.logger.verbose("Response tokenType set to " + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN);
                    response.tokenType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN;
                }
                else if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login) {
                    this.logger.verbose("Response tokenType set to " + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN);
                    response.tokenType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN;
                }
                if (!parentCallback) {
                    this.logger.verbose("Setting redirectResponse");
                    this.redirectResponse = response;
                    return;
                }
            }
            else if (!parentCallback) {
                this.logger.verbose("Response is null, setting redirectResponse with state");
                this.redirectResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(accountState);
                this.redirectError = authErr;
                this.cacheStorage.resetTempCacheItems(stateInfo.state);
                return;
            }
            this.logger.verbose("Calling callback provided to processCallback");
            parentCallback(response, authErr);
        }
        catch (err) {
            this.logger.error("Error occurred in token received callback function: " + err);
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createErrorInCallbackFunction(err.toString());
        }
    };
    /**
     * @hidden
     * This method must be called for processing the response received from the STS if using popups or iframes. It extracts the hash, processes the token or error
     * information and saves it in the cache. It then resolves the promises with the result.
     * @param {string} [hash=window.location.hash] - Hash fragment of Url.
     */
    UserAgentApplication.prototype.handleAuthenticationResponse = function (hash) {
        this.logger.verbose("HandleAuthenticationResponse has been called");
        // retrieve the hash
        var locationHash = hash || window.location.hash;
        // if (window.parent !== window), by using self, window.parent becomes equal to window in getResponseState method specifically
        var stateInfo = this.getResponseState(locationHash);
        this.logger.verbose("Obtained state from response");
        var tokenResponseCallback = window.callbackMappedToRenewStates[stateInfo.state];
        this.processCallBack(locationHash, stateInfo, tokenResponseCallback);
    };
    /**
     * @hidden
     * This method must be called for processing the response received from the STS when using redirect flows. It extracts the hash, processes the token or error
     * information and saves it in the cache. The result can then be accessed by user registered callbacks.
     * @param {string} [hash=window.location.hash] - Hash fragment of Url.
     */
    UserAgentApplication.prototype.handleRedirectAuthenticationResponse = function (hash) {
        this.logger.info("Returned from redirect url");
        this.logger.verbose("HandleRedirectAuthenticationResponse has been called");
        // clear hash from window
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].clearUrlFragment();
        this.logger.verbose("Window.location.hash cleared");
        // if (window.parent !== window), by using self, window.parent becomes equal to window in getResponseState method specifically
        var stateInfo = this.getResponseState(hash);
        // if set to navigate to loginRequest page post login
        if (this.config.auth.navigateToLoginRequestUrl && window.parent === window) {
            this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");
            var loginRequestUrl = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].LOGIN_REQUEST, stateInfo.state), this.inCookie);
            // Redirect to home page if login request url is null (real null or the string null)
            if (!loginRequestUrl || loginRequestUrl === "null") {
                this.logger.error("Unable to get valid login request url from cache, redirecting to home page");
                window.location.assign("/");
                return;
            }
            else {
                this.logger.verbose("Valid login request url obtained from cache");
                var currentUrl = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].removeHashFromUrl(window.location.href);
                var finalRedirectUrl = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].removeHashFromUrl(loginRequestUrl);
                if (currentUrl !== finalRedirectUrl) {
                    this.logger.verbose("Current url is not login request url, navigating");
                    this.logger.verbosePii("CurrentUrl: " + currentUrl + ", finalRedirectUrl: " + finalRedirectUrl);
                    window.location.assign("" + finalRedirectUrl + hash);
                    return;
                }
                else {
                    this.logger.verbose("Current url matches login request url");
                    var loginRequestUrlComponents = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].GetUrlComponents(loginRequestUrl);
                    if (loginRequestUrlComponents.Hash) {
                        this.logger.verbose("Login request url contains hash, resetting non-msal hash");
                        window.location.hash = loginRequestUrlComponents.Hash;
                    }
                }
            }
        }
        else if (!this.config.auth.navigateToLoginRequestUrl) {
            this.logger.verbose("Default navigation to start page after login turned off");
        }
        this.processCallBack(hash, stateInfo, null);
    };
    /**
     * @hidden
     * Creates a stateInfo object from the URL fragment and returns it.
     * @param {string} hash  -  Hash passed from redirect page
     * @returns {TokenResponse} an object created from the redirect response from AAD comprising of the keys - parameters, requestType, stateMatch, stateResponse and valid.
     * @ignore
     */
    UserAgentApplication.prototype.getResponseState = function (hash) {
        this.logger.verbose("GetResponseState has been called");
        var parameters = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].deserializeHash(hash);
        var stateResponse;
        if (!parameters) {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Hash was not parsed correctly.");
        }
        if (parameters.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].STATE)) {
            this.logger.verbose("Hash contains state. Creating stateInfo object");
            var parsedState = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].parseLibraryState(parameters.state);
            stateResponse = {
                requestType: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].unknown,
                state: parameters.state,
                timestamp: parsedState.ts,
                method: parsedState.method,
                stateMatch: false
            };
        }
        else {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Hash does not contain state.");
        }
        /*
         * async calls can fire iframe and login request at the same time if developer does not use the API as expected
         * incoming callback needs to be looked up to find the request type
         */
        // loginRedirect
        if (stateResponse.state === this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_LOGIN, stateResponse.state), this.inCookie) || stateResponse.state === this.silentAuthenticationState) {
            this.logger.verbose("State matches cached state, setting requestType to login");
            stateResponse.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login;
            stateResponse.stateMatch = true;
            return stateResponse;
        }
        // acquireTokenRedirect
        else if (stateResponse.state === this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_ACQ_TOKEN, stateResponse.state), this.inCookie)) {
            this.logger.verbose("State matches cached state, setting requestType to renewToken");
            stateResponse.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
            stateResponse.stateMatch = true;
            return stateResponse;
        }
        // external api requests may have many renewtoken requests for different resource
        if (!stateResponse.stateMatch) {
            this.logger.verbose("State does not match cached state, setting requestType to type from window");
            stateResponse.requestType = window.requestType;
            var statesInParentContext = window.renewStates;
            for (var i = 0; i < statesInParentContext.length; i++) {
                if (statesInParentContext[i] === stateResponse.state) {
                    this.logger.verbose("Matching state found for request");
                    stateResponse.stateMatch = true;
                    break;
                }
            }
            if (!stateResponse.stateMatch) {
                this.logger.verbose("Matching state not found for request");
            }
        }
        return stateResponse;
    };
    // #endregion
    // #region Token Processing (Extract to TokenProcessing.ts)
    /**
     * @hidden
     * Used to get token for the specified set of scopes from the cache
     * @param {@link ServerRequestParameters} - Request sent to the STS to obtain an id_token/access_token
     * @param {Account} account - Account for which the scopes were requested
     */
    UserAgentApplication.prototype.getCachedToken = function (serverAuthenticationRequest, account) {
        this.logger.verbose("GetCachedToken has been called");
        var scopes = serverAuthenticationRequest.scopes;
        /**
         * Id Token should be returned in every acquireTokenSilent call. The only exception is a response_type = token
         * request when a valid ID Token is not present in the cache.
         */
        var idToken = this.getCachedIdToken(serverAuthenticationRequest, account);
        var authResponse = this.getCachedAccessToken(serverAuthenticationRequest, account, scopes);
        var accountState = this.getAccountState(serverAuthenticationRequest.state);
        return _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__["ResponseUtils"].buildAuthResponse(idToken, authResponse, serverAuthenticationRequest, account, scopes, accountState);
    };
    /**
     * @hidden
     *
     * Uses passed in authority to further filter an array of tokenCacheItems until only the token being searched for remains, then returns that tokenCacheItem.
     * This method will throw if authority filtering still yields multiple matching tokens and will return null if not tokens match the authority passed in.
     *
     * @param authority
     * @param tokenCacheItems
     * @param request
     * @param requestScopes
     * @param tokenType
     */
    UserAgentApplication.prototype.getTokenCacheItemByAuthority = function (authority, tokenCacheItems, requestScopes, tokenType) {
        var _this = this;
        var filteredAuthorityItems;
        if (_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].isCommonAuthority(authority) || _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].isOrganizationsAuthority(authority)) {
            filteredAuthorityItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__["AuthCacheUtils"].filterTokenCacheItemsByDomain(tokenCacheItems, _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].GetUrlComponents(authority).HostNameAndPort);
        }
        else {
            filteredAuthorityItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__["AuthCacheUtils"].filterTokenCacheItemsByAuthority(tokenCacheItems, authority);
        }
        if (filteredAuthorityItems.length === 1) {
            return filteredAuthorityItems[0];
        }
        else if (filteredAuthorityItems.length > 1) {
            this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token.");
            filteredAuthorityItems.forEach(function (accessTokenCacheItem) {
                _this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
            });
            return null;
        }
        else {
            this.logger.verbose("No matching tokens of type " + tokenType + " found");
            return null;
        }
    };
    /**
     *
     * @hidden
     *
     * Searches the token cache for an ID Token that matches the request parameter and returns it as an IdToken object.
     *
     * @param serverAuthenticationRequest
     * @param account
     */
    UserAgentApplication.prototype.getCachedIdToken = function (serverAuthenticationRequest, account) {
        this.logger.verbose("Getting all cached tokens of type ID Token");
        var idTokenCacheItems = this.cacheStorage.getAllIdTokens(this.clientId, account ? account.homeAccountIdentifier : null);
        var matchAuthority = serverAuthenticationRequest.authority || this.authority;
        var idTokenCacheItem = this.getTokenCacheItemByAuthority(matchAuthority, idTokenCacheItems, null, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN);
        if (idTokenCacheItem) {
            this.logger.verbose("Evaluating ID token found");
            var idTokenIsStillValid = this.evaluateTokenExpiration(idTokenCacheItem);
            if (idTokenIsStillValid) {
                this.logger.verbose("ID token expiration is within offset, using ID token found in cache");
                var idTokenValue = idTokenCacheItem.value;
                if (idTokenValue) {
                    this.logger.verbose("ID Token found in cache is valid and unexpired");
                }
                else {
                    this.logger.verbose("ID Token found in cache is invalid");
                }
                return (idTokenValue) ? new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](idTokenValue.idToken) : null;
            }
            else {
                this.logger.verbose("Cached ID token is expired, removing from cache");
                this.cacheStorage.removeItem(JSON.stringify(idTokenCacheItem.key));
                return null;
            }
        }
        else {
            this.logger.verbose("No tokens found");
            return null;
        }
    };
    /**
     *
     * @hidden
     *
     * Searches the token cache for an access token that matches the request parameters and returns it as an AuthResponse.
     *
     * @param serverAuthenticationRequest
     * @param account
     * @param scopes
     */
    UserAgentApplication.prototype.getCachedAccessToken = function (serverAuthenticationRequest, account, scopes) {
        this.logger.verbose("Getting all cached tokens of type Access Token");
        var tokenCacheItems = this.cacheStorage.getAllAccessTokens(this.clientId, account ? account.homeAccountIdentifier : null);
        var scopeFilteredTokenCacheItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__["AuthCacheUtils"].filterTokenCacheItemsByScope(tokenCacheItems, scopes);
        var matchAuthority = serverAuthenticationRequest.authority || this.authority;
        // serverAuthenticationRequest.authority can only be common or organizations if not null
        var accessTokenCacheItem = this.getTokenCacheItemByAuthority(matchAuthority, scopeFilteredTokenCacheItems, scopes, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN);
        if (!accessTokenCacheItem) {
            this.logger.verbose("No matching token found when filtering by scope and authority");
            var authorityList = this.getUniqueAuthority(tokenCacheItems, "authority");
            if (authorityList.length > 1) {
                throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createMultipleAuthoritiesInCacheError(scopes.toString());
            }
            this.logger.verbose("Single authority used, setting authorityInstance");
            serverAuthenticationRequest.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(authorityList[0], this.config.auth.validateAuthority);
            return null;
        }
        else {
            serverAuthenticationRequest.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(accessTokenCacheItem.key.authority, this.config.auth.validateAuthority);
            this.logger.verbose("Evaluating access token found");
            var tokenIsStillValid = this.evaluateTokenExpiration(accessTokenCacheItem);
            // The response value will stay null if token retrieved from the cache is expired, otherwise it will be populated with said token's data
            if (tokenIsStillValid) {
                this.logger.verbose("Access token expiration is within offset, using access token found in cache");
                if (!account) {
                    account = this.getAccount();
                    if (!account) {
                        throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Account should not be null here.");
                    }
                }
                var aState = this.getAccountState(serverAuthenticationRequest.state);
                var response = {
                    uniqueId: "",
                    tenantId: "",
                    tokenType: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN,
                    idToken: null,
                    idTokenClaims: null,
                    accessToken: accessTokenCacheItem.value.accessToken,
                    scopes: accessTokenCacheItem.key.scopes.split(" "),
                    expiresOn: new Date(Number(accessTokenCacheItem.value.expiresIn) * 1000),
                    account: account,
                    accountState: aState,
                    fromCache: true
                };
                return response;
            }
            else {
                this.logger.verbose("Access token expired, removing from cache");
                this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
                return null;
            }
        }
    };
    /**
     * Returns true if the token passed in is within the acceptable expiration time offset, false if it is expired.
     * @param tokenCacheItem
     * @param serverAuthenticationRequest
     */
    UserAgentApplication.prototype.evaluateTokenExpiration = function (tokenCacheItem) {
        var expiration = Number(tokenCacheItem.value.expiresIn);
        return _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__["TokenUtils"].validateExpirationIsWithinOffset(expiration, this.config.system.tokenRenewalOffsetSeconds);
    };
    /**
     * @hidden
     * Used to get a unique list of authorities from the cache
     * @param {Array<AccessTokenCacheItem>}  accessTokenCacheItems - accessTokenCacheItems saved in the cache
     * @ignore
     */
    UserAgentApplication.prototype.getUniqueAuthority = function (accessTokenCacheItems, property) {
        this.logger.verbose("GetUniqueAuthority has been called");
        var authorityList = [];
        var flags = [];
        accessTokenCacheItems.forEach(function (element) {
            if (element.key.hasOwnProperty(property) && (flags.indexOf(element.key[property]) === -1)) {
                flags.push(element.key[property]);
                authorityList.push(element.key[property]);
            }
        });
        return authorityList;
    };
    /**
     * @hidden
     * Check if ADAL id_token exists and return if exists.
     *
     */
    UserAgentApplication.prototype.extractADALIdToken = function () {
        this.logger.verbose("ExtractADALIdToken has been called");
        var adalIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].adalIdToken);
        return (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(adalIdToken)) ? _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__["TokenUtils"].extractIdToken(adalIdToken) : null;
    };
    /**
     * @hidden
     * Acquires access token using a hidden iframe.
     * @ignore
     */
    UserAgentApplication.prototype.renewToken = function (requestSignature, resolve, reject, account, serverAuthenticationRequest) {
        this.logger.verbose("RenewToken has been called");
        this.logger.verbosePii("RenewToken scope and authority: " + requestSignature);
        var frameName = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].generateFrameName(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["FramePrefix"].TOKEN_FRAME, requestSignature);
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].addHiddenIFrame(frameName, this.logger);
        this.updateCacheEntries(serverAuthenticationRequest, account, false);
        this.logger.verbosePii("RenewToken expected state: " + serverAuthenticationRequest.state);
        // Build urlNavigate with "prompt=none" and navigate to URL in hidden iFrame
        var urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlRemoveQueryStringParameter(_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].createNavigateUrl(serverAuthenticationRequest), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt_none + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].response_mode_fragment;
        window.renewStates.push(serverAuthenticationRequest.state);
        window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
        this.logger.verbose("Set window.renewState and requestType");
        this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);
        this.logger.infoPii("Navigate to: " + urlNavigate);
        this.loadIframeTimeout(urlNavigate, frameName, requestSignature).catch(function (error) { return reject(error); });
    };
    /**
     * @hidden
     * Renews idtoken for app's own backend when clientId is passed as a single scope in the scopes array.
     * @ignore
     */
    UserAgentApplication.prototype.renewIdToken = function (requestSignature, resolve, reject, account, serverAuthenticationRequest) {
        this.logger.info("RenewIdToken has been called");
        var frameName = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].generateFrameName(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["FramePrefix"].ID_TOKEN_FRAME, requestSignature);
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].addHiddenIFrame(frameName, this.logger);
        this.updateCacheEntries(serverAuthenticationRequest, account, false);
        this.logger.verbose("RenewIdToken expected state: " + serverAuthenticationRequest.state);
        // Build urlNavigate with "prompt=none" and navigate to URL in hidden iFrame
        var urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlRemoveQueryStringParameter(_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].createNavigateUrl(serverAuthenticationRequest), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt_none + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].response_mode_fragment;
        if (this.silentLogin) {
            this.logger.verbose("Silent login is true, set silentAuthenticationState");
            window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login;
            this.silentAuthenticationState = serverAuthenticationRequest.state;
        }
        else {
            this.logger.verbose("Not silent login, set window.renewState and requestType");
            window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
            window.renewStates.push(serverAuthenticationRequest.state);
        }
        // note: scope here is clientId
        this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);
        this.logger.infoPii("Navigate to:\" " + urlNavigate);
        this.loadIframeTimeout(urlNavigate, frameName, requestSignature).catch(function (error) { return reject(error); });
    };
    /**
     * @hidden
     *
     * This method builds an Access Token Cache item and saves it to the cache, returning the original
     * AuthResponse augmented with a parsed expiresOn attribute.
     *
     * @param response The AuthResponse object that contains the token to be saved
     * @param authority The authority under which the ID token will be cached
     * @param scopes The scopes to be added to the cache item key (undefined for ID token cache items)
     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier
     * @param expiration Token expiration timestamp
     */
    UserAgentApplication.prototype.saveToken = function (response, authority, scopes, clientInfo, expiration) {
        var accessTokenKey = new _cache_AccessTokenKey__WEBPACK_IMPORTED_MODULE_1__["AccessTokenKey"](authority, this.clientId, scopes, clientInfo.uid, clientInfo.utid);
        var accessTokenValue = new _cache_AccessTokenValue__WEBPACK_IMPORTED_MODULE_2__["AccessTokenValue"](response.accessToken, response.idToken.rawIdToken, expiration.toString(), clientInfo.encodeClientInfo());
        this.cacheStorage.setItem(JSON.stringify(accessTokenKey), JSON.stringify(accessTokenValue));
        if (expiration) {
            this.logger.verbose("New expiration set for token");
            response.expiresOn = new Date(expiration * 1000);
        }
        else {
            this.logger.error("Could not parse expiresIn parameter for access token");
        }
        return response;
    };
    /**
     * @hidden
     *
     * This method sets up the elements of an ID Token cache item and calls saveToken to save it in
     * Access Token Cache item format for the client application to use.
     *
     * @param response The AuthResponse object that will be used to build the cache item
     * @param authority The authority under which the ID token will be cached
     * @param parameters The response's Hash Params, which contain the ID token returned from the server
     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier
     * @param idTokenObj ID Token object from which the ID token's expiration is extracted
     */
    /* tslint:disable:no-string-literal */
    UserAgentApplication.prototype.saveIdToken = function (response, authority, parameters, clientInfo, idTokenObj) {
        this.logger.verbose("SaveIdToken has been called");
        var idTokenResponse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, response);
        // Scopes are undefined so they don't show up in ID token cache key
        var scopes;
        idTokenResponse.scopes = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes;
        idTokenResponse.accessToken = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN];
        var expiration = Number(idTokenObj.expiration);
        // Set ID Token item in cache
        this.logger.verbose("Saving ID token to cache");
        return this.saveToken(idTokenResponse, authority, scopes, clientInfo, expiration);
    };
    /**
     * @hidden
     *
     * This method sets up the elements of an Access Token cache item and calls saveToken to save it to the cache
     *
     * @param response The AuthResponse object that will be used to build the cache item
     * @param authority The authority under which the access token will be cached
     * @param parameters The response's Hash Params, which contain the access token returned from the server
     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier
     */
    /* tslint:disable:no-string-literal */
    UserAgentApplication.prototype.saveAccessToken = function (response, authority, parameters, clientInfo) {
        this.logger.verbose("SaveAccessToken has been called");
        var accessTokenResponse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, response);
        // read the scopes
        var scope = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SCOPE];
        var consentedScopes = scope.split(" ");
        // retrieve all access tokens from the cache, remove the dup scopes
        var accessTokenCacheItems = this.cacheStorage.getAllAccessTokens(this.clientId, authority);
        this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");
        for (var i = 0; i < accessTokenCacheItems.length; i++) {
            var accessTokenCacheItem = accessTokenCacheItems[i];
            if (accessTokenCacheItem.key.homeAccountIdentifier === response.account.homeAccountIdentifier) {
                var cachedScopes = accessTokenCacheItem.key.scopes.split(" ");
                if (_ScopeSet__WEBPACK_IMPORTED_MODULE_9__["ScopeSet"].isIntersectingScopes(cachedScopes, consentedScopes)) {
                    this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
                }
            }
        }
        accessTokenResponse.accessToken = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN];
        accessTokenResponse.scopes = consentedScopes;
        var expiresIn = _utils_TimeUtils__WEBPACK_IMPORTED_MODULE_13__["TimeUtils"].parseExpiresIn(parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].EXPIRES_IN]);
        var parsedState = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].parseLibraryState(parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].STATE]);
        var expiration = parsedState.ts + expiresIn;
        this.logger.verbose("Saving access token to cache");
        return this.saveToken(accessTokenResponse, authority, scope, clientInfo, expiration);
    };
    /**
     * @hidden
     * Saves token or error received in the response from AAD in the cache. In case of id_token, it also creates the account object.
     * @ignore
     */
    UserAgentApplication.prototype.saveTokenFromHash = function (hash, stateInfo) {
        this.logger.verbose("SaveTokenFromHash has been called");
        this.logger.info("State status: " + stateInfo.stateMatch + "; Request type: " + stateInfo.requestType);
        var response = {
            uniqueId: "",
            tenantId: "",
            tokenType: "",
            idToken: null,
            idTokenClaims: null,
            accessToken: null,
            scopes: [],
            expiresOn: null,
            account: null,
            accountState: "",
            fromCache: false
        };
        var error;
        var hashParams = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].deserializeHash(hash);
        var authorityKey = "";
        var acquireTokenAccountKey = "";
        var idTokenObj = null;
        // If server returns an error
        if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION) || hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR)) {
            this.logger.verbose("Server returned an error");
            this.logger.infoPii("Error : " + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR] + "; Error description: " + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR]);
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            // login
            if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login) {
                this.logger.verbose("RequestType is login, caching login error, generating authorityKey");
                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].LOGIN_ERROR, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION] + ":" + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR]);
                authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(stateInfo.state);
            }
            // acquireToken
            if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken) {
                this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey");
                authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(stateInfo.state);
                var account = this.getAccount();
                var accountId = void 0;
                if (account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(account.homeAccountIdentifier)) {
                    accountId = account.homeAccountIdentifier;
                    this.logger.verbose("AccountId is set");
                }
                else {
                    accountId = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
                    this.logger.verbose("AccountId is set as no_account");
                }
                acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(accountId, stateInfo.state);
            }
            var _a = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR, hashErr = hashParams[_a], _b = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION, hashErrDesc = hashParams[_b];
            if (_error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__["InteractionRequiredAuthError"].isInteractionRequiredError(hashErr) ||
                _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__["InteractionRequiredAuthError"].isInteractionRequiredError(hashErrDesc)) {
                error = new _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__["InteractionRequiredAuthError"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR], hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            }
            else {
                error = new _error_ServerError__WEBPACK_IMPORTED_MODULE_22__["ServerError"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR], hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            }
        }
        // If the server returns "Success"
        else {
            this.logger.verbose("Server returns success");
            // Verify the state from redirect and record tokens to storage if exists
            if (stateInfo.stateMatch) {
                this.logger.info("State is right");
                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SESSION_STATE)) {
                    this.logger.verbose("Fragment has session state, caching");
                    this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].SESSION_STATE, stateInfo.state), hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SESSION_STATE]);
                }
                response.accountState = this.getAccountState(stateInfo.state);
                var clientInfo = void 0;
                // Process access_token
                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN)) {
                    this.logger.info("Fragment has access token");
                    response.accessToken = hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN];
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SCOPE)) {
                        response.scopes = hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SCOPE].split(" ");
                    }
                    // retrieve the id_token from response if present
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN)) {
                        this.logger.verbose("Fragment has id_token");
                        idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN]);
                    }
                    else {
                        this.logger.verbose("No idToken on fragment, getting idToken from cache");
                        idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].IDTOKEN));
                    }
                    response = _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__["ResponseUtils"].setResponseIdToken(response, idTokenObj);
                    // set authority
                    var authority = this.populateAuthority(stateInfo.state, this.inCookie, this.cacheStorage, idTokenObj);
                    this.logger.verbose("Got authority from cache");
                    // retrieve client_info - if it is not found, generate the uid and utid from idToken
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO)) {
                        this.logger.verbose("Fragment has clientInfo");
                        clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO], authority);
                    }
                    else if (this.authorityInstance.AuthorityType === _authority_Authority__WEBPACK_IMPORTED_MODULE_4__["AuthorityType"].Adfs) {
                        clientInfo = _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"].createClientInfoFromIdToken(idTokenObj, authority);
                    }
                    else {
                        this.logger.warning("ClientInfo not received in the response from AAD");
                    }
                    response.account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idTokenObj, clientInfo);
                    this.logger.verbose("Account object created from response");
                    var accountKey = void 0;
                    if (response.account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(response.account.homeAccountIdentifier)) {
                        this.logger.verbose("AccountKey set");
                        accountKey = response.account.homeAccountIdentifier;
                    }
                    else {
                        this.logger.verbose("AccountKey set as no_account");
                        accountKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
                    }
                    acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(accountKey, stateInfo.state);
                    var acquireTokenAccountKey_noaccount = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account, stateInfo.state);
                    this.logger.verbose("AcquireTokenAccountKey generated");
                    var cachedAccount = this.cacheStorage.getItem(acquireTokenAccountKey);
                    var acquireTokenAccount = void 0;
                    // Check with the account in the Cache
                    if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(cachedAccount)) {
                        acquireTokenAccount = JSON.parse(cachedAccount);
                        this.logger.verbose("AcquireToken request account retrieved from cache");
                        if (response.account && acquireTokenAccount && _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].compareAccounts(response.account, acquireTokenAccount)) {
                            response = this.saveAccessToken(response, authority, hashParams, clientInfo);
                            this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request");
                        }
                        else {
                            this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request");
                        }
                    }
                    else if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(this.cacheStorage.getItem(acquireTokenAccountKey_noaccount))) {
                        this.logger.verbose("No acquireToken account retrieved from cache");
                        response = this.saveAccessToken(response, authority, hashParams, clientInfo);
                    }
                }
                // Process id_token
                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN)) {
                    this.logger.info("Fragment has idToken");
                    // set the idToken
                    idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN]);
                    // set authority
                    var authority = this.populateAuthority(stateInfo.state, this.inCookie, this.cacheStorage, idTokenObj);
                    response = _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__["ResponseUtils"].setResponseIdToken(response, idTokenObj);
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO)) {
                        this.logger.verbose("Fragment has clientInfo");
                        clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO], authority);
                    }
                    else if (this.authorityInstance.AuthorityType === _authority_Authority__WEBPACK_IMPORTED_MODULE_4__["AuthorityType"].Adfs) {
                        clientInfo = _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"].createClientInfoFromIdToken(idTokenObj, authority);
                    }
                    else {
                        this.logger.warning("ClientInfo not received in the response from AAD");
                    }
                    this.account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idTokenObj, clientInfo);
                    response.account = this.account;
                    this.logger.verbose("Account object created from response");
                    if (idTokenObj && idTokenObj.nonce) {
                        this.logger.verbose("IdToken has nonce");
                        // check nonce integrity if idToken has nonce - throw an error if not matched
                        var cachedNonce = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].NONCE_IDTOKEN, stateInfo.state), this.inCookie);
                        if (idTokenObj.nonce !== cachedNonce) {
                            this.account = null;
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].LOGIN_ERROR, "Nonce Mismatch. Expected Nonce: " + cachedNonce + "," + "Actual Nonce: " + idTokenObj.nonce);
                            this.logger.error("Nonce Mismatch. Expected Nonce: " + cachedNonce + ", Actual Nonce: " + idTokenObj.nonce);
                            error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createNonceMismatchError(cachedNonce, idTokenObj.nonce);
                        }
                        // Save the token
                        else {
                            this.logger.verbose("Nonce matches, saving idToken to cache");
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].IDTOKEN, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN], this.inCookie);
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].CLIENT_INFO, clientInfo.encodeClientInfo(), this.inCookie);
                            // Save idToken as access token item for app itself
                            this.saveIdToken(response, authority, hashParams, clientInfo, idTokenObj);
                        }
                    }
                    else {
                        this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state");
                        authorityKey = stateInfo.state;
                        acquireTokenAccountKey = stateInfo.state;
                        this.logger.error("Invalid id_token received in the response");
                        error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidIdTokenError(idTokenObj);
                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, error.errorCode);
                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, error.errorMessage);
                    }
                }
            }
            // State mismatch - unexpected/invalid state
            else {
                this.logger.verbose("State mismatch");
                authorityKey = stateInfo.state;
                acquireTokenAccountKey = stateInfo.state;
                var expectedState = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_LOGIN, stateInfo.state), this.inCookie);
                this.logger.error("State Mismatch. Expected State: " + expectedState + ", Actual State: " + stateInfo.state);
                error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidStateError(stateInfo.state, expectedState);
                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, error.errorCode);
                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, error.errorMessage);
            }
        }
        // Set status to completed
        this.cacheStorage.removeItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, stateInfo.state));
        this.cacheStorage.resetTempCacheItems(stateInfo.state);
        this.logger.verbose("Status set to complete, temporary cache cleared");
        // this is required if navigateToLoginRequestUrl=false
        if (this.inCookie) {
            this.logger.verbose("InCookie is true, setting authorityKey in cookie");
            this.cacheStorage.setItemCookie(authorityKey, "", -1);
            this.cacheStorage.clearMsalCookie(stateInfo.state);
        }
        if (error) {
            // Error case, set status to cancelled
            throw error;
        }
        if (!response) {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Response is null");
        }
        return response;
    };
    /**
     * Set Authority when saving Token from the hash
     * @param state
     * @param inCookie
     * @param cacheStorage
     * @param idTokenObj
     * @param response
     */
    UserAgentApplication.prototype.populateAuthority = function (state, inCookie, cacheStorage, idTokenObj) {
        this.logger.verbose("PopulateAuthority has been called");
        var authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(state);
        var cachedAuthority = cacheStorage.getItem(authorityKey, inCookie);
        // retrieve the authority from cache and replace with tenantID
        return _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(cachedAuthority) ? cachedAuthority : _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].replaceTenantPath(cachedAuthority, idTokenObj.tenantId);
    };
    /* tslint:enable:no-string-literal */
    // #endregion
    // #region Account
    /**
     * Returns the signed in account
     * (the account object is created at the time of successful login)
     * or null when no state is found
     * @returns {@link Account} - the account object stored in MSAL
     */
    UserAgentApplication.prototype.getAccount = function () {
        // if a session already exists, get the account from the session
        if (this.account) {
            return this.account;
        }
        // frame is used to get idToken and populate the account for the given session
        var rawIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].IDTOKEN, this.inCookie);
        var rawClientInfo = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].CLIENT_INFO, this.inCookie);
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(rawIdToken) && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(rawClientInfo)) {
            var idToken = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](rawIdToken);
            var clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](rawClientInfo, "");
            this.account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idToken, clientInfo);
            return this.account;
        }
        // if login not yet done, return null
        return null;
    };
    /**
     * @hidden
     *
     * Extracts state value from the accountState sent with the authentication request.
     * @returns {string} scope.
     * @ignore
     */
    UserAgentApplication.prototype.getAccountState = function (state) {
        if (state) {
            var splitIndex = state.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].resourceDelimiter);
            if (splitIndex > -1 && splitIndex + 1 < state.length) {
                return state.substring(splitIndex + 1);
            }
        }
        return state;
    };
    /**
     * Use to get a list of unique accounts in MSAL cache based on homeAccountIdentifier.
     *
     * @param {@link Array<Account>} Account - all unique accounts in MSAL cache.
     */
    UserAgentApplication.prototype.getAllAccounts = function () {
        var accounts = [];
        var accessTokenCacheItems = this.cacheStorage.getAllAccessTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].homeAccountIdentifier);
        for (var i = 0; i < accessTokenCacheItems.length; i++) {
            var idToken = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](accessTokenCacheItems[i].value.idToken);
            var clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](accessTokenCacheItems[i].value.homeAccountIdentifier, "");
            var account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idToken, clientInfo);
            accounts.push(account);
        }
        return this.getUniqueAccounts(accounts);
    };
    /**
     * @hidden
     *
     * Used to filter accounts based on homeAccountIdentifier
     * @param {Array<Account>}  Accounts - accounts saved in the cache
     * @ignore
     */
    UserAgentApplication.prototype.getUniqueAccounts = function (accounts) {
        if (!accounts || accounts.length <= 1) {
            return accounts;
        }
        var flags = [];
        var uniqueAccounts = [];
        for (var index = 0; index < accounts.length; ++index) {
            if (accounts[index].homeAccountIdentifier && flags.indexOf(accounts[index].homeAccountIdentifier) === -1) {
                flags.push(accounts[index].homeAccountIdentifier);
                uniqueAccounts.push(accounts[index]);
            }
        }
        return uniqueAccounts;
    };
    // #endregion
    // #region Angular
    /**
     * @hidden
     *
     * Broadcast messages - Used only for Angular?  *
     * @param eventName
     * @param data
     */
    UserAgentApplication.prototype.broadcast = function (eventName, data) {
        var evt = new CustomEvent(eventName, { detail: data });
        window.dispatchEvent(evt);
    };
    /**
     * @hidden
     *
     * Helper function to retrieve the cached token
     *
     * @param scopes
     * @param {@link Account} account
     * @param state
     * @return {@link AuthResponse} AuthResponse
     */
    UserAgentApplication.prototype.getCachedTokenInternal = function (scopes, account, state, correlationId) {
        // Get the current session's account object
        var accountObject = account || this.getAccount();
        if (!accountObject) {
            return null;
        }
        // Construct AuthenticationRequest based on response type; set "redirectUri" from the "request" which makes this call from Angular - for this.getRedirectUri()
        var newAuthority = this.authorityInstance ? this.authorityInstance : _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(this.authority, this.config.auth.validateAuthority);
        var responseType = this.getTokenType(accountObject, scopes);
        var serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"](newAuthority, this.clientId, responseType, this.getRedirectUri(), scopes, state, correlationId);
        // get cached token
        return this.getCachedToken(serverAuthenticationRequest, account);
    };
    /**
     * @hidden
     *
     * Get scopes for the Endpoint - Used in Angular to track protected and unprotected resources without interaction from the developer app
     * Note: Please check if we need to set the "redirectUri" from the "request" which makes this call from Angular - for this.getRedirectUri()
     *
     * @param endpoint
     */
    UserAgentApplication.prototype.getScopesForEndpoint = function (endpoint) {
        // if user specified list of unprotectedResources, no need to send token to these endpoints, return null.
        if (this.config.framework.unprotectedResources.length > 0) {
            for (var i = 0; i < this.config.framework.unprotectedResources.length; i++) {
                if (endpoint.indexOf(this.config.framework.unprotectedResources[i]) > -1) {
                    return null;
                }
            }
        }
        // process all protected resources and send the matched one
        if (this.config.framework.protectedResourceMap.size > 0) {
            for (var _i = 0, _a = Array.from(this.config.framework.protectedResourceMap.keys()); _i < _a.length; _i++) {
                var key = _a[_i];
                // configEndpoint is like /api/Todo requested endpoint can be /api/Todo/1
                if (endpoint.indexOf(key) > -1) {
                    return this.config.framework.protectedResourceMap.get(key);
                }
            }
        }
        /*
         * default resource will be clientid if nothing specified
         * App will use idtoken for calls to itself
         * check if it's staring from http or https, needs to match with app host
         */
        if (endpoint.indexOf("http://") > -1 || endpoint.indexOf("https://") > -1) {
            if (_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].getHostFromUri(endpoint) === _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].getHostFromUri(this.getRedirectUri())) {
                return new Array(this.clientId);
            }
        }
        else {
            /*
             * in angular level, the url for $http interceptor call could be relative url,
             * if it's relative call, we'll treat it as app backend call.
             */
            return new Array(this.clientId);
        }
        // if not the app's own backend or not a domain listed in the endpoints structure
        return null;
    };
    /**
     * Return boolean flag to developer to help inform if login is in progress
     * @returns {boolean} true/false
     */
    UserAgentApplication.prototype.getLoginInProgress = function () {
        return this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress;
    };
    /**
     * @hidden
     * @ignore
     *
     * @param loginInProgress
     */
    UserAgentApplication.prototype.setInteractionInProgress = function (inProgress) {
        if (inProgress) {
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress);
        }
        else {
            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
        }
    };
    /**
     * @hidden
     * @ignore
     *
     * @param loginInProgress
     */
    UserAgentApplication.prototype.setloginInProgress = function (loginInProgress) {
        this.setInteractionInProgress(loginInProgress);
    };
    /**
     * @hidden
     * @ignore
     *
     * returns the status of acquireTokenInProgress
     */
    UserAgentApplication.prototype.getAcquireTokenInProgress = function () {
        return this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress;
    };
    /**
     * @hidden
     * @ignore
     *
     * @param acquireTokenInProgress
     */
    UserAgentApplication.prototype.setAcquireTokenInProgress = function (acquireTokenInProgress) {
        this.setInteractionInProgress(acquireTokenInProgress);
    };
    /**
     * @hidden
     * @ignore
     *
     * returns the logger handle
     */
    UserAgentApplication.prototype.getLogger = function () {
        return this.logger;
    };
    /**
     * Sets the logger callback.
     * @param logger Logger callback
     */
    UserAgentApplication.prototype.setLogger = function (logger) {
        this.logger = logger;
    };
    // #endregion
    // #region Getters and Setters
    /**
     * Use to get the redirect uri configured in MSAL or null.
     * Evaluates redirectUri if its a function, otherwise simply returns its value.
     *
     * @returns {string} redirect URL
     */
    UserAgentApplication.prototype.getRedirectUri = function (reqRedirectUri) {
        if (reqRedirectUri) {
            return reqRedirectUri;
        }
        else if (typeof this.config.auth.redirectUri === "function") {
            return this.config.auth.redirectUri();
        }
        return this.config.auth.redirectUri;
    };
    /**
     * Use to get the post logout redirect uri configured in MSAL or null.
     * Evaluates postLogoutredirectUri if its a function, otherwise simply returns its value.
     *
     * @returns {string} post logout redirect URL
     */
    UserAgentApplication.prototype.getPostLogoutRedirectUri = function () {
        if (typeof this.config.auth.postLogoutRedirectUri === "function") {
            return this.config.auth.postLogoutRedirectUri();
        }
        return this.config.auth.postLogoutRedirectUri;
    };
    /**
     * Use to get the current {@link Configuration} object in MSAL
     *
     * @returns {@link Configuration}
     */
    UserAgentApplication.prototype.getCurrentConfiguration = function () {
        if (!this.config) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createNoSetConfigurationError();
        }
        return this.config;
    };
    /**
     * @ignore
     *
     * Utils function to create the Authentication
     * @param {@link account} account object
     * @param scopes
     *
     * @returns {string} token type: token, id_token or id_token token
     *
     */
    UserAgentApplication.prototype.getTokenType = function (accountObject, scopes) {
        var accountsMatch = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].compareAccounts(accountObject, this.getAccount());
        return _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].determineResponseType(accountsMatch, scopes);
    };
    /**
     * @hidden
     * @ignore
     *
     * Sets the cachekeys for and stores the account information in cache
     * @param account
     * @param state
     * @hidden
     */
    UserAgentApplication.prototype.setAccountCache = function (account, state) {
        // Cache acquireTokenAccountKey
        var accountId = account ? this.getAccountId(account) : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
        var acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(accountId, state);
        this.cacheStorage.setItem(acquireTokenAccountKey, JSON.stringify(account));
    };
    /**
     * @hidden
     * @ignore
     *
     * Sets the cacheKey for and stores the authority information in cache
     * @param state
     * @param authority
     * @hidden
     */
    UserAgentApplication.prototype.setAuthorityCache = function (state, authority) {
        // Cache authorityKey
        var authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(state);
        this.cacheStorage.setItem(authorityKey, _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].CanonicalizeUri(authority), this.inCookie);
    };
    /**
     * Updates account, authority, and nonce in cache
     * @param serverAuthenticationRequest
     * @param account
     * @hidden
     * @ignore
     */
    UserAgentApplication.prototype.updateCacheEntries = function (serverAuthenticationRequest, account, isLoginCall, loginStartPage) {
        // Cache Request Originator Page
        if (loginStartPage) {
            this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].LOGIN_REQUEST, serverAuthenticationRequest.state), loginStartPage, this.inCookie);
        }
        // Cache account and authority
        if (isLoginCall) {
            // Cache the state
            this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_LOGIN, serverAuthenticationRequest.state), serverAuthenticationRequest.state, this.inCookie);
        }
        else {
            this.setAccountCache(account, serverAuthenticationRequest.state);
        }
        // Cache authorityKey
        this.setAuthorityCache(serverAuthenticationRequest.state, serverAuthenticationRequest.authority);
        // Cache nonce
        this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].NONCE_IDTOKEN, serverAuthenticationRequest.state), serverAuthenticationRequest.nonce, this.inCookie);
    };
    /**
     * Returns the unique identifier for the logged in account
     * @param account
     * @hidden
     * @ignore
     */
    UserAgentApplication.prototype.getAccountId = function (account) {
        // return `${account.accountIdentifier}` + Constants.resourceDelimiter + `${account.homeAccountIdentifier}`;
        var accountId;
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(account.homeAccountIdentifier)) {
            accountId = account.homeAccountIdentifier;
        }
        else {
            accountId = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
        }
        return accountId;
    };
    /**
     * @ignore
     * @param extraQueryParameters
     *
     * Construct 'tokenRequest' from the available data in adalIdToken
     */
    UserAgentApplication.prototype.buildIDTokenRequest = function (request) {
        var tokenRequest = {
            scopes: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes,
            authority: this.authority,
            account: this.getAccount(),
            extraQueryParameters: request.extraQueryParameters,
            correlationId: request.correlationId
        };
        return tokenRequest;
    };
    /**
     * @ignore
     * @param config
     * @param clientId
     *
     * Construct TelemetryManager from Configuration
     */
    UserAgentApplication.prototype.getTelemetryManagerFromConfig = function (config, clientId) {
        if (!config) { // if unset
            return _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__["default"].getTelemetrymanagerStub(clientId, this.logger);
        }
        // if set then validate
        var applicationName = config.applicationName, applicationVersion = config.applicationVersion, telemetryEmitter = config.telemetryEmitter;
        if (!applicationName || !applicationVersion || !telemetryEmitter) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createTelemetryConfigError(config);
        }
        // if valid then construct
        var telemetryPlatform = {
            applicationName: applicationName,
            applicationVersion: applicationVersion
        };
        var telemetryManagerConfig = {
            platform: telemetryPlatform,
            clientId: clientId
        };
        return new _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__["default"](telemetryManagerConfig, telemetryEmitter, this.logger);
    };
    return UserAgentApplication;
}());

//# sourceMappingURL=UserAgentApplication.js.map

/***/ }),

/***/ "/FJK":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/Constants.js ***!
  \****************************************************************************************************************/
/*! exports provided: GRAPH_API_VERSION, GRAPH_BASE_URL, GRAPH_URLS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GRAPH_API_VERSION", function() { return GRAPH_API_VERSION; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GRAPH_BASE_URL", function() { return GRAPH_BASE_URL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GRAPH_URLS", function() { return GRAPH_URLS; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module Constants
 */
/**
 * @constant
 * A Default API endpoint version for a request
 */
const GRAPH_API_VERSION = "v1.0";
/**
 * @constant
 * A Default base url for a request
 */
const GRAPH_BASE_URL = "https://graph.microsoft.com/";
/**
 * To hold list of the service root endpoints for Microsoft Graph and Graph Explorer for each national cloud.
 * Set(iterable:Object) is not supported in Internet Explorer. The consumer is recommended to use a suitable polyfill.
 */
const GRAPH_URLS = new Set(["graph.microsoft.com", "graph.microsoft.us", "dod-graph.microsoft.us", "graph.microsoft.de", "microsoftgraph.chinacloudapi.cn"]);
//# sourceMappingURL=Constants.js.map

/***/ }),

/***/ "/JyI":
/*!********************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/tasks/OneDriveLargeFileUploadTaskUtil.js ***!
  \********************************************************************************************************************************************/
/*! exports provided: getValidRangeSize */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getValidRangeSize", function() { return getValidRangeSize; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module OneDriveLargeFileUploadTaskUtil
 */
/**
 * @constant
 * Default value for the rangeSize
 * Recommended size is between 5 - 10 MB {@link https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/driveitem_createuploadsession#best-practices}
 */
const DEFAULT_FILE_SIZE = 5 * 1024 * 1024;
/**
 * @constant
 * Rounds off the given value to a multiple of 320 KB
 * @param {number} value - The value
 * @returns The rounded off value
 */
const roundTo320KB = (value) => {
    if (value > 320 * 1024) {
        value = Math.floor(value / (320 * 1024)) * 320 * 1024;
    }
    return value;
};
/**
 * @constant
 * Get the valid rangeSize for a file slicing (validity is based on the constrains mentioned in here
 * {@link https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/api/driveitem_createuploadsession#upload-bytes-to-the-upload-session})
 *
 * @param {number} [rangeSize = DEFAULT_FILE_SIZE] - The rangeSize value.
 * @returns The valid rangeSize
 */
const getValidRangeSize = (rangeSize = DEFAULT_FILE_SIZE) => {
    const sixtyMB = 60 * 1024 * 1024;
    if (rangeSize > sixtyMB) {
        rangeSize = sixtyMB;
    }
    return roundTo320KB(rangeSize);
};
//# sourceMappingURL=OneDriveLargeFileUploadTaskUtil.js.map

/***/ }),

/***/ "/LVv":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/cache/AccessTokenCacheItem.js ***!
  \****************************************************************************************************************/
/*! exports provided: AccessTokenCacheItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccessTokenCacheItem", function() { return AccessTokenCacheItem; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var AccessTokenCacheItem = /** @class */ (function () {
    function AccessTokenCacheItem(key, value) {
        this.key = key;
        this.value = value;
    }
    return AccessTokenCacheItem;
}());

//# sourceMappingURL=AccessTokenCacheItem.js.map

/***/ }),

/***/ "/M1i":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/MiddlewareControl.js ***!
  \***********************************************************************************************/
/*! exports provided: MiddlewareControl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MiddlewareControl", function() { return MiddlewareControl; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * Class representing MiddlewareControl
 */
class MiddlewareControl {
    /**
     * @public
     * @constructor
     * Creates an instance of MiddlewareControl
     * @param {MiddlewareOptions[]} [middlewareOptions = []] - The array of middlewareOptions
     * @returns The instance of MiddlewareControl
     */
    constructor(middlewareOptions = []) {
        // tslint:disable-next-line:ban-types
        this.middlewareOptions = new Map();
        for (const option of middlewareOptions) {
            const fn = option.constructor;
            this.middlewareOptions.set(fn, option);
        }
    }
    /**
     * @public
     * To get the middleware option using the class of the option
     * @param {Function} fn - The class of the strongly typed option class
     * @returns The middleware option
     * @example
     * // if you wanted to return the middleware option associated with this class (MiddlewareControl)
     * // call this function like this:
     * getMiddlewareOptions(MiddlewareControl)
     */
    // tslint:disable-next-line:ban-types
    getMiddlewareOptions(fn) {
        return this.middlewareOptions.get(fn);
    }
    /**
     * @public
     * To set the middleware options using the class of the option
     * @param {Function} fn - The class of the strongly typed option class
     * @param {MiddlewareOptions} option - The strongly typed middleware option
     * @returns nothing
     */
    // tslint:disable-next-line:ban-types
    setMiddlewareOptions(fn, option) {
        this.middlewareOptions.set(fn, option);
    }
}
//# sourceMappingURL=MiddlewareControl.js.map

/***/ }),

/***/ "/lxw":
/*!***************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/TeamsHelper.js ***!
  \***************************************************************************/
/*! exports provided: TeamsHelper */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TeamsHelper", function() { return TeamsHelper; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * A helper class for interacting with the Teams Client SDK.
 *
 * @export
 * @class TeamsHelper
 */
class TeamsHelper {
    /**
     * Optional entry point to the teams library
     * If this value is not set, the provider will attempt to use
     * the microsoftTeams global variable.
     *
     * @static
     * @type {*}
     * @memberof TeamsHelper
     */
    static get microsoftTeamsLib() {
        // tslint:disable-next-line: no-string-literal
        return this._microsoftTeamsLib || window['microsoftTeams'];
    }
    static set microsoftTeamsLib(value) {
        this._microsoftTeamsLib = value;
    }
    /**
     * Gets whether the Teams provider can be used in the current context
     * (Whether the app is running in Microsoft Teams)
     *
     * @readonly
     * @static
     * @memberof TeamsHelper
     */
    static get isAvailable() {
        if (!this.microsoftTeamsLib) {
            return false;
        }
        if (window.parent === window.self && window.nativeInterface) {
            // In Teams mobile client
            return true;
        }
        else if (window.name === 'embedded-page-container' || window.name === 'extension-tab-frame') {
            // In Teams web/desktop client
            return true;
        }
        return false;
    }
    /**
     * Execute a deeplink against the Teams lib.
     *
     * @static
     * @param {string} deeplink
     * @param {(status: boolean, reason?: string) => void} [onComplete]
     * @memberof TeamsHelper
     */
    static executeDeepLink(deeplink, onComplete) {
        const teams = this.microsoftTeamsLib;
        teams.initialize();
        teams.executeDeepLink(deeplink, onComplete);
    }
}
//# sourceMappingURL=TeamsHelper.js.map

/***/ }),

/***/ "/pXG":
/*!************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/Constants.js ***!
  \************************************************************************************************/
/*! exports provided: Constants, ServerHashParamKeys, ResponseTypes, TemporaryCacheKeys, PersistentCacheKeys, ErrorCacheKeys, DEFAULT_AUTHORITY, AAD_INSTANCE_DISCOVERY_ENDPOINT, WELL_KNOWN_SUFFIX, SSOTypes, BlacklistedEQParams, NetworkRequestType, PromptState, FramePrefix, libraryVersion */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Constants", function() { return Constants; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerHashParamKeys", function() { return ServerHashParamKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResponseTypes", function() { return ResponseTypes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TemporaryCacheKeys", function() { return TemporaryCacheKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PersistentCacheKeys", function() { return PersistentCacheKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ErrorCacheKeys", function() { return ErrorCacheKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFAULT_AUTHORITY", function() { return DEFAULT_AUTHORITY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AAD_INSTANCE_DISCOVERY_ENDPOINT", function() { return AAD_INSTANCE_DISCOVERY_ENDPOINT; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WELL_KNOWN_SUFFIX", function() { return WELL_KNOWN_SUFFIX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SSOTypes", function() { return SSOTypes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlacklistedEQParams", function() { return BlacklistedEQParams; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NetworkRequestType", function() { return NetworkRequestType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PromptState", function() { return PromptState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FramePrefix", function() { return FramePrefix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "libraryVersion", function() { return libraryVersion; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 * Constants
 */
var Constants = /** @class */ (function () {
    function Constants() {
    }
    Object.defineProperty(Constants, "libraryName", {
        get: function () { return "Msal.js"; } // used in telemetry sdkName
        ,
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "claims", {
        get: function () { return "claims"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "clientId", {
        get: function () { return "clientId"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "adalIdToken", {
        get: function () { return "adal.idtoken"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "cachePrefix", {
        get: function () { return "msal"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "scopes", {
        get: function () { return "scopes"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "no_account", {
        get: function () { return "NO_ACCOUNT"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "upn", {
        get: function () { return "upn"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "domain_hint", {
        get: function () { return "domain_hint"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "prompt_select_account", {
        get: function () { return "&prompt=select_account"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "prompt_none", {
        get: function () { return "&prompt=none"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "prompt", {
        get: function () { return "prompt"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "response_mode_fragment", {
        get: function () { return "&response_mode=fragment"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "resourceDelimiter", {
        get: function () { return "|"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "cacheDelimiter", {
        get: function () { return "."; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "popUpWidth", {
        get: function () { return this._popUpWidth; },
        set: function (width) {
            this._popUpWidth = width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "popUpHeight", {
        get: function () { return this._popUpHeight; },
        set: function (height) {
            this._popUpHeight = height;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "login", {
        get: function () { return "LOGIN"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "renewToken", {
        get: function () { return "RENEW_TOKEN"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "unknown", {
        get: function () { return "UNKNOWN"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "ADFS", {
        get: function () { return "adfs"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "homeAccountIdentifier", {
        get: function () { return "homeAccountIdentifier"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "common", {
        get: function () { return "common"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "openidScope", {
        get: function () { return "openid"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "profileScope", {
        get: function () { return "profile"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "oidcScopes", {
        get: function () { return [this.openidScope, this.profileScope]; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "interactionTypeRedirect", {
        get: function () { return "redirectInteraction"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "interactionTypePopup", {
        get: function () { return "popupInteraction"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "interactionTypeSilent", {
        get: function () { return "silentInteraction"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "inProgress", {
        get: function () { return "inProgress"; },
        enumerable: true,
        configurable: true
    });
    Constants._popUpWidth = 483;
    Constants._popUpHeight = 600;
    return Constants;
}());

/**
 * Keys in the hashParams
 */
var ServerHashParamKeys;
(function (ServerHashParamKeys) {
    ServerHashParamKeys["SCOPE"] = "scope";
    ServerHashParamKeys["STATE"] = "state";
    ServerHashParamKeys["ERROR"] = "error";
    ServerHashParamKeys["ERROR_DESCRIPTION"] = "error_description";
    ServerHashParamKeys["ACCESS_TOKEN"] = "access_token";
    ServerHashParamKeys["ID_TOKEN"] = "id_token";
    ServerHashParamKeys["EXPIRES_IN"] = "expires_in";
    ServerHashParamKeys["SESSION_STATE"] = "session_state";
    ServerHashParamKeys["CLIENT_INFO"] = "client_info";
})(ServerHashParamKeys || (ServerHashParamKeys = {}));
/**
 * @hidden
 * @ignore
 * response_type from OpenIDConnect
 * References: https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html & https://tools.ietf.org/html/rfc6749#section-4.2.1
 *
 */
var ResponseTypes = {
    id_token: "id_token",
    token: "token",
    id_token_token: "id_token token"
};
/**
 * @hidden
 * CacheKeys for MSAL
 */
var TemporaryCacheKeys;
(function (TemporaryCacheKeys) {
    TemporaryCacheKeys["AUTHORITY"] = "authority";
    TemporaryCacheKeys["ACQUIRE_TOKEN_ACCOUNT"] = "acquireTokenAccount";
    TemporaryCacheKeys["SESSION_STATE"] = "session.state";
    TemporaryCacheKeys["STATE_LOGIN"] = "state.login";
    TemporaryCacheKeys["STATE_ACQ_TOKEN"] = "state.acquireToken";
    TemporaryCacheKeys["STATE_RENEW"] = "state.renew";
    TemporaryCacheKeys["NONCE_IDTOKEN"] = "nonce.idtoken";
    TemporaryCacheKeys["LOGIN_REQUEST"] = "login.request";
    TemporaryCacheKeys["RENEW_STATUS"] = "token.renew.status";
    TemporaryCacheKeys["URL_HASH"] = "urlHash";
    TemporaryCacheKeys["INTERACTION_STATUS"] = "interaction_status";
    TemporaryCacheKeys["REDIRECT_REQUEST"] = "redirect_request";
})(TemporaryCacheKeys || (TemporaryCacheKeys = {}));
var PersistentCacheKeys;
(function (PersistentCacheKeys) {
    PersistentCacheKeys["IDTOKEN"] = "idtoken";
    PersistentCacheKeys["CLIENT_INFO"] = "client.info";
})(PersistentCacheKeys || (PersistentCacheKeys = {}));
var ErrorCacheKeys;
(function (ErrorCacheKeys) {
    ErrorCacheKeys["LOGIN_ERROR"] = "login.error";
    ErrorCacheKeys["ERROR"] = "error";
    ErrorCacheKeys["ERROR_DESC"] = "error.description";
})(ErrorCacheKeys || (ErrorCacheKeys = {}));
var DEFAULT_AUTHORITY = "https://login.microsoftonline.com/common/";
var AAD_INSTANCE_DISCOVERY_ENDPOINT = DEFAULT_AUTHORITY + "/discovery/instance?api-version=1.1&authorization_endpoint=";
var WELL_KNOWN_SUFFIX = ".well-known/openid-configuration";
/**
 * @hidden
 * SSO Types - generated to populate hints
 */
var SSOTypes;
(function (SSOTypes) {
    SSOTypes["ACCOUNT"] = "account";
    SSOTypes["SID"] = "sid";
    SSOTypes["LOGIN_HINT"] = "login_hint";
    SSOTypes["ORGANIZATIONS"] = "organizations";
    SSOTypes["ID_TOKEN"] = "id_token";
    SSOTypes["ACCOUNT_ID"] = "accountIdentifier";
    SSOTypes["HOMEACCOUNT_ID"] = "homeAccountIdentifier";
})(SSOTypes || (SSOTypes = {}));
/**
 * @hidden
 */
var BlacklistedEQParams = [
    SSOTypes.SID,
    SSOTypes.LOGIN_HINT
];
var NetworkRequestType = {
    GET: "GET",
    POST: "POST"
};
/**
 * we considered making this "enum" in the request instead of string, however it looks like the allowed list of
 * prompt values kept changing over past couple of years. There are some undocumented prompt values for some
 * internal partners too, hence the choice of generic "string" type instead of the "enum"
 * @hidden
 */
var PromptState = {
    LOGIN: "login",
    SELECT_ACCOUNT: "select_account",
    CONSENT: "consent",
    NONE: "none"
};
/**
 * Frame name prefixes for the hidden iframe created in silent frames
 */
var FramePrefix = {
    ID_TOKEN_FRAME: "msalIdTokenFrame",
    TOKEN_FRAME: "msalRenewFrame"
};
/**
 * MSAL JS Library Version
 */
function libraryVersion() {
    return "1.4.4";
}
//# sourceMappingURL=Constants.js.map

/***/ }),

/***/ "0Fh4":
/*!*****************************************************************!*\
  !*** ./node_modules/lit-html/lib/default-template-processor.js ***!
  \*****************************************************************/
/*! exports provided: DefaultTemplateProcessor, defaultTemplateProcessor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultTemplateProcessor", function() { return DefaultTemplateProcessor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultTemplateProcessor", function() { return defaultTemplateProcessor; });
/* harmony import */ var _parts_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./parts.js */ "XI78");
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */

/**
 * Creates Parts when a template is instantiated.
 */
class DefaultTemplateProcessor {
    /**
     * Create parts for an attribute-position binding, given the event, attribute
     * name, and string literals.
     *
     * @param element The element containing the binding
     * @param name  The attribute name
     * @param strings The string literals. There are always at least two strings,
     *   event for fully-controlled bindings with a single expression.
     */
    handleAttributeExpressions(element, name, strings, options) {
        const prefix = name[0];
        if (prefix === '.') {
            const committer = new _parts_js__WEBPACK_IMPORTED_MODULE_0__["PropertyCommitter"](element, name.slice(1), strings);
            return committer.parts;
        }
        if (prefix === '@') {
            return [new _parts_js__WEBPACK_IMPORTED_MODULE_0__["EventPart"](element, name.slice(1), options.eventContext)];
        }
        if (prefix === '?') {
            return [new _parts_js__WEBPACK_IMPORTED_MODULE_0__["BooleanAttributePart"](element, name.slice(1), strings)];
        }
        const committer = new _parts_js__WEBPACK_IMPORTED_MODULE_0__["AttributeCommitter"](element, name, strings);
        return committer.parts;
    }
    /**
     * Create parts for a text-position binding.
     * @param templateFactory
     */
    handleTextExpression(options) {
        return new _parts_js__WEBPACK_IMPORTED_MODULE_0__["NodePart"](options);
    }
}
const defaultTemplateProcessor = new DefaultTemplateProcessor();
//# sourceMappingURL=default-template-processor.js.map

/***/ }),

/***/ "0Kec":
/*!**************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/Version.js ***!
  \**************************************************************************/
/*! exports provided: PACKAGE_VERSION */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PACKAGE_VERSION", function() { return PACKAGE_VERSION; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
/**
 * @module Version
 */
const PACKAGE_VERSION = "2.2.1";
//# sourceMappingURL=Version.js.map

/***/ }),

/***/ "0Vrk":
/*!*****************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/graph/graph.user.js ***!
  \*****************************************************************************/
/*! exports provided: getMe, getUserWithPhoto, getUser, getUsersForUserIds, getUsersForPeopleQueries, findUsers, findGroupMembers */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getMe", function() { return getMe; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUserWithPhoto", function() { return getUserWithPhoto; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUser", function() { return getUser; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUsersForUserIds", function() { return getUsersForUserIds; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUsersForPeopleQueries", function() { return getUsersForPeopleQueries; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findUsers", function() { return findUsers; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findGroupMembers", function() { return findGroupMembers; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _graph_people__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./graph.people */ "r/Dn");
/* harmony import */ var _graph_photos__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./graph.photos */ "xch7");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Describes the organization of the cache db
 */
const cacheSchema = {
    name: 'users',
    stores: {
        users: {},
        usersQuery: {}
    },
    version: 1
};
/**
 * Defines the time it takes for objects in the cache to expire
 */
const getUserInvalidationTime = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.users.invalidationPeriod || _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.defaultInvalidationPeriod;
/**
 * Whether or not the cache is enabled
 */
const usersCacheEnabled = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.users.isEnabled && _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.isEnabled;
/**
 * Name of the users store name
 */
const userStore = 'users';
/**
 * Name of the users query store name
 */
const queryStore = 'usersQuery';
/**
 * async promise, returns Graph User data relating to the user logged in
 *
 * @returns {(Promise<User>)}
 * @memberof Graph
 */
function getMe(graph) {
    return __awaiter(this, void 0, void 0, function* () {
        let cache;
        if (usersCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, userStore);
            const me = yield cache.getValue('me');
            if (me && getUserInvalidationTime() > Date.now() - me.timeCached) {
                return JSON.parse(me.user);
            }
        }
        const response = graph
            .api('me')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('user.read'))
            .get();
        if (usersCacheEnabled()) {
            cache.putValue('me', { user: JSON.stringify(yield response) });
        }
        return response;
    });
}
/**
 * asnyc promise, returns IDynamicPerson
 *
 * @param {string} userId
 * @returns {(Promise<IDynamicPerson>)}
 * @memberof Graph
 */
function getUserWithPhoto(graph, userId) {
    return __awaiter(this, void 0, void 0, function* () {
        let photo = null;
        let user = null;
        let cachedPhoto;
        let cachedUser;
        const resource = userId ? `users/${userId}` : 'me';
        const scopes = userId ? ['user.readbasic.all'] : ['user.read'];
        // attempt to get user and photo from cache if enabled
        if (usersCacheEnabled()) {
            let cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, userStore);
            cachedUser = yield cache.getValue(userId || 'me');
            if (cachedUser && getUserInvalidationTime() > Date.now() - cachedUser.timeCached) {
                user = cachedUser.user ? JSON.parse(cachedUser.user) : null;
            }
            else {
                cachedUser = null;
            }
        }
        if (Object(_graph_photos__WEBPACK_IMPORTED_MODULE_2__["photosCacheEnabled"])()) {
            cachedPhoto = yield Object(_graph_photos__WEBPACK_IMPORTED_MODULE_2__["getPhotoFromCache"])(userId || 'me', 'users');
            if (cachedPhoto && Object(_graph_photos__WEBPACK_IMPORTED_MODULE_2__["getPhotoInvalidationTime"])() > Date.now() - cachedPhoto.timeCached) {
                photo = cachedPhoto.photo;
            }
            else if (cachedPhoto) {
                try {
                    const response = yield graph.api(`${resource}/photo`).get();
                    if (response && response['@odata.mediaEtag'] && response['@odata.mediaEtag'] === cachedPhoto.eTag) {
                        // put current image into the cache to update the timestamp since etag is the same
                        Object(_graph_photos__WEBPACK_IMPORTED_MODULE_2__["storePhotoInCache"])(userId || 'me', 'users', cachedPhoto);
                        photo = cachedPhoto.photo;
                    }
                    else {
                        cachedPhoto = null;
                    }
                }
                catch (e) { }
            }
        }
        // if both are not in the cache, batch get them
        if (!cachedPhoto && !cachedUser) {
            let eTag;
            // batch calls
            const batch = graph.createBatch();
            if (userId) {
                batch.get('user', `/users/${userId}`, ['user.readbasic.all']);
                batch.get('photo', `users/${userId}/photo/$value`, ['user.readbasic.all']);
            }
            else {
                batch.get('user', 'me', ['user.read']);
                batch.get('photo', 'me/photo/$value', ['user.read']);
            }
            const response = yield batch.executeAll();
            const photoResponse = response.get('photo');
            if (photoResponse) {
                eTag = photoResponse.headers['ETag'];
                photo = photoResponse.content;
            }
            const userResponse = response.get('user');
            if (userResponse) {
                user = userResponse.content;
            }
            // store user & photo in their respective cache
            if (usersCacheEnabled()) {
                let cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, userStore);
                cache.putValue(userId || 'me', { user: JSON.stringify(user) });
            }
            if (Object(_graph_photos__WEBPACK_IMPORTED_MODULE_2__["photosCacheEnabled"])()) {
                Object(_graph_photos__WEBPACK_IMPORTED_MODULE_2__["storePhotoInCache"])(userId || 'me', 'users', { eTag, photo: photo });
            }
        }
        else if (!cachedPhoto) {
            // if only photo or user is not cached, get it individually
            const response = yield Object(_graph_photos__WEBPACK_IMPORTED_MODULE_2__["getPhotoForResource"])(graph, resource, scopes);
            if (response) {
                if (Object(_graph_photos__WEBPACK_IMPORTED_MODULE_2__["photosCacheEnabled"])()) {
                    Object(_graph_photos__WEBPACK_IMPORTED_MODULE_2__["storePhotoInCache"])(userId || 'me', 'users', { eTag: response.eTag, photo: response.photo });
                }
                photo = response.photo;
            }
        }
        else if (!cachedUser) {
            // get user from graph
            const response = yield graph
                .api(resource)
                .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(...scopes))
                .get();
            if (response) {
                if (usersCacheEnabled()) {
                    let cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, userStore);
                    cache.putValue(userId || 'me', { user: JSON.stringify(response) });
                }
                user = response;
            }
        }
        if (user) {
            user.personImage = photo;
        }
        return user;
    });
}
/**
 * async promise, returns all Graph users associated with the userPrincipleName provided
 *
 * @param {string} userPrincipleName
 * @returns {(Promise<User>)}
 * @memberof Graph
 */
function getUser(graph, userPrincipleName) {
    return __awaiter(this, void 0, void 0, function* () {
        const scopes = 'user.readbasic.all';
        let cache;
        if (usersCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, userStore);
            // check cache
            const user = yield cache.getValue(userPrincipleName);
            // is it stored and is timestamp good?
            if (user && getUserInvalidationTime() > Date.now() - user.timeCached) {
                // return without any worries
                return user.user ? JSON.parse(user.user) : null;
            }
        }
        // else we must grab it
        const response = yield graph
            .api(`/users/${userPrincipleName}`)
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(scopes))
            .get();
        if (usersCacheEnabled()) {
            cache.putValue(userPrincipleName, { user: JSON.stringify(response) });
        }
        return response;
    });
}
/**
 * Returns a Promise of Graph Users array associated with the user ids array
 *
 * @export
 * @param {IGraph} graph
 * @param {string[]} userIds, an array of string ids
 * @returns {Promise<User[]>}
 */
function getUsersForUserIds(graph, userIds) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!userIds || userIds.length === 0) {
            return [];
        }
        const batch = graph.createBatch();
        const peopleDict = {};
        const notInCache = [];
        let cache;
        if (usersCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, userStore);
        }
        for (const id of userIds) {
            peopleDict[id] = null;
            let user = null;
            if (usersCacheEnabled()) {
                user = yield cache.getValue(id);
            }
            if (user && getUserInvalidationTime() > Date.now() - user.timeCached) {
                peopleDict[id] = user.user ? JSON.parse(user.user) : null;
            }
            else if (id !== '') {
                batch.get(id, `/users/${id}`, ['user.readbasic.all']);
                notInCache.push(id);
            }
        }
        try {
            const responses = yield batch.executeAll();
            // iterate over userIds to ensure the order of ids
            for (const id of userIds) {
                const response = responses.get(id);
                if (response && response.content) {
                    peopleDict[id] = response.content;
                    if (usersCacheEnabled()) {
                        cache.putValue(id, { user: JSON.stringify(response.content) });
                    }
                }
            }
            return Promise.all(Object.values(peopleDict));
        }
        catch (_) {
            // fallback to making the request one by one
            try {
                // call getUser for all the users that weren't cached
                userIds.filter(id => notInCache.includes(id)).forEach(id => (peopleDict[id] = getUser(graph, id)));
                if (usersCacheEnabled()) {
                    // store all users that weren't retrieved from the cache, into the cache
                    userIds
                        .filter(id => notInCache.includes(id))
                        .forEach((id) => __awaiter(this, void 0, void 0, function* () { return cache.putValue(id, { user: JSON.stringify(yield peopleDict[id]) }); }));
                }
                return Promise.all(Object.values(peopleDict));
            }
            catch (_) {
                return [];
            }
        }
    });
}
/**
 * Returns a Promise of Graph Users array associated with the people queries array
 *
 * @export
 * @param {IGraph} graph
 * @param {string[]} peopleQueries, an array of string ids
 * @returns {Promise<User[]>}
 */
function getUsersForPeopleQueries(graph, peopleQueries) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!peopleQueries || peopleQueries.length === 0) {
            return [];
        }
        const batch = graph.createBatch();
        const people = [];
        let cacheRes;
        let cache;
        if (usersCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, queryStore);
        }
        for (const personQuery of peopleQueries) {
            if (usersCacheEnabled()) {
                cacheRes = yield cache.getValue(personQuery);
            }
            if (usersCacheEnabled() && cacheRes && getUserInvalidationTime() > Date.now() - cacheRes.timeCached) {
                people.push(JSON.parse(cacheRes.results[0]));
            }
            else if (personQuery !== '') {
                batch.get(personQuery, `/me/people?$search="${personQuery}"`, ['people.read']);
            }
        }
        try {
            const responses = yield batch.executeAll();
            for (const personQuery of peopleQueries) {
                const response = responses.get(personQuery);
                if (response && response.content && response.content.value && response.content.value.length > 0) {
                    people.push(response.content.value[0]);
                    if (usersCacheEnabled()) {
                        cache.putValue(personQuery, { maxResults: 1, results: [JSON.stringify(response.content.value[0])] });
                    }
                }
            }
            return people;
        }
        catch (_) {
            try {
                return Promise.all(peopleQueries
                    .filter(personQuery => personQuery && personQuery !== '')
                    .map((personQuery) => __awaiter(this, void 0, void 0, function* () {
                    const personArray = yield Object(_graph_people__WEBPACK_IMPORTED_MODULE_1__["findPeople"])(graph, personQuery, 1);
                    if (personArray && personArray.length) {
                        if (usersCacheEnabled()) {
                            cache.putValue(personQuery, { maxResults: 1, results: [JSON.stringify(personArray[0])] });
                        }
                        return personArray[0];
                    }
                })));
            }
            catch (_) {
                return [];
            }
        }
    });
}
/**
 * Search Microsoft Graph for Users in the organization
 *
 * @export
 * @param {IGraph} graph
 * @param {string} query - the string to search for
 * @param {number} [top=10] - maximum number of results to return
 * @returns {Promise<User[]>}
 */
function findUsers(graph, query, top = 10) {
    return __awaiter(this, void 0, void 0, function* () {
        const scopes = 'User.ReadBasic.All';
        const item = { maxResults: top, results: null };
        let cache;
        if (usersCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, queryStore);
            const result = yield cache.getValue(query);
            if (result && getUserInvalidationTime() > Date.now() - result.timeCached) {
                return result.results.map(userStr => JSON.parse(userStr));
            }
        }
        let graphResult;
        try {
            graphResult = yield graph
                .api('users')
                .header('ConsistencyLevel', 'eventual')
                .count(true)
                .search(`"displayName:${query}"`)
                .top(top)
                .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(scopes))
                .get();
        }
        catch (_a) { }
        if (usersCacheEnabled() && graphResult) {
            item.results = graphResult.value.map(userStr => JSON.stringify(userStr));
            cache.putValue(query, item);
        }
        return graphResult ? graphResult.value : null;
    });
}
/**
 * async promise, returns all matching Graph users who are member of the specified group
 *
 * @param {string} query
 * @param {string} groupId - the group to query
 * @param {number} [top=10] - number of people to return
 * @param {PersonType} [personType=PersonType.person] - the type of person to search for
 * @param {boolean} [transitive=false] - whether the return should contain a flat list of all nested members
 * @returns {(Promise<User[]>)}
 */
function findGroupMembers(graph, query, groupId, top = 10, personType = _graph_people__WEBPACK_IMPORTED_MODULE_1__["PersonType"].person, transitive = false) {
    return __awaiter(this, void 0, void 0, function* () {
        const scopes = ['user.read.all', 'people.read'];
        const item = { maxResults: top, results: null };
        let cache;
        const key = `${groupId || '*'}:${query || '*'}:${personType}:${transitive}`;
        if (usersCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, queryStore);
            const result = yield cache.getValue(key);
            if (result && getUserInvalidationTime() > Date.now() - result.timeCached) {
                return result.results.map(userStr => JSON.parse(userStr));
            }
        }
        let filter = '';
        if (query) {
            filter = `startswith(displayName,'${query}') or startswith(givenName,'${query}') or startswith(surname,'${query}') or startswith(mail,'${query}') or startswith(userPrincipalName,'${query}')`;
        }
        let apiUrl = `/groups/${groupId}/${transitive ? 'transitiveMembers' : 'members'}`;
        if (personType === _graph_people__WEBPACK_IMPORTED_MODULE_1__["PersonType"].person) {
            apiUrl += `/microsoft.graph.user`;
        }
        else if (personType === _graph_people__WEBPACK_IMPORTED_MODULE_1__["PersonType"].group) {
            apiUrl += `/microsoft.graph.group`;
            if (query) {
                filter = `startswith(displayName,'${query}') or startswith(mail,'${query}')`;
            }
        }
        const graphResult = yield graph
            .api(apiUrl)
            .count(true)
            .top(top)
            .filter(filter)
            .header('ConsistencyLevel', 'eventual')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(...scopes))
            .get();
        if (usersCacheEnabled() && graphResult) {
            item.results = graphResult.value.map(userStr => JSON.stringify(userStr));
            cache.putValue(key, item);
        }
        return graphResult ? graphResult.value : null;
    });
}
//# sourceMappingURL=graph.user.js.map

/***/ }),

/***/ "13ek":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/TelemetryHandler.js ***!
  \**********************************************************************************************************************************/
/*! exports provided: TelemetryHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TelemetryHandler", function() { return TelemetryHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _GraphRequestUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../GraphRequestUtil */ "kC25");
/* harmony import */ var _Version__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Version */ "Rmnq");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./MiddlewareControl */ "ocZF");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./MiddlewareUtil */ "kM4i");
/* harmony import */ var _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./options/TelemetryHandlerOptions */ "Rgfv");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @module TelemetryHandler
 */





/**
 * @class
 * @implements Middleware
 * Class for TelemetryHandler
 */
class TelemetryHandler {
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const url = typeof context.request === "string" ? context.request : context.request.url;
                if (Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_1__["isGraphURL"])(url)) {
                    // Add telemetry only if the request url is a Graph URL.
                    // Errors are reported as in issue #265 if headers are present when redirecting to a non Graph URL
                    let clientRequestId = Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__["getRequestHeader"])(context.request, context.options, TelemetryHandler.CLIENT_REQUEST_ID_HEADER);
                    if (!clientRequestId) {
                        clientRequestId = Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__["generateUUID"])();
                        Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__["setRequestHeader"])(context.request, context.options, TelemetryHandler.CLIENT_REQUEST_ID_HEADER, clientRequestId);
                    }
                    let sdkVersionValue = `${TelemetryHandler.PRODUCT_NAME}/${_Version__WEBPACK_IMPORTED_MODULE_2__["PACKAGE_VERSION"]}`;
                    let options;
                    if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_3__["MiddlewareControl"]) {
                        options = context.middlewareControl.getMiddlewareOptions(_options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["TelemetryHandlerOptions"]);
                    }
                    if (options) {
                        const featureUsage = options.getFeatureUsage();
                        sdkVersionValue += ` (${TelemetryHandler.FEATURE_USAGE_STRING}=${featureUsage})`;
                    }
                    Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__["appendRequestHeader"])(context.request, context.options, TelemetryHandler.SDK_VERSION_HEADER, sdkVersionValue);
                }
                else {
                    // Remove telemetry headers if present during redirection.
                    delete context.options.headers[TelemetryHandler.CLIENT_REQUEST_ID_HEADER];
                    delete context.options.headers[TelemetryHandler.SDK_VERSION_HEADER];
                }
                return yield this.nextMiddleware.execute(context);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
/**
 * @private
 * @static
 * A member holding the name of the client request id header
 */
TelemetryHandler.CLIENT_REQUEST_ID_HEADER = "client-request-id";
/**
 * @private
 * @static
 * A member holding the name of the sdk version header
 */
TelemetryHandler.SDK_VERSION_HEADER = "SdkVersion";
/**
 * @private
 * @static
 * A member holding the language prefix for the sdk version header value
 */
TelemetryHandler.PRODUCT_NAME = "graph-js";
/**
 * @private
 * @static
 * A member holding the key for the feature usage metrics
 */
TelemetryHandler.FEATURE_USAGE_STRING = "featureUsage";
//# sourceMappingURL=TelemetryHandler.js.map

/***/ }),

/***/ "19uc":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/strings.js ***!
  \***********************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    sendEmailLinkSubtitle: 'Send email',
    startChatLinkSubtitle: 'Start chat',
    showMoreSectionButton: 'Show more'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "1JlL":
/*!****************************************************!*\
  !*** ./node_modules/lit-element/lib/decorators.js ***!
  \****************************************************/
/*! exports provided: customElement, property, internalProperty, query, queryAsync, queryAll, eventOptions, queryAssignedNodes */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "customElement", function() { return customElement; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "property", function() { return property; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "internalProperty", function() { return internalProperty; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "query", function() { return query; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryAsync", function() { return queryAsync; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryAll", function() { return queryAll; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "eventOptions", function() { return eventOptions; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryAssignedNodes", function() { return queryAssignedNodes; });
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const legacyCustomElement = (tagName, clazz) => {
    window.customElements.define(tagName, clazz);
    // Cast as any because TS doesn't recognize the return type as being a
    // subtype of the decorated class when clazz is typed as
    // `Constructor<HTMLElement>` for some reason.
    // `Constructor<HTMLElement>` is helpful to make sure the decorator is
    // applied to elements however.
    // tslint:disable-next-line:no-any
    return clazz;
};
const standardCustomElement = (tagName, descriptor) => {
    const { kind, elements } = descriptor;
    return {
        kind,
        elements,
        // This callback is called once the class is otherwise fully defined
        finisher(clazz) {
            window.customElements.define(tagName, clazz);
        }
    };
};
/**
 * Class decorator factory that defines the decorated class as a custom element.
 *
 * ```
 * @customElement('my-element')
 * class MyElement {
 *   render() {
 *     return html``;
 *   }
 * }
 * ```
 * @category Decorator
 * @param tagName The name of the custom element to define.
 */
const customElement = (tagName) => (classOrDescriptor) => (typeof classOrDescriptor === 'function') ?
    legacyCustomElement(tagName, classOrDescriptor) :
    standardCustomElement(tagName, classOrDescriptor);
const standardProperty = (options, element) => {
    // When decorating an accessor, pass it through and add property metadata.
    // Note, the `hasOwnProperty` check in `createProperty` ensures we don't
    // stomp over the user's accessor.
    if (element.kind === 'method' && element.descriptor &&
        !('value' in element.descriptor)) {
        return Object.assign(Object.assign({}, element), { finisher(clazz) {
                clazz.createProperty(element.key, options);
            } });
    }
    else {
        // createProperty() takes care of defining the property, but we still
        // must return some kind of descriptor, so return a descriptor for an
        // unused prototype field. The finisher calls createProperty().
        return {
            kind: 'field',
            key: Symbol(),
            placement: 'own',
            descriptor: {},
            // When @babel/plugin-proposal-decorators implements initializers,
            // do this instead of the initializer below. See:
            // https://github.com/babel/babel/issues/9260 extras: [
            //   {
            //     kind: 'initializer',
            //     placement: 'own',
            //     initializer: descriptor.initializer,
            //   }
            // ],
            initializer() {
                if (typeof element.initializer === 'function') {
                    this[element.key] = element.initializer.call(this);
                }
            },
            finisher(clazz) {
                clazz.createProperty(element.key, options);
            }
        };
    }
};
const legacyProperty = (options, proto, name) => {
    proto.constructor
        .createProperty(name, options);
};
/**
 * A property decorator which creates a LitElement property which reflects a
 * corresponding attribute value. A [[`PropertyDeclaration`]] may optionally be
 * supplied to configure property features.
 *
 * This decorator should only be used for public fields. Private or protected
 * fields should use the [[`internalProperty`]] decorator.
 *
 * @example
 * ```ts
 * class MyElement {
 *   @property({ type: Boolean })
 *   clicked = false;
 * }
 * ```
 * @category Decorator
 * @ExportDecoratedItems
 */
function property(options) {
    // tslint:disable-next-line:no-any decorator
    return (protoOrDescriptor, name) => (name !== undefined) ?
        legacyProperty(options, protoOrDescriptor, name) :
        standardProperty(options, protoOrDescriptor);
}
/**
 * Declares a private or protected property that still triggers updates to the
 * element when it changes.
 *
 * Properties declared this way must not be used from HTML or HTML templating
 * systems, they're solely for properties internal to the element. These
 * properties may be renamed by optimization tools like closure compiler.
 * @category Decorator
 */
function internalProperty(options) {
    return property({ attribute: false, hasChanged: options === null || options === void 0 ? void 0 : options.hasChanged });
}
/**
 * A property decorator that converts a class property into a getter that
 * executes a querySelector on the element's renderRoot.
 *
 * @param selector A DOMString containing one or more selectors to match.
 * @param cache An optional boolean which when true performs the DOM query only
 * once and caches the result.
 *
 * See: https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector
 *
 * @example
 *
 * ```ts
 * class MyElement {
 *   @query('#first')
 *   first;
 *
 *   render() {
 *     return html`
 *       <div id="first"></div>
 *       <div id="second"></div>
 *     `;
 *   }
 * }
 * ```
 * @category Decorator
 */
function query(selector, cache) {
    return (protoOrDescriptor, 
    // tslint:disable-next-line:no-any decorator
    name) => {
        const descriptor = {
            get() {
                return this.renderRoot.querySelector(selector);
            },
            enumerable: true,
            configurable: true,
        };
        if (cache) {
            const key = typeof name === 'symbol' ? Symbol() : `__${name}`;
            descriptor.get = function () {
                if (this[key] === undefined) {
                    (this[key] =
                        this.renderRoot.querySelector(selector));
                }
                return this[key];
            };
        }
        return (name !== undefined) ?
            legacyQuery(descriptor, protoOrDescriptor, name) :
            standardQuery(descriptor, protoOrDescriptor);
    };
}
// Note, in the future, we may extend this decorator to support the use case
// where the queried element may need to do work to become ready to interact
// with (e.g. load some implementation code). If so, we might elect to
// add a second argument defining a function that can be run to make the
// queried element loaded/updated/ready.
/**
 * A property decorator that converts a class property into a getter that
 * returns a promise that resolves to the result of a querySelector on the
 * element's renderRoot done after the element's `updateComplete` promise
 * resolves. When the queried property may change with element state, this
 * decorator can be used instead of requiring users to await the
 * `updateComplete` before accessing the property.
 *
 * @param selector A DOMString containing one or more selectors to match.
 *
 * See: https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector
 *
 * @example
 * ```ts
 * class MyElement {
 *   @queryAsync('#first')
 *   first;
 *
 *   render() {
 *     return html`
 *       <div id="first"></div>
 *       <div id="second"></div>
 *     `;
 *   }
 * }
 *
 * // external usage
 * async doSomethingWithFirst() {
 *  (await aMyElement.first).doSomething();
 * }
 * ```
 * @category Decorator
 */
function queryAsync(selector) {
    return (protoOrDescriptor, 
    // tslint:disable-next-line:no-any decorator
    name) => {
        const descriptor = {
            async get() {
                await this.updateComplete;
                return this.renderRoot.querySelector(selector);
            },
            enumerable: true,
            configurable: true,
        };
        return (name !== undefined) ?
            legacyQuery(descriptor, protoOrDescriptor, name) :
            standardQuery(descriptor, protoOrDescriptor);
    };
}
/**
 * A property decorator that converts a class property into a getter
 * that executes a querySelectorAll on the element's renderRoot.
 *
 * @param selector A DOMString containing one or more selectors to match.
 *
 * See:
 * https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll
 *
 * @example
 * ```ts
 * class MyElement {
 *   @queryAll('div')
 *   divs;
 *
 *   render() {
 *     return html`
 *       <div id="first"></div>
 *       <div id="second"></div>
 *     `;
 *   }
 * }
 * ```
 * @category Decorator
 */
function queryAll(selector) {
    return (protoOrDescriptor, 
    // tslint:disable-next-line:no-any decorator
    name) => {
        const descriptor = {
            get() {
                return this.renderRoot.querySelectorAll(selector);
            },
            enumerable: true,
            configurable: true,
        };
        return (name !== undefined) ?
            legacyQuery(descriptor, protoOrDescriptor, name) :
            standardQuery(descriptor, protoOrDescriptor);
    };
}
const legacyQuery = (descriptor, proto, name) => {
    Object.defineProperty(proto, name, descriptor);
};
const standardQuery = (descriptor, element) => ({
    kind: 'method',
    placement: 'prototype',
    key: element.key,
    descriptor,
});
const standardEventOptions = (options, element) => {
    return Object.assign(Object.assign({}, element), { finisher(clazz) {
            Object.assign(clazz.prototype[element.key], options);
        } });
};
const legacyEventOptions = 
// tslint:disable-next-line:no-any legacy decorator
(options, proto, name) => {
    Object.assign(proto[name], options);
};
/**
 * Adds event listener options to a method used as an event listener in a
 * lit-html template.
 *
 * @param options An object that specifies event listener options as accepted by
 * `EventTarget#addEventListener` and `EventTarget#removeEventListener`.
 *
 * Current browsers support the `capture`, `passive`, and `once` options. See:
 * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Parameters
 *
 * @example
 * ```ts
 * class MyElement {
 *   clicked = false;
 *
 *   render() {
 *     return html`
 *       <div @click=${this._onClick}`>
 *         <button></button>
 *       </div>
 *     `;
 *   }
 *
 *   @eventOptions({capture: true})
 *   _onClick(e) {
 *     this.clicked = true;
 *   }
 * }
 * ```
 * @category Decorator
 */
function eventOptions(options) {
    // Return value typed as any to prevent TypeScript from complaining that
    // standard decorator function signature does not match TypeScript decorator
    // signature
    // TODO(kschaaf): unclear why it was only failing on this decorator and not
    // the others
    return ((protoOrDescriptor, name) => (name !== undefined) ?
        legacyEventOptions(options, protoOrDescriptor, name) :
        standardEventOptions(options, protoOrDescriptor));
}
// x-browser support for matches
// tslint:disable-next-line:no-any
const ElementProto = Element.prototype;
const legacyMatches = ElementProto.msMatchesSelector || ElementProto.webkitMatchesSelector;
/**
 * A property decorator that converts a class property into a getter that
 * returns the `assignedNodes` of the given named `slot`. Note, the type of
 * this property should be annotated as `NodeListOf<HTMLElement>`.
 *
 * @param slotName A string name of the slot.
 * @param flatten A boolean which when true flattens the assigned nodes,
 * meaning any assigned nodes that are slot elements are replaced with their
 * assigned nodes.
 * @param selector A string which filters the results to elements that match
 * the given css selector.
 *
 * * @example
 * ```ts
 * class MyElement {
 *   @queryAssignedNodes('list', true, '.item')
 *   listItems;
 *
 *   render() {
 *     return html`
 *       <slot name="list"></slot>
 *     `;
 *   }
 * }
 * ```
 * @category Decorator
 */
function queryAssignedNodes(slotName = '', flatten = false, selector = '') {
    return (protoOrDescriptor, 
    // tslint:disable-next-line:no-any decorator
    name) => {
        const descriptor = {
            get() {
                const slotSelector = `slot${slotName ? `[name=${slotName}]` : ':not([name])'}`;
                const slot = this.renderRoot.querySelector(slotSelector);
                let nodes = slot && slot.assignedNodes({ flatten });
                if (nodes && selector) {
                    nodes = nodes.filter((node) => node.nodeType === Node.ELEMENT_NODE &&
                        node.matches ?
                        node.matches(selector) :
                        legacyMatches.call(node, selector));
                }
                return nodes;
            },
            enumerable: true,
            configurable: true,
        };
        return (name !== undefined) ?
            legacyQuery(descriptor, protoOrDescriptor, name) :
            standardQuery(descriptor, protoOrDescriptor);
    };
}
//# sourceMappingURL=decorators.js.map

/***/ }),

/***/ "1VLE":
/*!*******************************************!*\
  !*** ./node_modules/lit-html/lib/part.js ***!
  \*******************************************/
/*! exports provided: noChange, nothing */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "noChange", function() { return noChange; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nothing", function() { return nothing; });
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * A sentinel value that signals that a value was handled by a directive and
 * should not be written to the DOM.
 */
const noChange = {};
/**
 * A sentinel value that signals a NodePart to fully clear its content.
 */
const nothing = {};
//# sourceMappingURL=part.js.map

/***/ }),

/***/ "1pLI":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/RetryHandler.js ***!
  \******************************************************************************************************************************/
/*! exports provided: RetryHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RetryHandler", function() { return RetryHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _RequestMethod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../RequestMethod */ "umkM");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MiddlewareControl */ "ocZF");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./MiddlewareUtil */ "kM4i");
/* harmony import */ var _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./options/RetryHandlerOptions */ "Eakl");
/* harmony import */ var _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./options/TelemetryHandlerOptions */ "Rgfv");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */






/**
 * @class
 * @implements Middleware
 * Class for RetryHandler
 */
class RetryHandler {
    /**
     * @public
     * @constructor
     * To create an instance of RetryHandler
     * @param {RetryHandlerOptions} [options = new RetryHandlerOptions()] - The retry handler options value
     * @returns An instance of RetryHandler
     */
    constructor(options = new _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RetryHandlerOptions"]()) {
        this.options = options;
    }
    /**
     *
     * @private
     * To check whether the response has the retry status code
     * @param {Response} response - The response object
     * @returns Whether the response has retry status code or not
     */
    isRetry(response) {
        return RetryHandler.RETRY_STATUS_CODES.indexOf(response.status) !== -1;
    }
    /**
     * @private
     * To check whether the payload is buffered or not
     * @param {RequestInfo} request - The url string or the request object value
     * @param {FetchOptions} options - The options of a request
     * @returns Whether the payload is buffered or not
     */
    isBuffered(request, options) {
        const method = typeof request === "string" ? options.method : request.method;
        const isPutPatchOrPost = method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].PUT || method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].PATCH || method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].POST;
        if (isPutPatchOrPost) {
            const isStream = Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__["getRequestHeader"])(request, options, "Content-Type") === "application/octet-stream";
            if (isStream) {
                return false;
            }
        }
        return true;
    }
    /**
     * @private
     * To get the delay for a retry
     * @param {Response} response - The response object
     * @param {number} retryAttempts - The current attempt count
     * @param {number} delay - The delay value in seconds
     * @returns A delay for a retry
     */
    getDelay(response, retryAttempts, delay) {
        const getRandomness = () => Number(Math.random().toFixed(3));
        const retryAfter = response.headers !== undefined ? response.headers.get(RetryHandler.RETRY_AFTER_HEADER) : null;
        let newDelay;
        if (retryAfter !== null) {
            // tslint:disable: prefer-conditional-expression
            if (Number.isNaN(Number(retryAfter))) {
                newDelay = Math.round((new Date(retryAfter).getTime() - Date.now()) / 1000);
            }
            else {
                newDelay = Number(retryAfter);
            }
            // tslint:enable: prefer-conditional-expression
        }
        else {
            // Adding randomness to avoid retrying at a same
            newDelay = retryAttempts >= 2 ? this.getExponentialBackOffTime(retryAttempts) + delay + getRandomness() : delay + getRandomness();
        }
        return Math.min(newDelay, this.options.getMaxDelay() + getRandomness());
    }
    /**
     * @private
     * To get an exponential back off value
     * @param {number} attempts - The current attempt count
     * @returns An exponential back off value
     */
    getExponentialBackOffTime(attempts) {
        return Math.round((1 / 2) * (Math.pow(2, attempts) - 1));
    }
    /**
     * @private
     * @async
     * To add delay for the execution
     * @param {number} delaySeconds - The delay value in seconds
     * @returns Nothing
     */
    sleep(delaySeconds) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const delayMilliseconds = delaySeconds * 1000;
            return new Promise((resolve) => setTimeout(resolve, delayMilliseconds));
        });
    }
    getOptions(context) {
        let options;
        if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_2__["MiddlewareControl"]) {
            options = context.middlewareControl.getMiddlewareOptions(this.options.constructor);
        }
        if (typeof options === "undefined") {
            options = Object.assign(new _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RetryHandlerOptions"](), this.options);
        }
        return options;
    }
    /**
     * @private
     * @async
     * To execute the middleware with retries
     * @param {Context} context - The context object
     * @param {number} retryAttempts - The current attempt count
     * @param {RetryHandlerOptions} options - The retry middleware options instance
     * @returns A Promise that resolves to nothing
     */
    executeWithRetry(context, retryAttempts, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                yield this.nextMiddleware.execute(context);
                if (retryAttempts < options.maxRetries && this.isRetry(context.response) && this.isBuffered(context.request, context.options) && options.shouldRetry(options.delay, retryAttempts, context.request, context.options, context.response)) {
                    ++retryAttempts;
                    Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__["setRequestHeader"])(context.request, context.options, RetryHandler.RETRY_ATTEMPT_HEADER, retryAttempts.toString());
                    const delay = this.getDelay(context.response, retryAttempts, options.delay);
                    yield this.sleep(delay);
                    return yield this.executeWithRetry(context, retryAttempts, options);
                }
                else {
                    return;
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const retryAttempts = 0;
                const options = this.getOptions(context);
                _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["TelemetryHandlerOptions"].updateFeatureUsageFlag(context, _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["FeatureUsageFlag"].RETRY_HANDLER_ENABLED);
                return yield this.executeWithRetry(context, retryAttempts, options);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
/**
 * @private
 * @static
 * A list of status codes that needs to be retried
 */
RetryHandler.RETRY_STATUS_CODES = [
    429,
    503,
    504,
];
/**
 * @private
 * @static
 * A member holding the name of retry attempt header
 */
RetryHandler.RETRY_ATTEMPT_HEADER = "Retry-Attempt";
/**
 * @private
 * @static
 * A member holding the name of retry after header
 */
RetryHandler.RETRY_AFTER_HEADER = "Retry-After";
//# sourceMappingURL=RetryHandler.js.map

/***/ }),

/***/ "26ea":
/*!**********************************************!*\
  !*** external "@microsoft/sp-property-pane" ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__26ea__;

/***/ }),

/***/ "29R+":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/sub-components/mgt-arrow-options/mgt-arrow-options.js ***!
  \**************************************************************************************************************************/
/*! exports provided: MgtArrowOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtArrowOptions", function() { return MgtArrowOptions; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _mgt_arrow_options_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mgt-arrow-options-css */ "dwGj");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




/*
  Ok, the name here deserves a bit of explanation,
  This component originally had a built-in arrow icon,
  The problem came when you wanted to use a different symbol,
  So the arrow was removed, but the name was already set everywhere.
  - benotter
 */
/**
 * Custom Component used to handle an arrow rendering for TaskGroups utilized in the task component.
 *
 * @export MgtArrowOptions
 * @class MgtArrowOptions
 * @extends {MgtBaseComponent}
 */
let MgtArrowOptions = class MgtArrowOptions extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["MgtBaseComponent"] {
    constructor() {
        super();
        this.value = '';
        this.options = {};
        this._clickHandler = (e) => (this.open = false);
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * user the `css` tag function.
     */
    static get styles() {
        return _mgt_arrow_options_css__WEBPACK_IMPORTED_MODULE_3__["styles"];
    }
    // tslint:disable-next-line: completed-docs
    connectedCallback() {
        super.connectedCallback();
        window.addEventListener('click', this._clickHandler);
    }
    // tslint:disable-next-line: completed-docs
    disconnectedCallback() {
        window.removeEventListener('click', this._clickHandler);
        super.disconnectedCallback();
    }
    /**
     * Handles clicking for header menu, utilizing boolean switch open
     *
     * @param {MouseEvent} e attaches to Header to open menu
     * @memberof MgtArrowOptions
     */
    onHeaderClick(e) {
        const keys = Object.keys(this.options);
        if (keys.length > 1) {
            e.preventDefault();
            e.stopPropagation();
            this.open = !this.open;
        }
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <span class="Header" @click=${e => this.onHeaderClick(e)}>
        <span class="CurrentValue">${this.value}</span>
      </span>
      <div class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({ Menu: true, Open: this.open, Closed: !this.open })}>
        ${this.getMenuOptions()}
      </div>
    `;
    }
    getMenuOptions() {
        const keys = Object.keys(this.options);
        const funcs = this.options;
        return keys.map(opt => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div
          class="MenuOption"
          @click="${(e) => {
            this.open = false;
            funcs[opt](e);
        }}"
        >
          <span class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({ MenuOptionCheck: true, CurrentValue: this.value === opt })}>
            \uE73E
          </span>
          <span class="MenuOptionName">${opt}</span>
        </div>
      `);
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ type: Boolean }),
    __metadata("design:type", Boolean)
], MgtArrowOptions.prototype, "open", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ type: String }),
    __metadata("design:type", String)
], MgtArrowOptions.prototype, "value", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ type: Object }),
    __metadata("design:type", Object)
], MgtArrowOptions.prototype, "options", void 0);
MgtArrowOptions = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-arrow-options'),
    __metadata("design:paramtypes", [])
], MgtArrowOptions);

//# sourceMappingURL=mgt-arrow-options.js.map

/***/ }),

/***/ "2Fb8":
/*!****************************************************!*\
  !*** ./node_modules/lit-html/directives/repeat.js ***!
  \****************************************************/
/*! exports provided: repeat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "repeat", function() { return repeat; });
/* harmony import */ var _lit_html_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lit-html.js */ "AaG5");
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */

// Helper functions for manipulating parts
// TODO(kschaaf): Refactor into Part API?
const createAndInsertPart = (containerPart, beforePart) => {
    const container = containerPart.startNode.parentNode;
    const beforeNode = beforePart === undefined ? containerPart.endNode :
        beforePart.startNode;
    const startNode = container.insertBefore(Object(_lit_html_js__WEBPACK_IMPORTED_MODULE_0__["createMarker"])(), beforeNode);
    container.insertBefore(Object(_lit_html_js__WEBPACK_IMPORTED_MODULE_0__["createMarker"])(), beforeNode);
    const newPart = new _lit_html_js__WEBPACK_IMPORTED_MODULE_0__["NodePart"](containerPart.options);
    newPart.insertAfterNode(startNode);
    return newPart;
};
const updatePart = (part, value) => {
    part.setValue(value);
    part.commit();
    return part;
};
const insertPartBefore = (containerPart, part, ref) => {
    const container = containerPart.startNode.parentNode;
    const beforeNode = ref ? ref.startNode : containerPart.endNode;
    const endNode = part.endNode.nextSibling;
    if (endNode !== beforeNode) {
        Object(_lit_html_js__WEBPACK_IMPORTED_MODULE_0__["reparentNodes"])(container, part.startNode, endNode, beforeNode);
    }
};
const removePart = (part) => {
    Object(_lit_html_js__WEBPACK_IMPORTED_MODULE_0__["removeNodes"])(part.startNode.parentNode, part.startNode, part.endNode.nextSibling);
};
// Helper for generating a map of array item to its index over a subset
// of an array (used to lazily generate `newKeyToIndexMap` and
// `oldKeyToIndexMap`)
const generateMap = (list, start, end) => {
    const map = new Map();
    for (let i = start; i <= end; i++) {
        map.set(list[i], i);
    }
    return map;
};
// Stores previous ordered list of parts and map of key to index
const partListCache = new WeakMap();
const keyListCache = new WeakMap();
/**
 * A directive that repeats a series of values (usually `TemplateResults`)
 * generated from an iterable, and updates those items efficiently when the
 * iterable changes based on user-provided `keys` associated with each item.
 *
 * Note that if a `keyFn` is provided, strict key-to-DOM mapping is maintained,
 * meaning previous DOM for a given key is moved into the new position if
 * needed, and DOM will never be reused with values for different keys (new DOM
 * will always be created for new keys). This is generally the most efficient
 * way to use `repeat` since it performs minimum unnecessary work for insertions
 * and removals.
 *
 * IMPORTANT: If providing a `keyFn`, keys *must* be unique for all items in a
 * given call to `repeat`. The behavior when two or more items have the same key
 * is undefined.
 *
 * If no `keyFn` is provided, this directive will perform similar to mapping
 * items to values, and DOM will be reused against potentially different items.
 */
const repeat = Object(_lit_html_js__WEBPACK_IMPORTED_MODULE_0__["directive"])((items, keyFnOrTemplate, template) => {
    let keyFn;
    if (template === undefined) {
        template = keyFnOrTemplate;
    }
    else if (keyFnOrTemplate !== undefined) {
        keyFn = keyFnOrTemplate;
    }
    return (containerPart) => {
        if (!(containerPart instanceof _lit_html_js__WEBPACK_IMPORTED_MODULE_0__["NodePart"])) {
            throw new Error('repeat can only be used in text bindings');
        }
        // Old part & key lists are retrieved from the last update
        // (associated with the part for this instance of the directive)
        const oldParts = partListCache.get(containerPart) || [];
        const oldKeys = keyListCache.get(containerPart) || [];
        // New part list will be built up as we go (either reused from
        // old parts or created for new keys in this update). This is
        // saved in the above cache at the end of the update.
        const newParts = [];
        // New value list is eagerly generated from items along with a
        // parallel array indicating its key.
        const newValues = [];
        const newKeys = [];
        let index = 0;
        for (const item of items) {
            newKeys[index] = keyFn ? keyFn(item, index) : index;
            newValues[index] = template(item, index);
            index++;
        }
        // Maps from key to index for current and previous update; these
        // are generated lazily only when needed as a performance
        // optimization, since they are only required for multiple
        // non-contiguous changes in the list, which are less common.
        let newKeyToIndexMap;
        let oldKeyToIndexMap;
        // Head and tail pointers to old parts and new values
        let oldHead = 0;
        let oldTail = oldParts.length - 1;
        let newHead = 0;
        let newTail = newValues.length - 1;
        // Overview of O(n) reconciliation algorithm (general approach
        // based on ideas found in ivi, vue, snabbdom, etc.):
        //
        // * We start with the list of old parts and new values (and
        //   arrays of their respective keys), head/tail pointers into
        //   each, and we build up the new list of parts by updating
        //   (and when needed, moving) old parts or creating new ones.
        //   The initial scenario might look like this (for brevity of
        //   the diagrams, the numbers in the array reflect keys
        //   associated with the old parts or new values, although keys
        //   and parts/values are actually stored in parallel arrays
        //   indexed using the same head/tail pointers):
        //
        //      oldHead v                 v oldTail
        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]
        //   newParts: [ ,  ,  ,  ,  ,  ,  ]
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6] <- reflects the user's new
        //                                      item order
        //      newHead ^                 ^ newTail
        //
        // * Iterate old & new lists from both sides, updating,
        //   swapping, or removing parts at the head/tail locations
        //   until neither head nor tail can move.
        //
        // * Example below: keys at head pointers match, so update old
        //   part 0 in-place (no need to move it) and record part 0 in
        //   the `newParts` list. The last thing we do is advance the
        //   `oldHead` and `newHead` pointers (will be reflected in the
        //   next diagram).
        //
        //      oldHead v                 v oldTail
        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]
        //   newParts: [0,  ,  ,  ,  ,  ,  ] <- heads matched: update 0
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance both oldHead
        //                                      & newHead
        //      newHead ^                 ^ newTail
        //
        // * Example below: head pointers don't match, but tail
        //   pointers do, so update part 6 in place (no need to move
        //   it), and record part 6 in the `newParts` list. Last,
        //   advance the `oldTail` and `oldHead` pointers.
        //
        //         oldHead v              v oldTail
        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]
        //   newParts: [0,  ,  ,  ,  ,  , 6] <- tails matched: update 6
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance both oldTail
        //                                      & newTail
        //         newHead ^              ^ newTail
        //
        // * If neither head nor tail match; next check if one of the
        //   old head/tail items was removed. We first need to generate
        //   the reverse map of new keys to index (`newKeyToIndexMap`),
        //   which is done once lazily as a performance optimization,
        //   since we only hit this case if multiple non-contiguous
        //   changes were made. Note that for contiguous removal
        //   anywhere in the list, the head and tails would advance
        //   from either end and pass each other before we get to this
        //   case and removals would be handled in the final while loop
        //   without needing to generate the map.
        //
        // * Example below: The key at `oldTail` was removed (no longer
        //   in the `newKeyToIndexMap`), so remove that part from the
        //   DOM and advance just the `oldTail` pointer.
        //
        //         oldHead v           v oldTail
        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]
        //   newParts: [0,  ,  ,  ,  ,  , 6] <- 5 not in new map: remove
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    5 and advance oldTail
        //         newHead ^           ^ newTail
        //
        // * Once head and tail cannot move, any mismatches are due to
        //   either new or moved items; if a new key is in the previous
        //   "old key to old index" map, move the old part to the new
        //   location, otherwise create and insert a new part. Note
        //   that when moving an old part we null its position in the
        //   oldParts array if it lies between the head and tail so we
        //   know to skip it when the pointers get there.
        //
        // * Example below: neither head nor tail match, and neither
        //   were removed; so find the `newHead` key in the
        //   `oldKeyToIndexMap`, and move that old part's DOM into the
        //   next head position (before `oldParts[oldHead]`). Last,
        //   null the part in the `oldPart` array since it was
        //   somewhere in the remaining oldParts still to be scanned
        //   (between the head and tail pointers) so that we know to
        //   skip that old part on future iterations.
        //
        //         oldHead v        v oldTail
        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]
        //   newParts: [0, 2,  ,  ,  ,  , 6] <- stuck: update & move 2
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    into place and advance
        //                                      newHead
        //         newHead ^           ^ newTail
        //
        // * Note that for moves/insertions like the one above, a part
        //   inserted at the head pointer is inserted before the
        //   current `oldParts[oldHead]`, and a part inserted at the
        //   tail pointer is inserted before `newParts[newTail+1]`. The
        //   seeming asymmetry lies in the fact that new parts are
        //   moved into place outside in, so to the right of the head
        //   pointer are old parts, and to the right of the tail
        //   pointer are new parts.
        //
        // * We always restart back from the top of the algorithm,
        //   allowing matching and simple updates in place to
        //   continue...
        //
        // * Example below: the head pointers once again match, so
        //   simply update part 1 and record it in the `newParts`
        //   array.  Last, advance both head pointers.
        //
        //         oldHead v        v oldTail
        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]
        //   newParts: [0, 2, 1,  ,  ,  , 6] <- heads matched: update 1
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance both oldHead
        //                                      & newHead
        //            newHead ^        ^ newTail
        //
        // * As mentioned above, items that were moved as a result of
        //   being stuck (the final else clause in the code below) are
        //   marked with null, so we always advance old pointers over
        //   these so we're comparing the next actual old value on
        //   either end.
        //
        // * Example below: `oldHead` is null (already placed in
        //   newParts), so advance `oldHead`.
        //
        //            oldHead v     v oldTail
        //   oldKeys:  [0, 1, -, 3, 4, 5, 6] <- old head already used:
        //   newParts: [0, 2, 1,  ,  ,  , 6]    advance oldHead
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]
        //               newHead ^     ^ newTail
        //
        // * Note it's not critical to mark old parts as null when they
        //   are moved from head to tail or tail to head, since they
        //   will be outside the pointer range and never visited again.
        //
        // * Example below: Here the old tail key matches the new head
        //   key, so the part at the `oldTail` position and move its
        //   DOM to the new head position (before `oldParts[oldHead]`).
        //   Last, advance `oldTail` and `newHead` pointers.
        //
        //               oldHead v  v oldTail
        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]
        //   newParts: [0, 2, 1, 4,  ,  , 6] <- old tail matches new
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]   head: update & move 4,
        //                                     advance oldTail & newHead
        //               newHead ^     ^ newTail
        //
        // * Example below: Old and new head keys match, so update the
        //   old head part in place, and advance the `oldHead` and
        //   `newHead` pointers.
        //
        //               oldHead v oldTail
        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]
        //   newParts: [0, 2, 1, 4, 3,   ,6] <- heads match: update 3
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance oldHead &
        //                                      newHead
        //                  newHead ^  ^ newTail
        //
        // * Once the new or old pointers move past each other then all
        //   we have left is additions (if old list exhausted) or
        //   removals (if new list exhausted). Those are handled in the
        //   final while loops at the end.
        //
        // * Example below: `oldHead` exceeded `oldTail`, so we're done
        //   with the main loop.  Create the remaining part and insert
        //   it at the new head position, and the update is complete.
        //
        //                   (oldHead > oldTail)
        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]
        //   newParts: [0, 2, 1, 4, 3, 7 ,6] <- create and insert 7
        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]
        //                     newHead ^ newTail
        //
        // * Note that the order of the if/else clauses is not
        //   important to the algorithm, as long as the null checks
        //   come first (to ensure we're always working on valid old
        //   parts) and that the final else clause comes last (since
        //   that's where the expensive moves occur). The order of
        //   remaining clauses is is just a simple guess at which cases
        //   will be most common.
        //
        // * TODO(kschaaf) Note, we could calculate the longest
        //   increasing subsequence (LIS) of old items in new position,
        //   and only move those not in the LIS set. However that costs
        //   O(nlogn) time and adds a bit more code, and only helps
        //   make rare types of mutations require fewer moves. The
        //   above handles removes, adds, reversal, swaps, and single
        //   moves of contiguous items in linear time, in the minimum
        //   number of moves. As the number of multiple moves where LIS
        //   might help approaches a random shuffle, the LIS
        //   optimization becomes less helpful, so it seems not worth
        //   the code at this point. Could reconsider if a compelling
        //   case arises.
        while (oldHead <= oldTail && newHead <= newTail) {
            if (oldParts[oldHead] === null) {
                // `null` means old part at head has already been used
                // below; skip
                oldHead++;
            }
            else if (oldParts[oldTail] === null) {
                // `null` means old part at tail has already been used
                // below; skip
                oldTail--;
            }
            else if (oldKeys[oldHead] === newKeys[newHead]) {
                // Old head matches new head; update in place
                newParts[newHead] =
                    updatePart(oldParts[oldHead], newValues[newHead]);
                oldHead++;
                newHead++;
            }
            else if (oldKeys[oldTail] === newKeys[newTail]) {
                // Old tail matches new tail; update in place
                newParts[newTail] =
                    updatePart(oldParts[oldTail], newValues[newTail]);
                oldTail--;
                newTail--;
            }
            else if (oldKeys[oldHead] === newKeys[newTail]) {
                // Old head matches new tail; update and move to new tail
                newParts[newTail] =
                    updatePart(oldParts[oldHead], newValues[newTail]);
                insertPartBefore(containerPart, oldParts[oldHead], newParts[newTail + 1]);
                oldHead++;
                newTail--;
            }
            else if (oldKeys[oldTail] === newKeys[newHead]) {
                // Old tail matches new head; update and move to new head
                newParts[newHead] =
                    updatePart(oldParts[oldTail], newValues[newHead]);
                insertPartBefore(containerPart, oldParts[oldTail], oldParts[oldHead]);
                oldTail--;
                newHead++;
            }
            else {
                if (newKeyToIndexMap === undefined) {
                    // Lazily generate key-to-index maps, used for removals &
                    // moves below
                    newKeyToIndexMap = generateMap(newKeys, newHead, newTail);
                    oldKeyToIndexMap = generateMap(oldKeys, oldHead, oldTail);
                }
                if (!newKeyToIndexMap.has(oldKeys[oldHead])) {
                    // Old head is no longer in new list; remove
                    removePart(oldParts[oldHead]);
                    oldHead++;
                }
                else if (!newKeyToIndexMap.has(oldKeys[oldTail])) {
                    // Old tail is no longer in new list; remove
                    removePart(oldParts[oldTail]);
                    oldTail--;
                }
                else {
                    // Any mismatches at this point are due to additions or
                    // moves; see if we have an old part we can reuse and move
                    // into place
                    const oldIndex = oldKeyToIndexMap.get(newKeys[newHead]);
                    const oldPart = oldIndex !== undefined ? oldParts[oldIndex] : null;
                    if (oldPart === null) {
                        // No old part for this value; create a new one and
                        // insert it
                        const newPart = createAndInsertPart(containerPart, oldParts[oldHead]);
                        updatePart(newPart, newValues[newHead]);
                        newParts[newHead] = newPart;
                    }
                    else {
                        // Reuse old part
                        newParts[newHead] =
                            updatePart(oldPart, newValues[newHead]);
                        insertPartBefore(containerPart, oldPart, oldParts[oldHead]);
                        // This marks the old part as having been used, so that
                        // it will be skipped in the first two checks above
                        oldParts[oldIndex] = null;
                    }
                    newHead++;
                }
            }
        }
        // Add parts for any remaining new values
        while (newHead <= newTail) {
            // For all remaining additions, we insert before last new
            // tail, since old pointers are no longer valid
            const newPart = createAndInsertPart(containerPart, newParts[newTail + 1]);
            updatePart(newPart, newValues[newHead]);
            newParts[newHead++] = newPart;
        }
        // Remove any remaining unused old parts
        while (oldHead <= oldTail) {
            const oldPart = oldParts[oldHead++];
            if (oldPart !== null) {
                removePart(oldPart);
            }
        }
        // Save order of new parts for next round
        partListCache.set(containerPart, newParts);
        keyListCache.set(containerPart, newKeys);
    };
});
//# sourceMappingURL=repeat.js.map

/***/ }),

/***/ "2GLH":
/*!***************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-sharepoint-provider/dist/es6/index.js ***!
  \***************************************************************************/
/*! exports provided: SharePointProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _SharePointProvider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SharePointProvider */ "iNiz");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SharePointProvider", function() { return _SharePointProvider__WEBPACK_IMPORTED_MODULE_0__["SharePointProvider"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "2WXZ":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/tasks/PageIterator.js ***!
  \*************************************************************************************************************************/
/*! exports provided: PageIterator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PageIterator", function() { return PageIterator; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @class
 * Class for PageIterator
 */
class PageIterator {
    /**
     * @public
     * @constructor
     * Creates new instance for PageIterator
     * @param {Client} client - The graph client instance
     * @param {PageCollection} pageCollection - The page collection object
     * @param {PageIteratorCallback} callBack - The callback function
     * @param {GraphRequestOptions} requestOptions - The request options
     * @returns An instance of a PageIterator
     */
    constructor(client, pageCollection, callback, requestOptions) {
        this.client = client;
        this.collection = pageCollection.value;
        this.nextLink = pageCollection["@odata.nextLink"];
        this.deltaLink = pageCollection["@odata.deltaLink"];
        this.callback = callback;
        this.complete = false;
        this.requestOptions = requestOptions;
    }
    /**
     * @private
     * Iterates over a collection by enqueuing entries one by one and kicking the callback with the enqueued entry
     * @returns A boolean indicating the continue flag to process next page
     */
    iterationHelper() {
        if (this.collection === undefined) {
            return false;
        }
        let advance = true;
        while (advance && this.collection.length !== 0) {
            const item = this.collection.shift();
            advance = this.callback(item);
        }
        return advance;
    }
    /**
     * @private
     * @async
     * Helper to make a get request to fetch next page with nextLink url and update the page iterator instance with the returned response
     * @returns A promise that resolves to a response data with next page collection
     */
    fetchAndUpdateNextPageData() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                let graphRequest = this.client.api(this.nextLink);
                if (this.requestOptions) {
                    if (this.requestOptions.headers) {
                        graphRequest = graphRequest.headers(this.requestOptions.headers);
                    }
                    if (this.requestOptions.middlewareOptions) {
                        graphRequest = graphRequest.middlewareOptions(this.requestOptions.middlewareOptions);
                    }
                    if (this.requestOptions.options) {
                        graphRequest = graphRequest.options(this.requestOptions.options);
                    }
                }
                const response = yield graphRequest.get();
                this.collection = response.value;
                this.nextLink = response["@odata.nextLink"];
                this.deltaLink = response["@odata.deltaLink"];
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * Getter to get the deltaLink in the current response
     * @returns A deltaLink which is being used to make delta requests in future
     */
    getDeltaLink() {
        return this.deltaLink;
    }
    /**
     * @public
     * @async
     * Iterates over the collection and kicks callback for each item on iteration. Fetches next set of data through nextLink and iterates over again
     * This happens until the nextLink is drained out or the user responds with a red flag to continue from callback
     * @returns A Promise that resolves to nothing on completion and throws error incase of any discrepancy.
     */
    iterate() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                let advance = this.iterationHelper();
                while (advance) {
                    if (this.nextLink !== undefined) {
                        yield this.fetchAndUpdateNextPageData();
                        advance = this.iterationHelper();
                    }
                    else {
                        advance = false;
                    }
                }
                if (this.nextLink === undefined && this.collection.length === 0) {
                    this.complete = true;
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * To resume the iteration
     * Note: This internally calls the iterate method, It's just for more readability.
     * @returns A Promise that resolves to nothing on completion and throws error incase of any discrepancy
     */
    resume() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return this.iterate();
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To get the completeness status of the iterator
     * @returns Boolean indicating the completeness
     */
    isComplete() {
        return this.complete;
    }
}
//# sourceMappingURL=PageIterator.js.map

/***/ }),

/***/ "2n9K":
/*!**********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/components.js ***!
  \**********************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _mgt_agenda_mgt_agenda__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mgt-agenda/mgt-agenda */ "Bw11");
/* harmony import */ var _mgt_get_mgt_get__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mgt-get/mgt-get */ "sI9G");
/* harmony import */ var _mgt_login_mgt_login__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mgt-login/mgt-login */ "7LbE");
/* harmony import */ var _mgt_people_picker_mgt_people_picker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mgt-people-picker/mgt-people-picker */ "xHUi");
/* harmony import */ var _mgt_people_mgt_people__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mgt-people/mgt-people */ "iVPg");
/* harmony import */ var _mgt_person_card_mgt_person_card__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mgt-person-card/mgt-person-card */ "yFaD");
/* harmony import */ var _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./mgt-person/mgt-person */ "lBzc");
/* harmony import */ var _mgt_tasks_mgt_tasks__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./mgt-tasks/mgt-tasks */ "s+xp");
/* harmony import */ var _mgt_teams_channel_picker_mgt_teams_channel_picker__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./mgt-teams-channel-picker/mgt-teams-channel-picker */ "LaBb");
/* harmony import */ var _mgt_todo_mgt_todo__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./mgt-todo/mgt-todo */ "P7jh");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtAgenda", function() { return _mgt_agenda_mgt_agenda__WEBPACK_IMPORTED_MODULE_0__["MgtAgenda"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResponseType", function() { return _mgt_get_mgt_get__WEBPACK_IMPORTED_MODULE_1__["ResponseType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtGet", function() { return _mgt_get_mgt_get__WEBPACK_IMPORTED_MODULE_1__["MgtGet"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtLogin", function() { return _mgt_login_mgt_login__WEBPACK_IMPORTED_MODULE_2__["MgtLogin"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GroupType", function() { return _mgt_people_picker_mgt_people_picker__WEBPACK_IMPORTED_MODULE_3__["GroupType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PersonType", function() { return _mgt_people_picker_mgt_people_picker__WEBPACK_IMPORTED_MODULE_3__["PersonType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtPeoplePicker", function() { return _mgt_people_picker_mgt_people_picker__WEBPACK_IMPORTED_MODULE_3__["MgtPeoplePicker"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PersonCardInteraction", function() { return _mgt_people_mgt_people__WEBPACK_IMPORTED_MODULE_4__["PersonCardInteraction"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtPeople", function() { return _mgt_people_mgt_people__WEBPACK_IMPORTED_MODULE_4__["MgtPeople"]; });

/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _mgt_person_card_mgt_person_card__WEBPACK_IMPORTED_MODULE_5__) if(["MgtAgenda","ResponseType","MgtGet","MgtLogin","GroupType","PersonType","MgtPeoplePicker","PersonCardInteraction","MgtPeople","default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _mgt_person_card_mgt_person_card__WEBPACK_IMPORTED_MODULE_5__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PersonViewType", function() { return _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_6__["PersonViewType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtPerson", function() { return _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_6__["MgtPerson"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TasksSource", function() { return _mgt_tasks_mgt_tasks__WEBPACK_IMPORTED_MODULE_7__["TasksSource"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtTasks", function() { return _mgt_tasks_mgt_tasks__WEBPACK_IMPORTED_MODULE_7__["MgtTasks"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtTeamsChannelPicker", function() { return _mgt_teams_channel_picker_mgt_teams_channel_picker__WEBPACK_IMPORTED_MODULE_8__["MgtTeamsChannelPicker"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtTodo", function() { return _mgt_todo_mgt_todo__WEBPACK_IMPORTED_MODULE_9__["MgtTodo"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */




















//# sourceMappingURL=components.js.map

/***/ }),

/***/ "3/+1":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/CustomAuthenticationProvider.js ***!
  \***********************************************************************************************************************************/
/*! exports provided: CustomAuthenticationProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomAuthenticationProvider", function() { return CustomAuthenticationProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @class
 * Class representing CustomAuthenticationProvider
 * @extends AuthenticationProvider
 */
class CustomAuthenticationProvider {
    /**
     * @public
     * @constructor
     * Creates an instance of CustomAuthenticationProvider
     * @param {AuthProviderCallback} provider - An authProvider function
     * @returns An instance of CustomAuthenticationProvider
     */
    constructor(provider) {
        this.provider = provider;
    }
    /**
     * @public
     * @async
     * To get the access token
     * @returns The promise that resolves to an access token
     */
    getAccessToken() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => {
                this.provider((error, accessToken) => {
                    if (accessToken) {
                        resolve(accessToken);
                    }
                    else {
                        reject(error);
                    }
                });
            });
        });
    }
}
//# sourceMappingURL=CustomAuthenticationProvider.js.map

/***/ }),

/***/ "31fH":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/telemetry/TelemetryEvent.js ***!
  \*********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryConstants */ "tekO");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryUtils */ "Rgi7");
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/CryptoUtils */ "RDZQ");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var TelemetryEvent = /** @class */ (function () {
    function TelemetryEvent(eventName, correlationId, eventLabel) {
        var _a;
        this.eventId = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_3__["CryptoUtils"].createNewGuid();
        this.label = eventLabel;
        this.event = (_a = {},
            _a[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["EVENT_NAME_KEY"])] = eventName,
            _a[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["ELAPSED_TIME_KEY"])] = -1,
            _a["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].MsalCorrelationIdConstStrKey] = correlationId,
            _a);
    }
    TelemetryEvent.prototype.setElapsedTime = function (time) {
        this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["ELAPSED_TIME_KEY"])] = time;
    };
    TelemetryEvent.prototype.stop = function () {
        // Set duration of event
        this.setElapsedTime(+Date.now() - +this.startTimestamp);
        Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["endBrowserPerformanceMeasurement"])(this.displayName, this.perfStartMark, this.perfEndMark);
    };
    TelemetryEvent.prototype.start = function () {
        this.startTimestamp = Date.now();
        this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["START_TIME_KEY"])] = this.startTimestamp;
        Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["startBrowserPerformanceMeasurement"])(this.perfStartMark);
    };
    Object.defineProperty(TelemetryEvent.prototype, "telemetryCorrelationId", {
        get: function () {
            return this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].MsalCorrelationIdConstStrKey];
        },
        set: function (value) {
            this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].MsalCorrelationIdConstStrKey] = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "eventName", {
        get: function () {
            return this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["EVENT_NAME_KEY"])];
        },
        enumerable: true,
        configurable: true
    });
    TelemetryEvent.prototype.get = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.event, { eventId: this.eventId });
    };
    Object.defineProperty(TelemetryEvent.prototype, "key", {
        get: function () {
            return this.telemetryCorrelationId + "_" + this.eventId + "-" + this.eventName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "displayName", {
        get: function () {
            return "Msal-" + this.label + "-" + this.telemetryCorrelationId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "perfStartMark", {
        get: function () {
            return "start-" + this.key;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "perfEndMark", {
        get: function () {
            return "end-" + this.key;
        },
        enumerable: true,
        configurable: true
    });
    return TelemetryEvent;
}());
/* harmony default export */ __webpack_exports__["default"] = (TelemetryEvent);
//# sourceMappingURL=TelemetryEvent.js.map

/***/ }),

/***/ "3AmW":
/*!************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/graph/types.js ***!
  \************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
//# sourceMappingURL=types.js.map

/***/ }),

/***/ "3GTD":
/*!*********************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/Batch.js ***!
  \*********************************************************************/
/*! exports provided: BatchRequest, Batch */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRequest", function() { return BatchRequest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Batch", function() { return Batch; });
/* harmony import */ var _IBatch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../IBatch */ "Xol0");
/* harmony import */ var _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/microsoft-graph-client */ "9F8r");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils */ "XG4p");
/* harmony import */ var _GraphHelpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GraphHelpers */ "yLtT");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * Represents a request to be executed in a batch
 *
 * @class BatchRequest
 */
class BatchRequest {
    constructor(index, id, resource, method) {
        if (resource.charAt(0) !== '/') {
            resource = '/' + resource;
        }
        this.resource = resource;
        this.method = method;
        this.index = index;
        this.id = id;
    }
}
/**
 * Method to reduce repetitive requests to the Graph
 *
 * @export
 * @class Batch
 */
// tslint:disable-next-line: max-classes-per-file
class Batch {
    constructor(graph) {
        this.graph = graph;
        this.allRequests = [];
        this.requestsQueue = [];
        this.scopes = [];
        this.nextIndex = 0;
        this.retryAfter = 0;
    }
    /**
     * Get whether there are requests that have not been executed
     *
     * @readonly
     * @memberof Batch
     */
    get hasRequests() {
        return this.requestsQueue.length > 0;
    }
    /**
     * sets new request and scopes
     *
     * @param {string} id
     * @param {string} resource
     * @param {string[]} [scopes]
     * @memberof Batch
     */
    get(id, resource, scopes, headers) {
        const index = this.nextIndex++;
        const request = new BatchRequest(index, id, resource, 'GET');
        request.headers = headers;
        this.allRequests.push(request);
        this.requestsQueue.push(index);
        if (scopes) {
            this.scopes = this.scopes.concat(scopes);
        }
    }
    /**
     * Execute the next set of requests.
     * This will execute up to 20 requests at a time
     *
     * @returns {Promise<Map<string, BatchResponse>>}
     * @memberof Batch
     */
    executeNext() {
        return __awaiter(this, void 0, void 0, function* () {
            const responses = new Map();
            if (this.retryAfter) {
                yield Object(_utils__WEBPACK_IMPORTED_MODULE_2__["delay"])(this.retryAfter * 1000);
                this.retryAfter = 0;
            }
            if (!this.hasRequests) {
                return responses;
            }
            // batch can support up to 20 requests
            const nextBatch = this.requestsQueue.splice(0, 20);
            const batchRequestContent = new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_1__["BatchRequestContent"]();
            for (const request of nextBatch.map(i => this.allRequests[i])) {
                batchRequestContent.addRequest({
                    id: request.index.toString(),
                    request: new Request(Batch.baseUrl + request.resource, {
                        method: request.method,
                        headers: request.headers
                    })
                });
            }
            const middlewareOptions = this.scopes.length ? Object(_GraphHelpers__WEBPACK_IMPORTED_MODULE_3__["prepScopes"])(...this.scopes) : [];
            const batchRequest = this.graph.api('$batch').middlewareOptions(middlewareOptions);
            const batchRequestBody = yield batchRequestContent.getContent();
            const batchResponse = yield batchRequest.post(batchRequestBody);
            for (const r of batchResponse.responses) {
                const response = new _IBatch__WEBPACK_IMPORTED_MODULE_0__["BatchResponse"]();
                const request = this.allRequests[r.id];
                response.id = request.id;
                response.index = request.index;
                response.headers = r.headers;
                if (r.status !== 200) {
                    if (r.status === 429) {
                        // this request was throttled
                        // add request back to queue and set retry wait time
                        this.requestsQueue.unshift(r.id);
                        this.retryAfter = Math.max(this.retryAfter, parseInt(r.headers['Retry-After'], 10) || 1);
                    }
                    continue;
                }
                else if (r.headers['Content-Type'].includes('image/jpeg')) {
                    response.content = 'data:image/jpeg;base64,' + r.body;
                }
                else {
                    response.content = r.body;
                }
                responses.set(request.id, response);
            }
            return responses;
        });
    }
    /**
     * Execute all requests, up to 20 at a time until
     * all requests have been executed
     *
     * @returns {Promise<Map<string, BatchResponse>>}
     * @memberof Batch
     */
    executeAll() {
        return __awaiter(this, void 0, void 0, function* () {
            const responses = new Map();
            while (this.hasRequests) {
                const r = yield this.executeNext();
                for (const [key, value] of r) {
                    responses.set(key, value);
                }
            }
            return responses;
        });
    }
}
// this doesn't really mater what it is as long as it's a root base url
// otherwise a Request assumes the current path and that could change the relative path
Batch.baseUrl = 'https://graph.microsoft.com';
//# sourceMappingURL=Batch.js.map

/***/ }),

/***/ "3gM8":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/telemetry/TelemetryConstants.js ***!
  \*******************************************************************************************************/
/*! exports provided: EVENT_NAME_PREFIX, EVENT_NAME_KEY, START_TIME_KEY, ELAPSED_TIME_KEY, TELEMETRY_BLOB_EVENT_NAMES, TENANT_PLACEHOLDER */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_NAME_PREFIX", function() { return EVENT_NAME_PREFIX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_NAME_KEY", function() { return EVENT_NAME_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "START_TIME_KEY", function() { return START_TIME_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ELAPSED_TIME_KEY", function() { return ELAPSED_TIME_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TELEMETRY_BLOB_EVENT_NAMES", function() { return TELEMETRY_BLOB_EVENT_NAMES; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TENANT_PLACEHOLDER", function() { return TENANT_PLACEHOLDER; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
var EVENT_NAME_PREFIX = "msal.";
var EVENT_NAME_KEY = "event_name";
var START_TIME_KEY = "start_time";
var ELAPSED_TIME_KEY = "elapsed_time";
var TELEMETRY_BLOB_EVENT_NAMES = {
    MsalCorrelationIdConstStrKey: "Microsoft.MSAL.correlation_id",
    ApiTelemIdConstStrKey: "msal.api_telem_id",
    ApiIdConstStrKey: "msal.api_id",
    BrokerAppConstStrKey: "Microsoft_MSAL_broker_app",
    CacheEventCountConstStrKey: "Microsoft_MSAL_cache_event_count",
    HttpEventCountTelemetryBatchKey: "Microsoft_MSAL_http_event_count",
    IdpConstStrKey: "Microsoft_MSAL_idp",
    IsSilentTelemetryBatchKey: "",
    IsSuccessfulConstStrKey: "Microsoft_MSAL_is_successful",
    ResponseTimeConstStrKey: "Microsoft_MSAL_response_time",
    TenantIdConstStrKey: "Microsoft_MSAL_tenant_id",
    UiEventCountTelemetryBatchKey: "Microsoft_MSAL_ui_event_count"
};
// This is used to replace the real tenant in telemetry info
var TENANT_PLACEHOLDER = "<tenant>";
//# sourceMappingURL=TelemetryConstants.js.map

/***/ }),

/***/ "3gtU":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/GraphError.js ***!
  \*****************************************************************************************************************/
/*! exports provided: GraphError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphError", function() { return GraphError; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module GraphError
 */
/**
 * @class
 * Class for GraphError
 * @NOTE: This is NOT what is returned from the Graph
 * GraphError is created from parsing JSON errors returned from the graph
 * Some fields are renamed ie, "request-id" => requestId so you can use dot notation
 */
class GraphError extends Error {
    /**
     * @public
     * @constructor
     * Creates an instance of GraphError
     * @param {number} [statusCode = -1] - The status code of the error
     * @returns An instance of GraphError
     */
    constructor(statusCode = -1, message, baseError) {
        super(message || (baseError && baseError.message));
        // https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work
        Object.setPrototypeOf(this, GraphError.prototype);
        this.statusCode = statusCode;
        this.code = null;
        this.requestId = null;
        this.date = new Date();
        this.body = null;
        this.stack = baseError ? baseError.stack : this.stack;
    }
}
//# sourceMappingURL=GraphError.js.map

/***/ }),

/***/ "43Tr":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/authority/Authority.js ***!
  \**********************************************************************************************/
/*! exports provided: AuthorityType, Authority */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthorityType", function() { return AuthorityType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Authority", function() { return Authority; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "ovzL");
/* harmony import */ var _XHRClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../XHRClient */ "FEzz");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/UrlUtils */ "8P3k");
/* harmony import */ var _TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TrustedAuthority */ "FFC9");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/Constants */ "vFME");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */






/**
 * @hidden
 */
var AuthorityType;
(function (AuthorityType) {
    AuthorityType[AuthorityType["Default"] = 0] = "Default";
    AuthorityType[AuthorityType["Adfs"] = 1] = "Adfs";
})(AuthorityType || (AuthorityType = {}));
/**
 * @hidden
 */
var Authority = /** @class */ (function () {
    function Authority(authority, validateAuthority, authorityMetadata) {
        this.IsValidationEnabled = validateAuthority;
        this.CanonicalAuthority = authority;
        this.validateAsUri();
        this.tenantDiscoveryResponse = authorityMetadata;
    }
    Authority.isAdfs = function (authorityUrl) {
        var components = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].GetUrlComponents(authorityUrl);
        var pathSegments = components.PathSegments;
        return (pathSegments.length && pathSegments[0].toLowerCase() === _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["Constants"].ADFS);
    };
    Object.defineProperty(Authority.prototype, "AuthorityType", {
        get: function () {
            return Authority.isAdfs(this.canonicalAuthority) ? AuthorityType.Adfs : AuthorityType.Default;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "Tenant", {
        get: function () {
            return this.CanonicalAuthorityUrlComponents.PathSegments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "AuthorizationEndpoint", {
        get: function () {
            this.validateResolved();
            return this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g, this.Tenant);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "EndSessionEndpoint", {
        get: function () {
            this.validateResolved();
            return this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g, this.Tenant);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "SelfSignedJwtAudience", {
        get: function () {
            this.validateResolved();
            return this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g, this.Tenant);
        },
        enumerable: true,
        configurable: true
    });
    Authority.prototype.validateResolved = function () {
        if (!this.hasCachedMetadata()) {
            throw "Please call ResolveEndpointsAsync first";
        }
    };
    Object.defineProperty(Authority.prototype, "CanonicalAuthority", {
        /**
         * A URL that is the authority set by the developer
         */
        get: function () {
            return this.canonicalAuthority;
        },
        set: function (url) {
            this.canonicalAuthority = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].CanonicalizeUri(url);
            this.canonicalAuthorityUrlComponents = null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "CanonicalAuthorityUrlComponents", {
        get: function () {
            if (!this.canonicalAuthorityUrlComponents) {
                this.canonicalAuthorityUrlComponents = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].GetUrlComponents(this.CanonicalAuthority);
            }
            return this.canonicalAuthorityUrlComponents;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "DefaultOpenIdConfigurationEndpoint", {
        // http://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata
        get: function () {
            return (this.AuthorityType === AuthorityType.Adfs) ? "" + this.CanonicalAuthority + _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["WELL_KNOWN_SUFFIX"] : this.CanonicalAuthority + "v2.0/" + _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["WELL_KNOWN_SUFFIX"];
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Given a string, validate that it is of the form https://domain/path
     */
    Authority.prototype.validateAsUri = function () {
        var components;
        try {
            components = this.CanonicalAuthorityUrlComponents;
        }
        catch (e) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationErrorMessage"].invalidAuthorityType;
        }
        if (!components.Protocol || components.Protocol.toLowerCase() !== "https:") {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationErrorMessage"].authorityUriInsecure;
        }
        if (!components.PathSegments || components.PathSegments.length < 1) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationErrorMessage"].authorityUriInvalidPath;
        }
    };
    /**
     * Calls the OIDC endpoint and returns the response
     */
    Authority.prototype.DiscoverEndpoints = function (openIdConfigurationEndpoint, telemetryManager, correlationId) {
        var client = new _XHRClient__WEBPACK_IMPORTED_MODULE_2__["XhrClient"]();
        var httpMethod = _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["NetworkRequestType"].GET;
        var httpEvent = telemetryManager.createAndStartHttpEvent(correlationId, httpMethod, openIdConfigurationEndpoint, "openIdConfigurationEndpoint");
        return client.sendRequestAsync(openIdConfigurationEndpoint, httpMethod, /* enableCaching: */ true)
            .then(function (response) {
            httpEvent.httpResponseStatus = response.statusCode;
            telemetryManager.stopEvent(httpEvent);
            return {
                AuthorizationEndpoint: response.body.authorization_endpoint,
                EndSessionEndpoint: response.body.end_session_endpoint,
                Issuer: response.body.issuer
            };
        })
            .catch(function (err) {
            httpEvent.serverErrorCode = err;
            telemetryManager.stopEvent(httpEvent);
            throw err;
        });
    };
    /**
     * Returns a promise.
     * Checks to see if the authority is in the cache
     * Discover endpoints via openid-configuration
     * If successful, caches the endpoint for later use in OIDC
     */
    Authority.prototype.resolveEndpointsAsync = function (telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var host, openIdConfigurationEndpointResponse, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!this.IsValidationEnabled) return [3 /*break*/, 3];
                        host = this.canonicalAuthorityUrlComponents.HostNameAndPort;
                        if (!(_TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__["TrustedAuthority"].getTrustedHostList().length === 0)) return [3 /*break*/, 2];
                        return [4 /*yield*/, _TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__["TrustedAuthority"].setTrustedAuthoritiesFromNetwork(this.canonicalAuthority, telemetryManager, correlationId)];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!_TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__["TrustedAuthority"].IsInTrustedHostList(host)) {
                            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationError"].createUntrustedAuthorityError(host);
                        }
                        _b.label = 3;
                    case 3:
                        openIdConfigurationEndpointResponse = this.GetOpenIdConfigurationEndpoint();
                        _a = this;
                        return [4 /*yield*/, this.DiscoverEndpoints(openIdConfigurationEndpointResponse, telemetryManager, correlationId)];
                    case 4:
                        _a.tenantDiscoveryResponse = _b.sent();
                        return [2 /*return*/, this.tenantDiscoveryResponse];
                }
            });
        });
    };
    /**
     * Checks if there is a cached tenant discovery response with required fields.
     */
    Authority.prototype.hasCachedMetadata = function () {
        return !!(this.tenantDiscoveryResponse &&
            this.tenantDiscoveryResponse.AuthorizationEndpoint &&
            this.tenantDiscoveryResponse.EndSessionEndpoint &&
            this.tenantDiscoveryResponse.Issuer);
    };
    /**
     * Returns a promise which resolves to the OIDC endpoint
     * Only responds with the endpoint
     */
    Authority.prototype.GetOpenIdConfigurationEndpoint = function () {
        return this.DefaultOpenIdConfigurationEndpoint;
    };
    return Authority;
}());

//# sourceMappingURL=Authority.js.map

/***/ }),

/***/ "49sm":
/*!***************************************!*\
  !*** ./node_modules/isarray/index.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};


/***/ }),

/***/ "4GfR":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/content/BatchRequestContent.js ***!
  \**********************************************************************************************************************************/
/*! exports provided: BatchRequestContent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRequestContent", function() { return BatchRequestContent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _RequestMethod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../RequestMethod */ "umkM");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @module BatchRequestContent
 */

/**
 * @class
 * Class for handling BatchRequestContent
 */
class BatchRequestContent {
    /**
     * @public
     * @constructor
     * Constructs a BatchRequestContent instance
     * @param {BatchRequestStep[]} [requests] - Array of requests value
     * @returns An instance of a BatchRequestContent
     */
    constructor(requests) {
        this.requests = new Map();
        if (typeof requests !== "undefined") {
            const limit = BatchRequestContent.requestLimit;
            if (requests.length > limit) {
                const error = new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${limit}`);
                error.name = "Limit Exceeded Error";
                throw error;
            }
            for (const req of requests) {
                this.addRequest(req);
            }
        }
    }
    /**
     * @private
     * @static
     * Validates the dependency chain of the requests
     *
     * Note:
     * Individual requests can depend on other individual requests. Currently, requests can only depend on a single other request, and must follow one of these three patterns:
     * 1. Parallel - no individual request states a dependency in the dependsOn property.
     * 2. Serial - all individual requests depend on the previous individual request.
     * 3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.
     * As JSON batching matures, these limitations will be removed.
     * @see {@link https://developer.microsoft.com/en-us/graph/docs/concepts/known_issues#json-batching}
     *
     * @param {Map<string, BatchRequestStep>} requests - The map of requests.
     * @returns The boolean indicating the validation status
     */
    static validateDependencies(requests) {
        const isParallel = (reqs) => {
            const iterator = reqs.entries();
            let cur = iterator.next();
            while (!cur.done) {
                const curReq = cur.value[1];
                if (curReq.dependsOn !== undefined && curReq.dependsOn.length > 0) {
                    return false;
                }
                cur = iterator.next();
            }
            return true;
        };
        const isSerial = (reqs) => {
            const iterator = reqs.entries();
            let cur = iterator.next();
            const firstRequest = cur.value[1];
            if (firstRequest.dependsOn !== undefined && firstRequest.dependsOn.length > 0) {
                return false;
            }
            let prev = cur;
            cur = iterator.next();
            while (!cur.done) {
                const curReq = cur.value[1];
                if (curReq.dependsOn === undefined || curReq.dependsOn.length !== 1 || curReq.dependsOn[0] !== prev.value[1].id) {
                    return false;
                }
                prev = cur;
                cur = iterator.next();
            }
            return true;
        };
        const isSame = (reqs) => {
            const iterator = reqs.entries();
            let cur = iterator.next();
            const firstRequest = cur.value[1];
            let dependencyId;
            if (firstRequest.dependsOn === undefined || firstRequest.dependsOn.length === 0) {
                dependencyId = firstRequest.id;
            }
            else {
                if (firstRequest.dependsOn.length === 1) {
                    const fDependencyId = firstRequest.dependsOn[0];
                    if (fDependencyId !== firstRequest.id && reqs.has(fDependencyId)) {
                        dependencyId = fDependencyId;
                    }
                    else {
                        return false;
                    }
                }
                else {
                    return false;
                }
            }
            cur = iterator.next();
            while (!cur.done) {
                const curReq = cur.value[1];
                if ((curReq.dependsOn === undefined || curReq.dependsOn.length === 0) && dependencyId !== curReq.id) {
                    return false;
                }
                if (curReq.dependsOn !== undefined && curReq.dependsOn.length !== 0) {
                    if (curReq.dependsOn.length === 1 && (curReq.id === dependencyId || curReq.dependsOn[0] !== dependencyId)) {
                        return false;
                    }
                    if (curReq.dependsOn.length > 1) {
                        return false;
                    }
                }
                cur = iterator.next();
            }
            return true;
        };
        if (requests.size === 0) {
            const error = new Error("Empty requests map, Please provide at least one request.");
            error.name = "Empty Requests Error";
            throw error;
        }
        return isParallel(requests) || isSerial(requests) || isSame(requests);
    }
    /**
     * @private
     * @static
     * @async
     * Converts Request Object instance to a JSON
     * @param {IsomorphicRequest} request - The IsomorphicRequest Object instance
     * @returns A promise that resolves to JSON representation of a request
     */
    static getRequestData(request) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const requestData = {
                url: "",
            };
            const hasHttpRegex = new RegExp("^https?://");
            // Stripping off hostname, port and url scheme
            requestData.url = hasHttpRegex.test(request.url) ? "/" + request.url.split(/.*?\/\/.*?\//)[1] : request.url;
            requestData.method = request.method;
            const headers = {};
            request.headers.forEach((value, key) => {
                headers[key] = value;
            });
            if (Object.keys(headers).length) {
                requestData.headers = headers;
            }
            if (request.method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].PATCH || request.method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].POST || request.method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].PUT) {
                requestData.body = yield BatchRequestContent.getRequestBody(request);
            }
            /**
             * TODO: Check any other property needs to be used from the Request object and add them
             */
            return requestData;
        });
    }
    /**
     * @private
     * @static
     * @async
     * Gets the body of a Request object instance
     * @param {IsomorphicRequest} request - The IsomorphicRequest object instance
     * @returns The Promise that resolves to a body value of a Request
     */
    static getRequestBody(request) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            let bodyParsed = false;
            let body;
            try {
                const cloneReq = request.clone();
                body = yield cloneReq.json();
                bodyParsed = true;
            }
            catch (e) {
                // tslint:disable-line: no-empty
            }
            if (!bodyParsed) {
                try {
                    if (typeof Blob !== "undefined") {
                        const blob = yield request.blob();
                        const reader = new FileReader();
                        body = yield new Promise((resolve) => {
                            reader.addEventListener("load", () => {
                                const dataURL = reader.result;
                                /**
                                 * Some valid dataURL schemes:
                                 *  1. data:text/vnd-example+xyz;foo=bar;base64,R0lGODdh
                                 *  2. data:text/plain;charset=UTF-8;page=21,the%20data:1234,5678
                                 *  3. data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==
                                 *  4. data:image/png,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==
                                 *  5. data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==
                                 * @see Syntax {@link https://en.wikipedia.org/wiki/Data_URI_scheme} for more
                                 */
                                const regex = new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$");
                                const segments = regex.exec(dataURL);
                                resolve(segments[4]);
                            }, false);
                            reader.readAsDataURL(blob);
                        });
                    }
                    else if (typeof Buffer !== "undefined") {
                        const buffer = yield request.buffer();
                        body = buffer.toString("base64");
                    }
                    bodyParsed = true;
                }
                catch (e) {
                    // tslint:disable-line: no-empty
                }
            }
            return body;
        });
    }
    /**
     * @public
     * Adds a request to the batch request content
     * @param {BatchRequestStep} request - The request value
     * @returns The id of the added request
     */
    addRequest(request) {
        const limit = BatchRequestContent.requestLimit;
        if (request.id === "") {
            const error = new Error(`Id for a request is empty, Please provide an unique id`);
            error.name = "Empty Id For Request";
            throw error;
        }
        if (this.requests.size === limit) {
            const error = new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${limit}`);
            error.name = "Limit Exceeded Error";
            throw error;
        }
        if (this.requests.has(request.id)) {
            const error = new Error(`Adding request with duplicate id ${request.id}, Make the id of the requests unique`);
            error.name = "Duplicate RequestId Error";
            throw error;
        }
        this.requests.set(request.id, request);
        return request.id;
    }
    /**
     * @public
     * Removes request from the batch payload and its dependencies from all dependents
     * @param {string} requestId - The id of a request that needs to be removed
     * @returns The boolean indicating removed status
     */
    removeRequest(requestId) {
        const deleteStatus = this.requests.delete(requestId);
        const iterator = this.requests.entries();
        let cur = iterator.next();
        /**
         * Removing dependencies where this request is present as a dependency
         */
        while (!cur.done) {
            const dependencies = cur.value[1].dependsOn;
            if (typeof dependencies !== "undefined") {
                const index = dependencies.indexOf(requestId);
                if (index !== -1) {
                    dependencies.splice(index, 1);
                }
                if (dependencies.length === 0) {
                    delete cur.value[1].dependsOn;
                }
            }
            cur = iterator.next();
        }
        return deleteStatus;
    }
    /**
     * @public
     * @async
     * Serialize content from BatchRequestContent instance
     * @returns The body content to make batch request
     */
    getContent() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const requests = [];
            const requestBody = {
                requests,
            };
            const iterator = this.requests.entries();
            let cur = iterator.next();
            if (cur.done) {
                const error = new Error("No requests added yet, Please add at least one request.");
                error.name = "Empty Payload";
                throw error;
            }
            if (!BatchRequestContent.validateDependencies(this.requests)) {
                const error = new Error(`Invalid dependency found, Dependency should be:
1. Parallel - no individual request states a dependency in the dependsOn property.
2. Serial - all individual requests depend on the previous individual request.
3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.`);
                error.name = "Invalid Dependency";
                throw error;
            }
            while (!cur.done) {
                const requestStep = cur.value[1];
                const batchRequestData = (yield BatchRequestContent.getRequestData(requestStep.request));
                /**
                 * @see {@link https://developer.microsoft.com/en-us/graph/docs/concepts/json_batching#request-format}
                 */
                if (batchRequestData.body !== undefined && (batchRequestData.headers === undefined || batchRequestData.headers["content-type"] === undefined)) {
                    const error = new Error(`Content-type header is not mentioned for request #${requestStep.id}, For request having body, Content-type header should be mentioned`);
                    error.name = "Invalid Content-type header";
                    throw error;
                }
                batchRequestData.id = requestStep.id;
                if (requestStep.dependsOn !== undefined && requestStep.dependsOn.length > 0) {
                    batchRequestData.dependsOn = requestStep.dependsOn;
                }
                requests.push(batchRequestData);
                cur = iterator.next();
            }
            requestBody.requests = requests;
            return requestBody;
        });
    }
    /**
     * @public
     * Adds a dependency for a given dependent request
     * @param {string} dependentId - The id of the dependent request
     * @param {string} [dependencyId] - The id of the dependency request, if not specified the preceding request will be considered as a dependency
     * @returns Nothing
     */
    addDependency(dependentId, dependencyId) {
        if (!this.requests.has(dependentId)) {
            const error = new Error(`Dependent ${dependentId} does not exists, Please check the id`);
            error.name = "Invalid Dependent";
            throw error;
        }
        if (typeof dependencyId !== "undefined" && !this.requests.has(dependencyId)) {
            const error = new Error(`Dependency ${dependencyId} does not exists, Please check the id`);
            error.name = "Invalid Dependency";
            throw error;
        }
        if (typeof dependencyId !== "undefined") {
            const dependent = this.requests.get(dependentId);
            if (dependent.dependsOn === undefined) {
                dependent.dependsOn = [];
            }
            if (dependent.dependsOn.indexOf(dependencyId) !== -1) {
                const error = new Error(`Dependency ${dependencyId} is already added for the request ${dependentId}`);
                error.name = "Duplicate Dependency";
                throw error;
            }
            dependent.dependsOn.push(dependencyId);
        }
        else {
            const iterator = this.requests.entries();
            let prev;
            let cur = iterator.next();
            while (!cur.done && cur.value[1].id !== dependentId) {
                prev = cur;
                cur = iterator.next();
            }
            if (typeof prev !== "undefined") {
                const dId = prev.value[0];
                if (cur.value[1].dependsOn === undefined) {
                    cur.value[1].dependsOn = [];
                }
                if (cur.value[1].dependsOn.indexOf(dId) !== -1) {
                    const error = new Error(`Dependency ${dId} is already added for the request ${dependentId}`);
                    error.name = "Duplicate Dependency";
                    throw error;
                }
                cur.value[1].dependsOn.push(dId);
            }
            else {
                const error = new Error(`Can't add dependency ${dependencyId}, There is only a dependent request in the batch`);
                error.name = "Invalid Dependency Addition";
                throw error;
            }
        }
    }
    /**
     * @public
     * Removes a dependency for a given dependent request id
     * @param {string} dependentId - The id of the dependent request
     * @param {string} [dependencyId] - The id of the dependency request, if not specified will remove all the dependencies of that request
     * @returns The boolean indicating removed status
     */
    removeDependency(dependentId, dependencyId) {
        const request = this.requests.get(dependentId);
        if (typeof request === "undefined" || request.dependsOn === undefined || request.dependsOn.length === 0) {
            return false;
        }
        if (typeof dependencyId !== "undefined") {
            const index = request.dependsOn.indexOf(dependencyId);
            if (index === -1) {
                return false;
            }
            request.dependsOn.splice(index, 1);
            return true;
        }
        else {
            delete request.dependsOn;
            return true;
        }
    }
}
/**
 * @private
 * @static
 * Limit for number of requests {@link - https://developer.microsoft.com/en-us/graph/docs/concepts/known_issues#json-batching}
 */
BatchRequestContent.requestLimit = 20;
//# sourceMappingURL=BatchRequestContent.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../../../../buffer/index.js */ "tjlA").Buffer))

/***/ }),

/***/ "4J3T":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/sub-components/mgt-dot-options/mgt-dot-options.js ***!
  \**********************************************************************************************************************/
/*! exports provided: MgtDotOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtDotOptions", function() { return MgtDotOptions; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _mgt_dot_options_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mgt-dot-options-css */ "rrN1");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




/**
 * Custom Component used to handle an arrow rendering for TaskGroups utilized in the task component.
 *
 * @export MgtDotOptions
 * @class MgtDotOptions
 * @extends {MgtBaseComponent}
 */
let MgtDotOptions = class MgtDotOptions extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["MgtBaseComponent"] {
    constructor() {
        super();
        this._clickHandler = null;
        this._clickHandler = (e) => (this.open = false);
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * user the `css` tag function.
     */
    static get styles() {
        return _mgt_dot_options_css__WEBPACK_IMPORTED_MODULE_3__["styles"];
    }
    // tslint:disable-next-line: completed-docs
    connectedCallback() {
        super.connectedCallback();
        window.addEventListener('click', this._clickHandler);
    }
    // tslint:disable-next-line: completed-docs
    disconnectedCallback() {
        window.removeEventListener('click', this._clickHandler);
        super.disconnectedCallback();
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({ DotMenu: true, Open: this.open })} @click=${e => this.onDotClick(e)}>
        <span class="DotIcon">\uE712</span>
        <div class="Menu">
          ${Object.keys(this.options).map(prop => this.getMenuOption(prop, this.options[prop]))}
        </div>
      </div>
    `;
    }
    /**
     * Used by the render method to attach click handler to each dot item
     *
     * @param {string} name
     * @param {((e: MouseEvent) => void | any)} click
     * @returns
     * @memberof MgtDotOptions
     */
    getMenuOption(name, click) {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div
        class="DotItem"
        @click="${e => {
            e.preventDefault();
            e.stopPropagation();
            click(e);
            this.open = false;
        }}"
      >
        <span class="DotItemName">
          ${name}
        </span>
      </div>
    `;
    }
    onDotClick(e) {
        e.preventDefault();
        e.stopPropagation();
        this.open = !this.open;
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ type: Boolean }),
    __metadata("design:type", Boolean)
], MgtDotOptions.prototype, "open", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ type: Object }),
    __metadata("design:type", Object)
], MgtDotOptions.prototype, "options", void 0);
MgtDotOptions = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-dot-options'),
    __metadata("design:paramtypes", [])
], MgtDotOptions);

//# sourceMappingURL=mgt-dot-options.js.map

/***/ }),

/***/ "4N0K":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/cache/AccessTokenKey.js ***!
  \***********************************************************************************************/
/*! exports provided: AccessTokenKey */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccessTokenKey", function() { return AccessTokenKey; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/CryptoUtils */ "qD3l");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/UrlUtils */ "8P3k");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * @hidden
 */
var AccessTokenKey = /** @class */ (function () {
    function AccessTokenKey(authority, clientId, scopes, uid, utid) {
        this.authority = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].CanonicalizeUri(authority);
        this.clientId = clientId;
        this.scopes = scopes;
        this.homeAccountIdentifier = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(uid) + "." + _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(utid);
    }
    return AccessTokenKey;
}());

//# sourceMappingURL=AccessTokenKey.js.map

/***/ }),

/***/ "4hjE":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/ResponseUtils.js ***!
  \**********************************************************************************************/
/*! exports provided: ResponseUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResponseUtils", function() { return ResponseUtils; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Constants */ "vFME");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var ResponseUtils = /** @class */ (function () {
    function ResponseUtils() {
    }
    ResponseUtils.setResponseIdToken = function (originalResponse, idTokenObj) {
        if (!originalResponse) {
            return null;
        }
        else if (!idTokenObj) {
            return originalResponse;
        }
        var exp = Number(idTokenObj.expiration);
        if (exp && !originalResponse.expiresOn) {
            originalResponse.expiresOn = new Date(exp * 1000);
        }
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, originalResponse, { idToken: idTokenObj, idTokenClaims: idTokenObj.claims, uniqueId: idTokenObj.objectId || idTokenObj.subject, tenantId: idTokenObj.tenantId });
    };
    ResponseUtils.buildAuthResponse = function (idToken, authResponse, serverAuthenticationRequest, account, scopes, accountState) {
        switch (serverAuthenticationRequest.responseType) {
            case _Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token:
                authResponse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, authResponse, { tokenType: _Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ID_TOKEN, account: account, scopes: scopes, accountState: accountState });
                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);
                return (authResponse.idToken) ? authResponse : null;
            case _Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token_token:
                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);
                return (authResponse && authResponse.accessToken && authResponse.idToken) ? authResponse : null;
            case _Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].token:
                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);
                return authResponse;
            default:
                return null;
        }
    };
    return ResponseUtils;
}());

//# sourceMappingURL=ResponseUtils.js.map

/***/ }),

/***/ "4q16":
/*!**********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/providers/SimpleProvider.js ***!
  \**********************************************************************************/
/*! exports provided: SimpleProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SimpleProvider", function() { return SimpleProvider; });
/* harmony import */ var _Graph__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Graph */ "WOkV");
/* harmony import */ var _IProvider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./IProvider */ "DmZw");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


/**
 * Facilitates create of new custom provider
 *
 * @export
 * @class SimpleProvider
 * @extends {IProvider}
 */
class SimpleProvider extends _IProvider__WEBPACK_IMPORTED_MODULE_1__["IProvider"] {
    constructor(getAccessTokenHandler, loginHandler, logoutHandler) {
        super();
        this._getAccessTokenHandler = getAccessTokenHandler;
        this._loginHandler = loginHandler;
        this._logoutHandler = logoutHandler;
        this.graph = Object(_Graph__WEBPACK_IMPORTED_MODULE_0__["createFromProvider"])(this);
    }
    /**
     * Invokes the getAccessToken function
     *
     * @param {AuthenticationProviderOptions} [options]
     * @returns {Promise<string>}
     * @memberof SimpleProvider
     */
    getAccessToken(options) {
        return this._getAccessTokenHandler(options.scopes);
    }
    /**
     * Invokes login function
     *
     * @returns {Promise<void>}
     * @memberof SimpleProvider
     */
    login() {
        return this._loginHandler();
    }
    /**
     * Invokes logout function
     *
     * @returns {Promise<void>}
     * @memberof SimpleProvider
     */
    logout() {
        return this._logoutHandler();
    }
}
//# sourceMappingURL=SimpleProvider.js.map

/***/ }),

/***/ "4qoK":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-login/mgt-login-css.js ***!
  \***********************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}:host,mgt-login{--font-size:14px;--font-weight:600;--width:'100%';--height:'100%';--margin:0;--padding:12px 20px;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--button-color,#323130);background-color:var(--button-background-color,transparent);border:none;cursor:pointer;transition:color .3s,background-color .3s}:host .login-button mgt-person,mgt-login .login-button mgt-person{--color-sub1:set-var(button__color, $theme-default, $login)}:host .login-button:hover,mgt-login .login-button:hover{color:var(--button-color--hover,#0078d4);--color:var(--button-color--hover, #0078d4);background-color:var(--button-background-color--hover,var(--background-color--hover,#edebe9));--color-sub1:var(--button-color--hover, #0078d4)}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-button.no-click,mgt-login .login-button.no-click{pointer-events:none}:host .login-icon+span,mgt-login .login-icon+span{margin-left:6px}:host .popup,mgt-login .popup{font-family:var(--default-font-family);background-color:var(--popup-background-color,var(--background-color-sub1,#faf9f8));min-width:240px;z-index:1;color:var(--popup-color,#323130)}:host .popup mgt-person,mgt-login .popup mgt-person{--color-sub1:set-var(popup__color, $theme-default, $login)}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding)}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:#0078d4;background-color:var(--popup-background-color,var(--background-color-sub1,#faf9f8));border:none;padding:0;cursor:pointer;transition:color .3s}:host .popup-command:hover,mgt-login .popup-command:hover{color:#005a9e}[dir=rtl]{--popup-padding:24px 24px 16px 48px}[dir=rtl] mgt-person .details{--details-spacing:0px 12px 0px 0px}[dir=rtl] mgt-person .details.small{--details-spacing:0px 6px 0px 0px}
`
];
//# sourceMappingURL=mgt-login-css.js.map

/***/ }),

/***/ "4qtV":
/*!*******************************************************!*\
  !*** ./node_modules/lit-html/directives/class-map.js ***!
  \*******************************************************/
/*! exports provided: classMap */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "classMap", function() { return classMap; });
/* harmony import */ var _lit_html_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lit-html.js */ "AaG5");
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */

// IE11 doesn't support classList on SVG elements, so we emulate it with a Set
class ClassList {
    constructor(element) {
        this.classes = new Set();
        this.changed = false;
        this.element = element;
        const classList = (element.getAttribute('class') || '').split(/\s+/);
        for (const cls of classList) {
            this.classes.add(cls);
        }
    }
    add(cls) {
        this.classes.add(cls);
        this.changed = true;
    }
    remove(cls) {
        this.classes.delete(cls);
        this.changed = true;
    }
    commit() {
        if (this.changed) {
            let classString = '';
            this.classes.forEach((cls) => classString += cls + ' ');
            this.element.setAttribute('class', classString);
        }
    }
}
/**
 * Stores the ClassInfo object applied to a given AttributePart.
 * Used to unset existing values when a new ClassInfo object is applied.
 */
const previousClassesCache = new WeakMap();
/**
 * A directive that applies CSS classes. This must be used in the `class`
 * attribute and must be the only part used in the attribute. It takes each
 * property in the `classInfo` argument and adds the property name to the
 * element's `class` if the property value is truthy; if the property value is
 * falsey, the property name is removed from the element's `class`. For example
 * `{foo: bar}` applies the class `foo` if the value of `bar` is truthy.
 * @param classInfo {ClassInfo}
 */
const classMap = Object(_lit_html_js__WEBPACK_IMPORTED_MODULE_0__["directive"])((classInfo) => (part) => {
    if (!(part instanceof _lit_html_js__WEBPACK_IMPORTED_MODULE_0__["AttributePart"]) || (part instanceof _lit_html_js__WEBPACK_IMPORTED_MODULE_0__["PropertyPart"]) ||
        part.committer.name !== 'class' || part.committer.parts.length > 1) {
        throw new Error('The `classMap` directive must be used in the `class` attribute ' +
            'and must be the only part in the attribute.');
    }
    const { committer } = part;
    const { element } = committer;
    let previousClasses = previousClassesCache.get(part);
    if (previousClasses === undefined) {
        // Write static classes once
        // Use setAttribute() because className isn't a string on SVG elements
        element.setAttribute('class', committer.strings.join(' '));
        previousClassesCache.set(part, previousClasses = new Set());
    }
    const classList = (element.classList || new ClassList(element));
    // Remove old classes that no longer apply
    // We use forEach() instead of for-of so that re don't require down-level
    // iteration.
    previousClasses.forEach((name) => {
        if (!(name in classInfo)) {
            classList.remove(name);
            previousClasses.delete(name);
        }
    });
    // Add or remove classes based on their classMap value
    for (const name in classInfo) {
        const value = classInfo[name];
        if (value != previousClasses.has(name)) {
            // We explicitly want a loose truthy check of `value` because it seems
            // more convenient that '' and 0 are skipped.
            if (value) {
                classList.add(name);
                previousClasses.add(name);
            }
            else {
                classList.remove(name);
                previousClasses.delete(name);
            }
        }
    }
    if (typeof classList.commit === 'function') {
        classList.commit();
    }
});
//# sourceMappingURL=class-map.js.map

/***/ }),

/***/ "4yuk":
/*!***********************************************!*\
  !*** ./node_modules/lit-html/lib/template.js ***!
  \***********************************************/
/*! exports provided: marker, nodeMarker, markerRegex, boundAttributeSuffix, Template, isTemplatePartActive, createMarker, lastAttributeNameRegex */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "marker", function() { return marker; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nodeMarker", function() { return nodeMarker; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "markerRegex", function() { return markerRegex; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "boundAttributeSuffix", function() { return boundAttributeSuffix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Template", function() { return Template; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isTemplatePartActive", function() { return isTemplatePartActive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createMarker", function() { return createMarker; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "lastAttributeNameRegex", function() { return lastAttributeNameRegex; });
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * An expression marker with embedded unique key to avoid collision with
 * possible text in templates.
 */
const marker = `{{lit-${String(Math.random()).slice(2)}}}`;
/**
 * An expression marker used text-positions, multi-binding attributes, and
 * attributes with markup-like text values.
 */
const nodeMarker = `<!--${marker}-->`;
const markerRegex = new RegExp(`${marker}|${nodeMarker}`);
/**
 * Suffix appended to all bound attribute names.
 */
const boundAttributeSuffix = '$lit$';
/**
 * An updatable Template that tracks the location of dynamic parts.
 */
class Template {
    constructor(result, element) {
        this.parts = [];
        this.element = element;
        const nodesToRemove = [];
        const stack = [];
        // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be null
        const walker = document.createTreeWalker(element.content, 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */, null, false);
        // Keeps track of the last index associated with a part. We try to delete
        // unnecessary nodes, but we never want to associate two different parts
        // to the same index. They must have a constant node between.
        let lastPartIndex = 0;
        let index = -1;
        let partIndex = 0;
        const { strings, values: { length } } = result;
        while (partIndex < length) {
            const node = walker.nextNode();
            if (node === null) {
                // We've exhausted the content inside a nested template element.
                // Because we still have parts (the outer for-loop), we know:
                // - There is a template in the stack
                // - The walker will find a nextNode outside the template
                walker.currentNode = stack.pop();
                continue;
            }
            index++;
            if (node.nodeType === 1 /* Node.ELEMENT_NODE */) {
                if (node.hasAttributes()) {
                    const attributes = node.attributes;
                    const { length } = attributes;
                    // Per
                    // https://developer.mozilla.org/en-US/docs/Web/API/NamedNodeMap,
                    // attributes are not guaranteed to be returned in document order.
                    // In particular, Edge/IE can return them out of order, so we cannot
                    // assume a correspondence between part index and attribute index.
                    let count = 0;
                    for (let i = 0; i < length; i++) {
                        if (endsWith(attributes[i].name, boundAttributeSuffix)) {
                            count++;
                        }
                    }
                    while (count-- > 0) {
                        // Get the template literal section leading up to the first
                        // expression in this attribute
                        const stringForPart = strings[partIndex];
                        // Find the attribute name
                        const name = lastAttributeNameRegex.exec(stringForPart)[2];
                        // Find the corresponding attribute
                        // All bound attributes have had a suffix added in
                        // TemplateResult#getHTML to opt out of special attribute
                        // handling. To look up the attribute value we also need to add
                        // the suffix.
                        const attributeLookupName = name.toLowerCase() + boundAttributeSuffix;
                        const attributeValue = node.getAttribute(attributeLookupName);
                        node.removeAttribute(attributeLookupName);
                        const statics = attributeValue.split(markerRegex);
                        this.parts.push({ type: 'attribute', index, name, strings: statics });
                        partIndex += statics.length - 1;
                    }
                }
                if (node.tagName === 'TEMPLATE') {
                    stack.push(node);
                    walker.currentNode = node.content;
                }
            }
            else if (node.nodeType === 3 /* Node.TEXT_NODE */) {
                const data = node.data;
                if (data.indexOf(marker) >= 0) {
                    const parent = node.parentNode;
                    const strings = data.split(markerRegex);
                    const lastIndex = strings.length - 1;
                    // Generate a new text node for each literal section
                    // These nodes are also used as the markers for node parts
                    for (let i = 0; i < lastIndex; i++) {
                        let insert;
                        let s = strings[i];
                        if (s === '') {
                            insert = createMarker();
                        }
                        else {
                            const match = lastAttributeNameRegex.exec(s);
                            if (match !== null && endsWith(match[2], boundAttributeSuffix)) {
                                s = s.slice(0, match.index) + match[1] +
                                    match[2].slice(0, -boundAttributeSuffix.length) + match[3];
                            }
                            insert = document.createTextNode(s);
                        }
                        parent.insertBefore(insert, node);
                        this.parts.push({ type: 'node', index: ++index });
                    }
                    // If there's no text, we must insert a comment to mark our place.
                    // Else, we can trust it will stick around after cloning.
                    if (strings[lastIndex] === '') {
                        parent.insertBefore(createMarker(), node);
                        nodesToRemove.push(node);
                    }
                    else {
                        node.data = strings[lastIndex];
                    }
                    // We have a part for each match found
                    partIndex += lastIndex;
                }
            }
            else if (node.nodeType === 8 /* Node.COMMENT_NODE */) {
                if (node.data === marker) {
                    const parent = node.parentNode;
                    // Add a new marker node to be the startNode of the Part if any of
                    // the following are true:
                    //  * We don't have a previousSibling
                    //  * The previousSibling is already the start of a previous part
                    if (node.previousSibling === null || index === lastPartIndex) {
                        index++;
                        parent.insertBefore(createMarker(), node);
                    }
                    lastPartIndex = index;
                    this.parts.push({ type: 'node', index });
                    // If we don't have a nextSibling, keep this node so we have an end.
                    // Else, we can remove it to save future costs.
                    if (node.nextSibling === null) {
                        node.data = '';
                    }
                    else {
                        nodesToRemove.push(node);
                        index--;
                    }
                    partIndex++;
                }
                else {
                    let i = -1;
                    while ((i = node.data.indexOf(marker, i + 1)) !== -1) {
                        // Comment node has a binding marker inside, make an inactive part
                        // The binding won't work, but subsequent bindings will
                        // TODO (justinfagnani): consider whether it's even worth it to
                        // make bindings in comments work
                        this.parts.push({ type: 'node', index: -1 });
                        partIndex++;
                    }
                }
            }
        }
        // Remove text binding nodes after the walk to not disturb the TreeWalker
        for (const n of nodesToRemove) {
            n.parentNode.removeChild(n);
        }
    }
}
const endsWith = (str, suffix) => {
    const index = str.length - suffix.length;
    return index >= 0 && str.slice(index) === suffix;
};
const isTemplatePartActive = (part) => part.index !== -1;
// Allows `document.createComment('')` to be renamed for a
// small manual size-savings.
const createMarker = () => document.createComment('');
/**
 * This regex extracts the attribute name preceding an attribute-position
 * expression. It does this by matching the syntax allowed for attributes
 * against the string literal directly preceding the expression, assuming that
 * the expression is in an attribute-value position.
 *
 * See attributes in the HTML spec:
 * https://www.w3.org/TR/html5/syntax.html#elements-attributes
 *
 * " \x09\x0a\x0c\x0d" are HTML space characters:
 * https://www.w3.org/TR/html5/infrastructure.html#space-characters
 *
 * "\0-\x1F\x7F-\x9F" are Unicode control characters, which includes every
 * space character except " ".
 *
 * So an attribute is:
 *  * The name: any character except a control character, space character, ('),
 *    ("), ">", "=", or "/"
 *  * Followed by zero or more space characters
 *  * Followed by "="
 *  * Followed by zero or more space characters
 *  * Followed by:
 *    * Any character except space, ('), ("), "<", ">", "=", (`), or
 *    * (") then any non-("), or
 *    * (') then any non-(')
 */
const lastAttributeNameRegex = 
// eslint-disable-next-line no-control-regex
/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;
//# sourceMappingURL=template.js.map

/***/ }),

/***/ "53Y/":
/*!********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/error/ServerError.js ***!
  \********************************************************************************************/
/*! exports provided: ServerErrorMessage, ServerError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerErrorMessage", function() { return ServerErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerError", function() { return ServerError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuthError */ "a+UN");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var ServerErrorMessage = {
    serverUnavailable: {
        code: "server_unavailable",
        desc: "Server is temporarily unavailable."
    },
    unknownServerError: {
        code: "unknown_server_error"
    },
};
/**
 * Error thrown when there is an error with the server code, for example, unavailability.
 */
var ServerError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ServerError, _super);
    function ServerError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ServerError";
        Object.setPrototypeOf(_this, ServerError.prototype);
        return _this;
    }
    ServerError.createServerUnavailableError = function () {
        return new ServerError(ServerErrorMessage.serverUnavailable.code, ServerErrorMessage.serverUnavailable.desc);
    };
    ServerError.createUnknownServerError = function (errorDesc) {
        return new ServerError(ServerErrorMessage.unknownServerError.code, errorDesc);
    };
    return ServerError;
}(_AuthError__WEBPACK_IMPORTED_MODULE_1__["AuthError"]));

//# sourceMappingURL=ServerError.js.map

/***/ }),

/***/ "55I0":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/AuthResponse.js ***!
  \**************************************************************************************************/
/*! exports provided: buildResponseStateOnly */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "buildResponseStateOnly", function() { return buildResponseStateOnly; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
function buildResponseStateOnly(state) {
    return {
        uniqueId: "",
        tenantId: "",
        tokenType: "",
        idToken: null,
        idTokenClaims: null,
        accessToken: "",
        scopes: null,
        expiresOn: null,
        account: null,
        accountState: state,
        fromCache: false
    };
}
//# sourceMappingURL=AuthResponse.js.map

/***/ }),

/***/ "68J5":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/tasks/OneDriveLargeFileUploadTask.js ***!
  \****************************************************************************************************/
/*! exports provided: OneDriveLargeFileUploadTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OneDriveLargeFileUploadTask", function() { return OneDriveLargeFileUploadTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _LargeFileUploadTask__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./LargeFileUploadTask */ "P6yO");
/* harmony import */ var _OneDriveLargeFileUploadTaskUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OneDriveLargeFileUploadTaskUtil */ "/1+S");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */



/**
 * @class
 * Class representing OneDriveLargeFileUploadTask
 */
class OneDriveLargeFileUploadTask extends _LargeFileUploadTask__WEBPACK_IMPORTED_MODULE_1__["LargeFileUploadTask"] {
    /**
     * @public
     * @constructor
     * Constructs a OneDriveLargeFileUploadTask
     * @param {Client} client - The GraphClient instance
     * @param {FileObject} file - The FileObject holding details of a file that needs to be uploaded
     * @param {LargeFileUploadSession} uploadSession - The upload session to which the upload has to be done
     * @param {LargeFileUploadTaskOptions} options - The upload task options
     * @returns An instance of OneDriveLargeFileUploadTask
     */
    constructor(client, file, uploadSession, options) {
        super(client, file, uploadSession, options);
    }
    /**
     * @private
     * @static
     * Constructs the create session url for Onedrive
     * @param {string} fileName - The name of the file
     * @param {path} [path = OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH] - The path for the upload
     * @returns The constructed create session url
     */
    static constructCreateSessionUrl(fileName, path = OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH) {
        fileName = fileName.trim();
        path = path.trim();
        if (path === "") {
            path = "/";
        }
        if (path[0] !== "/") {
            path = `/${path}`;
        }
        if (path[path.length - 1] !== "/") {
            path = `${path}/`;
        }
        // we choose to encode each component of the file path separately because when encoding full URI
        // with encodeURI, special characters like # or % in the file name doesn't get encoded as desired
        return `/me/drive/root:${path
            .split("/")
            .map((p) => encodeURIComponent(p))
            .join("/")}${encodeURIComponent(fileName)}:/createUploadSession`;
    }
    /**
     * @public
     * @static
     * @async
     * Creates a OneDriveLargeFileUploadTask
     * @param {Client} client - The GraphClient instance
     * @param {Blob | Buffer | File} file - File represented as Blob, Buffer or File
     * @param {OneDriveLargeFileUploadOptions} options - The options for upload task
     * @returns The promise that will be resolves to OneDriveLargeFileUploadTask instance
     */
    static create(client, file, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const name = options.fileName;
            let content;
            let size;
            if (typeof Blob !== "undefined" && file instanceof Blob) {
                content = new File([file], name);
                size = content.size;
            }
            else if (typeof File !== "undefined" && file instanceof File) {
                content = file;
                size = content.size;
            }
            else if (typeof Buffer !== "undefined" && file instanceof Buffer) {
                const b = file;
                size = b.byteLength - b.byteOffset;
                content = b.buffer.slice(b.byteOffset, b.byteOffset + b.byteLength);
            }
            try {
                const requestUrl = OneDriveLargeFileUploadTask.constructCreateSessionUrl(options.fileName, options.path);
                const session = yield OneDriveLargeFileUploadTask.createUploadSession(client, requestUrl, options.fileName);
                const rangeSize = Object(_OneDriveLargeFileUploadTaskUtil__WEBPACK_IMPORTED_MODULE_2__["getValidRangeSize"])(options.rangeSize);
                const fileObj = {
                    name,
                    content,
                    size,
                };
                return new OneDriveLargeFileUploadTask(client, fileObj, session, {
                    rangeSize,
                });
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @static
     * @async
     * Makes request to the server to create an upload session
     * @param {Client} client - The GraphClient instance
     * @param {string} requestUrl - The URL to create the upload session
     * @param {string} fileName - The name of a file to upload, (with extension)
     * @returns The promise that resolves to LargeFileUploadSession
     */
    static createUploadSession(client, requestUrl, fileName) {
        const _super = Object.create(null, {
            createUploadSession: { get: () => super.createUploadSession }
        });
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const payload = {
                item: {
                    "@microsoft.graph.conflictBehavior": "rename",
                    name: fileName,
                },
            };
            try {
                return _super.createUploadSession.call(this, client, requestUrl, payload);
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * Commits upload session to end uploading
     * @param {string} requestUrl - The URL to commit the upload session
     * @returns The promise resolves to committed response
     */
    commit(requestUrl) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const payload = {
                    name: this.file.name,
                    "@microsoft.graph.conflictBehavior": "rename",
                    "@microsoft.graph.sourceUrl": this.uploadSession.url,
                };
                return yield this.client.api(requestUrl).put(payload);
            }
            catch (err) {
                throw err;
            }
        });
    }
}
/**
 * @private
 * @static
 * Default path for the file being uploaded
 */
OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH = "/";
//# sourceMappingURL=OneDriveLargeFileUploadTask.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../buffer/index.js */ "tjlA").Buffer))

/***/ }),

/***/ "6ISa":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/content/BatchResponseContent.js ***!
  \***********************************************************************************************************************************/
/*! exports provided: BatchResponseContent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchResponseContent", function() { return BatchResponseContent; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * Class that handles BatchResponseContent
 */
class BatchResponseContent {
    /**
     * @public
     * @constructor
     * Creates the BatchResponseContent instance
     * @param {BatchResponseBody} response - The response body returned for batch request from server
     * @returns An instance of a BatchResponseContent
     */
    constructor(response) {
        this.responses = new Map();
        this.update(response);
    }
    /**
     * @private
     * Creates native Response object from the json representation of it.
     * @param {KeyValuePairObject} responseJSON - The response json value
     * @returns The Response Object instance
     */
    createResponseObject(responseJSON) {
        const body = responseJSON.body;
        const options = {};
        options.status = responseJSON.status;
        if (responseJSON.statusText !== undefined) {
            options.statusText = responseJSON.statusText;
        }
        options.headers = responseJSON.headers;
        if (options.headers !== undefined && options.headers["Content-Type"] !== undefined) {
            if (options.headers["Content-Type"].split(";")[0] === "application/json") {
                const bodyString = JSON.stringify(body);
                return new Response(bodyString, options);
            }
        }
        return new Response(body, options);
    }
    /**
     * @public
     * Updates the Batch response content instance with given responses.
     * @param {BatchResponseBody} response - The response json representing batch response message
     * @returns Nothing
     */
    update(response) {
        this.nextLink = response["@odata.nextLink"];
        const responses = response.responses;
        for (let i = 0, l = responses.length; i < l; i++) {
            this.responses.set(responses[i].id, this.createResponseObject(responses[i]));
        }
    }
    /**
     * @public
     * To get the response of a request for a given request id
     * @param {string} requestId - The request id value
     * @returns The Response object instance for the particular request
     */
    getResponseById(requestId) {
        return this.responses.get(requestId);
    }
    /**
     * @public
     * To get all the responses of the batch request
     * @returns The Map of id and Response objects
     */
    getResponses() {
        return this.responses;
    }
    /**
     * @public
     * To get the iterator for the responses
     * @returns The Iterable generator for the response objects
     */
    *getResponsesIterator() {
        const iterator = this.responses.entries();
        let cur = iterator.next();
        while (!cur.done) {
            yield cur.value;
            cur = iterator.next();
        }
    }
}
//# sourceMappingURL=BatchResponseContent.js.map

/***/ }),

/***/ "6Pc0":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-contact/mgt-person-card-contact.js ***!
  \************************************************************************************************************************************************/
/*! exports provided: MgtPersonCardContact */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtPersonCardContact", function() { return MgtPersonCardContact; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var _graph_graph_people__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../graph/graph.people */ "r/Dn");
/* harmony import */ var _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../BasePersonCardSection */ "8z1x");
/* harmony import */ var _mgt_person_card_contact_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mgt-person-card-contact-css */ "tPKz");
/* harmony import */ var _utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../utils/SvgHelper */ "FPR2");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./strings */ "8hzC");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








/**
 * The contact details subsection of the person card
 *
 * @export
 * @class MgtPersonCardProfile
 * @extends {MgtTemplatedComponent}
 */
let MgtPersonCardContact = class MgtPersonCardContact extends _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_4__["BasePersonCardSection"] {
    // tslint:enable: object-literal-sort-keys
    constructor(person) {
        super();
        // tslint:disable: object-literal-sort-keys
        this._contactParts = {
            email: {
                icon: Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].Email, '#929292'),
                onClick: () => this.sendEmail(),
                showCompact: true,
                title: 'Email'
            },
            chat: {
                icon: Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].Chat, '#929292'),
                onClick: () => this.sendChat(),
                showCompact: false,
                title: 'Teams'
            },
            businessPhone: {
                icon: Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].CellPhone, '#929292'),
                onClick: () => this.sendCall(),
                showCompact: true,
                title: 'Business Phone'
            },
            cellPhone: {
                icon: Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].CellPhone, '#929292'),
                onClick: () => this.sendCall(),
                showCompact: true,
                title: 'Mobile Phone'
            },
            department: {
                icon: Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].Department, '#929292'),
                showCompact: false,
                title: 'Department'
            },
            title: {
                icon: Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].Person, '#929292'),
                showCompact: false,
                title: 'Title'
            },
            officeLocation: {
                icon: Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].OfficeLocation, '#929292'),
                showCompact: true,
                title: 'Office Location'
            }
        };
        this._person = person;
        this._contactParts.email.value = Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_3__["getEmailFromGraphEntity"])(this._person);
        this._contactParts.chat.value = this._person.userPrincipalName;
        this._contactParts.cellPhone.value = this._person.mobilePhone;
        this._contactParts.department.value = this._person.department;
        this._contactParts.title.value = this._person.jobTitle;
        this._contactParts.officeLocation.value = this._person.officeLocation;
        if (this._person.businessPhones && this._person.businessPhones.length) {
            this._contactParts.businessPhone.value = this._person.businessPhones[0];
        }
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_person_card_contact_css__WEBPACK_IMPORTED_MODULE_5__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_7__["strings"];
    }
    /**
     * Returns true if the component has data it can render
     *
     * @readonly
     * @abstract
     * @type {boolean}
     * @memberof BasePersonCardSection
     */
    get hasData() {
        if (!this._contactParts) {
            return false;
        }
        const availableParts = Object.values(this._contactParts).filter((p) => !!p.value);
        return !!availableParts.length;
    }
    /**
     * The name for display in the overview section.
     *
     * @readonly
     * @type {string}
     * @memberof MgtPersonCardContact
     */
    get displayName() {
        return this.strings.contactSectionTitle;
    }
    // Defines the skeleton for what contact fields are available and what they do.
    /**
     * Render the icon for display in the navigation ribbon.
     *
     * @returns {TemplateResult}
     * @memberof MgtPersonCardContact
     */
    renderIcon() {
        return Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].Contact);
    }
    /**
     * Reset any state in the section
     *
     * @protected
     * @memberof MgtPersonCardContact
     */
    clearState() {
        for (const key of Object.keys(this._contactParts)) {
            this._contactParts[key].value = null;
        }
    }
    /**
     * Render the compact view
     *
     * @returns {TemplateResult}
     * @memberof MgtPersonCardContact
     */
    renderCompactView() {
        let contentTemplate;
        if (!this.hasData) {
            return null;
        }
        const availableParts = Object.values(this._contactParts).filter((p) => !!p.value);
        // Filter for compact mode parts with values
        let compactParts = Object.values(availableParts).filter((p) => !!p.value && p.showCompact);
        if (!compactParts || !compactParts.length) {
            compactParts = Object.values(availableParts).slice(0, 2);
        }
        contentTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      ${compactParts.map(p => this.renderContactPart(p))}
    `;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root compact" dir=${this.direction}>
        ${contentTemplate}
      </div>
    `;
    }
    /**
     * Render the full view
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardContact
     */
    renderFullView() {
        let contentTemplate;
        if (this.hasData) {
            // Filter for parts with values only
            const availableParts = Object.values(this._contactParts).filter((p) => !!p.value);
            contentTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        ${availableParts.map(part => this.renderContactPart(part))}
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root" dir=${this.direction}>
        <div class="title">${this.displayName}</div>
        ${contentTemplate}
      </div>
    `;
    }
    /**
     * Render a specific contact part
     *
     * @protected
     * @param {IContactPart} part
     * @returns {TemplateResult}
     * @memberof MgtPersonCardContact
     */
    renderContactPart(part) {
        let isPhone = false;
        if (part.title === 'Mobile Phone' || part.title === 'Business Phone') {
            isPhone = true;
        }
        const partLinkClasses = {
            part__link: true,
            phone: isPhone
        };
        const valueTemplate = part.onClick
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <span class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_2__["classMap"])(partLinkClasses)} @click=${(e) => part.onClick(e)}>${part.value}</span>
        `
            : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          ${part.value}
        `;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="part" @click=${(e) => this.handlePartClick(e, part.value)}>
        <div class="part__icon">${part.icon}</div>
        <div class="part__details">
          <div class="part__title">${part.title}</div>
          <div class="part__value">${valueTemplate}</div>
        </div>
        <div class="part__copy">
          ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].Copy)}
        </div>
      </div>
    `;
    }
    /**
     * Handle the click event for contact parts
     *
     * @protected
     * @memberof MgtPersonCardContact
     */
    handlePartClick(e, value) {
        if (value) {
            navigator.clipboard.writeText(value);
        }
    }
    /**
     * Send a chat message to the user
     *
     * @protected
     * @memberof MgtPersonCardContact
     */
    sendChat() {
        const chat = this._contactParts.chat.value;
        if (!chat) {
            return;
        }
        const url = `https://teams.microsoft.com/l/chat/0/0?users=${chat}`;
        const openWindow = () => window.open(url, '_blank');
        if (_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["TeamsHelper"].isAvailable) {
            _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["TeamsHelper"].executeDeepLink(url, (status) => {
                if (!status) {
                    openWindow();
                }
            });
        }
        else {
            openWindow();
        }
    }
    /**
     * Send an email to the user
     *
     * @protected
     * @memberof MgtPersonCardContact
     */
    sendEmail() {
        const email = this._contactParts.email.value;
        if (email) {
            window.open('mailto:' + email, '_blank');
        }
    }
    /**
     * Send a call to the user
     *
     * @protected
     * @memberof MgtPersonCardContact
     */
    sendCall() {
        const cellPhone = this._contactParts.cellPhone.value;
        if (cellPhone) {
            window.open('tel:' + cellPhone, '_blank');
        }
    }
};
MgtPersonCardContact = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-person-card-contact'),
    __metadata("design:paramtypes", [Object])
], MgtPersonCardContact);

//# sourceMappingURL=mgt-person-card-contact.js.map

/***/ }),

/***/ "6USQ":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/telemetry/DefaultEvent.js ***!
  \*******************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryConstants */ "tekO");
/* harmony import */ var _TelemetryEvent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryEvent */ "31fH");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TelemetryUtils */ "Rgi7");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var DefaultEvent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DefaultEvent, _super);
    // TODO Platform Type
    function DefaultEvent(platform, correlationId, clientId, eventCount) {
        var _this = _super.call(this, Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("default_event"), correlationId, "DefaultEvent") || this;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("client_id")] = clientId;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("sdk_plaform")] = platform.sdk;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("sdk_version")] = platform.sdkVersion;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("application_name")] = platform.applicationName;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("application_version")] = platform.applicationVersion;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("effective_connection_speed")] = platform.networkInformation && platform.networkInformation.connectionSpeed;
        _this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].UiEventCountTelemetryBatchKey] = _this.getEventCount(Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("ui_event"), eventCount);
        _this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].HttpEventCountTelemetryBatchKey] = _this.getEventCount(Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("http_event"), eventCount);
        _this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].CacheEventCountConstStrKey] = _this.getEventCount(Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("cache_event"), eventCount);
        return _this;
        // / Device id?
    }
    DefaultEvent.prototype.getEventCount = function (eventName, eventCount) {
        if (!eventCount[eventName]) {
            return 0;
        }
        return eventCount[eventName];
    };
    return DefaultEvent;
}(_TelemetryEvent__WEBPACK_IMPORTED_MODULE_2__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (DefaultEvent);
//# sourceMappingURL=DefaultEvent.js.map

/***/ }),

/***/ "6YFA":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/cache/BrowserStorage.js ***!
  \**********************************************************************************************************/
/*! exports provided: BrowserStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BrowserStorage", function() { return BrowserStorage; });
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "UBea");
/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../error/AuthError */ "MEWQ");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * @hidden
 */
var BrowserStorage = /** @class */ (function () {
    function BrowserStorage(cacheLocation) {
        if (!window) {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_1__["AuthError"].createNoWindowObjectError("Browser storage class could not find window object");
        }
        var storageSupported = typeof window[cacheLocation] !== "undefined" && window[cacheLocation] != null;
        if (!storageSupported) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createStorageNotSupportedError(cacheLocation);
        }
        this.cacheLocation = cacheLocation;
    }
    /**
     * add value to storage
     * @param key
     * @param value
     * @param enableCookieStorage
     */
    BrowserStorage.prototype.setItem = function (key, value, enableCookieStorage) {
        window[this.cacheLocation].setItem(key, value);
        if (enableCookieStorage) {
            this.setItemCookie(key, value);
        }
    };
    /**
     * get one item by key from storage
     * @param key
     * @param enableCookieStorage
     */
    BrowserStorage.prototype.getItem = function (key, enableCookieStorage) {
        if (enableCookieStorage && this.getItemCookie(key)) {
            return this.getItemCookie(key);
        }
        return window[this.cacheLocation].getItem(key);
    };
    /**
     * remove value from storage
     * @param key
     */
    BrowserStorage.prototype.removeItem = function (key) {
        return window[this.cacheLocation].removeItem(key);
    };
    /**
     * clear storage (remove all items from it)
     */
    BrowserStorage.prototype.clear = function () {
        return window[this.cacheLocation].clear();
    };
    /**
     * add value to cookies
     * @param cName
     * @param cValue
     * @param expires
     */
    BrowserStorage.prototype.setItemCookie = function (cName, cValue, expires) {
        var cookieStr = cName + "=" + cValue + ";path=/;";
        if (expires) {
            var expireTime = this.getCookieExpirationTime(expires);
            cookieStr += "expires=" + expireTime + ";";
        }
        document.cookie = cookieStr;
    };
    /**
     * get one item by key from cookies
     * @param cName
     */
    BrowserStorage.prototype.getItemCookie = function (cName) {
        var name = cName + "=";
        var ca = document.cookie.split(";");
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) === " ") {
                c = c.substring(1);
            }
            if (c.indexOf(name) === 0) {
                return c.substring(name.length, c.length);
            }
        }
        return "";
    };
    /**
     * Clear an item in the cookies by key
     * @param cName
     */
    BrowserStorage.prototype.clearItemCookie = function (cName) {
        this.setItemCookie(cName, "", -1);
    };
    /**
     * Get cookie expiration time
     * @param cookieLifeDays
     */
    BrowserStorage.prototype.getCookieExpirationTime = function (cookieLifeDays) {
        var today = new Date();
        var expr = new Date(today.getTime() + cookieLifeDays * 24 * 60 * 60 * 1000);
        return expr.toUTCString();
    };
    return BrowserStorage;
}());

//# sourceMappingURL=BrowserStorage.js.map

/***/ }),

/***/ "6i0k":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/ResponseUtils.js ***!
  \*********************************************************************************************************/
/*! exports provided: ResponseUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResponseUtils", function() { return ResponseUtils; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Constants */ "MQw9");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var ResponseUtils = /** @class */ (function () {
    function ResponseUtils() {
    }
    ResponseUtils.setResponseIdToken = function (originalResponse, idTokenObj) {
        if (!originalResponse) {
            return null;
        }
        else if (!idTokenObj) {
            return originalResponse;
        }
        var exp = Number(idTokenObj.expiration);
        if (exp && !originalResponse.expiresOn) {
            originalResponse.expiresOn = new Date(exp * 1000);
        }
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, originalResponse, { idToken: idTokenObj, idTokenClaims: idTokenObj.claims, uniqueId: idTokenObj.objectId || idTokenObj.subject, tenantId: idTokenObj.tenantId });
    };
    ResponseUtils.buildAuthResponse = function (idToken, authResponse, serverAuthenticationRequest, account, scopes, accountState) {
        switch (serverAuthenticationRequest.responseType) {
            case _Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token:
                authResponse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, authResponse, { tokenType: _Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ID_TOKEN, account: account, scopes: scopes, accountState: accountState });
                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);
                return (authResponse.idToken) ? authResponse : null;
            case _Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token_token:
                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);
                return (authResponse && authResponse.accessToken && authResponse.idToken) ? authResponse : null;
            case _Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].token:
                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);
                return authResponse;
            default:
                return null;
        }
    };
    return ResponseUtils;
}());

//# sourceMappingURL=ResponseUtils.js.map

/***/ }),

/***/ "6r4W":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/UrlUtils.js ***!
  \****************************************************************************************************/
/*! exports provided: UrlUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UrlUtils", function() { return UrlUtils; });
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Constants */ "MQw9");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ScopeSet */ "qfGv");
/* harmony import */ var _StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./StringUtils */ "UjIo");
/* harmony import */ var _CryptoUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./CryptoUtils */ "oish");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




/**
 * @hidden
 */
var UrlUtils = /** @class */ (function () {
    function UrlUtils() {
    }
    /**
     * generates the URL with QueryString Parameters
     * @param scopes
     */
    UrlUtils.createNavigateUrl = function (serverRequestParams) {
        var str = this.createNavigationUrlString(serverRequestParams);
        var authEndpoint = serverRequestParams.authorityInstance.AuthorizationEndpoint;
        // if the endpoint already has queryparams, lets add to it, otherwise add the first one
        if (authEndpoint.indexOf("?") < 0) {
            authEndpoint += "?";
        }
        else {
            authEndpoint += "&";
        }
        var requestUrl = "" + authEndpoint + str.join("&");
        return requestUrl;
    };
    /**
     * Generate the array of all QueryStringParams to be sent to the server
     * @param scopes
     */
    UrlUtils.createNavigationUrlString = function (serverRequestParams) {
        var scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_1__["ScopeSet"].appendDefaultScopes(serverRequestParams.scopes);
        var str = [];
        str.push("response_type=" + serverRequestParams.responseType);
        str.push("scope=" + encodeURIComponent(_ScopeSet__WEBPACK_IMPORTED_MODULE_1__["ScopeSet"].parseScope(scopes)));
        str.push("client_id=" + encodeURIComponent(serverRequestParams.clientId));
        str.push("redirect_uri=" + encodeURIComponent(serverRequestParams.redirectUri));
        str.push("state=" + encodeURIComponent(serverRequestParams.state));
        str.push("nonce=" + encodeURIComponent(serverRequestParams.nonce));
        str.push("client_info=1");
        str.push("x-client-SKU=" + serverRequestParams.xClientSku);
        str.push("x-client-Ver=" + serverRequestParams.xClientVer);
        if (serverRequestParams.promptValue) {
            str.push("prompt=" + encodeURIComponent(serverRequestParams.promptValue));
        }
        if (serverRequestParams.claimsValue) {
            str.push("claims=" + encodeURIComponent(serverRequestParams.claimsValue));
        }
        if (serverRequestParams.queryParameters) {
            str.push(serverRequestParams.queryParameters);
        }
        if (serverRequestParams.extraQueryParameters) {
            str.push(serverRequestParams.extraQueryParameters);
        }
        str.push("client-request-id=" + encodeURIComponent(serverRequestParams.correlationId));
        return str;
    };
    /**
     * Returns current window URL as redirect uri
     */
    UrlUtils.getCurrentUrl = function () {
        return window.location.href.split("?")[0].split("#")[0];
    };
    /**
     * Returns given URL with query string removed
     */
    UrlUtils.removeHashFromUrl = function (url) {
        return url.split("#")[0];
    };
    /**
     * Given a url like https://a:b/common/d?e=f#g, and a tenantId, returns https://a:b/tenantId/d
     * @param href The url
     * @param tenantId The tenant id to replace
     */
    UrlUtils.replaceTenantPath = function (url, tenantId) {
        var lowerCaseUrl = url.toLowerCase();
        var urlObject = this.GetUrlComponents(lowerCaseUrl);
        var pathArray = urlObject.PathSegments;
        if (tenantId && (pathArray.length !== 0 && (pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["Constants"].common || pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["SSOTypes"].ORGANIZATIONS))) {
            pathArray[0] = tenantId;
        }
        return this.constructAuthorityUriFromObject(urlObject, pathArray);
    };
    UrlUtils.constructAuthorityUriFromObject = function (urlObject, pathArray) {
        return this.CanonicalizeUri(urlObject.Protocol + "//" + urlObject.HostNameAndPort + "/" + pathArray.join("/"));
    };
    /**
     * Checks if an authority is common (ex. https://a:b/common/)
     * @param url The url
     * @returns true if authority is common and false otherwise
     */
    UrlUtils.isCommonAuthority = function (url) {
        var authority = this.CanonicalizeUri(url);
        var pathArray = this.GetUrlComponents(authority).PathSegments;
        return (pathArray.length !== 0 && pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["Constants"].common);
    };
    /**
     * Checks if an authority is for organizations (ex. https://a:b/organizations/)
     * @param url The url
     * @returns true if authority is for  and false otherwise
     */
    UrlUtils.isOrganizationsAuthority = function (url) {
        var authority = this.CanonicalizeUri(url);
        var pathArray = this.GetUrlComponents(authority).PathSegments;
        return (pathArray.length !== 0 && pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["SSOTypes"].ORGANIZATIONS);
    };
    /**
     * Parses out the components from a url string.
     * @returns An object with the various components. Please cache this value insted of calling this multiple times on the same url.
     */
    UrlUtils.GetUrlComponents = function (url) {
        if (!url) {
            throw "Url required";
        }
        // https://gist.github.com/curtisz/11139b2cfcaef4a261e0
        var regEx = RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");
        var match = url.match(regEx);
        if (!match || match.length < 6) {
            throw "Valid url required";
        }
        var urlComponents = {
            Protocol: match[1],
            HostNameAndPort: match[4],
            AbsolutePath: match[5]
        };
        var pathSegments = urlComponents.AbsolutePath.split("/");
        pathSegments = pathSegments.filter(function (val) { return val && val.length > 0; }); // remove empty elements
        urlComponents.PathSegments = pathSegments;
        if (match[6]) {
            urlComponents.Search = match[6];
        }
        if (match[8]) {
            urlComponents.Hash = match[8];
        }
        return urlComponents;
    };
    /**
     * Given a url or path, append a trailing slash if one doesnt exist
     *
     * @param url
     */
    UrlUtils.CanonicalizeUri = function (url) {
        if (url) {
            url = url.toLowerCase();
        }
        if (url && !UrlUtils.endsWith(url, "/")) {
            url += "/";
        }
        return url;
    };
    /**
     * Checks to see if the url ends with the suffix
     * Required because we are compiling for es5 instead of es6
     * @param url
     * @param str
     */
    // TODO: Rename this, not clear what it is supposed to do
    UrlUtils.endsWith = function (url, suffix) {
        if (!url || !suffix) {
            return false;
        }
        return url.indexOf(suffix, url.length - suffix.length) !== -1;
    };
    /**
     * Utils function to remove the login_hint and domain_hint from the i/p extraQueryParameters
     * @param url
     * @param name
     */
    UrlUtils.urlRemoveQueryStringParameter = function (url, name) {
        if (_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(url)) {
            return url;
        }
        var regex = new RegExp("(\\&" + name + "=)[^\&]+");
        url = url.replace(regex, "");
        // name=value&
        regex = new RegExp("(" + name + "=)[^\&]+&");
        url = url.replace(regex, "");
        // name=value
        regex = new RegExp("(" + name + "=)[^\&]+");
        url = url.replace(regex, "");
        return url;
    };
    /**
     * @hidden
     * @ignore
     *
     * Returns the anchor part(#) of the URL
     */
    UrlUtils.getHashFromUrl = function (urlStringOrFragment) {
        var hashIndex1 = urlStringOrFragment.indexOf("#");
        var hashIndex2 = urlStringOrFragment.indexOf("#/");
        if (hashIndex2 > -1) {
            return urlStringOrFragment.substring(hashIndex2 + 2);
        }
        else if (hashIndex1 > -1) {
            return urlStringOrFragment.substring(hashIndex1 + 1);
        }
        return urlStringOrFragment;
    };
    /**
     * @hidden
     * Check if the url contains a hash with known properties
     * @ignore
     */
    UrlUtils.urlContainsHash = function (urlString) {
        var parameters = UrlUtils.deserializeHash(urlString);
        return (parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ERROR_DESCRIPTION) ||
            parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ERROR) ||
            parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ACCESS_TOKEN) ||
            parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ID_TOKEN));
    };
    /**
     * @hidden
     * Returns deserialized portion of URL hash
     * @ignore
     */
    UrlUtils.deserializeHash = function (urlFragment) {
        var hash = UrlUtils.getHashFromUrl(urlFragment);
        return _CryptoUtils__WEBPACK_IMPORTED_MODULE_3__["CryptoUtils"].deserialize(hash);
    };
    /**
     * @ignore
     * @param {string} URI
     * @returns {string} host from the URI
     *
     * extract URI from the host
     */
    UrlUtils.getHostFromUri = function (uri) {
        // remove http:// or https:// from uri
        var extractedUri = String(uri).replace(/^(https?:)\/\//, "");
        extractedUri = extractedUri.split("/")[0];
        return extractedUri;
    };
    return UrlUtils;
}());

//# sourceMappingURL=UrlUtils.js.map

/***/ }),

/***/ "6unr":
/*!********************************************************!*\
  !*** ./node_modules/lit-html/lib/template-instance.js ***!
  \********************************************************/
/*! exports provided: TemplateInstance */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TemplateInstance", function() { return TemplateInstance; });
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom.js */ "tFPJ");
/* harmony import */ var _template_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./template.js */ "4yuk");
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */


/**
 * An instance of a `Template` that can be attached to the DOM and updated
 * with new values.
 */
class TemplateInstance {
    constructor(template, processor, options) {
        this.__parts = [];
        this.template = template;
        this.processor = processor;
        this.options = options;
    }
    update(values) {
        let i = 0;
        for (const part of this.__parts) {
            if (part !== undefined) {
                part.setValue(values[i]);
            }
            i++;
        }
        for (const part of this.__parts) {
            if (part !== undefined) {
                part.commit();
            }
        }
    }
    _clone() {
        // There are a number of steps in the lifecycle of a template instance's
        // DOM fragment:
        //  1. Clone - create the instance fragment
        //  2. Adopt - adopt into the main document
        //  3. Process - find part markers and create parts
        //  4. Upgrade - upgrade custom elements
        //  5. Update - set node, attribute, property, etc., values
        //  6. Connect - connect to the document. Optional and outside of this
        //     method.
        //
        // We have a few constraints on the ordering of these steps:
        //  * We need to upgrade before updating, so that property values will pass
        //    through any property setters.
        //  * We would like to process before upgrading so that we're sure that the
        //    cloned fragment is inert and not disturbed by self-modifying DOM.
        //  * We want custom elements to upgrade even in disconnected fragments.
        //
        // Given these constraints, with full custom elements support we would
        // prefer the order: Clone, Process, Adopt, Upgrade, Update, Connect
        //
        // But Safari does not implement CustomElementRegistry#upgrade, so we
        // can not implement that order and still have upgrade-before-update and
        // upgrade disconnected fragments. So we instead sacrifice the
        // process-before-upgrade constraint, since in Custom Elements v1 elements
        // must not modify their light DOM in the constructor. We still have issues
        // when co-existing with CEv0 elements like Polymer 1, and with polyfills
        // that don't strictly adhere to the no-modification rule because shadow
        // DOM, which may be created in the constructor, is emulated by being placed
        // in the light DOM.
        //
        // The resulting order is on native is: Clone, Adopt, Upgrade, Process,
        // Update, Connect. document.importNode() performs Clone, Adopt, and Upgrade
        // in one step.
        //
        // The Custom Elements v1 polyfill supports upgrade(), so the order when
        // polyfilled is the more ideal: Clone, Process, Adopt, Upgrade, Update,
        // Connect.
        const fragment = _dom_js__WEBPACK_IMPORTED_MODULE_0__["isCEPolyfill"] ?
            this.template.element.content.cloneNode(true) :
            document.importNode(this.template.element.content, true);
        const stack = [];
        const parts = this.template.parts;
        // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be null
        const walker = document.createTreeWalker(fragment, 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */, null, false);
        let partIndex = 0;
        let nodeIndex = 0;
        let part;
        let node = walker.nextNode();
        // Loop through all the nodes and parts of a template
        while (partIndex < parts.length) {
            part = parts[partIndex];
            if (!Object(_template_js__WEBPACK_IMPORTED_MODULE_1__["isTemplatePartActive"])(part)) {
                this.__parts.push(undefined);
                partIndex++;
                continue;
            }
            // Progress the tree walker until we find our next part's node.
            // Note that multiple parts may share the same node (attribute parts
            // on a single element), so this loop may not run at all.
            while (nodeIndex < part.index) {
                nodeIndex++;
                if (node.nodeName === 'TEMPLATE') {
                    stack.push(node);
                    walker.currentNode = node.content;
                }
                if ((node = walker.nextNode()) === null) {
                    // We've exhausted the content inside a nested template element.
                    // Because we still have parts (the outer for-loop), we know:
                    // - There is a template in the stack
                    // - The walker will find a nextNode outside the template
                    walker.currentNode = stack.pop();
                    node = walker.nextNode();
                }
            }
            // We've arrived at our part's node.
            if (part.type === 'node') {
                const part = this.processor.handleTextExpression(this.options);
                part.insertAfterNode(node.previousSibling);
                this.__parts.push(part);
            }
            else {
                this.__parts.push(...this.processor.handleAttributeExpressions(node, part.name, part.strings, this.options));
            }
            partIndex++;
        }
        if (_dom_js__WEBPACK_IMPORTED_MODULE_0__["isCEPolyfill"]) {
            document.adoptNode(fragment);
            customElements.upgrade(fragment);
        }
        return fragment;
    }
}
//# sourceMappingURL=template-instance.js.map

/***/ }),

/***/ "71h5":
/*!*********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-messages/strings.js ***!
  \*********************************************************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    emailsSectionTitle: 'Emails'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "72nD":
/*!*******************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/TemplateContext.js ***!
  \*******************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
//# sourceMappingURL=TemplateContext.js.map

/***/ }),

/***/ "7LbE":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-login/mgt-login.js ***!
  \*******************************************************************************************/
/*! exports provided: MgtLogin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtLogin", function() { return MgtLogin; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _mgt_login_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mgt-login-css */ "4qoK");
/* harmony import */ var _graph_graph_user__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../graph/graph.user */ "0Vrk");
/* harmony import */ var _styles_style_helper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../styles/style-helper */ "XyBC");
/* harmony import */ var _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../mgt-person/mgt-person */ "lBzc");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./strings */ "VZ59");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









/**
 * Web component button and flyout control to facilitate Microsoft identity platform authentication
 *
 * @export
 * @class MgtLogin
 * @extends {MgtBaseComponent}
 *
 * @fires loginInitiated - Fired when login is initiated by the user
 * @fires loginCompleted - Fired when login completes
 * @fires loginFailed - Fired when login fails
 * @fires logoutInitiated - Fired when logout is initiated by the user
 * @fires logoutCompleted - Fired when logout completed
 *
 * @template signed-in-button-content (dataContext: {personDetails, personImage})
 * @template signed-out-button-content (dataContext: null)
 * @template flyout-commands (dataContext: {handleSignOut})
 * @template flyout-person-details (dataContext: {personDetails, personImage})
 *
 * @cssprop --font-size - {Length} Login font size
 * @cssprop --font-weight - {Length} Login font weight
 * @cssprop --height - {String} Login height percentage
 * @cssprop --margin - {String} Margin size
 * @cssprop --padding - {String} Padding size
 * @cssprop --button-color - {Color} Login button font color
 * @cssprop --button-color--hover - {Color} Login button font hover color
 * @cssprop --button-background-color - {Color} Login button background color
 * @cssprop --button-background-color--hover - {Color} Login background hover color
 * @cssprop --popup-background-color - {Color} Popup background color
 * @cssprop --popup-color - {Color} Popup font color
 * @cssprop --popup-command-font-size - {Length} Popup command font size
 */
let MgtLogin = class MgtLogin extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["MgtTemplatedComponent"] {
    constructor() {
        super();
        this._isFlyoutOpen = false;
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_login_css__WEBPACK_IMPORTED_MODULE_3__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_7__["strings"];
    }
    /**
     * Gets the flyout element
     *
     * @protected
     * @type {MgtFlyout}
     * @memberof MgtLogin
     */
    get flyout() {
        return this.renderRoot.querySelector('.flyout');
    }
    /**
     * Invoked each time the custom element is appended into a document-connected element
     *
     * @memberof MgtLogin
     */
    connectedCallback() {
        super.connectedCallback();
        this.addEventListener('click', e => e.stopPropagation());
    }
    /**
     * Initiate login
     *
     * @returns {Promise<void>}
     * @memberof MgtLogin
     */
    login() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.userDetails || !this.fireCustomEvent('loginInitiated')) {
                return;
            }
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["Providers"].globalProvider;
            if (provider && provider.login) {
                yield provider.login();
                if (provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["ProviderState"].SignedIn) {
                    this.fireCustomEvent('loginCompleted');
                }
                else {
                    this.fireCustomEvent('loginFailed');
                }
            }
        });
    }
    /**
     * Initiate logout
     *
     * @returns {Promise<void>}
     * @memberof MgtLogin
     */
    logout() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.fireCustomEvent('logoutInitiated')) {
                return;
            }
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["Providers"].globalProvider;
            if (provider && provider.logout) {
                yield provider.logout();
                this.userDetails = null;
                this.hideFlyout();
                this.fireCustomEvent('logoutCompleted');
            }
        });
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root" dir=${this.direction}>
        <div>
          ${this.renderButton()}
        </div>
        ${this.renderFlyout()}
      </div>
    `;
    }
    /**
     * Load state into the component.
     *
     * @protected
     * @returns
     * @memberof MgtLogin
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["Providers"].globalProvider;
            if (provider && !this.userDetails) {
                if (provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["ProviderState"].SignedIn) {
                    this.userDetails = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_4__["getUserWithPhoto"])(provider.graph.forComponent(this));
                    if (this.userDetails.personImage) {
                        this._image = this.userDetails.personImage;
                    }
                    this.fireCustomEvent('loginCompleted');
                }
                else {
                    this.userDetails = null;
                }
            }
        });
    }
    /**
     * Render the button.
     *
     * @protected
     * @memberof MgtLogin
     */
    renderButton() {
        const classes = {
            'login-button': true,
            'no-click': this._isFlyoutOpen
        };
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <button ?disabled="${this.isLoadingState}" @click=${this.onClick} class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(classes)} role="button">
        ${this.renderButtonContent()}
      </button>
    `;
    }
    /**
     * Render the details flyout.
     *
     * @protected
     * @memberof MgtLogin
     */
    renderFlyout() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${() => (this._isFlyoutOpen = true)}
        @closed=${() => (this._isFlyoutOpen = false)}
      >
        <div slot="flyout">
          ${this.renderFlyoutContent()}
        </div>
      </mgt-flyout>
    `;
    }
    /**
     * Render the flyout menu content.
     *
     * @protected
     * @returns
     * @memberof MgtLogin
     */
    renderFlyoutContent() {
        if (!this.userDetails) {
            return;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="popup">
        <div class="popup-content">
          <div>
            ${this.renderFlyoutPersonDetails(this.userDetails, this._image)}
          </div>
          <div class="popup-commands">
            ${this.renderFlyoutCommands()}
          </div>
        </div>
      </div>
    `;
    }
    /**
     * Render the flyout person details.
     *
     * @protected
     * @returns
     * @memberof MgtLogin
     */
    renderFlyoutPersonDetails(personDetails, personImage) {
        const template = this.renderTemplate('flyout-person-details', { personDetails, personImage });
        return (template ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <mgt-person .personDetails=${personDetails} .personImage=${personImage} .view=${_mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_6__["PersonViewType"].twolines} />
      `);
    }
    /**
     * Render the flyout commands.
     *
     * @protected
     * @returns
     * @memberof MgtLogin
     */
    renderFlyoutCommands() {
        const template = this.renderTemplate('flyout-commands', { handleSignOut: () => this.logout() });
        return (template ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <ul>
          <li>
            <button class="popup-command" @click=${this.logout} aria-label="Sign Out">
              ${this.strings.signOutLinkSubtitle}
            </button>
          </li>
        </ul>
      `);
    }
    /**
     * Render the button content.
     *
     * @protected
     * @returns
     * @memberof MgtLogin
     */
    renderButtonContent() {
        if (this.userDetails) {
            return this.renderSignedInButtonContent(this.userDetails, this._image);
        }
        else {
            return this.renderSignedOutButtonContent();
        }
    }
    /**
     * Render the button content when the user is signed in.
     *
     * @protected
     * @returns
     * @memberof MgtLogin
     */
    renderSignedInButtonContent(personDetails, personImage) {
        const template = this.renderTemplate('signed-in-button-content', { personDetails, personImage });
        return (template ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <mgt-person .personDetails=${this.userDetails} .personImage=${this._image} .view=${_mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_6__["PersonViewType"].oneline} />
      `);
    }
    /**
     * Render the button content when the user is not signed in.
     *
     * @protected
     * @returns
     * @memberof MgtLogin
     */
    renderSignedOutButtonContent() {
        const template = this.renderTemplate('signed-out-button-content', null);
        return (template ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
        <span aria-label="Sign In">
          ${this.strings.signInLinkSubtitle}
        </span>
      `);
    }
    /**
     * Show the flyout and its content.
     *
     * @protected
     * @memberof MgtLogin
     */
    showFlyout() {
        const flyout = this.flyout;
        if (flyout) {
            flyout.open();
        }
    }
    /**
     * Dismiss the flyout.
     *
     * @protected
     * @memberof MgtLogin
     */
    hideFlyout() {
        const flyout = this.flyout;
        if (flyout) {
            flyout.close();
        }
    }
    onClick() {
        if (this.userDetails) {
            this.showFlyout();
        }
        else {
            this.login();
        }
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'user-details',
        type: Object
    }),
    __metadata("design:type", Object)
], MgtLogin.prototype, "userDetails", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: false }),
    __metadata("design:type", Boolean)
], MgtLogin.prototype, "_isFlyoutOpen", void 0);
MgtLogin = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-login'),
    __metadata("design:paramtypes", [])
], MgtLogin);

//# sourceMappingURL=mgt-login.js.map

/***/ }),

/***/ "7TLm":
/*!************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/mock/MockGraph.js ***!
  \************************************************************************/
/*! exports provided: MockGraph */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MockGraph", function() { return MockGraph; });
/* harmony import */ var _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/microsoft-graph-client */ "9F8r");
/* harmony import */ var _Graph__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Graph */ "WOkV");
/* harmony import */ var _utils_GraphHelpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/GraphHelpers */ "yLtT");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * The base URL for the mock endpoint
 */
const BASE_URL = 'https://proxy.apisandbox.msdn.microsoft.com/svc?url=';
/**
 * The base URL for the graph
 */
const ROOT_GRAPH_URL = 'https://graph.microsoft.com/';
/**
 * MockGraph Instance
 *
 * @export
 * @class MockGraph
 * @extends {Graph}
 */
// tslint:disable-next-line: max-classes-per-file
class MockGraph extends _Graph__WEBPACK_IMPORTED_MODULE_1__["Graph"] {
    constructor(mockProvider) {
        const middleware = [
            new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["AuthenticationHandler"](mockProvider),
            new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["RetryHandler"](new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["RetryHandlerOptions"]()),
            new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["TelemetryHandler"](),
            new MockMiddleware(),
            new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["HTTPMessageHandler"]()
        ];
        super(_microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["Client"].initWithMiddleware({
            baseUrl: BASE_URL + ROOT_GRAPH_URL,
            middleware: Object(_utils_GraphHelpers__WEBPACK_IMPORTED_MODULE_2__["chainMiddleware"])(...middleware)
        }));
    }
    /**
     * Returns an instance of the Graph in the context of the provided component.
     *
     * @param {MgtBaseComponent} component
     * @returns
     * @memberof Graph
     */
    forComponent(component) {
        // The purpose of the forComponent pattern is to update the headers of any outgoing Graph requests.
        // The MockGraph isn't making real Graph requests, so we can simply no-op and return the same instance.
        return this;
    }
}
/**
 * Implements Middleware for the Mock Client to escape
 * the graph url from the request
 *
 * @class MockMiddleware
 * @implements {Middleware}
 */
// tslint:disable-next-line: max-classes-per-file
class MockMiddleware {
    // tslint:disable-next-line: completed-docs
    execute(context) {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                const url = context.request;
                const baseLength = BASE_URL.length;
                context.request = url.substring(0, baseLength) + escape(url.substring(baseLength));
            }
            catch (error) {
                // ignore error
            }
            return yield this._nextMiddleware.execute(context);
        });
    }
    /**
     * Handles setting of next middleware
     *
     * @param {Middleware} next
     * @memberof SdkVersionMiddleware
     */
    setNext(next) {
        this._nextMiddleware = next;
    }
}
//# sourceMappingURL=MockGraph.js.map

/***/ }),

/***/ "7eED":
/*!***********************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/GraphRequestUtil.js ***!
  \***********************************************************************************/
/*! exports provided: oDataQueryNames, urlJoin, serializeContent, isGraphURL */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "oDataQueryNames", function() { return oDataQueryNames; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "urlJoin", function() { return urlJoin; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "serializeContent", function() { return serializeContent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isGraphURL", function() { return isGraphURL; });
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Constants */ "Blta");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module GraphRequestUtil
 */

/**
 * To hold list of OData query params
 */
const oDataQueryNames = ["$select", "$expand", "$orderby", "$filter", "$top", "$skip", "$skipToken", "$count"];
/**
 * To construct the URL by appending the segments with "/"
 * @param {string[]} urlSegments - The array of strings
 * @returns The constructed URL string
 */
const urlJoin = (urlSegments) => {
    const removePostSlash = (s) => s.replace(/\/+$/, "");
    const removePreSlash = (s) => s.replace(/^\/+/, "");
    const joiner = (pre, cur) => [removePostSlash(pre), removePreSlash(cur)].join("/");
    const parts = Array.prototype.slice.call(urlSegments);
    return parts.reduce(joiner);
};
/**
 * Serializes the content
 * @param {any} content - The content value that needs to be serialized
 * @returns The serialized content
 *
 * Note:
 * This conversion is required due to the following reasons:
 * Body parameter of Request method of isomorphic-fetch only accepts Blob, ArrayBuffer, FormData, TypedArrays string.
 * Node.js platform does not support Blob, FormData. Javascript File object inherits from Blob so it is also not supported in node. Therefore content of type Blob, File, FormData will only come from browsers.
 * Parallel to ArrayBuffer in javascript, node provides Buffer interface. Node's Buffer is able to send the arbitrary binary data to the server successfully for both Browser and Node platform. Whereas sending binary data via ArrayBuffer or TypedArrays was only possible using Browser. To support both Node and Browser, `serializeContent` converts TypedArrays or ArrayBuffer to `Node Buffer`.
 * If the data received is in JSON format, `serializeContent` converts the JSON to string.
 */
const serializeContent = (content) => {
    const className = content && content.constructor && content.constructor.name;
    if (className === "Buffer" || className === "Blob" || className === "File" || className === "FormData" || typeof content === "string") {
        return content;
    }
    if (className === "ArrayBuffer") {
        content = Buffer.from(content);
    }
    else if (className === "Int8Array" || className === "Int16Array" || className === "Int32Array" || className === "Uint8Array" || className === "Uint16Array" || className === "Uint32Array" || className === "Uint8ClampedArray" || className === "Float32Array" || className === "Float64Array" || className === "DataView") {
        content = Buffer.from(content.buffer);
    }
    else {
        try {
            content = JSON.stringify(content);
        }
        catch (error) {
            throw new Error("Unable to stringify the content");
        }
    }
    return content;
};
/**
 * Checks if the url is one of the service root endpoints for Microsoft Graph and Graph Explorer.
 * @param {string} url - The url to be verified
 * @returns {boolean} - Returns true if the url is a Graph URL
 */
const isGraphURL = (url) => {
    // Valid Graph URL pattern - https://graph.microsoft.com/{version}/{resource}?{query-parameters}
    // Valid Graph URL example - https://graph.microsoft.com/v1.0/
    url = url.toLowerCase();
    if (url.indexOf("https://") !== -1) {
        url = url.replace("https://", "");
        // Find where the host ends
        const startofPortNoPos = url.indexOf(":");
        const endOfHostStrPos = url.indexOf("/");
        let hostName = "";
        if (endOfHostStrPos !== -1) {
            if (startofPortNoPos !== -1 && startofPortNoPos < endOfHostStrPos) {
                hostName = url.substring(0, startofPortNoPos);
                return _Constants__WEBPACK_IMPORTED_MODULE_0__["GRAPH_URLS"].has(hostName);
            }
            // Parse out the host
            hostName = url.substring(0, endOfHostStrPos);
            return _Constants__WEBPACK_IMPORTED_MODULE_0__["GRAPH_URLS"].has(hostName);
        }
    }
    return false;
};
//# sourceMappingURL=GraphRequestUtil.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../buffer/index.js */ "tjlA").Buffer))

/***/ }),

/***/ "7elE":
/*!*********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/components/baseProvider.js ***!
  \*********************************************************************************/
/*! exports provided: MgtBaseProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtBaseProvider", function() { return MgtBaseProvider; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _baseComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./baseComponent */ "zoxn");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


/**
 * Abstract implementation for provider component
 *
 * @export
 * @abstract
 * @class MgtBaseProvider
 * @extends {MgtBaseComponent}
 */
class MgtBaseProvider extends _baseComponent__WEBPACK_IMPORTED_MODULE_1__["MgtBaseComponent"] {
    /**
     * The IProvider created by this component
     *
     * @memberof MgtBaseProvider
     */
    get provider() {
        return this._provider;
    }
    set provider(value) {
        if (this._provider) {
            this.provider.removeStateChangedHandler(() => this.stateChangedHandler);
        }
        this._provider = value;
        if (this._provider) {
            this.provider.onStateChanged(() => this.stateChangedHandler);
        }
    }
    /**
     * Gets weather this provider can be used in this environment
     *
     * @readonly
     * @type {boolean}
     * @memberof MgtBaseProvider
     */
    get isAvailable() {
        return true;
    }
    /**
     * Invoked when the element is first updated. Implement to perform one time
     * work on the element after update.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    firstUpdated(changedProperties) {
        super.firstUpdated(changedProperties);
        let higherPriority = false;
        if (this.dependsOn) {
            let higherPriorityProvider = this.dependsOn;
            while (higherPriorityProvider) {
                if (higherPriorityProvider.isAvailable) {
                    higherPriority = true;
                    break;
                }
                higherPriorityProvider = higherPriorityProvider.dependsOn;
            }
        }
        if (!higherPriority && this.isAvailable) {
            this.initializeProvider();
        }
    }
    /**
     * method called to initialize the provider. Each derived class should provide
     * their own implementation
     *
     * @protected
     * @memberof MgtBaseProvider
     */
    // tslint:disable-next-line: no-empty
    initializeProvider() { }
    stateChangedHandler() {
        this.fireCustomEvent('onStateChanged', this.provider.state);
    }
}
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'depends-on',
        converter: newValue => {
            return document.querySelector(newValue);
        },
        type: String
    }),
    __metadata("design:type", MgtBaseProvider)
], MgtBaseProvider.prototype, "dependsOn", void 0);
//# sourceMappingURL=baseProvider.js.map

/***/ }),

/***/ "7xDs":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/telemetry/TelemetryConstants.js ***!
  \******************************************************************************************************************/
/*! exports provided: EVENT_NAME_PREFIX, EVENT_NAME_KEY, START_TIME_KEY, ELAPSED_TIME_KEY, TELEMETRY_BLOB_EVENT_NAMES, TENANT_PLACEHOLDER */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_NAME_PREFIX", function() { return EVENT_NAME_PREFIX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_NAME_KEY", function() { return EVENT_NAME_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "START_TIME_KEY", function() { return START_TIME_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ELAPSED_TIME_KEY", function() { return ELAPSED_TIME_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TELEMETRY_BLOB_EVENT_NAMES", function() { return TELEMETRY_BLOB_EVENT_NAMES; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TENANT_PLACEHOLDER", function() { return TENANT_PLACEHOLDER; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
var EVENT_NAME_PREFIX = "msal.";
var EVENT_NAME_KEY = "event_name";
var START_TIME_KEY = "start_time";
var ELAPSED_TIME_KEY = "elapsed_time";
var TELEMETRY_BLOB_EVENT_NAMES = {
    MsalCorrelationIdConstStrKey: "Microsoft.MSAL.correlation_id",
    ApiTelemIdConstStrKey: "msal.api_telem_id",
    ApiIdConstStrKey: "msal.api_id",
    BrokerAppConstStrKey: "Microsoft_MSAL_broker_app",
    CacheEventCountConstStrKey: "Microsoft_MSAL_cache_event_count",
    HttpEventCountTelemetryBatchKey: "Microsoft_MSAL_http_event_count",
    IdpConstStrKey: "Microsoft_MSAL_idp",
    IsSilentTelemetryBatchKey: "",
    IsSuccessfulConstStrKey: "Microsoft_MSAL_is_successful",
    ResponseTimeConstStrKey: "Microsoft_MSAL_response_time",
    TenantIdConstStrKey: "Microsoft_MSAL_tenant_id",
    UiEventCountTelemetryBatchKey: "Microsoft_MSAL_ui_event_count"
};
// This is used to replace the real tenant in telemetry info
var TENANT_PLACEHOLDER = "<tenant>";
//# sourceMappingURL=TelemetryConstants.js.map

/***/ }),

/***/ "859E":
/*!************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/error/ClientAuthError.js ***!
  \************************************************************************************************/
/*! exports provided: ClientAuthErrorMessage, ClientAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientAuthErrorMessage", function() { return ClientAuthErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientAuthError", function() { return ClientAuthError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuthError */ "a+UN");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StringUtils */ "Ft/c");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



var ClientAuthErrorMessage = {
    multipleCacheAuthorities: {
        code: "multiple_authorities",
        desc: "Multiple authorities found in the cache. Pass authority in the API overload."
    },
    endpointResolutionError: {
        code: "endpoints_resolution_error",
        desc: "Error: could not resolve endpoints. Please check network and try again."
    },
    popUpWindowError: {
        code: "popup_window_error",
        desc: "Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."
    },
    tokenRenewalError: {
        code: "token_renewal_error",
        desc: "Token renewal operation failed due to timeout."
    },
    invalidIdToken: {
        code: "invalid_id_token",
        desc: "Invalid ID token format."
    },
    invalidStateError: {
        code: "invalid_state_error",
        desc: "Invalid state."
    },
    nonceMismatchError: {
        code: "nonce_mismatch_error",
        desc: "Nonce is not matching, Nonce received: "
    },
    loginProgressError: {
        code: "login_progress_error",
        desc: "Login_In_Progress: Error during login call - login is already in progress."
    },
    acquireTokenProgressError: {
        code: "acquiretoken_progress_error",
        desc: "AcquireToken_In_Progress: Error during login call - login is already in progress."
    },
    userCancelledError: {
        code: "user_cancelled",
        desc: "User cancelled the flow."
    },
    callbackError: {
        code: "callback_error",
        desc: "Error occurred in token received callback function."
    },
    userLoginRequiredError: {
        code: "user_login_error",
        desc: "User login is required. For silent calls, request must contain either sid or login_hint"
    },
    userDoesNotExistError: {
        code: "user_non_existent",
        desc: "User object does not exist. Please call a login API."
    },
    clientInfoDecodingError: {
        code: "client_info_decoding_error",
        desc: "The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."
    },
    clientInfoNotPopulatedError: {
        code: "client_info_not_populated_error",
        desc: "The service did not populate client_info in the response, Please verify with the service team"
    },
    nullOrEmptyIdToken: {
        code: "null_or_empty_id_token",
        desc: "The idToken is null or empty. Please review the trace to determine the root cause."
    },
    idTokenNotParsed: {
        code: "id_token_parsing_error",
        desc: "ID token cannot be parsed. Please review stack trace to determine root cause."
    },
    tokenEncodingError: {
        code: "token_encoding_error",
        desc: "The token to be decoded is not encoded correctly."
    },
    invalidInteractionType: {
        code: "invalid_interaction_type",
        desc: "The interaction type passed to the handler was incorrect or unknown"
    },
    cacheParseError: {
        code: "cannot_parse_cache",
        desc: "The cached token key is not a valid JSON and cannot be parsed"
    },
    blockTokenRequestsInHiddenIframe: {
        code: "block_token_requests",
        desc: "Token calls are blocked in hidden iframes"
    }
};
/**
 * Error thrown when there is an error in the client code running on the browser.
 */
var ClientAuthError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ClientAuthError, _super);
    function ClientAuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ClientAuthError";
        Object.setPrototypeOf(_this, ClientAuthError.prototype);
        return _this;
    }
    ClientAuthError.createEndpointResolutionError = function (errDetail) {
        var errorMessage = ClientAuthErrorMessage.endpointResolutionError.desc;
        if (errDetail && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(errDetail)) {
            errorMessage += " Details: " + errDetail;
        }
        return new ClientAuthError(ClientAuthErrorMessage.endpointResolutionError.code, errorMessage);
    };
    ClientAuthError.createMultipleAuthoritiesInCacheError = function (scope) {
        return new ClientAuthError(ClientAuthErrorMessage.multipleCacheAuthorities.code, "Cache error for scope " + scope + ": " + ClientAuthErrorMessage.multipleCacheAuthorities.desc + ".");
    };
    ClientAuthError.createPopupWindowError = function (errDetail) {
        var errorMessage = ClientAuthErrorMessage.popUpWindowError.desc;
        if (errDetail && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(errDetail)) {
            errorMessage += " Details: " + errDetail;
        }
        return new ClientAuthError(ClientAuthErrorMessage.popUpWindowError.code, errorMessage);
    };
    ClientAuthError.createTokenRenewalTimeoutError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.tokenRenewalError.code, ClientAuthErrorMessage.tokenRenewalError.desc);
    };
    ClientAuthError.createInvalidIdTokenError = function (idToken) {
        return new ClientAuthError(ClientAuthErrorMessage.invalidIdToken.code, ClientAuthErrorMessage.invalidIdToken.desc + " Given token: " + idToken);
    };
    // TODO: Is this not a security flaw to send the user the state expected??
    ClientAuthError.createInvalidStateError = function (invalidState, actualState) {
        return new ClientAuthError(ClientAuthErrorMessage.invalidStateError.code, ClientAuthErrorMessage.invalidStateError.desc + " " + invalidState + ", state expected : " + actualState + ".");
    };
    // TODO: Is this not a security flaw to send the user the Nonce expected??
    ClientAuthError.createNonceMismatchError = function (invalidNonce, actualNonce) {
        return new ClientAuthError(ClientAuthErrorMessage.nonceMismatchError.code, ClientAuthErrorMessage.nonceMismatchError.desc + " " + invalidNonce + ", nonce expected : " + actualNonce + ".");
    };
    ClientAuthError.createLoginInProgressError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.loginProgressError.code, ClientAuthErrorMessage.loginProgressError.desc);
    };
    ClientAuthError.createAcquireTokenInProgressError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.acquireTokenProgressError.code, ClientAuthErrorMessage.acquireTokenProgressError.desc);
    };
    ClientAuthError.createUserCancelledError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userCancelledError.code, ClientAuthErrorMessage.userCancelledError.desc);
    };
    ClientAuthError.createErrorInCallbackFunction = function (errorDesc) {
        return new ClientAuthError(ClientAuthErrorMessage.callbackError.code, ClientAuthErrorMessage.callbackError.desc + " " + errorDesc + ".");
    };
    ClientAuthError.createUserLoginRequiredError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userLoginRequiredError.code, ClientAuthErrorMessage.userLoginRequiredError.desc);
    };
    ClientAuthError.createUserDoesNotExistError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userDoesNotExistError.code, ClientAuthErrorMessage.userDoesNotExistError.desc);
    };
    ClientAuthError.createClientInfoDecodingError = function (caughtError) {
        return new ClientAuthError(ClientAuthErrorMessage.clientInfoDecodingError.code, ClientAuthErrorMessage.clientInfoDecodingError.desc + " Failed with error: " + caughtError);
    };
    ClientAuthError.createClientInfoNotPopulatedError = function (caughtError) {
        return new ClientAuthError(ClientAuthErrorMessage.clientInfoNotPopulatedError.code, ClientAuthErrorMessage.clientInfoNotPopulatedError.desc + " Failed with error: " + caughtError);
    };
    ClientAuthError.createIdTokenNullOrEmptyError = function (invalidRawTokenString) {
        return new ClientAuthError(ClientAuthErrorMessage.nullOrEmptyIdToken.code, ClientAuthErrorMessage.nullOrEmptyIdToken.desc + " Raw ID Token Value: " + invalidRawTokenString);
    };
    ClientAuthError.createIdTokenParsingError = function (caughtParsingError) {
        return new ClientAuthError(ClientAuthErrorMessage.idTokenNotParsed.code, ClientAuthErrorMessage.idTokenNotParsed.desc + " Failed with error: " + caughtParsingError);
    };
    ClientAuthError.createTokenEncodingError = function (incorrectlyEncodedToken) {
        return new ClientAuthError(ClientAuthErrorMessage.tokenEncodingError.code, ClientAuthErrorMessage.tokenEncodingError.desc + " Attempted to decode: " + incorrectlyEncodedToken);
    };
    ClientAuthError.createInvalidInteractionTypeError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.invalidInteractionType.code, ClientAuthErrorMessage.invalidInteractionType.desc);
    };
    ClientAuthError.createCacheParseError = function (key) {
        var errorMessage = "invalid key: " + key + ", " + ClientAuthErrorMessage.cacheParseError.desc;
        return new ClientAuthError(ClientAuthErrorMessage.cacheParseError.code, errorMessage);
    };
    ClientAuthError.createBlockTokenRequestsInHiddenIframeError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.code, ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.desc);
    };
    return ClientAuthError;
}(_AuthError__WEBPACK_IMPORTED_MODULE_1__["AuthError"]));

//# sourceMappingURL=ClientAuthError.js.map

/***/ }),

/***/ "8Crj":
/*!************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/sub-components/mgt-flyout/mgt-flyout.js ***!
  \************************************************************************************************************/
/*! exports provided: MgtFlyout */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtFlyout", function() { return MgtFlyout; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var _utils_WindowSegmentHelpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/WindowSegmentHelpers */ "yFpm");
/* harmony import */ var _mgt_flyout_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mgt-flyout-css */ "e54M");
/* harmony import */ var _microsoft_mgt_element___WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @microsoft/mgt-element/ */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





/**
 * A component to create flyout anchored to an element
 *
 * @export
 * @class MgtFlyout
 * @extends {LitElement}
 */
let MgtFlyout = class MgtFlyout extends _microsoft_mgt_element___WEBPACK_IMPORTED_MODULE_4__["MgtBaseComponent"] {
    constructor() {
        super();
        // Minimum distance to render from window edge
        this._edgePadding = 24;
        // if the flyout is opened once, this will keep the flyout in the dom
        this._renderedOnce = false;
        this.avoidHidingAnchor = true;
        this.handleWindowEvent = this.handleWindowEvent.bind(this);
        this.handleResize = this.handleResize.bind(this);
        this.handleKeyUp = this.handleKeyUp.bind(this);
        // handling when person-card is expanded and size changes
        this.addEventListener('expanded', () => {
            window.requestAnimationFrame(() => {
                this.updateFlyout();
            });
        });
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_flyout_css__WEBPACK_IMPORTED_MODULE_3__["styles"];
    }
    /**
     * Gets or sets whether the flyout is visible
     *
     * @type {string}
     * @memberof MgtFlyout
     */
    get isOpen() {
        return this._isOpen;
    }
    set isOpen(value) {
        const oldValue = this._isOpen;
        if (oldValue === value) {
            return;
        }
        this._isOpen = value;
        window.requestAnimationFrame(() => {
            this.setupWindowEvents(this.isOpen);
            const flyout = this._flyout;
            if (!this.isOpen && flyout) {
                // reset style for next update
                flyout.style.width = null;
                flyout.style.setProperty('--mgt-flyout-set-width', null);
                flyout.style.height = null;
                flyout.style.top = null;
                flyout.style.left = null;
                flyout.style.bottom = null;
            }
        });
        this.requestUpdate('isOpen', oldValue);
        this.dispatchEvent(new Event(value ? 'opened' : 'closed'));
    }
    get _flyout() {
        return this.renderRoot.querySelector('.flyout');
    }
    get _anchor() {
        return this.renderRoot.querySelector('.anchor');
    }
    /**
     * Show the flyout.
     */
    open() {
        this.isOpen = true;
    }
    /**
     * Close the flyout.
     */
    close() {
        this.isOpen = false;
    }
    /**
     * Invoked each time the custom element is disconnected from the document's DOM
     *
     * @memberof MgtFlyout
     */
    disconnectedCallback() {
        this.setupWindowEvents(false);
        super.disconnectedCallback();
    }
    /**
     * Invoked whenever the element is updated. Implement to perform
     * post-updating tasks via DOM APIs, for example, focusing an element.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * @param changedProperties Map of changed properties with old values
     */
    updated(changedProps) {
        super.updated(changedProps);
        window.requestAnimationFrame(() => {
            this.updateFlyout();
        });
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        const flyoutClasses = {
            dir: this.direction,
            root: true,
            visible: this.isOpen
        };
        const anchorTemplate = this.renderAnchor();
        let flyoutTemplate = null;
        if (this.isOpen || this._renderedOnce) {
            this._renderedOnce = true;
            flyoutTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="flyout" @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(flyoutClasses)}>
        <div class="anchor">
          ${anchorTemplate}
        </div>
        ${flyoutTemplate}
      </div>
    `;
    }
    /**
     * Renders the anchor content.
     *
     * @protected
     * @returns
     * @memberof MgtFlyout
     */
    renderAnchor() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <slot></slot>
    `;
    }
    /**
     * Renders the flyout.
     */
    renderFlyout() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <slot name="flyout"></slot>
    `;
    }
    updateFlyout() {
        if (!this.isOpen) {
            return;
        }
        const anchor = this._anchor;
        const flyout = this._flyout;
        if (flyout && anchor) {
            const windowWidth = window.innerWidth && document.documentElement.clientWidth
                ? Math.min(window.innerWidth, document.documentElement.clientWidth)
                : window.innerWidth || document.documentElement.clientWidth;
            const windowHeight = window.innerHeight && document.documentElement.clientHeight
                ? Math.min(window.innerHeight, document.documentElement.clientHeight)
                : window.innerHeight || document.documentElement.clientHeight;
            let left = 0;
            let bottom;
            let top = 0;
            let height;
            let width;
            const flyoutRect = flyout.getBoundingClientRect();
            const anchorRect = anchor.getBoundingClientRect();
            const windowRect = {
                height: windowHeight,
                left: 0,
                top: 0,
                width: windowWidth
            };
            if (Object(_utils_WindowSegmentHelpers__WEBPACK_IMPORTED_MODULE_2__["isWindowSegmentAware"])()) {
                const segmentAwareWindow = Object(_utils_WindowSegmentHelpers__WEBPACK_IMPORTED_MODULE_2__["getSegmentAwareWindow"])();
                const screenSegments = segmentAwareWindow.getWindowSegments();
                let anchorSegment;
                const anchorCenterX = anchorRect.left + anchorRect.width / 2;
                const anchorCenterY = anchorRect.top + anchorRect.height / 2;
                for (const segment of screenSegments) {
                    if (anchorCenterX >= segment.left && anchorCenterY >= segment.top) {
                        anchorSegment = segment;
                        break;
                    }
                }
                if (anchorSegment) {
                    windowRect.left = anchorSegment.left;
                    windowRect.top = anchorSegment.top;
                    windowRect.width = anchorSegment.width;
                    windowRect.height = anchorSegment.height;
                }
            }
            if (flyoutRect.width + 2 * this._edgePadding > windowRect.width) {
                if (flyoutRect.width > windowRect.width) {
                    // flyout is wider than the window
                    width = windowRect.width;
                    left = 0;
                }
                else {
                    // center in between
                    left = (windowRect.width - flyoutRect.width) / 2;
                }
            }
            else if (anchorRect.left + flyoutRect.width + this._edgePadding > windowRect.width) {
                // it will render off screen to the right, move to the left
                left = anchorRect.left - (anchorRect.left + flyoutRect.width + this._edgePadding - windowRect.width);
            }
            else if (anchorRect.left < this._edgePadding) {
                // it will render off screen to the left, move to the right
                left = this._edgePadding;
            }
            else {
                left = anchorRect.left;
            }
            if (flyoutRect.height + 2 * this._edgePadding > windowRect.height) {
                if (flyoutRect.height >= windowRect.height) {
                    height = windowRect.height;
                    top = 0;
                }
                else {
                    top = (windowRect.height - flyoutRect.height) / 2;
                }
            }
            else if (this.avoidHidingAnchor &&
                anchorRect.top + anchorRect.height + flyoutRect.height + this._edgePadding > windowRect.height &&
                anchorRect.top - flyoutRect.height - this._edgePadding > 0) {
                if (windowRect.height - anchorRect.top + flyoutRect.height < 0) {
                    bottom = windowRect.height - flyoutRect.height - this._edgePadding;
                }
                else {
                    bottom = Math.max(windowRect.height - anchorRect.top, this._edgePadding);
                }
            }
            else {
                if (anchorRect.top + anchorRect.height + flyoutRect.height + this._edgePadding > windowRect.height) {
                    // it will render offscreen bellow, move it up a bit
                    top = windowRect.height - flyoutRect.height - this._edgePadding;
                }
                else {
                    top = Math.max(anchorRect.top + anchorRect.height, this._edgePadding);
                }
            }
            if (this.direction === 'rtl') {
                if (left > 100 && this.offsetLeft > 100) {
                    // potentially anchored to right side (for non people-picker flyout)
                    flyout.style.left = `${windowRect.width - left + flyoutRect.left - flyoutRect.width - 30}px`;
                }
            }
            else {
                flyout.style.left = `${left + windowRect.left}px`;
            }
            if (typeof bottom !== 'undefined') {
                flyout.style.top = 'unset';
                flyout.style.bottom = `${bottom}px`;
            }
            else {
                flyout.style.bottom = 'unset';
                flyout.style.top = `${top + windowRect.top}px`;
            }
            flyout.style.height = height ? `${height}px` : null;
            if (width) {
                // if we had to set the width, recalculate since the height could have changed
                flyout.style.width = `${width}px`;
                flyout.style.setProperty('--mgt-flyout-set-width', `${width}px`);
                window.requestAnimationFrame(() => this.updateFlyout());
            }
        }
    }
    setupWindowEvents(isOpen) {
        if (isOpen && this.isLightDismiss) {
            window.addEventListener('wheel', this.handleWindowEvent);
            window.addEventListener('pointerdown', this.handleWindowEvent);
            window.addEventListener('resize', this.handleResize);
            window.addEventListener('keyup', this.handleKeyUp);
        }
        else {
            window.removeEventListener('wheel', this.handleWindowEvent);
            window.removeEventListener('pointerdown', this.handleWindowEvent);
            window.removeEventListener('resize', this.handleResize);
            window.removeEventListener('keyup', this.handleKeyUp);
        }
    }
    handleWindowEvent(e) {
        const flyout = this._flyout;
        if (flyout) {
            // IE
            if (!e.composedPath) {
                let currentElem = e.target;
                while (currentElem) {
                    currentElem = currentElem.parentElement;
                    if (currentElem === flyout || (e.type === 'pointerdown' && currentElem === this)) {
                        return;
                    }
                }
            }
            else {
                const path = e.composedPath();
                if (path.includes(flyout) || (e.type === 'pointerdown' && path.includes(this))) {
                    return;
                }
            }
        }
        this.close();
    }
    handleResize(e) {
        this.close();
    }
    handleKeyUp(e) {
        if (e.key === 'Escape') {
            this.close();
        }
    }
    handleFlyoutWheel(e) {
        e.preventDefault();
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'light-dismiss',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtFlyout.prototype, "isLightDismiss", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: null,
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtFlyout.prototype, "avoidHidingAnchor", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'isOpen',
        type: Boolean
    }),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], MgtFlyout.prototype, "isOpen", null);
MgtFlyout = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-flyout'),
    __metadata("design:paramtypes", [])
], MgtFlyout);

//# sourceMappingURL=mgt-flyout.js.map

/***/ }),

/***/ "8P3k":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/UrlUtils.js ***!
  \*****************************************************************************************/
/*! exports provided: UrlUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UrlUtils", function() { return UrlUtils; });
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Constants */ "vFME");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ScopeSet */ "mb9z");
/* harmony import */ var _StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./StringUtils */ "Ft/c");
/* harmony import */ var _CryptoUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./CryptoUtils */ "qD3l");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




/**
 * @hidden
 */
var UrlUtils = /** @class */ (function () {
    function UrlUtils() {
    }
    /**
     * generates the URL with QueryString Parameters
     * @param scopes
     */
    UrlUtils.createNavigateUrl = function (serverRequestParams) {
        var str = this.createNavigationUrlString(serverRequestParams);
        var authEndpoint = serverRequestParams.authorityInstance.AuthorizationEndpoint;
        // if the endpoint already has queryparams, lets add to it, otherwise add the first one
        if (authEndpoint.indexOf("?") < 0) {
            authEndpoint += "?";
        }
        else {
            authEndpoint += "&";
        }
        var requestUrl = "" + authEndpoint + str.join("&");
        return requestUrl;
    };
    /**
     * Generate the array of all QueryStringParams to be sent to the server
     * @param scopes
     */
    UrlUtils.createNavigationUrlString = function (serverRequestParams) {
        var scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_1__["ScopeSet"].appendDefaultScopes(serverRequestParams.scopes);
        var str = [];
        str.push("response_type=" + serverRequestParams.responseType);
        str.push("scope=" + encodeURIComponent(_ScopeSet__WEBPACK_IMPORTED_MODULE_1__["ScopeSet"].parseScope(scopes)));
        str.push("client_id=" + encodeURIComponent(serverRequestParams.clientId));
        str.push("redirect_uri=" + encodeURIComponent(serverRequestParams.redirectUri));
        str.push("state=" + encodeURIComponent(serverRequestParams.state));
        str.push("nonce=" + encodeURIComponent(serverRequestParams.nonce));
        str.push("client_info=1");
        str.push("x-client-SKU=" + serverRequestParams.xClientSku);
        str.push("x-client-Ver=" + serverRequestParams.xClientVer);
        if (serverRequestParams.promptValue) {
            str.push("prompt=" + encodeURIComponent(serverRequestParams.promptValue));
        }
        if (serverRequestParams.claimsValue) {
            str.push("claims=" + encodeURIComponent(serverRequestParams.claimsValue));
        }
        if (serverRequestParams.queryParameters) {
            str.push(serverRequestParams.queryParameters);
        }
        if (serverRequestParams.extraQueryParameters) {
            str.push(serverRequestParams.extraQueryParameters);
        }
        str.push("client-request-id=" + encodeURIComponent(serverRequestParams.correlationId));
        return str;
    };
    /**
     * Returns current window URL as redirect uri
     */
    UrlUtils.getCurrentUrl = function () {
        return window.location.href.split("?")[0].split("#")[0];
    };
    /**
     * Returns given URL with query string removed
     */
    UrlUtils.removeHashFromUrl = function (url) {
        return url.split("#")[0];
    };
    /**
     * Given a url like https://a:b/common/d?e=f#g, and a tenantId, returns https://a:b/tenantId/d
     * @param href The url
     * @param tenantId The tenant id to replace
     */
    UrlUtils.replaceTenantPath = function (url, tenantId) {
        var lowerCaseUrl = url.toLowerCase();
        var urlObject = this.GetUrlComponents(lowerCaseUrl);
        var pathArray = urlObject.PathSegments;
        if (tenantId && (pathArray.length !== 0 && (pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["Constants"].common || pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["SSOTypes"].ORGANIZATIONS))) {
            pathArray[0] = tenantId;
        }
        return this.constructAuthorityUriFromObject(urlObject, pathArray);
    };
    UrlUtils.constructAuthorityUriFromObject = function (urlObject, pathArray) {
        return this.CanonicalizeUri(urlObject.Protocol + "//" + urlObject.HostNameAndPort + "/" + pathArray.join("/"));
    };
    /**
     * Checks if an authority is common (ex. https://a:b/common/)
     * @param url The url
     * @returns true if authority is common and false otherwise
     */
    UrlUtils.isCommonAuthority = function (url) {
        var authority = this.CanonicalizeUri(url);
        var pathArray = this.GetUrlComponents(authority).PathSegments;
        return (pathArray.length !== 0 && pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["Constants"].common);
    };
    /**
     * Checks if an authority is for organizations (ex. https://a:b/organizations/)
     * @param url The url
     * @returns true if authority is for  and false otherwise
     */
    UrlUtils.isOrganizationsAuthority = function (url) {
        var authority = this.CanonicalizeUri(url);
        var pathArray = this.GetUrlComponents(authority).PathSegments;
        return (pathArray.length !== 0 && pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["SSOTypes"].ORGANIZATIONS);
    };
    /**
     * Parses out the components from a url string.
     * @returns An object with the various components. Please cache this value insted of calling this multiple times on the same url.
     */
    UrlUtils.GetUrlComponents = function (url) {
        if (!url) {
            throw "Url required";
        }
        // https://gist.github.com/curtisz/11139b2cfcaef4a261e0
        var regEx = RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");
        var match = url.match(regEx);
        if (!match || match.length < 6) {
            throw "Valid url required";
        }
        var urlComponents = {
            Protocol: match[1],
            HostNameAndPort: match[4],
            AbsolutePath: match[5]
        };
        var pathSegments = urlComponents.AbsolutePath.split("/");
        pathSegments = pathSegments.filter(function (val) { return val && val.length > 0; }); // remove empty elements
        urlComponents.PathSegments = pathSegments;
        if (match[6]) {
            urlComponents.Search = match[6];
        }
        if (match[8]) {
            urlComponents.Hash = match[8];
        }
        return urlComponents;
    };
    /**
     * Given a url or path, append a trailing slash if one doesnt exist
     *
     * @param url
     */
    UrlUtils.CanonicalizeUri = function (url) {
        if (url) {
            url = url.toLowerCase();
        }
        if (url && !UrlUtils.endsWith(url, "/")) {
            url += "/";
        }
        return url;
    };
    /**
     * Checks to see if the url ends with the suffix
     * Required because we are compiling for es5 instead of es6
     * @param url
     * @param str
     */
    // TODO: Rename this, not clear what it is supposed to do
    UrlUtils.endsWith = function (url, suffix) {
        if (!url || !suffix) {
            return false;
        }
        return url.indexOf(suffix, url.length - suffix.length) !== -1;
    };
    /**
     * Utils function to remove the login_hint and domain_hint from the i/p extraQueryParameters
     * @param url
     * @param name
     */
    UrlUtils.urlRemoveQueryStringParameter = function (url, name) {
        if (_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(url)) {
            return url;
        }
        var regex = new RegExp("(\\&" + name + "=)[^\&]+");
        url = url.replace(regex, "");
        // name=value&
        regex = new RegExp("(" + name + "=)[^\&]+&");
        url = url.replace(regex, "");
        // name=value
        regex = new RegExp("(" + name + "=)[^\&]+");
        url = url.replace(regex, "");
        return url;
    };
    /**
     * @hidden
     * @ignore
     *
     * Returns the anchor part(#) of the URL
     */
    UrlUtils.getHashFromUrl = function (urlStringOrFragment) {
        var hashIndex1 = urlStringOrFragment.indexOf("#");
        var hashIndex2 = urlStringOrFragment.indexOf("#/");
        if (hashIndex2 > -1) {
            return urlStringOrFragment.substring(hashIndex2 + 2);
        }
        else if (hashIndex1 > -1) {
            return urlStringOrFragment.substring(hashIndex1 + 1);
        }
        return urlStringOrFragment;
    };
    /**
     * @hidden
     * Check if the url contains a hash with known properties
     * @ignore
     */
    UrlUtils.urlContainsHash = function (urlString) {
        var parameters = UrlUtils.deserializeHash(urlString);
        return (parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ERROR_DESCRIPTION) ||
            parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ERROR) ||
            parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ACCESS_TOKEN) ||
            parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ID_TOKEN));
    };
    /**
     * @hidden
     * Returns deserialized portion of URL hash
     * @ignore
     */
    UrlUtils.deserializeHash = function (urlFragment) {
        var hash = UrlUtils.getHashFromUrl(urlFragment);
        return _CryptoUtils__WEBPACK_IMPORTED_MODULE_3__["CryptoUtils"].deserialize(hash);
    };
    /**
     * @ignore
     * @param {string} URI
     * @returns {string} host from the URI
     *
     * extract URI from the host
     */
    UrlUtils.getHostFromUri = function (uri) {
        // remove http:// or https:// from uri
        var extractedUri = String(uri).replace(/^(https?:)\/\//, "");
        extractedUri = extractedUri.split("/")[0];
        return extractedUri;
    };
    return UrlUtils;
}());

//# sourceMappingURL=UrlUtils.js.map

/***/ }),

/***/ "8hzC":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-contact/strings.js ***!
  \********************************************************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    contactSectionTitle: 'Contact'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "8oxB":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),

/***/ "8w1o":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/TokenUtils.js ***!
  \*******************************************************************************************/
/*! exports provided: TokenUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TokenUtils", function() { return TokenUtils; });
/* harmony import */ var _CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CryptoUtils */ "qD3l");
/* harmony import */ var _StringUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./StringUtils */ "Ft/c");
/* harmony import */ var _TimeUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TimeUtils */ "h916");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * @hidden
 */
var TokenUtils = /** @class */ (function () {
    function TokenUtils() {
    }
    /**
     * decode a JWT
     *
     * @param jwtToken
     */
    TokenUtils.decodeJwt = function (jwtToken) {
        if (_StringUtils__WEBPACK_IMPORTED_MODULE_1__["StringUtils"].isEmpty(jwtToken)) {
            return null;
        }
        var idTokenPartsRegex = /^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/;
        var matches = idTokenPartsRegex.exec(jwtToken);
        if (!matches || matches.length < 4) {
            // this._requestContext.logger.warn("The returned id_token is not parseable.");
            return null;
        }
        var crackedToken = {
            header: matches[1],
            JWSPayload: matches[2],
            JWSSig: matches[3]
        };
        return crackedToken;
    };
    /**
     * Evaluates whether token cache item expiration is within expiration offset range
     * @param tokenCacheItem
     */
    TokenUtils.validateExpirationIsWithinOffset = function (expiration, tokenRenewalOffsetSeconds) {
        var offset = tokenRenewalOffsetSeconds || 300;
        return expiration && (expiration > _TimeUtils__WEBPACK_IMPORTED_MODULE_2__["TimeUtils"].now() + offset);
    };
    /**
     * Extract IdToken by decoding the RAWIdToken
     *
     * @param encodedIdToken
     */
    TokenUtils.extractIdToken = function (encodedIdToken) {
        // id token will be decoded to get the username
        var decodedToken = this.decodeJwt(encodedIdToken);
        if (!decodedToken) {
            return null;
        }
        try {
            var base64IdToken = decodedToken.JWSPayload;
            var base64Decoded = _CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Decode(base64IdToken);
            if (!base64Decoded) {
                // this._requestContext.logger.info("The returned id_token could not be base64 url safe decoded.");
                return null;
            }
            // ECMA script has JSON built-in support
            return JSON.parse(base64Decoded);
        }
        catch (err) {
            // this._requestContext.logger.error("The returned id_token could not be decoded" + err);
        }
        return null;
    };
    return TokenUtils;
}());

//# sourceMappingURL=TokenUtils.js.map

/***/ }),

/***/ "8z1x":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/BasePersonCardSection.js ***!
  \**********************************************************************************************************************/
/*! exports provided: BasePersonCardSection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BasePersonCardSection", function() { return BasePersonCardSection; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _sub_components_mgt_spinner_mgt_spinner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sub-components/mgt-spinner/mgt-spinner */ "Jics");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



/**
 * A base class for building person card subsections.
 *
 * @export
 * @class BasePersonCardSection
 * @extends {MgtTemplatedComponent}
 */
class BasePersonCardSection extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["MgtTemplatedComponent"] {
    constructor() {
        super();
        this._isCompact = false;
        this._personDetails = null;
    }
    /**
     * Set the person details to render
     *
     * @type {IDynamicPerson}
     * @memberof BasePersonCardSection
     */
    get personDetails() {
        return this._personDetails;
    }
    set personDetails(value) {
        if (this._personDetails === value) {
            return;
        }
        this._personDetails = value;
        this.requestStateUpdate();
    }
    /**
     * Determines the appropriate view state: full or compact
     *
     * @protected
     * @type {boolean}
     * @memberof BasePersonCardSection
     */
    get isCompact() {
        return this._isCompact;
    }
    /**
     * Set the section to compact view mode
     *
     * @returns
     * @memberof BasePersonCardSection
     */
    asCompactView() {
        this._isCompact = true;
        this.requestUpdate();
        return this;
    }
    /**
     * Set the section to full view mode
     *
     * @returns
     * @memberof BasePersonCardSection
     */
    asFullView() {
        this._isCompact = false;
        this.requestUpdate();
        return this;
    }
    /**
     * Reset any state in the section
     *
     * @protected
     * @abstract
     * @memberof BasePersonCardSection
     */
    // tslint:disable-next-line:no-empty
    clearState() { }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        return this.isCompact ? this.renderCompactView() : this.renderFullView();
    }
    /**
     * Render a spinner while the component loads state
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof BasePersonCardSection
     */
    renderLoading() {
        return lit_element__WEBPACK_IMPORTED_MODULE_1__["html"] `
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `;
    }
    /**
     * Render the section in a empty data state
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardContact
     */
    renderNoData() {
        return lit_element__WEBPACK_IMPORTED_MODULE_1__["html"] `
      <div class="no-data">No data</div>
    `;
    }
    /**
     * Navigate the card to a different user.
     *
     * @protected
     * @memberof BasePersonCardSection
     */
    navigateCard(person) {
        // Search for card parent and update it's personDetails object
        let parent = this.parentNode;
        while (parent) {
            parent = parent.parentNode;
            if (parent && parent.host && parent.host.tagName === 'MGT-PERSON-CARD') {
                parent = parent.host;
                break;
            }
        }
        const personCard = parent;
        personCard.navigate(person);
    }
}
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_1__["property"])({
        attribute: 'person-details',
        type: Object
    }),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], BasePersonCardSection.prototype, "personDetails", null);
//# sourceMappingURL=BasePersonCardSection.js.map

/***/ }),

/***/ "9F8r":
/*!************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/index.js ***!
  \************************************************************************************************************/
/*! exports provided: BatchRequestContent, BatchResponseContent, AuthenticationHandler, HTTPMessageHandler, RetryHandler, RedirectHandler, TelemetryHandler, MiddlewareFactory, AuthenticationHandlerOptions, RetryHandlerOptions, RedirectHandlerOptions, FeatureUsageFlag, TelemetryHandlerOptions, ChaosHandlerOptions, ChaosStrategy, ChaosHandler, LargeFileUploadTask, OneDriveLargeFileUploadTask, PageIterator, Client, CustomAuthenticationProvider, GraphError, GraphRequest, ImplicitMSALAuthenticationProvider, MSALAuthenticationProviderOptions, ResponseType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _content_BatchRequestContent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./content/BatchRequestContent */ "4GfR");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchRequestContent", function() { return _content_BatchRequestContent__WEBPACK_IMPORTED_MODULE_0__["BatchRequestContent"]; });

/* harmony import */ var _content_BatchResponseContent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./content/BatchResponseContent */ "6ISa");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchResponseContent", function() { return _content_BatchResponseContent__WEBPACK_IMPORTED_MODULE_1__["BatchResponseContent"]; });

/* harmony import */ var _middleware_AuthenticationHandler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./middleware/AuthenticationHandler */ "WEFG");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AuthenticationHandler", function() { return _middleware_AuthenticationHandler__WEBPACK_IMPORTED_MODULE_2__["AuthenticationHandler"]; });

/* harmony import */ var _middleware_HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./middleware/HTTPMessageHandler */ "ehPe");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HTTPMessageHandler", function() { return _middleware_HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_3__["HTTPMessageHandler"]; });

/* harmony import */ var _middleware_RetryHandler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./middleware/RetryHandler */ "1pLI");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RetryHandler", function() { return _middleware_RetryHandler__WEBPACK_IMPORTED_MODULE_4__["RetryHandler"]; });

/* harmony import */ var _middleware_RedirectHandler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./middleware/RedirectHandler */ "rQCx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RedirectHandler", function() { return _middleware_RedirectHandler__WEBPACK_IMPORTED_MODULE_5__["RedirectHandler"]; });

/* harmony import */ var _middleware_TelemetryHandler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./middleware/TelemetryHandler */ "13ek");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TelemetryHandler", function() { return _middleware_TelemetryHandler__WEBPACK_IMPORTED_MODULE_6__["TelemetryHandler"]; });

/* harmony import */ var _middleware_MiddlewareFactory__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./middleware/MiddlewareFactory */ "S3To");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MiddlewareFactory", function() { return _middleware_MiddlewareFactory__WEBPACK_IMPORTED_MODULE_7__["MiddlewareFactory"]; });

/* harmony import */ var _middleware_options_AuthenticationHandlerOptions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./middleware/options/AuthenticationHandlerOptions */ "QoAq");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AuthenticationHandlerOptions", function() { return _middleware_options_AuthenticationHandlerOptions__WEBPACK_IMPORTED_MODULE_8__["AuthenticationHandlerOptions"]; });

/* harmony import */ var _middleware_options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./middleware/options/RetryHandlerOptions */ "Eakl");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RetryHandlerOptions", function() { return _middleware_options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_9__["RetryHandlerOptions"]; });

/* harmony import */ var _middleware_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./middleware/options/RedirectHandlerOptions */ "Ytee");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RedirectHandlerOptions", function() { return _middleware_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_10__["RedirectHandlerOptions"]; });

/* harmony import */ var _middleware_options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./middleware/options/TelemetryHandlerOptions */ "Rgfv");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FeatureUsageFlag", function() { return _middleware_options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_11__["FeatureUsageFlag"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TelemetryHandlerOptions", function() { return _middleware_options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_11__["TelemetryHandlerOptions"]; });

/* harmony import */ var _middleware_options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./middleware/options/ChaosHandlerOptions */ "lgJW");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ChaosHandlerOptions", function() { return _middleware_options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_12__["ChaosHandlerOptions"]; });

/* harmony import */ var _middleware_options_ChaosStrategy__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./middleware/options/ChaosStrategy */ "WJ2Y");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ChaosStrategy", function() { return _middleware_options_ChaosStrategy__WEBPACK_IMPORTED_MODULE_13__["ChaosStrategy"]; });

/* harmony import */ var _middleware_ChaosHandler__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./middleware/ChaosHandler */ "v0JY");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ChaosHandler", function() { return _middleware_ChaosHandler__WEBPACK_IMPORTED_MODULE_14__["ChaosHandler"]; });

/* harmony import */ var _tasks_LargeFileUploadTask__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./tasks/LargeFileUploadTask */ "E94R");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LargeFileUploadTask", function() { return _tasks_LargeFileUploadTask__WEBPACK_IMPORTED_MODULE_15__["LargeFileUploadTask"]; });

/* harmony import */ var _tasks_OneDriveLargeFileUploadTask__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./tasks/OneDriveLargeFileUploadTask */ "h1MS");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OneDriveLargeFileUploadTask", function() { return _tasks_OneDriveLargeFileUploadTask__WEBPACK_IMPORTED_MODULE_16__["OneDriveLargeFileUploadTask"]; });

/* harmony import */ var _tasks_PageIterator__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./tasks/PageIterator */ "2WXZ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageIterator", function() { return _tasks_PageIterator__WEBPACK_IMPORTED_MODULE_17__["PageIterator"]; });

/* harmony import */ var _Client__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Client */ "+O9S");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Client", function() { return _Client__WEBPACK_IMPORTED_MODULE_18__["Client"]; });

/* harmony import */ var _CustomAuthenticationProvider__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./CustomAuthenticationProvider */ "3/+1");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CustomAuthenticationProvider", function() { return _CustomAuthenticationProvider__WEBPACK_IMPORTED_MODULE_19__["CustomAuthenticationProvider"]; });

/* harmony import */ var _GraphError__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./GraphError */ "3gtU");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GraphError", function() { return _GraphError__WEBPACK_IMPORTED_MODULE_20__["GraphError"]; });

/* harmony import */ var _GraphRequest__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./GraphRequest */ "T1gI");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GraphRequest", function() { return _GraphRequest__WEBPACK_IMPORTED_MODULE_21__["GraphRequest"]; });

/* harmony import */ var _ImplicitMSALAuthenticationProvider__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./ImplicitMSALAuthenticationProvider */ "djkT");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImplicitMSALAuthenticationProvider", function() { return _ImplicitMSALAuthenticationProvider__WEBPACK_IMPORTED_MODULE_22__["ImplicitMSALAuthenticationProvider"]; });

/* harmony import */ var _MSALAuthenticationProviderOptions__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./MSALAuthenticationProviderOptions */ "GqWT");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MSALAuthenticationProviderOptions", function() { return _MSALAuthenticationProviderOptions__WEBPACK_IMPORTED_MODULE_23__["MSALAuthenticationProviderOptions"]; });

/* harmony import */ var _ResponseType__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./ResponseType */ "LrMb");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResponseType", function() { return _ResponseType__WEBPACK_IMPORTED_MODULE_24__["ResponseType"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

























//# sourceMappingURL=index.js.map

/***/ }),

/***/ "9FZN":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/authority/TrustedAuthority.js ***!
  \***********************************************************************************************************/
/*! exports provided: TrustedAuthority */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TrustedAuthority", function() { return TrustedAuthority; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _XHRClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../XHRClient */ "Pich");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/Constants */ "/pXG");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/UrlUtils */ "j0B3");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var TrustedAuthority = /** @class */ (function () {
    function TrustedAuthority() {
    }
    /**
     *
     * @param validateAuthority
     * @param knownAuthorities
     */
    TrustedAuthority.setTrustedAuthoritiesFromConfig = function (validateAuthority, knownAuthorities) {
        if (validateAuthority && !this.getTrustedHostList().length) {
            knownAuthorities.forEach(function (authority) {
                TrustedAuthority.TrustedHostList.push(authority.toLowerCase());
            });
        }
    };
    /**
     *
     * @param telemetryManager
     * @param correlationId
     */
    TrustedAuthority.getAliases = function (authorityToVerify, telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, httpMethod, instanceDiscoveryEndpoint, httpEvent;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                client = new _XHRClient__WEBPACK_IMPORTED_MODULE_1__["XhrClient"]();
                httpMethod = _utils_Constants__WEBPACK_IMPORTED_MODULE_2__["NetworkRequestType"].GET;
                instanceDiscoveryEndpoint = "" + _utils_Constants__WEBPACK_IMPORTED_MODULE_2__["AAD_INSTANCE_DISCOVERY_ENDPOINT"] + authorityToVerify + "oauth2/v2.0/authorize";
                httpEvent = telemetryManager.createAndStartHttpEvent(correlationId, httpMethod, instanceDiscoveryEndpoint, "getAliases");
                return [2 /*return*/, client.sendRequestAsync(instanceDiscoveryEndpoint, httpMethod, true)
                        .then(function (response) {
                        httpEvent.httpResponseStatus = response.statusCode;
                        telemetryManager.stopEvent(httpEvent);
                        return response.body.metadata;
                    })
                        .catch(function (err) {
                        httpEvent.serverErrorCode = err;
                        telemetryManager.stopEvent(httpEvent);
                        throw err;
                    })];
            });
        });
    };
    /**
     *
     * @param telemetryManager
     * @param correlationId
     */
    TrustedAuthority.setTrustedAuthoritiesFromNetwork = function (authorityToVerify, telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var metadata, host;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.getAliases(authorityToVerify, telemetryManager, correlationId)];
                    case 1:
                        metadata = _a.sent();
                        metadata.forEach(function (entry) {
                            var authorities = entry.aliases;
                            authorities.forEach(function (authority) {
                                TrustedAuthority.TrustedHostList.push(authority.toLowerCase());
                            });
                        });
                        host = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].GetUrlComponents(authorityToVerify).HostNameAndPort;
                        if (TrustedAuthority.getTrustedHostList().length && !TrustedAuthority.IsInTrustedHostList(host)) {
                            // Custom Domain scenario, host is trusted because Instance Discovery call succeeded
                            TrustedAuthority.TrustedHostList.push(host.toLowerCase());
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    TrustedAuthority.getTrustedHostList = function () {
        return this.TrustedHostList;
    };
    /**
     * Checks to see if the host is in a list of trusted hosts
     * @param host
     */
    TrustedAuthority.IsInTrustedHostList = function (host) {
        return this.TrustedHostList.indexOf(host.toLowerCase()) > -1;
    };
    TrustedAuthority.TrustedHostList = [];
    return TrustedAuthority;
}());

//# sourceMappingURL=TrustedAuthority.js.map

/***/ }),

/***/ "9Xmr":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/cache/AccessTokenCacheItem.js ***!
  \*****************************************************************************************************/
/*! exports provided: AccessTokenCacheItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccessTokenCacheItem", function() { return AccessTokenCacheItem; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var AccessTokenCacheItem = /** @class */ (function () {
    function AccessTokenCacheItem(key, value) {
        this.key = key;
        this.value = value;
    }
    return AccessTokenCacheItem;
}());

//# sourceMappingURL=AccessTokenCacheItem.js.map

/***/ }),

/***/ "9eIZ":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/cache/AccessTokenKey.js ***!
  \**********************************************************************************************************/
/*! exports provided: AccessTokenKey */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccessTokenKey", function() { return AccessTokenKey; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/CryptoUtils */ "oish");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/UrlUtils */ "6r4W");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * @hidden
 */
var AccessTokenKey = /** @class */ (function () {
    function AccessTokenKey(authority, clientId, scopes, uid, utid) {
        this.authority = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].CanonicalizeUri(authority);
        this.clientId = clientId;
        this.scopes = scopes;
        this.homeAccountIdentifier = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(uid) + "." + _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(utid);
    }
    return AccessTokenKey;
}());

//# sourceMappingURL=AccessTokenKey.js.map

/***/ }),

/***/ "9mdp":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/HTTPClientFactory.js ***!
  \************************************************************************************************************************/
/*! exports provided: HTTPClientFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(process) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTPClientFactory", function() { return HTTPClientFactory; });
/* harmony import */ var _HTTPClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./HTTPClient */ "h8e6");
/* harmony import */ var _middleware_AuthenticationHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./middleware/AuthenticationHandler */ "WEFG");
/* harmony import */ var _middleware_HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./middleware/HTTPMessageHandler */ "ehPe");
/* harmony import */ var _middleware_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./middleware/options/RedirectHandlerOptions */ "Ytee");
/* harmony import */ var _middleware_options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./middleware/options/RetryHandlerOptions */ "Eakl");
/* harmony import */ var _middleware_RedirectHandler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./middleware/RedirectHandler */ "rQCx");
/* harmony import */ var _middleware_RetryHandler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./middleware/RetryHandler */ "1pLI");
/* harmony import */ var _middleware_TelemetryHandler__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./middleware/TelemetryHandler */ "13ek");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module HTTPClientFactory
 */








/**
 * @private
 * To check whether the environment is node or not
 * @returns A boolean representing the environment is node or not
 */
const isNodeEnvironment = () => {
    return typeof process === "object" && "function" === "function";
};
/**
 * @class
 * Class representing HTTPClientFactory
 */
class HTTPClientFactory {
    /**
     * @public
     * @static
     * Creates HTTPClient with default middleware chain
     * @param {AuthenticationProvider} authProvider - The authentication provider instance
     * @returns A HTTPClient instance
     *
     * NOTE: These are the things that we need to remember while doing modifications in the below default pipeline.
     * 		* HTTPMessageHander should be the last one in the middleware pipeline, because this makes the actual network call of the request
     * 		* TelemetryHandler should be the one prior to the last middleware in the chain, because this is the one which actually collects and appends the usage flag and placing this handler 	*		  before making the actual network call ensures that the usage of all features are recorded in the flag.
     * 		* The best place for AuthenticationHandler is in the starting of the pipeline, because every other handler might have to work for multiple times for a request but the auth token for
     * 		  them will remain same. For example, Retry and Redirect handlers might be working multiple times for a request based on the response but their auth token would remain same.
     */
    static createWithAuthenticationProvider(authProvider) {
        const authenticationHandler = new _middleware_AuthenticationHandler__WEBPACK_IMPORTED_MODULE_1__["AuthenticationHandler"](authProvider);
        const retryHandler = new _middleware_RetryHandler__WEBPACK_IMPORTED_MODULE_6__["RetryHandler"](new _middleware_options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RetryHandlerOptions"]());
        const telemetryHandler = new _middleware_TelemetryHandler__WEBPACK_IMPORTED_MODULE_7__["TelemetryHandler"]();
        const httpMessageHandler = new _middleware_HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_2__["HTTPMessageHandler"]();
        authenticationHandler.setNext(retryHandler);
        if (isNodeEnvironment()) {
            const redirectHandler = new _middleware_RedirectHandler__WEBPACK_IMPORTED_MODULE_5__["RedirectHandler"](new _middleware_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_3__["RedirectHandlerOptions"]());
            retryHandler.setNext(redirectHandler);
            redirectHandler.setNext(telemetryHandler);
        }
        else {
            retryHandler.setNext(telemetryHandler);
        }
        telemetryHandler.setNext(httpMessageHandler);
        return HTTPClientFactory.createWithMiddleware(authenticationHandler);
    }
    /**
     * @public
     * @static
     * Creates a middleware chain with the given one
     * @property {...Middleware} middleware - The first middleware of the middleware chain or a sequence of all the Middleware handlers
     * @returns A HTTPClient instance
     */
    static createWithMiddleware(...middleware) {
        // Middleware should not empty or undefined. This is check is present in the HTTPClient constructor.
        return new _HTTPClient__WEBPACK_IMPORTED_MODULE_0__["HTTPClient"](...middleware);
    }
}
//# sourceMappingURL=HTTPClientFactory.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../../../process/browser.js */ "8oxB")))

/***/ }),

/***/ "A+Uu":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/Configuration.js ***!
  \***************************************************************************************************/
/*! exports provided: buildConfiguration */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "buildConfiguration", function() { return buildConfiguration; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Logger */ "FT8K");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/UrlUtils */ "6r4W");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * Defaults for the Configuration Options
 */
var FRAME_TIMEOUT = 6000;
var OFFSET = 300;
var NAVIGATE_FRAME_WAIT = 500;
var DEFAULT_AUTH_OPTIONS = {
    clientId: "",
    authority: null,
    validateAuthority: true,
    authorityMetadata: "",
    knownAuthorities: [],
    redirectUri: function () { return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__["UrlUtils"].getCurrentUrl(); },
    postLogoutRedirectUri: function () { return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__["UrlUtils"].getCurrentUrl(); },
    navigateToLoginRequestUrl: true
};
var DEFAULT_CACHE_OPTIONS = {
    cacheLocation: "sessionStorage",
    storeAuthStateInCookie: false
};
var DEFAULT_SYSTEM_OPTIONS = {
    logger: new _Logger__WEBPACK_IMPORTED_MODULE_1__["Logger"](null),
    loadFrameTimeout: FRAME_TIMEOUT,
    tokenRenewalOffsetSeconds: OFFSET,
    navigateFrameWait: NAVIGATE_FRAME_WAIT
};
var DEFAULT_FRAMEWORK_OPTIONS = {
    isAngular: false,
    unprotectedResources: new Array(),
    protectedResourceMap: new Map()
};
/**
 * MSAL function that sets the default options when not explicitly configured from app developer
 *
 * @param TAuthOptions
 * @param TCacheOptions
 * @param TSystemOptions
 * @param TFrameworkOptions
 * @param TAuthorityDataOptions
 *
 * @returns TConfiguration object
 */
function buildConfiguration(_a) {
    var auth = _a.auth, _b = _a.cache, cache = _b === void 0 ? {} : _b, _c = _a.system, system = _c === void 0 ? {} : _c, _d = _a.framework, framework = _d === void 0 ? {} : _d;
    var overlayedConfig = {
        auth: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_AUTH_OPTIONS, auth),
        cache: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_CACHE_OPTIONS, cache),
        system: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_SYSTEM_OPTIONS, system),
        framework: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_FRAMEWORK_OPTIONS, framework)
    };
    return overlayedConfig;
}
//# sourceMappingURL=Configuration.js.map

/***/ }),

/***/ "ARSx":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/cache/BrowserStorage.js ***!
  \*****************************************************************************************************/
/*! exports provided: BrowserStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BrowserStorage", function() { return BrowserStorage; });
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "SRUK");
/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../error/AuthError */ "UrvO");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * @hidden
 */
var BrowserStorage = /** @class */ (function () {
    function BrowserStorage(cacheLocation) {
        if (!window) {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_1__["AuthError"].createNoWindowObjectError("Browser storage class could not find window object");
        }
        var storageSupported = typeof window[cacheLocation] !== "undefined" && window[cacheLocation] != null;
        if (!storageSupported) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createStorageNotSupportedError(cacheLocation);
        }
        this.cacheLocation = cacheLocation;
    }
    /**
     * add value to storage
     * @param key
     * @param value
     * @param enableCookieStorage
     */
    BrowserStorage.prototype.setItem = function (key, value, enableCookieStorage) {
        window[this.cacheLocation].setItem(key, value);
        if (enableCookieStorage) {
            this.setItemCookie(key, value);
        }
    };
    /**
     * get one item by key from storage
     * @param key
     * @param enableCookieStorage
     */
    BrowserStorage.prototype.getItem = function (key, enableCookieStorage) {
        if (enableCookieStorage && this.getItemCookie(key)) {
            return this.getItemCookie(key);
        }
        return window[this.cacheLocation].getItem(key);
    };
    /**
     * remove value from storage
     * @param key
     */
    BrowserStorage.prototype.removeItem = function (key) {
        return window[this.cacheLocation].removeItem(key);
    };
    /**
     * clear storage (remove all items from it)
     */
    BrowserStorage.prototype.clear = function () {
        return window[this.cacheLocation].clear();
    };
    /**
     * add value to cookies
     * @param cName
     * @param cValue
     * @param expires
     */
    BrowserStorage.prototype.setItemCookie = function (cName, cValue, expires) {
        var cookieStr = cName + "=" + cValue + ";path=/;";
        if (expires) {
            var expireTime = this.getCookieExpirationTime(expires);
            cookieStr += "expires=" + expireTime + ";";
        }
        document.cookie = cookieStr;
    };
    /**
     * get one item by key from cookies
     * @param cName
     */
    BrowserStorage.prototype.getItemCookie = function (cName) {
        var name = cName + "=";
        var ca = document.cookie.split(";");
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) === " ") {
                c = c.substring(1);
            }
            if (c.indexOf(name) === 0) {
                return c.substring(name.length, c.length);
            }
        }
        return "";
    };
    /**
     * Clear an item in the cookies by key
     * @param cName
     */
    BrowserStorage.prototype.clearItemCookie = function (cName) {
        this.setItemCookie(cName, "", -1);
    };
    /**
     * Get cookie expiration time
     * @param cookieLifeDays
     */
    BrowserStorage.prototype.getCookieExpirationTime = function (cookieLifeDays) {
        var today = new Date();
        var expr = new Date(today.getTime() + cookieLifeDays * 24 * 60 * 60 * 1000);
        return expr.toUTCString();
    };
    return BrowserStorage;
}());

//# sourceMappingURL=BrowserStorage.js.map

/***/ }),

/***/ "AUyD":
/*!***********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-proxy-provider/dist/es6/mgt-proxy-provider.js ***!
  \***********************************************************************************/
/*! exports provided: MgtProxyProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtProxyProvider", function() { return MgtProxyProvider; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _ProxyProvider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ProxyProvider */ "M4Ox");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



/**
 * Authentication component for ProxyProvider
 *
 * @export
 * @class MgtProxyProvider
 * @extends {LitElement}
 */
let MgtProxyProvider = class MgtProxyProvider extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["MgtBaseProvider"] {
    /**
     * Gets whether this provider can be used in this environment
     *
     * @readonly
     * @memberof MgtMsalProvider
     */
    get isAvailable() {
        return true;
    }
    /**
     * method called to initialize the provider. Each derived class should provide their own implementation.
     *
     * @protected
     * @memberof MgtProxyProvider
     */
    initializeProvider() {
        if (this.graphProxyUrl !== undefined) {
            this.provider = new _ProxyProvider__WEBPACK_IMPORTED_MODULE_2__["ProxyProvider"](this.graphProxyUrl);
            _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["Providers"].globalProvider = this.provider;
        }
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'graph-proxy-url' }),
    __metadata("design:type", String)
], MgtProxyProvider.prototype, "graphProxyUrl", void 0);
MgtProxyProvider = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-proxy-provider')
], MgtProxyProvider);

//# sourceMappingURL=mgt-proxy-provider.js.map

/***/ }),

/***/ "AWSq":
/*!***********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-teams-provider/dist/es6/mgt-teams-provider.js ***!
  \***********************************************************************************/
/*! exports provided: MgtTeamsProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtTeamsProvider", function() { return MgtTeamsProvider; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _TeamsProvider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TeamsProvider */ "Yol3");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



/**
 * Authentication Library Provider for Microsoft Teams accounts
 *
 * @export
 * @class MgtTeamsProvider
 * @extends {MgtBaseProvider}
 */
let MgtTeamsProvider = class MgtTeamsProvider extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["MgtBaseProvider"] {
    constructor() {
        super(...arguments);
        /**
         * String alphanumerical value relation to a specific user
         *
         * @memberof MgtTeamsProvider
         */
        this.clientId = '';
        /**
         * The relative or absolute path of the html page that will handle the authentication
         *
         * @memberof MgtTeamsProvider
         */
        this.authPopupUrl = '';
    }
    /**
     * Gets whether this provider can be used in this environment
     *
     * @readonly
     * @memberof MgtTeamsProvider
     */
    get isAvailable() {
        return _TeamsProvider__WEBPACK_IMPORTED_MODULE_2__["TeamsProvider"].isAvailable;
    }
    /**
     * method called to initialize the provider. Each derived class should provide their own implementation
     *
     * @protected
     * @memberof MgtTeamsProvider
     */
    initializeProvider() {
        if (this.clientId && this.authPopupUrl) {
            const config = {
                authPopupUrl: this.authPopupUrl,
                clientId: this.clientId
            };
            if (this.scopes) {
                const scope = this.scopes.split(',');
                if (scope && scope.length > 0) {
                    config.scopes = scope;
                }
            }
            if (this.authority) {
                const msalConfig = {
                    auth: {
                        authority: this.authority,
                        clientId: this.clientId
                    }
                };
                config.msalOptions = msalConfig;
            }
            this.provider = new _TeamsProvider__WEBPACK_IMPORTED_MODULE_2__["TeamsProvider"](config);
            _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["Providers"].globalProvider = this.provider;
        }
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'client-id',
        type: String
    }),
    __metadata("design:type", Object)
], MgtTeamsProvider.prototype, "clientId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'auth-popup-url',
        type: String
    }),
    __metadata("design:type", Object)
], MgtTeamsProvider.prototype, "authPopupUrl", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Object)
], MgtTeamsProvider.prototype, "authority", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'scopes',
        type: String
    }),
    __metadata("design:type", Object)
], MgtTeamsProvider.prototype, "scopes", void 0);
MgtTeamsProvider = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-teams-provider')
], MgtTeamsProvider);

//# sourceMappingURL=mgt-teams-provider.js.map

/***/ }),

/***/ "AaG5":
/*!*******************************************!*\
  !*** ./node_modules/lit-html/lit-html.js ***!
  \*******************************************/
/*! exports provided: DefaultTemplateProcessor, defaultTemplateProcessor, directive, isDirective, removeNodes, reparentNodes, noChange, nothing, AttributeCommitter, AttributePart, BooleanAttributePart, EventPart, isIterable, isPrimitive, NodePart, PropertyCommitter, PropertyPart, parts, render, templateCaches, templateFactory, TemplateInstance, SVGTemplateResult, TemplateResult, createMarker, isTemplatePartActive, Template, html, svg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "html", function() { return html; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "svg", function() { return svg; });
/* harmony import */ var _lib_default_template_processor_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./lib/default-template-processor.js */ "0Fh4");
/* harmony import */ var _lib_template_result_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./lib/template-result.js */ "GMCd");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DefaultTemplateProcessor", function() { return _lib_default_template_processor_js__WEBPACK_IMPORTED_MODULE_0__["DefaultTemplateProcessor"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "defaultTemplateProcessor", function() { return _lib_default_template_processor_js__WEBPACK_IMPORTED_MODULE_0__["defaultTemplateProcessor"]; });

/* harmony import */ var _lib_directive_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/directive.js */ "eByC");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "directive", function() { return _lib_directive_js__WEBPACK_IMPORTED_MODULE_2__["directive"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isDirective", function() { return _lib_directive_js__WEBPACK_IMPORTED_MODULE_2__["isDirective"]; });

/* harmony import */ var _lib_dom_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./lib/dom.js */ "tFPJ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "removeNodes", function() { return _lib_dom_js__WEBPACK_IMPORTED_MODULE_3__["removeNodes"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "reparentNodes", function() { return _lib_dom_js__WEBPACK_IMPORTED_MODULE_3__["reparentNodes"]; });

/* harmony import */ var _lib_part_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./lib/part.js */ "1VLE");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "noChange", function() { return _lib_part_js__WEBPACK_IMPORTED_MODULE_4__["noChange"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "nothing", function() { return _lib_part_js__WEBPACK_IMPORTED_MODULE_4__["nothing"]; });

/* harmony import */ var _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./lib/parts.js */ "XI78");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AttributeCommitter", function() { return _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__["AttributeCommitter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AttributePart", function() { return _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__["AttributePart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BooleanAttributePart", function() { return _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__["BooleanAttributePart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EventPart", function() { return _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__["EventPart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isIterable", function() { return _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__["isIterable"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isPrimitive", function() { return _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__["isPrimitive"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NodePart", function() { return _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__["NodePart"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PropertyCommitter", function() { return _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__["PropertyCommitter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PropertyPart", function() { return _lib_parts_js__WEBPACK_IMPORTED_MODULE_5__["PropertyPart"]; });

/* harmony import */ var _lib_render_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./lib/render.js */ "wmha");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "parts", function() { return _lib_render_js__WEBPACK_IMPORTED_MODULE_6__["parts"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _lib_render_js__WEBPACK_IMPORTED_MODULE_6__["render"]; });

/* harmony import */ var _lib_template_factory_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./lib/template-factory.js */ "PqmH");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "templateCaches", function() { return _lib_template_factory_js__WEBPACK_IMPORTED_MODULE_7__["templateCaches"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "templateFactory", function() { return _lib_template_factory_js__WEBPACK_IMPORTED_MODULE_7__["templateFactory"]; });

/* harmony import */ var _lib_template_instance_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./lib/template-instance.js */ "6unr");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TemplateInstance", function() { return _lib_template_instance_js__WEBPACK_IMPORTED_MODULE_8__["TemplateInstance"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SVGTemplateResult", function() { return _lib_template_result_js__WEBPACK_IMPORTED_MODULE_1__["SVGTemplateResult"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TemplateResult", function() { return _lib_template_result_js__WEBPACK_IMPORTED_MODULE_1__["TemplateResult"]; });

/* harmony import */ var _lib_template_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./lib/template.js */ "4yuk");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createMarker", function() { return _lib_template_js__WEBPACK_IMPORTED_MODULE_9__["createMarker"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isTemplatePartActive", function() { return _lib_template_js__WEBPACK_IMPORTED_MODULE_9__["isTemplatePartActive"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Template", function() { return _lib_template_js__WEBPACK_IMPORTED_MODULE_9__["Template"]; });

/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 *
 * Main lit-html module.
 *
 * Main exports:
 *
 * -  [[html]]
 * -  [[svg]]
 * -  [[render]]
 *
 * @packageDocumentation
 */
/**
 * Do not remove this comment; it keeps typedoc from misplacing the module
 * docs.
 */




// TODO(justinfagnani): remove line when we get NodePart moving methods








// IMPORTANT: do not change the property name or the assignment expression.
// This line will be used in regexes to search for lit-html usage.
// TODO(justinfagnani): inject version number at build time
if (typeof window !== 'undefined') {
    (window['litHtmlVersions'] || (window['litHtmlVersions'] = [])).push('1.3.0');
}
/**
 * Interprets a template literal as an HTML template that can efficiently
 * render to and update a container.
 */
const html = (strings, ...values) => new _lib_template_result_js__WEBPACK_IMPORTED_MODULE_1__["TemplateResult"](strings, values, 'html', _lib_default_template_processor_js__WEBPACK_IMPORTED_MODULE_0__["defaultTemplateProcessor"]);
/**
 * Interprets a template literal as an SVG template that can efficiently
 * render to and update a container.
 */
const svg = (strings, ...values) => new _lib_template_result_js__WEBPACK_IMPORTED_MODULE_1__["SVGTemplateResult"](strings, values, 'svg', _lib_default_template_processor_js__WEBPACK_IMPORTED_MODULE_0__["defaultTemplateProcessor"]);
//# sourceMappingURL=lit-html.js.map

/***/ }),

/***/ "AvGg":
/*!****************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-profile/mgt-person-card-profile-css.js ***!
  \****************************************************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:16px;color:var(--title-color-sub2,#797775)}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-direction:row;flex-wrap:wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--background-color-sub2,#f3f2f1);border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item:hover{color:var(--color-sub1,#323130)}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--color-sub2,#797775);margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--title-color-subtitle,#323130)}:host .root .data-list__item .data-list__item__date-range{color:var(--color-sub2,#797775);font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#0078d4}:host .root .work-position .work-position__location{font-size:10px;color:var(--color-sub2,#797775);line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--color-sub3,#979593)}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--color-sub1,#323130)}[dir=rtl] .token-list__item{margin-right:0!important}
`
];
//# sourceMappingURL=mgt-person-card-profile-css.js.map

/***/ }),

/***/ "B52y":
/*!***************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/Logger.js ***!
  \***************************************************************************************/
/*! exports provided: LogLevel, Logger */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LogLevel", function() { return LogLevel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Logger", function() { return Logger; });
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/StringUtils */ "k+Uk");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ "/pXG");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var LogLevel;
(function (LogLevel) {
    LogLevel[LogLevel["Error"] = 0] = "Error";
    LogLevel[LogLevel["Warning"] = 1] = "Warning";
    LogLevel[LogLevel["Info"] = 2] = "Info";
    LogLevel[LogLevel["Verbose"] = 3] = "Verbose";
})(LogLevel || (LogLevel = {}));
var Logger = /** @class */ (function () {
    function Logger(localCallback, options) {
        if (options === void 0) { options = {}; }
        /**
         * @hidden
         */
        this.level = LogLevel.Info;
        var _a = options.correlationId, correlationId = _a === void 0 ? "" : _a, _b = options.level, level = _b === void 0 ? LogLevel.Info : _b, _c = options.piiLoggingEnabled, piiLoggingEnabled = _c === void 0 ? false : _c;
        this.localCallback = localCallback;
        this.correlationId = correlationId;
        this.level = level;
        this.piiLoggingEnabled = piiLoggingEnabled;
    }
    /**
     * @hidden
     */
    Logger.prototype.logMessage = function (logLevel, logMessage, containsPii) {
        if ((logLevel > this.level) || (!this.piiLoggingEnabled && containsPii)) {
            return;
        }
        var timestamp = new Date().toUTCString();
        var log;
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_0__["StringUtils"].isEmpty(this.correlationId)) {
            log = timestamp + ":" + this.correlationId + "-" + Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["libraryVersion"])() + "-" + LogLevel[logLevel] + (containsPii ? "-pii" : "") + " " + logMessage;
        }
        else {
            log = timestamp + ":" + Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["libraryVersion"])() + "-" + LogLevel[logLevel] + (containsPii ? "-pii" : "") + " " + logMessage;
        }
        this.executeCallback(logLevel, log, containsPii);
    };
    /**
     * @hidden
     */
    Logger.prototype.executeCallback = function (level, message, containsPii) {
        if (this.localCallback) {
            this.localCallback(level, message, containsPii);
        }
    };
    /**
     * @hidden
     */
    Logger.prototype.error = function (message) {
        this.logMessage(LogLevel.Error, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.errorPii = function (message) {
        this.logMessage(LogLevel.Error, message, true);
    };
    /**
     * @hidden
     */
    Logger.prototype.warning = function (message) {
        this.logMessage(LogLevel.Warning, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.warningPii = function (message) {
        this.logMessage(LogLevel.Warning, message, true);
    };
    /**
     * @hidden
     */
    Logger.prototype.info = function (message) {
        this.logMessage(LogLevel.Info, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.infoPii = function (message) {
        this.logMessage(LogLevel.Info, message, true);
    };
    /**
     * @hidden
     */
    Logger.prototype.verbose = function (message) {
        this.logMessage(LogLevel.Verbose, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.verbosePii = function (message) {
        this.logMessage(LogLevel.Verbose, message, true);
    };
    Logger.prototype.isPiiLoggingEnabled = function () {
        return this.piiLoggingEnabled;
    };
    return Logger;
}());

//# sourceMappingURL=Logger.js.map

/***/ }),

/***/ "BKw3":
/*!****************************************!*\
  !*** external "SpfxMgtWebPartStrings" ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_BKw3__;

/***/ }),

/***/ "BZLG":
/*!****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-todo/strings.js ***!
  \****************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    cancelNewTaskSubtitle: 'cancel',
    newTaskPlaceholder: 'Task...',
    addTaskButtonSubtitle: 'Add',
    removeTaskSubtitle: 'Delete Task'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "Blta":
/*!****************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/Constants.js ***!
  \****************************************************************************/
/*! exports provided: GRAPH_API_VERSION, GRAPH_BASE_URL, GRAPH_URLS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GRAPH_API_VERSION", function() { return GRAPH_API_VERSION; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GRAPH_BASE_URL", function() { return GRAPH_BASE_URL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GRAPH_URLS", function() { return GRAPH_URLS; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module Constants
 */
/**
 * @constant
 * A Default API endpoint version for a request
 */
const GRAPH_API_VERSION = "v1.0";
/**
 * @constant
 * A Default base url for a request
 */
const GRAPH_BASE_URL = "https://graph.microsoft.com/";
/**
 * To hold list of the service root endpoints for Microsoft Graph and Graph Explorer for each national cloud.
 * Set(iterable:Object) is not supported in Internet Explorer. The consumer is recommended to use a suitable polyfill.
 */
const GRAPH_URLS = new Set(["graph.microsoft.com", "graph.microsoft.us", "dod-graph.microsoft.us", "graph.microsoft.de", "microsoftgraph.chinacloudapi.cn"]);
//# sourceMappingURL=Constants.js.map

/***/ }),

/***/ "BoDS":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/telemetry/ApiEvent.js ***!
  \********************************************************************************************************/
/*! exports provided: EVENT_KEYS, API_CODE, API_EVENT_IDENTIFIER, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_KEYS", function() { return EVENT_KEYS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "API_CODE", function() { return API_CODE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "API_EVENT_IDENTIFIER", function() { return API_EVENT_IDENTIFIER; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryEvent */ "aklA");
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryConstants */ "7xDs");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TelemetryUtils */ "E5LX");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
var _a;




var EVENT_KEYS = {
    AUTHORITY: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("authority"),
    AUTHORITY_TYPE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("authority_type"),
    PROMPT: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("ui_behavior"),
    TENANT_ID: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("tenant_id"),
    USER_ID: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("user_id"),
    WAS_SUCESSFUL: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("was_successful"),
    API_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("api_error_code"),
    LOGIN_HINT: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("login_hint")
};
var API_CODE;
(function (API_CODE) {
    API_CODE[API_CODE["AcquireTokenRedirect"] = 2001] = "AcquireTokenRedirect";
    API_CODE[API_CODE["AcquireTokenSilent"] = 2002] = "AcquireTokenSilent";
    API_CODE[API_CODE["AcquireTokenPopup"] = 2003] = "AcquireTokenPopup";
    API_CODE[API_CODE["LoginRedirect"] = 2004] = "LoginRedirect";
    API_CODE[API_CODE["LoginPopup"] = 2005] = "LoginPopup";
    API_CODE[API_CODE["Logout"] = 2006] = "Logout";
})(API_CODE || (API_CODE = {}));
var API_EVENT_IDENTIFIER;
(function (API_EVENT_IDENTIFIER) {
    API_EVENT_IDENTIFIER["AcquireTokenRedirect"] = "AcquireTokenRedirect";
    API_EVENT_IDENTIFIER["AcquireTokenSilent"] = "AcquireTokenSilent";
    API_EVENT_IDENTIFIER["AcquireTokenPopup"] = "AcquireTokenPopup";
    API_EVENT_IDENTIFIER["LoginRedirect"] = "LoginRedirect";
    API_EVENT_IDENTIFIER["LoginPopup"] = "LoginPopup";
    API_EVENT_IDENTIFIER["Logout"] = "Logout";
})(API_EVENT_IDENTIFIER || (API_EVENT_IDENTIFIER = {}));
var mapEventIdentiferToCode = (_a = {},
    _a[API_EVENT_IDENTIFIER.AcquireTokenSilent] = API_CODE.AcquireTokenSilent,
    _a[API_EVENT_IDENTIFIER.AcquireTokenPopup] = API_CODE.AcquireTokenPopup,
    _a[API_EVENT_IDENTIFIER.AcquireTokenRedirect] = API_CODE.AcquireTokenRedirect,
    _a[API_EVENT_IDENTIFIER.LoginPopup] = API_CODE.LoginPopup,
    _a[API_EVENT_IDENTIFIER.LoginRedirect] = API_CODE.LoginRedirect,
    _a[API_EVENT_IDENTIFIER.Logout] = API_CODE.Logout,
    _a);
var ApiEvent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ApiEvent, _super);
    function ApiEvent(correlationId, piiEnabled, apiEventIdentifier) {
        var _this = _super.call(this, Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("api_event"), correlationId, apiEventIdentifier) || this;
        if (apiEventIdentifier) {
            _this.apiCode = mapEventIdentiferToCode[apiEventIdentifier];
            _this.apiEventIdentifier = apiEventIdentifier;
        }
        _this.piiEnabled = piiEnabled;
        return _this;
    }
    Object.defineProperty(ApiEvent.prototype, "apiEventIdentifier", {
        set: function (apiEventIdentifier) {
            this.event[_TelemetryConstants__WEBPACK_IMPORTED_MODULE_2__["TELEMETRY_BLOB_EVENT_NAMES"].ApiTelemIdConstStrKey] = apiEventIdentifier;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "apiCode", {
        set: function (apiCode) {
            this.event[_TelemetryConstants__WEBPACK_IMPORTED_MODULE_2__["TELEMETRY_BLOB_EVENT_NAMES"].ApiIdConstStrKey] = apiCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "authority", {
        set: function (uri) {
            this.event[EVENT_KEYS.AUTHORITY] = Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["scrubTenantFromUri"])(uri).toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "apiErrorCode", {
        set: function (errorCode) {
            this.event[EVENT_KEYS.API_ERROR_CODE] = errorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "tenantId", {
        set: function (tenantId) {
            this.event[EVENT_KEYS.TENANT_ID] = this.piiEnabled && tenantId ?
                Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["hashPersonalIdentifier"])(tenantId)
                : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "accountId", {
        set: function (accountId) {
            this.event[EVENT_KEYS.USER_ID] = this.piiEnabled && accountId ?
                Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["hashPersonalIdentifier"])(accountId)
                : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "wasSuccessful", {
        get: function () {
            return this.event[EVENT_KEYS.WAS_SUCESSFUL] === true;
        },
        set: function (wasSuccessful) {
            this.event[EVENT_KEYS.WAS_SUCESSFUL] = wasSuccessful;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "loginHint", {
        set: function (loginHint) {
            this.event[EVENT_KEYS.LOGIN_HINT] = this.piiEnabled && loginHint ?
                Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["hashPersonalIdentifier"])(loginHint)
                : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "authorityType", {
        set: function (authorityType) {
            this.event[EVENT_KEYS.AUTHORITY_TYPE] = authorityType.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "promptType", {
        set: function (promptType) {
            this.event[EVENT_KEYS.PROMPT] = promptType.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    return ApiEvent;
}(_TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (ApiEvent);
//# sourceMappingURL=ApiEvent.js.map

/***/ }),

/***/ "Brgr":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/telemetry/ApiEvent.js ***!
  \*********************************************************************************************/
/*! exports provided: EVENT_KEYS, API_CODE, API_EVENT_IDENTIFIER, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_KEYS", function() { return EVENT_KEYS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "API_CODE", function() { return API_CODE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "API_EVENT_IDENTIFIER", function() { return API_EVENT_IDENTIFIER; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryEvent */ "ZwGo");
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryConstants */ "3gM8");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TelemetryUtils */ "yuSj");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
var _a;




var EVENT_KEYS = {
    AUTHORITY: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("authority"),
    AUTHORITY_TYPE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("authority_type"),
    PROMPT: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("ui_behavior"),
    TENANT_ID: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("tenant_id"),
    USER_ID: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("user_id"),
    WAS_SUCESSFUL: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("was_successful"),
    API_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("api_error_code"),
    LOGIN_HINT: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("login_hint")
};
var API_CODE;
(function (API_CODE) {
    API_CODE[API_CODE["AcquireTokenRedirect"] = 2001] = "AcquireTokenRedirect";
    API_CODE[API_CODE["AcquireTokenSilent"] = 2002] = "AcquireTokenSilent";
    API_CODE[API_CODE["AcquireTokenPopup"] = 2003] = "AcquireTokenPopup";
    API_CODE[API_CODE["LoginRedirect"] = 2004] = "LoginRedirect";
    API_CODE[API_CODE["LoginPopup"] = 2005] = "LoginPopup";
    API_CODE[API_CODE["Logout"] = 2006] = "Logout";
})(API_CODE || (API_CODE = {}));
var API_EVENT_IDENTIFIER;
(function (API_EVENT_IDENTIFIER) {
    API_EVENT_IDENTIFIER["AcquireTokenRedirect"] = "AcquireTokenRedirect";
    API_EVENT_IDENTIFIER["AcquireTokenSilent"] = "AcquireTokenSilent";
    API_EVENT_IDENTIFIER["AcquireTokenPopup"] = "AcquireTokenPopup";
    API_EVENT_IDENTIFIER["LoginRedirect"] = "LoginRedirect";
    API_EVENT_IDENTIFIER["LoginPopup"] = "LoginPopup";
    API_EVENT_IDENTIFIER["Logout"] = "Logout";
})(API_EVENT_IDENTIFIER || (API_EVENT_IDENTIFIER = {}));
var mapEventIdentiferToCode = (_a = {},
    _a[API_EVENT_IDENTIFIER.AcquireTokenSilent] = API_CODE.AcquireTokenSilent,
    _a[API_EVENT_IDENTIFIER.AcquireTokenPopup] = API_CODE.AcquireTokenPopup,
    _a[API_EVENT_IDENTIFIER.AcquireTokenRedirect] = API_CODE.AcquireTokenRedirect,
    _a[API_EVENT_IDENTIFIER.LoginPopup] = API_CODE.LoginPopup,
    _a[API_EVENT_IDENTIFIER.LoginRedirect] = API_CODE.LoginRedirect,
    _a[API_EVENT_IDENTIFIER.Logout] = API_CODE.Logout,
    _a);
var ApiEvent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ApiEvent, _super);
    function ApiEvent(correlationId, piiEnabled, apiEventIdentifier) {
        var _this = _super.call(this, Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("api_event"), correlationId, apiEventIdentifier) || this;
        if (apiEventIdentifier) {
            _this.apiCode = mapEventIdentiferToCode[apiEventIdentifier];
            _this.apiEventIdentifier = apiEventIdentifier;
        }
        _this.piiEnabled = piiEnabled;
        return _this;
    }
    Object.defineProperty(ApiEvent.prototype, "apiEventIdentifier", {
        set: function (apiEventIdentifier) {
            this.event[_TelemetryConstants__WEBPACK_IMPORTED_MODULE_2__["TELEMETRY_BLOB_EVENT_NAMES"].ApiTelemIdConstStrKey] = apiEventIdentifier;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "apiCode", {
        set: function (apiCode) {
            this.event[_TelemetryConstants__WEBPACK_IMPORTED_MODULE_2__["TELEMETRY_BLOB_EVENT_NAMES"].ApiIdConstStrKey] = apiCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "authority", {
        set: function (uri) {
            this.event[EVENT_KEYS.AUTHORITY] = Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["scrubTenantFromUri"])(uri).toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "apiErrorCode", {
        set: function (errorCode) {
            this.event[EVENT_KEYS.API_ERROR_CODE] = errorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "tenantId", {
        set: function (tenantId) {
            this.event[EVENT_KEYS.TENANT_ID] = this.piiEnabled && tenantId ?
                Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["hashPersonalIdentifier"])(tenantId)
                : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "accountId", {
        set: function (accountId) {
            this.event[EVENT_KEYS.USER_ID] = this.piiEnabled && accountId ?
                Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["hashPersonalIdentifier"])(accountId)
                : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "wasSuccessful", {
        get: function () {
            return this.event[EVENT_KEYS.WAS_SUCESSFUL] === true;
        },
        set: function (wasSuccessful) {
            this.event[EVENT_KEYS.WAS_SUCESSFUL] = wasSuccessful;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "loginHint", {
        set: function (loginHint) {
            this.event[EVENT_KEYS.LOGIN_HINT] = this.piiEnabled && loginHint ?
                Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["hashPersonalIdentifier"])(loginHint)
                : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "authorityType", {
        set: function (authorityType) {
            this.event[EVENT_KEYS.AUTHORITY_TYPE] = authorityType.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "promptType", {
        set: function (promptType) {
            this.event[EVENT_KEYS.PROMPT] = promptType.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    return ApiEvent;
}(_TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (ApiEvent);
//# sourceMappingURL=ApiEvent.js.map

/***/ }),

/***/ "Bw11":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-agenda/mgt-agenda.js ***!
  \*********************************************************************************************/
/*! exports provided: MgtAgenda */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtAgenda", function() { return MgtAgenda; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _styles_style_helper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../styles/style-helper */ "XyBC");
/* harmony import */ var _utils_Utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/Utils */ "vQVX");
/* harmony import */ var _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../mgt-person/mgt-person */ "lBzc");
/* harmony import */ var _mgt_agenda_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mgt-agenda-css */ "mHPW");
/* harmony import */ var _mgt_agenda_graph__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./mgt-agenda.graph */ "rwpb");
/* harmony import */ var _utils_SvgHelper__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/SvgHelper */ "FPR2");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};








/**
 * Web Component which represents events in a user or group calendar.
 *
 * @export
 * @class MgtAgenda
 * @extends {MgtTemplatedComponent}
 *
 * @fires eventClick - Fired when user click an event
 *
 * @cssprop --event-box-shadow - {String} Event box shadow color and size
 * @cssprop --event-margin - {String} Event margin
 * @cssprop --event-padding - {String} Event padding
 * @cssprop --event-background-color - {Color} Event background color
 * @cssprop --event-border - {String} Event border style
 * @cssprop --agenda-header-margin - {String} Agenda header margin size
 * @cssprop --agenda-header-font-size - {Length} Agenda header font size
 * @cssprop --agenda-header-color - {Color} Agenda header color
 * @cssprop --event-time-font-size - {Length} Event time font size
 * @cssprop --event-time-color - {Color} Event time color
 * @cssprop --event-subject-font-size - {Length} Event subject font size
 * @cssprop --event-subject-color - {Color} Event subject color
 * @cssprop --event-location-font-size - {Length} Event location font size
 * @cssprop --event-location-color - {Color} Event location color
 */
let MgtAgenda = class MgtAgenda extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["MgtTemplatedComponent"] {
    constructor() {
        super();
        this._days = 3;
        this.onResize = this.onResize.bind(this);
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_agenda_css__WEBPACK_IMPORTED_MODULE_5__["styles"];
    }
    /**
     * stores current date for initial calender selection in events.
     * @type {string}
     */
    get date() {
        return this._date;
    }
    set date(value) {
        if (this._date === value) {
            return;
        }
        this._date = value;
        this.reloadState();
    }
    /**
     * determines if agenda events come from specific group
     * @type {string}
     */
    get groupId() {
        return this._groupId;
    }
    set groupId(value) {
        if (this._groupId === value) {
            return;
        }
        this._groupId = value;
        this.reloadState();
    }
    /**
     * sets number of days until end date, 3 is the default
     * @type {number}
     */
    get days() {
        return this._days;
    }
    set days(value) {
        if (this._days === value) {
            return;
        }
        this._days = value;
        this.reloadState();
    }
    /**
     * allows developer to specify a different graph query that retrieves events
     * @type {string}
     */
    get eventQuery() {
        return this._eventQuery;
    }
    set eventQuery(value) {
        if (this._eventQuery === value) {
            return;
        }
        this._eventQuery = value;
        this.reloadState();
    }
    /**
     * allows developer to specify preferred timezone that should be used for
     * retrieving events from Graph, eg. `Pacific Standard Time`. The preferred timezone for
     * the current user can be retrieved by calling `me/mailboxSettings` and
     * retrieving the value of the `timeZone` property.
     * @type {string}
     */
    get preferredTimezone() {
        return this._preferredTimezone;
    }
    set preferredTimezone(value) {
        if (this._preferredTimezone === value) {
            return;
        }
        this._preferredTimezone = value;
        this.reloadState();
    }
    /**
     * Determines width available if resize is necessary, adds onResize event listener to window
     *
     * @memberof MgtAgenda
     */
    connectedCallback() {
        this._isNarrow = this.offsetWidth < 600;
        super.connectedCallback();
        window.addEventListener('resize', this.onResize);
    }
    /**
     * Removes onResize event listener from window
     *
     * @memberof MgtAgenda
     */
    disconnectedCallback() {
        window.removeEventListener('resize', this.onResize);
        super.disconnectedCallback();
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return a lit-html TemplateResult.
     * Setting properties inside this method will not trigger the element to update
     *
     * @returns
     * @memberof MgtAgenda
     */
    render() {
        // Loading
        if (!this.events && this.isLoadingState) {
            return this.renderLoading();
        }
        // No data
        if (!this.events || this.events.length === 0) {
            return this.renderNoData();
        }
        // Prep data
        const events = this.showMax && this.showMax > 0 ? this.events.slice(0, this.showMax) : this.events;
        // Default template
        const renderedTemplate = this.renderTemplate('default', { events });
        if (renderedTemplate) {
            return renderedTemplate;
        }
        // Update narrow state
        this._isNarrow = this.offsetWidth < 600;
        // Render list
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div dir=${this.direction} class="agenda${this._isNarrow ? ' narrow' : ''}${this.groupByDay ? ' grouped' : ''}">
        ${this.groupByDay ? this.renderGroups(events) : this.renderEvents(events)}
        ${this.isLoadingState ? this.renderLoading() : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``}
      </div>
    `;
    }
    /**
     * Reloads the component with its current settings and potential new data
     *
     * @memberof MgtAgenda
     */
    reload() {
        return __awaiter(this, void 0, void 0, function* () {
            this.events = yield this.loadEvents();
        });
    }
    /**
     * Render the loading state
     *
     * @protected
     * @returns
     * @memberof MgtAgenda
     */
    renderLoading() {
        return (this.renderTemplate('loading', null) ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="event">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </div>
      `);
    }
    /**
     * Render the no-data state.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtAgenda
     */
    renderNoData() {
        return this.renderTemplate('no-data', null) || lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
    }
    /**
     * Render an individual Event.
     *
     * @protected
     * @param {MicrosoftGraph.Event} event
     * @returns
     * @memberof MgtAgenda
     */
    renderEvent(event) {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="event">
        <div class="event-time-container">
          <div class="event-time" aria-label="${this.getEventTimeString(event)}">${this.getEventTimeString(event)}</div>
        </div>
        <div class="event-details-container">
          ${this.renderTitle(event)} ${this.renderLocation(event)} ${this.renderAttendees(event)}
        </div>
        <div class="event-other-container">${this.renderOther(event)}</div>
      </div>
    `;
        // <div class="event-duration">${this.getEventDuration(event)}</div>
    }
    /**
     * Render the header for a group.
     * Only relevant for grouped Events.
     *
     * @protected
     * @param {Date} date
     * @returns
     * @memberof MgtAgenda
     */
    renderHeader(header) {
        return (this.renderTemplate('header', { header }, 'header-' + header) ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="header" aria-label="${header}">${header}</div>
      `);
    }
    /**
     * Render the title field of an Event
     *
     * @protected
     * @param {MicrosoftGraph.Event} event
     * @returns
     * @memberof MgtAgenda
     */
    renderTitle(event) {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="event-subject">${event.subject}</div>
    `;
    }
    /**
     * Render the location field of an Event
     *
     * @protected
     * @param {MicrosoftGraph.Event} event
     * @returns
     * @memberof MgtAgenda
     */
    renderLocation(event) {
        if (!event.location.displayName) {
            return null;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="event-location-container">
        <div class="event-location-icon">${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_7__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_7__["SvgIcon"].OfficeLocation)}</div>
        <div class="event-location" aria-label="${event.location.displayName}">${event.location.displayName}</div>
      </div>
    `;
    }
    /**
     * Render the attendees field of an Event
     *
     * @protected
     * @param {MicrosoftGraph.Event} event
     * @returns
     * @memberof MgtAgenda
     */
    renderAttendees(event) {
        if (!event.attendees.length) {
            return null;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <mgt-people
        class="event-attendees"
        .peopleQueries=${event.attendees.map(attendee => {
            return attendee.emailAddress.address;
        })}
      ></mgt-people>
    `;
    }
    /**
     * Render the event other field of an Event
     *
     * @protected
     * @param {MicrosoftGraph.Event} event
     * @returns
     * @memberof MgtAgenda
     */
    renderOther(event) {
        return this.hasTemplate('event-other')
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          ${this.renderTemplate('event-other', { event }, event.id + '-other')}
        `
            : null;
    }
    /**
     * Render the events in groups, each with a header.
     *
     * @protected
     * @param {MicrosoftGraph.Event[]} events
     * @returns {TemplateResult}
     * @memberof MgtAgenda
     */
    renderGroups(events) {
        // Render list, grouped by day
        const grouped = {};
        events.forEach(event => {
            const header = this.getDateHeaderFromDateTimeString(event.start.dateTime);
            grouped[header] = grouped[header] || [];
            grouped[header].push(event);
        });
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      ${Object.keys(grouped).map(header => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="group">${this.renderHeader(header)} ${this.renderEvents(grouped[header])}</div>
          `)}
    `;
    }
    /**
     * Render a list of events.
     *
     * @protected
     * @param {MicrosoftGraph.Event[]} events
     * @returns {TemplateResult}
     * @memberof MgtAgenda
     */
    renderEvents(events) {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <ul class="agenda-list">
        ${events.map(event => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
              <li @click=${() => this.eventClicked(event)}>
                ${this.renderTemplate('event', { event }, event.id) || this.renderEvent(event)}
              </li>
            `)}
      </ul>
    `;
    }
    /**
     * Load state into the component
     *
     * @protected
     * @returns
     * @memberof MgtAgenda
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.events) {
                return;
            }
            const events = yield this.loadEvents();
            if (events && events.length > 0) {
                this.events = events;
            }
        });
    }
    reloadState() {
        return __awaiter(this, void 0, void 0, function* () {
            this.events = null;
            this.requestStateUpdate(true);
        });
    }
    onResize() {
        this._isNarrow = this.offsetWidth < 600;
    }
    eventClicked(event) {
        this.fireCustomEvent('eventClick', { event });
    }
    getEventTimeString(event) {
        if (event.isAllDay) {
            return 'ALL DAY';
        }
        const start = this.prettyPrintTimeFromDateTime(new Date(event.start.dateTime));
        const end = this.prettyPrintTimeFromDateTime(new Date(event.end.dateTime));
        return `${start} - ${end}`;
    }
    loadEvents() {
        return __awaiter(this, void 0, void 0, function* () {
            const p = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["Providers"].globalProvider;
            let events = [];
            if (p && p.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["ProviderState"].SignedIn) {
                const graph = p.graph.forComponent(this);
                if (this.eventQuery) {
                    try {
                        const tokens = this.eventQuery.split('|');
                        let scope;
                        let query;
                        if (tokens.length > 1) {
                            query = tokens[0].trim();
                            scope = tokens[1].trim();
                        }
                        else {
                            query = this.eventQuery;
                        }
                        let request = yield graph.api(query);
                        if (scope) {
                            request = request.middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["prepScopes"])(scope));
                        }
                        if (this.preferredTimezone) {
                            request = request.header('Prefer', `outlook.timezone="${this.preferredTimezone}"`);
                        }
                        const results = yield request.get();
                        if (results && results.value) {
                            events = results.value;
                        }
                        // tslint:disable-next-line: no-empty
                    }
                    catch (e) { }
                }
                else {
                    const start = this.date ? new Date(this.date) : new Date();
                    start.setHours(0, 0, 0, 0);
                    const end = new Date(start.getTime());
                    end.setDate(start.getDate() + this.days);
                    try {
                        const iterator = yield Object(_mgt_agenda_graph__WEBPACK_IMPORTED_MODULE_6__["getEventsPageIterator"])(graph, start, end, this.groupId, this.preferredTimezone);
                        if (iterator && iterator.value) {
                            events = iterator.value;
                            while (iterator.hasNext) {
                                yield iterator.next();
                                events = iterator.value;
                            }
                        }
                    }
                    catch (error) {
                        // noop - possible error with graph
                    }
                }
            }
            return events;
        });
    }
    prettyPrintTimeFromDateTime(date) {
        // If a preferred time zone was sent in the Graph request
        // times are already set correctly. Do not adjust
        if (!this.preferredTimezone) {
            // If no preferred time zone was specified, the times are in UTC
            // fall back to old behavior and adjust the times to the browser's
            // time zone
            date.setMinutes(date.getMinutes() - date.getTimezoneOffset());
        }
        let hours = date.getHours();
        const minutes = date.getMinutes();
        const ampm = hours >= 12 ? 'PM' : 'AM';
        hours = hours % 12;
        hours = hours ? hours : 12;
        const minutesStr = minutes < 10 ? '0' + minutes : minutes;
        return `${hours}:${minutesStr} ${ampm}`;
    }
    getDateHeaderFromDateTimeString(dateTimeString) {
        const date = new Date(dateTimeString);
        date.setMinutes(date.getMinutes() - date.getTimezoneOffset());
        const dayIndex = date.getDay();
        const monthIndex = date.getMonth();
        const day = date.getDate();
        const year = date.getFullYear();
        return `${Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_3__["getDayOfWeekString"])(dayIndex)}, ${Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_3__["getMonthString"])(monthIndex)} ${day}, ${year}`;
    }
    getEventDuration(event) {
        let dtStart = new Date(event.start.dateTime);
        const dtEnd = new Date(event.end.dateTime);
        const dtNow = new Date();
        let result = '';
        if (dtNow > dtStart) {
            dtStart = dtNow;
        }
        const diff = dtEnd.getTime() - dtStart.getTime();
        const durationMinutes = Math.round(diff / 60000);
        if (durationMinutes > 1440 || event.isAllDay) {
            result = Math.ceil(durationMinutes / 1440) + 'd';
        }
        else if (durationMinutes > 60) {
            result = Math.round(durationMinutes / 60) + 'h';
            const leftoverMinutes = durationMinutes % 60;
            if (leftoverMinutes) {
                result += leftoverMinutes + 'm';
            }
        }
        else {
            result = durationMinutes + 'm';
        }
        return result;
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'date',
        type: String
    }),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [Object])
], MgtAgenda.prototype, "date", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'group-id',
        type: String
    }),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [Object])
], MgtAgenda.prototype, "groupId", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'days',
        type: Number
    }),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Object])
], MgtAgenda.prototype, "days", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'event-query',
        type: String
    }),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [Object])
], MgtAgenda.prototype, "eventQuery", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'events',
        type: Array
    }),
    __metadata("design:type", Array)
], MgtAgenda.prototype, "events", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'show-max',
        type: Number
    }),
    __metadata("design:type", Number)
], MgtAgenda.prototype, "showMax", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'group-by-day',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtAgenda.prototype, "groupByDay", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'preferred-timezone',
        type: String
    }),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [Object])
], MgtAgenda.prototype, "preferredTimezone", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: false }),
    __metadata("design:type", Boolean)
], MgtAgenda.prototype, "_isNarrow", void 0);
MgtAgenda = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-agenda'),
    __metadata("design:paramtypes", [])
], MgtAgenda);

//# sourceMappingURL=mgt-agenda.js.map

/***/ }),

/***/ "C1WP":
/*!*********************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/Cache.js ***!
  \*********************************************************************/
/*! exports provided: CacheService, CacheStore */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CacheService", function() { return CacheService; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CacheStore", function() { return CacheStore; });
/* harmony import */ var idb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! idb */ "P0+2");
/* harmony import */ var _providers_Providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../providers/Providers */ "Viiq");
/* harmony import */ var _providers_IProvider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../providers/IProvider */ "DmZw");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * class in charge of managing all the caches and their stores
 *
 * @export
 * @class CacheService
 */
// tslint:disable-next-line: max-classes-per-file
class CacheService {
    /**
     *  Looks for existing cache, otherwise creates a new one
     *
     * @static
     * @template T
     * @param {CacheSchema} schema
     * @param {string} storeName
     * @returns {CacheStore<T>}
     * @memberof CacheService
     */
    static getCache(schema, storeName) {
        const key = `${schema.name}/${storeName}`;
        if (!this.isInitialized) {
            this.init();
        }
        if (!this.cacheStore.has(storeName)) {
            this.cacheStore.set(key, new CacheStore(schema, storeName));
        }
        return this.cacheStore.get(key);
    }
    /**
     * Clears all the stores within the cache
     */
    static clearCaches() {
        this.cacheStore.forEach(x => indexedDB.deleteDatabase(x.getDBName()));
    }
    /**
     * returns the cacheconfig object
     *
     * @readonly
     * @static
     * @type {CacheConfig}
     * @memberof CacheService
     */
    static get config() {
        return this.cacheConfig;
    }
    /**
     * Checks for current sign in state and see if it has changed from signed-in to signed out
     *
     *
     * @private
     * @static
     * @memberof CacheService
     */
    static init() {
        let previousState;
        if (_providers_Providers__WEBPACK_IMPORTED_MODULE_1__["Providers"].globalProvider) {
            previousState = _providers_Providers__WEBPACK_IMPORTED_MODULE_1__["Providers"].globalProvider.state;
        }
        _providers_Providers__WEBPACK_IMPORTED_MODULE_1__["Providers"].onProviderUpdated(() => {
            if (previousState === _providers_IProvider__WEBPACK_IMPORTED_MODULE_2__["ProviderState"].SignedIn && _providers_Providers__WEBPACK_IMPORTED_MODULE_1__["Providers"].globalProvider.state === _providers_IProvider__WEBPACK_IMPORTED_MODULE_2__["ProviderState"].SignedOut) {
                this.clearCaches();
            }
            previousState = _providers_Providers__WEBPACK_IMPORTED_MODULE_1__["Providers"].globalProvider.state;
        });
        this.isInitialized = true;
    }
}
CacheService.cacheStore = new Map();
CacheService.isInitialized = false;
CacheService.cacheConfig = {
    defaultInvalidationPeriod: 3600000,
    groups: {
        invalidationPeriod: null,
        isEnabled: true
    },
    isEnabled: true,
    people: {
        invalidationPeriod: null,
        isEnabled: true
    },
    photos: {
        invalidationPeriod: null,
        isEnabled: true
    },
    presence: {
        invalidationPeriod: 300000,
        isEnabled: true
    },
    users: {
        invalidationPeriod: null,
        isEnabled: true
    },
    response: {
        invalidationPeriod: null,
        isEnabled: true
    }
};
/**
 * Represents a store in the cache
 *
 * @class CacheStore
 * @template T
 */
// tslint:disable-next-line: max-classes-per-file
class CacheStore {
    constructor(schema, store) {
        if (!(store in schema.stores)) {
            throw Error('"store" must be defined in the "schema"');
        }
        this.schema = schema;
        this.store = store;
    }
    /**
     * gets value from cache for the given key
     *
     * @param {string} key
     * @returns {Promise<T>}
     * @memberof Cache
     */
    getValue(key) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!window.indexedDB) {
                return null;
            }
            return (yield this.getDb()).get(this.store, key);
        });
    }
    /**
     * inserts value into cache for the given key
     *
     * @param {string} key
     * @param {T} item
     * @returns
     * @memberof Cache
     */
    putValue(key, item) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!window.indexedDB) {
                return;
            }
            yield (yield this.getDb()).put(this.store, Object.assign(Object.assign({}, item), { timeCached: Date.now() }), key);
        });
    }
    /**
     * Clears the store of all stored values
     *
     * @returns
     * @memberof Cache
     */
    clearStore() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!window.indexedDB) {
                return;
            }
            (yield this.getDb()).clear(this.store);
        });
    }
    /**
     * Returns the name of the parent DB that the cache store belongs to
     */
    getDBName() {
        return `mgt-${this.schema.name}`;
    }
    getDb() {
        return Object(idb__WEBPACK_IMPORTED_MODULE_0__["openDB"])(this.getDBName(), this.schema.version, {
            upgrade: (db, oldVersion, newVersion, transaction) => {
                for (const storeName in this.schema.stores) {
                    if (this.schema.stores.hasOwnProperty(storeName)) {
                        db.createObjectStore(storeName);
                    }
                }
            }
        });
    }
}
//# sourceMappingURL=Cache.js.map

/***/ }),

/***/ "CKcM":
/*!******************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/ChaosHandlerData.js ***!
  \******************************************************************************************************************************************/
/*! exports provided: methodStatusCode, httpStatusCode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "methodStatusCode", function() { return methodStatusCode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "httpStatusCode", function() { return httpStatusCode; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module ChaosHandlerData
 */
/**
 * Contains RequestMethod to corresponding array of possible status codes, used for Random mode
 */
const methodStatusCode = {
    GET: [429, 500, 502, 503, 504],
    POST: [429, 500, 502, 503, 504, 507],
    PUT: [429, 500, 502, 503, 504, 507],
    PATCH: [429, 500, 502, 503, 504],
    DELETE: [429, 500, 502, 503, 504, 507],
};
/**
 * Contains statusCode to statusMessage map
 */
const httpStatusCode = {
    100: "Continue",
    101: "Switching Protocols",
    102: "Processing",
    103: "Early Hints",
    200: "OK",
    201: "Created",
    202: "Accepted",
    203: "Non-Authoritative Information",
    204: "No Content",
    205: "Reset Content",
    206: "Partial Content",
    207: "Multi-Status",
    208: "Already Reported",
    226: "IM Used",
    300: "Multiple Choices",
    301: "Moved Permanently",
    302: "Found",
    303: "See Other",
    304: "Not Modified",
    305: "Use Proxy",
    307: "Temporary Redirect",
    308: "Permanent Redirect",
    400: "Bad Request",
    401: "Unauthorized",
    402: "Payment Required",
    403: "Forbidden",
    404: "Not Found",
    405: "Method Not Allowed",
    406: "Not Acceptable",
    407: "Proxy Authentication Required",
    408: "Request Timeout",
    409: "Conflict",
    410: "Gone",
    411: "Length Required",
    412: "Precondition Failed",
    413: "Payload Too Large",
    414: "URI Too Long",
    415: "Unsupported Media Type",
    416: "Range Not Satisfiable",
    417: "Expectation Failed",
    421: "Misdirected Request",
    422: "Unprocessable Entity",
    423: "Locked",
    424: "Failed Dependency",
    425: "Too Early",
    426: "Upgrade Required",
    428: "Precondition Required",
    429: "Too Many Requests",
    431: "Request Header Fields Too Large",
    451: "Unavailable For Legal Reasons",
    500: "Internal Server Error",
    501: "Not Implemented",
    502: "Bad Gateway",
    503: "Service Unavailable",
    504: "Gateway Timeout",
    505: "HTTP Version Not Supported",
    506: "Variant Also Negotiates",
    507: "Insufficient Storage",
    508: "Loop Detected",
    510: "Not Extended",
    511: "Network Authentication Required",
};
//# sourceMappingURL=ChaosHandlerData.js.map

/***/ }),

/***/ "CLp/":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/AuthCacheUtils.js ***!
  \*****************************************************************************************************/
/*! exports provided: AuthCacheUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthCacheUtils", function() { return AuthCacheUtils; });
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ScopeSet */ "aX9C");
/* harmony import */ var _UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UrlUtils */ "j0B3");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * @hidden
 */
var AuthCacheUtils = /** @class */ (function () {
    function AuthCacheUtils() {
    }
    AuthCacheUtils.filterTokenCacheItemsByScope = function (tokenCacheItems, requestScopes) {
        return tokenCacheItems.filter(function (cacheItem) {
            var cachedScopes = cacheItem.key.scopes.split(" ");
            var searchScopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_0__["ScopeSet"].removeDefaultScopes(requestScopes);
            // If requestScopes contain only default scopes search for default scopes otherwise search for everything but default scopes
            return searchScopes.length === 0 ? _ScopeSet__WEBPACK_IMPORTED_MODULE_0__["ScopeSet"].containsScope(cachedScopes, requestScopes) : _ScopeSet__WEBPACK_IMPORTED_MODULE_0__["ScopeSet"].containsScope(cachedScopes, searchScopes);
        });
    };
    AuthCacheUtils.filterTokenCacheItemsByAuthority = function (tokenCacheItems, authority) {
        return tokenCacheItems.filter(function (cacheItem) { return _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].CanonicalizeUri(cacheItem.key.authority) === authority; });
    };
    AuthCacheUtils.filterTokenCacheItemsByDomain = function (tokenCacheItems, requestDomain) {
        return tokenCacheItems.filter(function (cacheItem) {
            var cacheItemDomain = _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].GetUrlComponents(cacheItem.key.authority).HostNameAndPort;
            return cacheItemDomain === requestDomain;
        });
    };
    return AuthCacheUtils;
}());

//# sourceMappingURL=AuthCacheUtils.js.map

/***/ }),

/***/ "CQbg":
/*!*************************************************!*\
  !*** ./node_modules/lit-element/lit-element.js ***!
  \*************************************************/
/*! exports provided: html, svg, TemplateResult, SVGTemplateResult, LitElement, defaultConverter, notEqual, UpdatingElement, customElement, property, internalProperty, query, queryAsync, queryAll, eventOptions, queryAssignedNodes, supportsAdoptingStyleSheets, CSSResult, unsafeCSS, css */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LitElement", function() { return LitElement; });
/* harmony import */ var lit_html_lib_shady_render_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-html/lib/shady-render.js */ "qcns");
/* harmony import */ var _lib_updating_element_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./lib/updating-element.js */ "sivJ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "defaultConverter", function() { return _lib_updating_element_js__WEBPACK_IMPORTED_MODULE_1__["defaultConverter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "notEqual", function() { return _lib_updating_element_js__WEBPACK_IMPORTED_MODULE_1__["notEqual"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UpdatingElement", function() { return _lib_updating_element_js__WEBPACK_IMPORTED_MODULE_1__["UpdatingElement"]; });

/* harmony import */ var _lib_decorators_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/decorators.js */ "1JlL");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "customElement", function() { return _lib_decorators_js__WEBPACK_IMPORTED_MODULE_2__["customElement"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "property", function() { return _lib_decorators_js__WEBPACK_IMPORTED_MODULE_2__["property"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "internalProperty", function() { return _lib_decorators_js__WEBPACK_IMPORTED_MODULE_2__["internalProperty"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "query", function() { return _lib_decorators_js__WEBPACK_IMPORTED_MODULE_2__["query"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "queryAsync", function() { return _lib_decorators_js__WEBPACK_IMPORTED_MODULE_2__["queryAsync"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "queryAll", function() { return _lib_decorators_js__WEBPACK_IMPORTED_MODULE_2__["queryAll"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "eventOptions", function() { return _lib_decorators_js__WEBPACK_IMPORTED_MODULE_2__["eventOptions"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "queryAssignedNodes", function() { return _lib_decorators_js__WEBPACK_IMPORTED_MODULE_2__["queryAssignedNodes"]; });

/* harmony import */ var lit_html_lit_html_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lit-html/lit-html.js */ "AaG5");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "html", function() { return lit_html_lit_html_js__WEBPACK_IMPORTED_MODULE_3__["html"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "svg", function() { return lit_html_lit_html_js__WEBPACK_IMPORTED_MODULE_3__["svg"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TemplateResult", function() { return lit_html_lit_html_js__WEBPACK_IMPORTED_MODULE_3__["TemplateResult"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SVGTemplateResult", function() { return lit_html_lit_html_js__WEBPACK_IMPORTED_MODULE_3__["SVGTemplateResult"]; });

/* harmony import */ var _lib_css_tag_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./lib/css-tag.js */ "a7t/");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "supportsAdoptingStyleSheets", function() { return _lib_css_tag_js__WEBPACK_IMPORTED_MODULE_4__["supportsAdoptingStyleSheets"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CSSResult", function() { return _lib_css_tag_js__WEBPACK_IMPORTED_MODULE_4__["CSSResult"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "unsafeCSS", function() { return _lib_css_tag_js__WEBPACK_IMPORTED_MODULE_4__["unsafeCSS"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "css", function() { return _lib_css_tag_js__WEBPACK_IMPORTED_MODULE_4__["css"]; });

/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * The main LitElement module, which defines the [[`LitElement`]] base class and
 * related APIs.
 *
 *  LitElement components can define a template and a set of observed
 * properties. Changing an observed property triggers a re-render of the
 * element.
 *
 *  Import [[`LitElement`]] and [[`html`]] from this module to create a
 * component:
 *
 *  ```js
 * import {LitElement, html} from 'lit-element';
 *
 * class MyElement extends LitElement {
 *
 *   // Declare observed properties
 *   static get properties() {
 *     return {
 *       adjective: {}
 *     }
 *   }
 *
 *   constructor() {
 *     this.adjective = 'awesome';
 *   }
 *
 *   // Define the element's template
 *   render() {
 *     return html`<p>your ${adjective} template here</p>`;
 *   }
 * }
 *
 * customElements.define('my-element', MyElement);
 * ```
 *
 * `LitElement` extends [[`UpdatingElement`]] and adds lit-html templating.
 * The `UpdatingElement` class is provided for users that want to build
 * their own custom element base classes that don't use lit-html.
 *
 * @packageDocumentation
 */







// IMPORTANT: do not change the property name or the assignment expression.
// This line will be used in regexes to search for LitElement usage.
// TODO(justinfagnani): inject version number at build time
(window['litElementVersions'] || (window['litElementVersions'] = []))
    .push('2.4.0');
/**
 * Sentinal value used to avoid calling lit-html's render function when
 * subclasses do not implement `render`
 */
const renderNotImplemented = {};
/**
 * Base element class that manages element properties and attributes, and
 * renders a lit-html template.
 *
 * To define a component, subclass `LitElement` and implement a
 * `render` method to provide the component's template. Define properties
 * using the [[`properties`]] property or the [[`property`]] decorator.
 */
class LitElement extends _lib_updating_element_js__WEBPACK_IMPORTED_MODULE_1__["UpdatingElement"] {
    /**
     * Return the array of styles to apply to the element.
     * Override this method to integrate into a style management system.
     *
     * @nocollapse
     */
    static getStyles() {
        return this.styles;
    }
    /** @nocollapse */
    static _getUniqueStyles() {
        // Only gather styles once per class
        if (this.hasOwnProperty(JSCompiler_renameProperty('_styles', this))) {
            return;
        }
        // Take care not to call `this.getStyles()` multiple times since this
        // generates new CSSResults each time.
        // TODO(sorvell): Since we do not cache CSSResults by input, any
        // shared styles will generate new stylesheet objects, which is wasteful.
        // This should be addressed when a browser ships constructable
        // stylesheets.
        const userStyles = this.getStyles();
        if (Array.isArray(userStyles)) {
            // De-duplicate styles preserving the _last_ instance in the set.
            // This is a performance optimization to avoid duplicated styles that can
            // occur especially when composing via subclassing.
            // The last item is kept to try to preserve the cascade order with the
            // assumption that it's most important that last added styles override
            // previous styles.
            const addStyles = (styles, set) => styles.reduceRight((set, s) => 
            // Note: On IE set.add() does not return the set
            Array.isArray(s) ? addStyles(s, set) : (set.add(s), set), set);
            // Array.from does not work on Set in IE, otherwise return
            // Array.from(addStyles(userStyles, new Set<CSSResult>())).reverse()
            const set = addStyles(userStyles, new Set());
            const styles = [];
            set.forEach((v) => styles.unshift(v));
            this._styles = styles;
        }
        else {
            this._styles = userStyles === undefined ? [] : [userStyles];
        }
        // Ensure that there are no invalid CSSStyleSheet instances here. They are
        // invalid in two conditions.
        // (1) the sheet is non-constructible (`sheet` of a HTMLStyleElement), but
        //     this is impossible to check except via .replaceSync or use
        // (2) the ShadyCSS polyfill is enabled (:. supportsAdoptingStyleSheets is
        //     false)
        this._styles = this._styles.map((s) => {
            if (s instanceof CSSStyleSheet && !_lib_css_tag_js__WEBPACK_IMPORTED_MODULE_4__["supportsAdoptingStyleSheets"]) {
                // Flatten the cssText from the passed constructible stylesheet (or
                // undetectable non-constructible stylesheet). The user might have
                // expected to update their stylesheets over time, but the alternative
                // is a crash.
                const cssText = Array.prototype.slice.call(s.cssRules)
                    .reduce((css, rule) => css + rule.cssText, '');
                return Object(_lib_css_tag_js__WEBPACK_IMPORTED_MODULE_4__["unsafeCSS"])(cssText);
            }
            return s;
        });
    }
    /**
     * Performs element initialization. By default this calls
     * [[`createRenderRoot`]] to create the element [[`renderRoot`]] node and
     * captures any pre-set values for registered properties.
     */
    initialize() {
        super.initialize();
        this.constructor._getUniqueStyles();
        this.renderRoot = this.createRenderRoot();
        // Note, if renderRoot is not a shadowRoot, styles would/could apply to the
        // element's getRootNode(). While this could be done, we're choosing not to
        // support this now since it would require different logic around de-duping.
        if (window.ShadowRoot && this.renderRoot instanceof window.ShadowRoot) {
            this.adoptStyles();
        }
    }
    /**
     * Returns the node into which the element should render and by default
     * creates and returns an open shadowRoot. Implement to customize where the
     * element's DOM is rendered. For example, to render into the element's
     * childNodes, return `this`.
     * @returns {Element|DocumentFragment} Returns a node into which to render.
     */
    createRenderRoot() {
        return this.attachShadow({ mode: 'open' });
    }
    /**
     * Applies styling to the element shadowRoot using the [[`styles`]]
     * property. Styling will apply using `shadowRoot.adoptedStyleSheets` where
     * available and will fallback otherwise. When Shadow DOM is polyfilled,
     * ShadyCSS scopes styles and adds them to the document. When Shadow DOM
     * is available but `adoptedStyleSheets` is not, styles are appended to the
     * end of the `shadowRoot` to [mimic spec
     * behavior](https://wicg.github.io/construct-stylesheets/#using-constructed-stylesheets).
     */
    adoptStyles() {
        const styles = this.constructor._styles;
        if (styles.length === 0) {
            return;
        }
        // There are three separate cases here based on Shadow DOM support.
        // (1) shadowRoot polyfilled: use ShadyCSS
        // (2) shadowRoot.adoptedStyleSheets available: use it
        // (3) shadowRoot.adoptedStyleSheets polyfilled: append styles after
        // rendering
        if (window.ShadyCSS !== undefined && !window.ShadyCSS.nativeShadow) {
            window.ShadyCSS.ScopingShim.prepareAdoptedCssText(styles.map((s) => s.cssText), this.localName);
        }
        else if (_lib_css_tag_js__WEBPACK_IMPORTED_MODULE_4__["supportsAdoptingStyleSheets"]) {
            this.renderRoot.adoptedStyleSheets =
                styles.map((s) => s instanceof CSSStyleSheet ? s : s.styleSheet);
        }
        else {
            // This must be done after rendering so the actual style insertion is done
            // in `update`.
            this._needsShimAdoptedStyleSheets = true;
        }
    }
    connectedCallback() {
        super.connectedCallback();
        // Note, first update/render handles styleElement so we only call this if
        // connected after first update.
        if (this.hasUpdated && window.ShadyCSS !== undefined) {
            window.ShadyCSS.styleElement(this);
        }
    }
    /**
     * Updates the element. This method reflects property values to attributes
     * and calls `render` to render DOM via lit-html. Setting properties inside
     * this method will *not* trigger another update.
     * @param _changedProperties Map of changed properties with old values
     */
    update(changedProperties) {
        // Setting properties in `render` should not trigger an update. Since
        // updates are allowed after super.update, it's important to call `render`
        // before that.
        const templateResult = this.render();
        super.update(changedProperties);
        // If render is not implemented by the component, don't call lit-html render
        if (templateResult !== renderNotImplemented) {
            this.constructor
                .render(templateResult, this.renderRoot, { scopeName: this.localName, eventContext: this });
        }
        // When native Shadow DOM is used but adoptedStyles are not supported,
        // insert styling after rendering to ensure adoptedStyles have highest
        // priority.
        if (this._needsShimAdoptedStyleSheets) {
            this._needsShimAdoptedStyleSheets = false;
            this.constructor._styles.forEach((s) => {
                const style = document.createElement('style');
                style.textContent = s.cssText;
                this.renderRoot.appendChild(style);
            });
        }
    }
    /**
     * Invoked on each update to perform rendering tasks. This method may return
     * any value renderable by lit-html's `NodePart` - typically a
     * `TemplateResult`. Setting properties inside this method will *not* trigger
     * the element to update.
     */
    render() {
        return renderNotImplemented;
    }
}
/**
 * Ensure this class is marked as `finalized` as an optimization ensuring
 * it will not needlessly try to `finalize`.
 *
 * Note this property name is a string to prevent breaking Closure JS Compiler
 * optimizations. See updating-element.ts for more information.
 */
LitElement['finalized'] = true;
/**
 * Reference to the underlying library method used to render the element's
 * DOM. By default, points to the `render` method from lit-html's shady-render
 * module.
 *
 * **Most users will never need to touch this property.**
 *
 * This  property should not be confused with the `render` instance method,
 * which should be overridden to define a template for the element.
 *
 * Advanced users creating a new base class based on LitElement can override
 * this property to point to a custom render method with a signature that
 * matches [shady-render's `render`
 * method](https://lit-html.polymer-project.org/api/modules/shady_render.html#render).
 *
 * @nocollapse
 */
LitElement.render = lit_html_lib_shady_render_js__WEBPACK_IMPORTED_MODULE_0__["render"];
//# sourceMappingURL=lit-element.js.map

/***/ }),

/***/ "CZFO":
/*!***************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-proxy-provider/dist/es6/ProxyGraph.js ***!
  \***************************************************************************/
/*! exports provided: ProxyGraph */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ProxyGraph", function() { return ProxyGraph; });
/* harmony import */ var _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/microsoft-graph-client */ "XZ4c");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _microsoft_mgt_element_dist_es6_utils_SdkVersionMiddleware__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/mgt-element/dist/es6/utils/SdkVersionMiddleware */ "ZiRd");
/* harmony import */ var _microsoft_mgt_element_dist_es6_utils_version__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @microsoft/mgt-element/dist/es6/utils/version */ "YdX3");
/* harmony import */ var _CustomHeaderMiddleware__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./CustomHeaderMiddleware */ "cTj7");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */





/**
 * ProxyGraph Instance
 *
 * @export
 * @class ProxyGraph
 * @extends {Graph}
 */
// tslint:disable-next-line: max-classes-per-file
class ProxyGraph extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["Graph"] {
    constructor(baseUrl, getCustomHeaders) {
        const middleware = [
            new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["RetryHandler"](new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["RetryHandlerOptions"]()),
            new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["TelemetryHandler"](),
            new _microsoft_mgt_element_dist_es6_utils_SdkVersionMiddleware__WEBPACK_IMPORTED_MODULE_2__["SdkVersionMiddleware"](_microsoft_mgt_element_dist_es6_utils_version__WEBPACK_IMPORTED_MODULE_3__["PACKAGE_VERSION"]),
            new _CustomHeaderMiddleware__WEBPACK_IMPORTED_MODULE_4__["CustomHeaderMiddleware"](getCustomHeaders),
            new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["HTTPMessageHandler"]()
        ];
        super(_microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["Client"].initWithMiddleware({
            baseUrl,
            middleware: Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["chainMiddleware"])(...middleware)
        }));
    }
}
//# sourceMappingURL=ProxyGraph.js.map

/***/ }),

/***/ "D39h":
/*!*************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/Client.js ***!
  \*************************************************************************/
/*! exports provided: Client */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Client", function() { return Client; });
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Constants */ "Blta");
/* harmony import */ var _CustomAuthenticationProvider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CustomAuthenticationProvider */ "SdJ9");
/* harmony import */ var _GraphRequest__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GraphRequest */ "tIC7");
/* harmony import */ var _HTTPClient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./HTTPClient */ "Hj1S");
/* harmony import */ var _HTTPClientFactory__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./HTTPClientFactory */ "vJwf");
/* harmony import */ var _ValidatePolyFilling__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ValidatePolyFilling */ "pRai");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module Client
 */






class Client {
    /**
     * @private
     * @constructor
     * Creates an instance of Client
     * @param {ClientOptions} clientOptions - The options to instantiate the client object
     */
    constructor(clientOptions) {
        /**
         * @private
         * A member which stores the Client instance options
         */
        this.config = {
            baseUrl: _Constants__WEBPACK_IMPORTED_MODULE_0__["GRAPH_BASE_URL"],
            debugLogging: false,
            defaultVersion: _Constants__WEBPACK_IMPORTED_MODULE_0__["GRAPH_API_VERSION"],
        };
        try {
            Object(_ValidatePolyFilling__WEBPACK_IMPORTED_MODULE_5__["validatePolyFilling"])();
        }
        catch (error) {
            throw error;
        }
        for (const key in clientOptions) {
            if (clientOptions.hasOwnProperty(key)) {
                this.config[key] = clientOptions[key];
            }
        }
        let httpClient;
        if (clientOptions.authProvider !== undefined && clientOptions.middleware !== undefined) {
            const error = new Error();
            error.name = "AmbiguityInInitialization";
            error.message = "Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both";
            throw error;
        }
        else if (clientOptions.authProvider !== undefined) {
            httpClient = _HTTPClientFactory__WEBPACK_IMPORTED_MODULE_4__["HTTPClientFactory"].createWithAuthenticationProvider(clientOptions.authProvider);
        }
        else if (clientOptions.middleware !== undefined) {
            httpClient = new _HTTPClient__WEBPACK_IMPORTED_MODULE_3__["HTTPClient"](...[].concat(clientOptions.middleware));
        }
        else {
            const error = new Error();
            error.name = "InvalidMiddlewareChain";
            error.message = "Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain";
            throw error;
        }
        this.httpClient = httpClient;
    }
    /**
     * @public
     * @static
     * To create a client instance with options and initializes the default middleware chain
     * @param {Options} options - The options for client instance
     * @returns The Client instance
     */
    static init(options) {
        const clientOptions = {};
        for (const i in options) {
            if (options.hasOwnProperty(i)) {
                clientOptions[i] = i === "authProvider" ? new _CustomAuthenticationProvider__WEBPACK_IMPORTED_MODULE_1__["CustomAuthenticationProvider"](options[i]) : options[i];
            }
        }
        return Client.initWithMiddleware(clientOptions);
    }
    /**
     * @public
     * @static
     * To create a client instance with the Client Options
     * @param {ClientOptions} clientOptions - The options object for initializing the client
     * @returns The Client instance
     */
    static initWithMiddleware(clientOptions) {
        try {
            return new Client(clientOptions);
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * @public
     * Entry point to make requests
     * @param {string} path - The path string value
     * @returns The graph request instance
     */
    api(path) {
        return new _GraphRequest__WEBPACK_IMPORTED_MODULE_2__["GraphRequest"](this.httpClient, this.config, path);
    }
}
//# sourceMappingURL=Client.js.map

/***/ }),

/***/ "DOGG":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/ChaosHandlerOptions.js ***!
  \*********************************************************************************************************/
/*! exports provided: ChaosHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChaosHandlerOptions", function() { return ChaosHandlerOptions; });
/* harmony import */ var _ChaosStrategy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ChaosStrategy */ "nT0M");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module ChaosHandlerOptions
 */

/**
 * Class representing ChaosHandlerOptions
 * @class
 * Class
 * @implements MiddlewareOptions
 */
class ChaosHandlerOptions {
    /**
     * @public
     * @constructor
     * To create an instance of Testing Handler Options
     * @param {ChaosStrategy} ChaosStrategy - Specifies the startegy used for the Testing Handler -> RAMDOM/MANUAL
     * @param {string} statusMessage - The Message to be returned in the response
     * @param {number?} statusCode - The statusCode to be returned in the response
     * @param {number?} chaosPercentage - The percentage of randomness/chaos in the handler
     * @param {any?} responseBody - The response body to be returned in the response
     * @returns An instance of ChaosHandlerOptions
     */
    constructor(chaosStrategy = _ChaosStrategy__WEBPACK_IMPORTED_MODULE_0__["ChaosStrategy"].RANDOM, statusMessage = "Some error Happened", statusCode, chaosPercentage, responseBody) {
        this.chaosStrategy = chaosStrategy;
        this.statusCode = statusCode;
        this.statusMessage = statusMessage;
        this.chaosPercentage = chaosPercentage !== undefined ? chaosPercentage : 10;
        this.responseBody = responseBody;
        if (this.chaosPercentage > 100) {
            throw new Error("Error Pecentage can not be more than 100");
        }
    }
}
//# sourceMappingURL=ChaosHandlerOptions.js.map

/***/ }),

/***/ "DmZw":
/*!*****************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/providers/IProvider.js ***!
  \*****************************************************************************/
/*! exports provided: IProvider, LoginType, ProviderState */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IProvider", function() { return IProvider; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoginType", function() { return LoginType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ProviderState", function() { return ProviderState; });
/* harmony import */ var _utils_EventDispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/EventDispatcher */ "kDYw");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * Provider Type to be extended for implmenting new providers
 *
 * @export
 * @abstract
 * @class IProvider
 * @implements {AuthenticationProvider}
 */
class IProvider {
    constructor() {
        this._loginChangedDispatcher = new _utils_EventDispatcher__WEBPACK_IMPORTED_MODULE_0__["EventDispatcher"]();
        this._state = ProviderState.Loading;
    }
    /**
     * returns state of Provider
     *
     * @readonly
     * @type {ProviderState}
     * @memberof IProvider
     */
    get state() {
        return this._state;
    }
    /**
     * sets state of Provider and fires loginchangedDispatcher
     *
     * @param {ProviderState} state
     * @memberof IProvider
     */
    setState(state) {
        if (state !== this._state) {
            this._state = state;
            this._loginChangedDispatcher.fire({});
        }
    }
    /**
     * event handler when login changes
     *
     * @param {EventHandler<LoginChangedEvent>} eventHandler
     * @memberof IProvider
     */
    onStateChanged(eventHandler) {
        this._loginChangedDispatcher.add(eventHandler);
    }
    /**
     * removes event handler for when login changes
     *
     * @param {EventHandler<LoginChangedEvent>} eventHandler
     * @memberof IProvider
     */
    removeStateChangedHandler(eventHandler) {
        this._loginChangedDispatcher.remove(eventHandler);
    }
    /**
     * uses scopes to recieve access token
     *
     * @param {...string[]} scopes
     * @returns {Promise<string>}
     * @memberof IProvider
     */
    getAccessTokenForScopes(...scopes) {
        return this.getAccessToken({ scopes });
    }
}
/**
 * LoginType
 *
 * @export
 * @enum {number}
 */
var LoginType;
(function (LoginType) {
    /**
     * Popup = 0
     */
    LoginType[LoginType["Popup"] = 0] = "Popup";
    /**
     * Redirect = 1
     */
    LoginType[LoginType["Redirect"] = 1] = "Redirect";
})(LoginType || (LoginType = {}));
/**
 * ProviderState
 *
 * @export
 * @enum {number}
 */
var ProviderState;
(function (ProviderState) {
    /**
     * Loading = 0
     */
    ProviderState[ProviderState["Loading"] = 0] = "Loading";
    /**
     * SignedOut = 1
     */
    ProviderState[ProviderState["SignedOut"] = 1] = "SignedOut";
    /**
     * SignedIn = 2
     */
    ProviderState[ProviderState["SignedIn"] = 2] = "SignedIn";
})(ProviderState || (ProviderState = {}));
//# sourceMappingURL=IProvider.js.map

/***/ }),

/***/ "E5LX":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/telemetry/TelemetryUtils.js ***!
  \**************************************************************************************************************/
/*! exports provided: scrubTenantFromUri, hashPersonalIdentifier, prependEventNamePrefix, supportsBrowserPerformance, endBrowserPerformanceMeasurement, startBrowserPerformanceMeasurement */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "scrubTenantFromUri", function() { return scrubTenantFromUri; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hashPersonalIdentifier", function() { return hashPersonalIdentifier; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prependEventNamePrefix", function() { return prependEventNamePrefix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "supportsBrowserPerformance", function() { return supportsBrowserPerformance; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "endBrowserPerformanceMeasurement", function() { return endBrowserPerformanceMeasurement; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "startBrowserPerformanceMeasurement", function() { return startBrowserPerformanceMeasurement; });
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TelemetryConstants */ "7xDs");
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/CryptoUtils */ "oish");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/UrlUtils */ "6r4W");
/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../authority/Authority */ "UYCr");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var scrubTenantFromUri = function (uri) {
    var url = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__["UrlUtils"].GetUrlComponents(uri);
    // validate trusted host
    if (_authority_Authority__WEBPACK_IMPORTED_MODULE_3__["Authority"].isAdfs(uri)) {
        /**
         * returning what was passed because the library needs to work with uris that are non
         * AAD trusted but passed by users such as B2C or others.
         * HTTP Events for instance can take a url to the open id config endpoint
         */
        return uri;
    }
    var pathParams = url.PathSegments;
    if (pathParams && pathParams.length >= 2) {
        var tenantPosition = pathParams[1] === "tfp" ? 2 : 1;
        if (tenantPosition < pathParams.length) {
            pathParams[tenantPosition] = _TelemetryConstants__WEBPACK_IMPORTED_MODULE_0__["TENANT_PLACEHOLDER"];
        }
    }
    return url.Protocol + "//" + url.HostNameAndPort + "/" + pathParams.join("/");
};
var hashPersonalIdentifier = function (valueToHash) {
    /*
     * TODO sha256 this
     * Current test runner is being funny with node libs that are webpacked anyway
     * need a different solution
     */
    return _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_1__["CryptoUtils"].base64Encode(valueToHash);
};
var prependEventNamePrefix = function (suffix) { return "" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_0__["EVENT_NAME_PREFIX"] + (suffix || ""); };
var supportsBrowserPerformance = function () { return !!(typeof window !== "undefined" &&
    "performance" in window &&
    window.performance.mark &&
    window.performance.measure); };
var endBrowserPerformanceMeasurement = function (measureName, startMark, endMark) {
    if (supportsBrowserPerformance()) {
        window.performance.mark(endMark);
        window.performance.measure(measureName, startMark, endMark);
        window.performance.clearMeasures(measureName);
        window.performance.clearMarks(startMark);
        window.performance.clearMarks(endMark);
    }
};
var startBrowserPerformanceMeasurement = function (startMark) {
    if (supportsBrowserPerformance()) {
        window.performance.mark(startMark);
    }
};
//# sourceMappingURL=TelemetryUtils.js.map

/***/ }),

/***/ "E6hj":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/sub-components/mgt-spinner/mgt-spinner-css.js ***!
  \******************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .spinner{border:2px solid #c7e0f4;border-top:2px solid #0078d4;border-radius:50%;width:20px;height:20px;animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
`
];
//# sourceMappingURL=mgt-spinner-css.js.map

/***/ }),

/***/ "E94R":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/tasks/LargeFileUploadTask.js ***!
  \********************************************************************************************************************************/
/*! exports provided: LargeFileUploadTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LargeFileUploadTask", function() { return LargeFileUploadTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Range__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Range */ "Ya4k");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


/**
 * @class
 * Class representing LargeFileUploadTask
 */
class LargeFileUploadTask {
    /**
     * @public
     * @constructor
     * Constructs a LargeFileUploadTask
     * @param {Client} client - The GraphClient instance
     * @param {FileObject} file - The FileObject holding details of a file that needs to be uploaded
     * @param {LargeFileUploadSession} uploadSession - The upload session to which the upload has to be done
     * @param {LargeFileUploadTaskOptions} options - The upload task options
     * @returns An instance of LargeFileUploadTask
     */
    constructor(client, file, uploadSession, options = {}) {
        /**
         * @private
         * Default value for the rangeSize
         */
        this.DEFAULT_FILE_SIZE = 5 * 1024 * 1024;
        this.client = client;
        this.file = file;
        if (options.rangeSize === undefined) {
            options.rangeSize = this.DEFAULT_FILE_SIZE;
        }
        this.options = options;
        this.uploadSession = uploadSession;
        this.nextRange = new _Range__WEBPACK_IMPORTED_MODULE_1__["Range"](0, this.options.rangeSize - 1);
    }
    /**
     * @public
     * @static
     * @async
     * Makes request to the server to create an upload session
     * @param {Client} client - The GraphClient instance
     * @param {any} payload - The payload that needs to be sent
     * @param {KeyValuePairObjectStringNumber} headers - The headers that needs to be sent
     * @returns The promise that resolves to LargeFileUploadSession
     */
    static createUploadSession(client, requestUrl, payload, headers = {}) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const session = yield client
                    .api(requestUrl)
                    .headers(headers)
                    .post(payload);
                const largeFileUploadSession = {
                    url: session.uploadUrl,
                    expiry: new Date(session.expirationDateTime),
                };
                return largeFileUploadSession;
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @private
     * Parses given range string to the Range instance
     * @param {string[]} ranges - The ranges value
     * @returns The range instance
     */
    parseRange(ranges) {
        const rangeStr = ranges[0];
        if (typeof rangeStr === "undefined" || rangeStr === "") {
            return new _Range__WEBPACK_IMPORTED_MODULE_1__["Range"]();
        }
        const firstRange = rangeStr.split("-");
        const minVal = parseInt(firstRange[0], 10);
        let maxVal = parseInt(firstRange[1], 10);
        if (Number.isNaN(maxVal)) {
            maxVal = this.file.size - 1;
        }
        return new _Range__WEBPACK_IMPORTED_MODULE_1__["Range"](minVal, maxVal);
    }
    /**
     * @private
     * Updates the expiration date and the next range
     * @param {UploadStatusResponse} response - The response of the upload status
     * @returns Nothing
     */
    updateTaskStatus(response) {
        this.uploadSession.expiry = new Date(response.expirationDateTime);
        this.nextRange = this.parseRange(response.nextExpectedRanges);
    }
    /**
     * @public
     * Gets next range that needs to be uploaded
     * @returns The range instance
     */
    getNextRange() {
        if (this.nextRange.minValue === -1) {
            return this.nextRange;
        }
        const minVal = this.nextRange.minValue;
        let maxValue = minVal + this.options.rangeSize - 1;
        if (maxValue >= this.file.size) {
            maxValue = this.file.size - 1;
        }
        return new _Range__WEBPACK_IMPORTED_MODULE_1__["Range"](minVal, maxValue);
    }
    /**
     * @public
     * Slices the file content to the given range
     * @param {Range} range - The range value
     * @returns The sliced ArrayBuffer or Blob
     */
    sliceFile(range) {
        const blob = this.file.content.slice(range.minValue, range.maxValue + 1);
        return blob;
    }
    /**
     * @public
     * @async
     * Uploads file to the server in a sequential order by slicing the file
     * @returns The promise resolves to uploaded response
     */
    upload() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                while (true) {
                    const nextRange = this.getNextRange();
                    if (nextRange.maxValue === -1) {
                        const err = new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");
                        err.name = "Invalid Session";
                        throw err;
                    }
                    const fileSlice = this.sliceFile(nextRange);
                    const response = yield this.uploadSlice(fileSlice, nextRange, this.file.size);
                    // Upon completion of upload process incase of onedrive, driveItem is returned, which contains id
                    if (response.id !== undefined) {
                        return response;
                    }
                    else {
                        this.updateTaskStatus(response);
                    }
                }
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @async
     * Uploads given slice to the server
     * @param {ArrayBuffer | Blob | File} fileSlice - The file slice
     * @param {Range} range - The range value
     * @param {number} totalSize - The total size of a complete file
     */
    uploadSlice(fileSlice, range, totalSize) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.client
                    .api(this.uploadSession.url)
                    .headers({
                    "Content-Length": `${range.maxValue - range.minValue + 1}`,
                    "Content-Range": `bytes ${range.minValue}-${range.maxValue}/${totalSize}`,
                })
                    .put(fileSlice);
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @async
     * Deletes upload session in the server
     * @returns The promise resolves to cancelled response
     */
    cancel() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.client.api(this.uploadSession.url).delete();
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @async
     * Gets status for the upload session
     * @returns The promise resolves to the status enquiry response
     */
    getStatus() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const response = yield this.client.api(this.uploadSession.url).get();
                this.updateTaskStatus(response);
                return response;
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @async
     * Resumes upload session and continue uploading the file from the last sent range
     * @returns The promise resolves to the uploaded response
     */
    resume() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                yield this.getStatus();
                return yield this.upload();
            }
            catch (err) {
                throw err;
            }
        });
    }
}
//# sourceMappingURL=LargeFileUploadTask.js.map

/***/ }),

/***/ "EKcv":
/*!********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/styles/fluent-icons.js ***!
  \********************************************************************************/
/*! exports provided: getFileTypeIconUri */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFileTypeIconUri", function() { return getFileTypeIconUri; });
const fileTypeMap = {
    PowerPoint: 'pptx',
    Word: 'docx',
    Excel: 'xlsx',
    Pdf: 'pdf',
    OneNote: 'onetoc',
    OneNotePage: 'one',
    InfoPath: 'xsn',
    Visio: 'vstx',
    Publisher: 'pub',
    Project: 'mpp',
    Access: 'accdb',
    Mail: 'email',
    Csv: 'csv',
    Archive: 'archive',
    Xps: 'vector',
    Audio: 'audio',
    Video: 'video',
    Image: 'photo',
    Web: 'html',
    Text: 'txt',
    Xml: 'xml',
    Story: 'genericfile',
    ExternalContent: 'genericfile',
    Folder: 'folder',
    Spsite: 'spo',
    Other: 'genericfile'
};
// tslint:disable-next-line:completed-docs
const baseUri = 'https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types';
function getFileTypeIconUri(type, size, extension) {
    const fileType = fileTypeMap[type] || 'genericfile';
    return `${baseUri}/${size.toString()}/${fileType}.${extension}`;
}
//# sourceMappingURL=fluent-icons.js.map

/***/ }),

/***/ "Eakl":
/*!*********************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/RetryHandlerOptions.js ***!
  \*********************************************************************************************************************************************/
/*! exports provided: RetryHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RetryHandlerOptions", function() { return RetryHandlerOptions; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * @implements MiddlewareOptions
 * Class for RetryHandlerOptions
 */
class RetryHandlerOptions {
    /**
     * @public
     * @constructor
     * To create an instance of RetryHandlerOptions
     * @param {number} [delay = RetryHandlerOptions.DEFAULT_DELAY] - The delay value in seconds
     * @param {number} [maxRetries = RetryHandlerOptions.DEFAULT_MAX_RETRIES] - The maxRetries value
     * @param {ShouldRetry} [shouldRetry = RetryHandlerOptions.DEFAULT_SHOULD_RETRY] - The shouldRetry callback function
     * @returns An instance of RetryHandlerOptions
     */
    constructor(delay = RetryHandlerOptions.DEFAULT_DELAY, maxRetries = RetryHandlerOptions.DEFAULT_MAX_RETRIES, shouldRetry = RetryHandlerOptions.DEFAULT_SHOULD_RETRY) {
        if (delay > RetryHandlerOptions.MAX_DELAY && maxRetries > RetryHandlerOptions.MAX_MAX_RETRIES) {
            const error = new Error(`Delay and MaxRetries should not be more than ${RetryHandlerOptions.MAX_DELAY} and ${RetryHandlerOptions.MAX_MAX_RETRIES}`);
            error.name = "MaxLimitExceeded";
            throw error;
        }
        else if (delay > RetryHandlerOptions.MAX_DELAY) {
            const error = new Error(`Delay should not be more than ${RetryHandlerOptions.MAX_DELAY}`);
            error.name = "MaxLimitExceeded";
            throw error;
        }
        else if (maxRetries > RetryHandlerOptions.MAX_MAX_RETRIES) {
            const error = new Error(`MaxRetries should not be more than ${RetryHandlerOptions.MAX_MAX_RETRIES}`);
            error.name = "MaxLimitExceeded";
            throw error;
        }
        else if (delay < 0 && maxRetries < 0) {
            const error = new Error(`Delay and MaxRetries should not be negative`);
            error.name = "MinExpectationNotMet";
            throw error;
        }
        else if (delay < 0) {
            const error = new Error(`Delay should not be negative`);
            error.name = "MinExpectationNotMet";
            throw error;
        }
        else if (maxRetries < 0) {
            const error = new Error(`MaxRetries should not be negative`);
            error.name = "MinExpectationNotMet";
            throw error;
        }
        this.delay = Math.min(delay, RetryHandlerOptions.MAX_DELAY);
        this.maxRetries = Math.min(maxRetries, RetryHandlerOptions.MAX_MAX_RETRIES);
        this.shouldRetry = shouldRetry;
    }
    /**
     * @public
     * To get the maximum delay
     * @returns A maximum delay
     */
    getMaxDelay() {
        return RetryHandlerOptions.MAX_DELAY;
    }
}
/**
 * @private
 * @static
 * A member holding default delay value in seconds
 */
RetryHandlerOptions.DEFAULT_DELAY = 3;
/**
 * @private
 * @static
 * A member holding default maxRetries value
 */
RetryHandlerOptions.DEFAULT_MAX_RETRIES = 3;
/**
 * @private
 * @static
 * A member holding maximum delay value in seconds
 */
RetryHandlerOptions.MAX_DELAY = 180;
/**
 * @private
 * @static
 * A member holding maximum maxRetries value
 */
RetryHandlerOptions.MAX_MAX_RETRIES = 10;
/**
 * @private
 * A member holding default shouldRetry callback
 */
RetryHandlerOptions.DEFAULT_SHOULD_RETRY = () => true;
//# sourceMappingURL=RetryHandlerOptions.js.map

/***/ }),

/***/ "EnkG":
/*!************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/telemetry/DefaultEvent.js ***!
  \************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryConstants */ "7xDs");
/* harmony import */ var _TelemetryEvent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryEvent */ "aklA");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TelemetryUtils */ "E5LX");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var DefaultEvent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DefaultEvent, _super);
    // TODO Platform Type
    function DefaultEvent(platform, correlationId, clientId, eventCount) {
        var _this = _super.call(this, Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("default_event"), correlationId, "DefaultEvent") || this;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("client_id")] = clientId;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("sdk_plaform")] = platform.sdk;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("sdk_version")] = platform.sdkVersion;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("application_name")] = platform.applicationName;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("application_version")] = platform.applicationVersion;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("effective_connection_speed")] = platform.networkInformation && platform.networkInformation.connectionSpeed;
        _this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].UiEventCountTelemetryBatchKey] = _this.getEventCount(Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("ui_event"), eventCount);
        _this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].HttpEventCountTelemetryBatchKey] = _this.getEventCount(Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("http_event"), eventCount);
        _this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].CacheEventCountConstStrKey] = _this.getEventCount(Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("cache_event"), eventCount);
        return _this;
        // / Device id?
    }
    DefaultEvent.prototype.getEventCount = function (eventName, eventCount) {
        if (!eventCount[eventName]) {
            return 0;
        }
        return eventCount[eventName];
    };
    return DefaultEvent;
}(_TelemetryEvent__WEBPACK_IMPORTED_MODULE_2__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (DefaultEvent);
//# sourceMappingURL=DefaultEvent.js.map

/***/ }),

/***/ "Exx9":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/ClientInfo.js ***!
  \*******************************************************************************************/
/*! exports provided: ClientInfo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientInfo", function() { return ClientInfo; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ "RDZQ");
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./error/ClientAuthError */ "n82g");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ "k+Uk");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * @hidden
 */
var ClientInfo = /** @class */ (function () {
    function ClientInfo(rawClientInfo, authority) {
        if (!rawClientInfo || _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(rawClientInfo)) {
            this.uid = "";
            this.utid = "";
            return;
        }
        try {
            var decodedClientInfo = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Decode(rawClientInfo);
            var clientInfo = JSON.parse(decodedClientInfo);
            if (clientInfo) {
                if (clientInfo.hasOwnProperty("uid")) {
                    this.uid = authority ? ClientInfo.stripPolicyFromUid(clientInfo.uid, authority) : clientInfo.uid;
                }
                if (clientInfo.hasOwnProperty("utid")) {
                    this.utid = clientInfo.utid;
                }
            }
        }
        catch (e) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__["ClientAuthError"].createClientInfoDecodingError(e);
        }
    }
    Object.defineProperty(ClientInfo.prototype, "uid", {
        get: function () {
            return this._uid ? this._uid : "";
        },
        set: function (uid) {
            this._uid = uid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ClientInfo.prototype, "utid", {
        get: function () {
            return this._utid ? this._utid : "";
        },
        set: function (utid) {
            this._utid = utid;
        },
        enumerable: true,
        configurable: true
    });
    ClientInfo.createClientInfoFromIdToken = function (idToken, authority) {
        var clientInfo = {
            uid: idToken.subject,
            utid: ""
        };
        return new ClientInfo(_utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(JSON.stringify(clientInfo)), authority);
    };
    ClientInfo.stripPolicyFromUid = function (uid, authority) {
        var uidSegments = uid.split("-");
        // Reverse the url segments so the last one is more easily accessible
        var urlSegments = authority.split("/").reverse();
        var policy = "";
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(urlSegments[0])) {
            policy = urlSegments[0];
        }
        else if (urlSegments.length > 1) {
            // If the original url had a trailing slash, urlSegments[0] would be "" so take the next element
            policy = urlSegments[1];
        }
        if (uidSegments[uidSegments.length - 1] === policy) {
            // If the last segment of uid matches the last segment of authority url, remove the last segment of uid
            return uidSegments.slice(0, uidSegments.length - 1).join("-");
        }
        return uid;
    };
    ClientInfo.prototype.encodeClientInfo = function () {
        var clientInfo = JSON.stringify({ uid: this.uid, utid: this.utid });
        return _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(clientInfo);
    };
    return ClientInfo;
}());

//# sourceMappingURL=ClientInfo.js.map

/***/ }),

/***/ "FDgl":
/*!************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/RedirectHandlerOptions.js ***!
  \************************************************************************************************************/
/*! exports provided: RedirectHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RedirectHandlerOptions", function() { return RedirectHandlerOptions; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * @implements MiddlewareOptions
 * A class representing RedirectHandlerOptions
 */
class RedirectHandlerOptions {
    /**
     * @public
     * @constructor
     * To create an instance of RedirectHandlerOptions
     * @param {number} [maxRedirects = RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS] - The max redirects value
     * @param {ShouldRedirect} [shouldRedirect = RedirectHandlerOptions.DEFAULT_SHOULD_RETRY] - The should redirect callback
     * @returns An instance of RedirectHandlerOptions
     */
    constructor(maxRedirects = RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS, shouldRedirect = RedirectHandlerOptions.DEFAULT_SHOULD_RETRY) {
        if (maxRedirects > RedirectHandlerOptions.MAX_MAX_REDIRECTS) {
            const error = new Error(`MaxRedirects should not be more than ${RedirectHandlerOptions.MAX_MAX_REDIRECTS}`);
            error.name = "MaxLimitExceeded";
            throw error;
        }
        if (maxRedirects < 0) {
            const error = new Error(`MaxRedirects should not be negative`);
            error.name = "MinExpectationNotMet";
            throw error;
        }
        this.maxRedirects = maxRedirects;
        this.shouldRedirect = shouldRedirect;
    }
}
/**
 * @private
 * @static
 * A member holding default max redirects value
 */
RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS = 5;
/**
 * @private
 * @static
 * A member holding maximum max redirects value
 */
RedirectHandlerOptions.MAX_MAX_REDIRECTS = 20;
/**
 * @private
 * A member holding default shouldRedirect callback
 */
RedirectHandlerOptions.DEFAULT_SHOULD_RETRY = () => true;
//# sourceMappingURL=RedirectHandlerOptions.js.map

/***/ }),

/***/ "FE8f":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-tasks/task-sources.js ***!
  \**********************************************************************************************/
/*! exports provided: PlannerTaskSource, TodoTaskSource */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PlannerTaskSource", function() { return PlannerTaskSource; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TodoTaskSource", function() { return TodoTaskSource; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mgt-tasks.graph.planner */ "Nnp4");
/* harmony import */ var _mgt_tasks_graph_todo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mgt-tasks.graph.todo */ "nclX");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * async method to get user details
 *
 * @class TaskSourceBase
 */
class TaskSourceBase {
    constructor(graph) {
        // Use an instance of BetaGraph since we know we need to call beta apis.
        this.graph = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["BetaGraph"].fromGraph(graph);
    }
}
/**
 * Create Planner
 *
 * @export
 * @class PlannerTaskSource
 * @extends {TaskSourceBase}
 * @implements {ITaskSource}
 */
// tslint:disable-next-line: max-classes-per-file
class PlannerTaskSource extends TaskSourceBase {
    /**
     * returns promise with all of users plans
     *
     * @returns {Promise<ITaskGroup[]>}
     * @memberof PlannerTaskSource
     */
    getTaskGroups() {
        return __awaiter(this, void 0, void 0, function* () {
            const plans = yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["getAllMyPlannerPlans"])(this.graph);
            return plans.map(plan => ({ id: plan.id, title: plan.title }));
        });
    }
    /**
     * returns promise with all of plans for group id
     *
     * @param {string} id
     * @returns {Promise<ITaskGroup[]>}
     * @memberof PlannerTaskSource
     */
    getTaskGroupsForGroup(id) {
        return __awaiter(this, void 0, void 0, function* () {
            const plans = yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["getPlansForGroup"])(this.graph, id);
            return plans.map(plan => ({ id: plan.id, title: plan.title }));
        });
    }
    /**
     * returns promise single TaskGroup or plan from plan.id
     *
     * @param {string} id
     * @returns {Promise<ITaskGroup>}
     * @memberof PlannerTaskSource
     */
    getTaskGroup(id) {
        return __awaiter(this, void 0, void 0, function* () {
            const plan = yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["getSinglePlannerPlan"])(this.graph, id);
            return { id: plan.id, title: plan.title, _raw: plan };
        });
    }
    /**
     * returns promise with Bucket for a plan from bucket.id
     *
     * @param {string} id
     * @returns {Promise<ITaskFolder[]>}
     * @memberof PlannerTaskSource
     */
    getTaskFoldersForTaskGroup(id) {
        return __awaiter(this, void 0, void 0, function* () {
            const buckets = yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["getBucketsForPlannerPlan"])(this.graph, id);
            return buckets.map(bucket => ({
                _raw: bucket,
                id: bucket.id,
                name: bucket.name,
                parentId: bucket.planId
            }));
        });
    }
    /**
     * get all task from a Bucket given task id
     *
     * @param {string} id
     * @returns {Promise<ITask[]>}
     * @memberof PlannerTaskSource
     */
    getTasksForTaskFolder(id) {
        return __awaiter(this, void 0, void 0, function* () {
            const tasks = yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["getTasksForPlannerBucket"])(this.graph, id);
            return tasks.map(task => ({
                _raw: task,
                assignments: task.assignments,
                completed: task.percentComplete === 100,
                dueDate: task.dueDateTime && new Date(task.dueDateTime),
                eTag: task['@odata.etag'],
                id: task.id,
                immediateParentId: task.bucketId,
                name: task.title,
                topParentId: task.planId
            }));
        });
    }
    /**
     * set task in planner to complete state by id
     *
     * @param {string} id
     * @param {string} eTag
     * @returns {Promise<any>}
     * @memberof PlannerTaskSource
     */
    setTaskComplete(id, eTag) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["setPlannerTaskComplete"])(this.graph, id, eTag);
        });
    }
    /**
     * set task in planner to incomplete state by id
     *
     * @param {string} id
     * @param {string} eTag
     * @returns {Promise<any>}
     * @memberof PlannerTaskSource
     */
    setTaskIncomplete(id, eTag) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["setPlannerTaskIncomplete"])(this.graph, id, eTag);
        });
    }
    /**
     * add new task to bucket
     *
     * @param {ITask} newTask
     * @returns {Promise<any>}
     * @memberof PlannerTaskSource
     */
    addTask(newTask) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["addPlannerTask"])(this.graph, {
                assignments: newTask.assignments,
                bucketId: newTask.immediateParentId,
                dueDateTime: newTask.dueDate && newTask.dueDate.toISOString(),
                planId: newTask.topParentId,
                title: newTask.name
            });
        });
    }
    /**
     * Assigns people to task
     *
     * @param {string} id
     * @param {string} eTag
     * @param {*} people
     * @returns {Promise<any>}
     * @memberof PlannerTaskSource
     */
    assignPeopleToTask(id, eTag, people) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["assignPeopleToPlannerTask"])(this.graph, id, eTag, people);
        });
    }
    /**
     * remove task from bucket
     *
     * @param {string} id
     * @param {string} eTag
     * @returns {Promise<any>}
     * @memberof PlannerTaskSource
     */
    removeTask(id, eTag) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["removePlannerTask"])(this.graph, id, eTag);
        });
    }
    /**
     * assigns task to the signed in user
     *
     * @param {ITask} task
     * @param {string} myId
     * @returns {boolean}
     * @memberof PlannerTaskSource
     */
    isAssignedToMe(task, myId) {
        const keys = Object.keys(task.assignments);
        return keys.includes(myId);
    }
}
/**
 * determins outlook task group for data source
 *
 * @export
 * @class TodoTaskSource
 * @extends {TaskSourceBase}
 * @implements {ITaskSource}
 */
// tslint:disable-next-line: max-classes-per-file
class TodoTaskSource extends TaskSourceBase {
    /**
     * get all Outlook task groups
     *
     * @returns {Promise<ITaskGroup[]>}
     * @memberof TodoTaskSource
     */
    getTaskGroups() {
        return __awaiter(this, void 0, void 0, function* () {
            const groups = yield Object(_mgt_tasks_graph_todo__WEBPACK_IMPORTED_MODULE_2__["getAllMyTodoGroups"])(this.graph);
            return groups.map(group => ({
                _raw: group,
                id: group.id,
                secondaryId: group.groupKey,
                title: group.name
            }));
        });
    }
    /**
     * get a single OutlookTaskGroup from id
     *
     * @param {string} id
     * @returns {Promise<ITaskGroup>}
     * @memberof TodoTaskSource
     */
    getTaskGroup(id) {
        return __awaiter(this, void 0, void 0, function* () {
            const group = yield Object(_mgt_tasks_graph_todo__WEBPACK_IMPORTED_MODULE_2__["getSingleTodoGroup"])(this.graph, id);
            return { id: group.id, secondaryId: group.groupKey, title: group.name, _raw: group };
        });
    }
    /**
     * get all OutlookTaskFolder for group by id
     *
     * @param {string} id
     * @returns {Promise<ITaskFolder[]>}
     * @memberof TodoTaskSource
     */
    getTaskFoldersForTaskGroup(id) {
        return __awaiter(this, void 0, void 0, function* () {
            const folders = yield Object(_mgt_tasks_graph_todo__WEBPACK_IMPORTED_MODULE_2__["getFoldersForTodoGroup"])(this.graph, id);
            return folders.map(folder => ({
                _raw: folder,
                id: folder.id,
                name: folder.name,
                parentId: id
            }));
        });
    }
    /**
     * gets all tasks for OutLook Task Folder by id
     *
     * @param {string} id
     * @param {string} parId
     * @returns {Promise<ITask[]>}
     * @memberof TodoTaskSource
     */
    getTasksForTaskFolder(id, parId) {
        return __awaiter(this, void 0, void 0, function* () {
            const tasks = yield Object(_mgt_tasks_graph_todo__WEBPACK_IMPORTED_MODULE_2__["getAllTodoTasksForFolder"])(this.graph, id);
            return tasks.map(task => ({
                _raw: task,
                assignments: {},
                completed: !!task.completedDateTime,
                dueDate: task.dueDateTime && new Date(task.dueDateTime.dateTime + 'Z'),
                eTag: task['@odata.etag'],
                id: task.id,
                immediateParentId: id,
                name: task.subject,
                topParentId: parId
            }));
        });
    }
    /**
     * set task in planner to complete state by id
     *
     * @param {string} id
     * @param {string} eTag
     * @returns {Promise<any>}
     * @memberof TodoTaskSource
     */
    setTaskComplete(id, eTag) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Object(_mgt_tasks_graph_todo__WEBPACK_IMPORTED_MODULE_2__["setTodoTaskComplete"])(this.graph, id, eTag);
        });
    }
    /**
     * Assigns people to task
     *
     * @param {string} id
     * @param {string} eTag
     * @param {*} people
     * @returns {Promise<any>}
     * @memberof PlannerTaskSource
     */
    assignPeopleToTask(id, eTag, people) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Object(_mgt_tasks_graph_planner__WEBPACK_IMPORTED_MODULE_1__["assignPeopleToPlannerTask"])(this.graph, id, eTag, people);
        });
    }
    /**
     * set task in planner to incomplete state by id
     *
     * @param {string} id
     * @param {string} eTag
     * @returns {Promise<any>}
     * @memberof TodoTaskSource
     */
    setTaskIncomplete(id, eTag) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Object(_mgt_tasks_graph_todo__WEBPACK_IMPORTED_MODULE_2__["setTodoTaskIncomplete"])(this.graph, id, eTag);
        });
    }
    /**
     * add new task to planner
     *
     * @param {ITask} newTask
     * @returns {Promise<any>}
     * @memberof TodoTaskSource
     */
    addTask(newTask) {
        return __awaiter(this, void 0, void 0, function* () {
            const task = {
                parentFolderId: newTask.immediateParentId,
                subject: newTask.name
            };
            if (newTask.dueDate) {
                task.dueDateTime = {
                    dateTime: newTask.dueDate.toISOString(),
                    timeZone: 'UTC'
                };
            }
            return yield Object(_mgt_tasks_graph_todo__WEBPACK_IMPORTED_MODULE_2__["addTodoTask"])(this.graph, task);
        });
    }
    /**
     * remove task from planner by id
     *
     * @param {string} id
     * @param {string} eTag
     * @returns {Promise<any>}
     * @memberof TodoTaskSource
     */
    removeTask(id, eTag) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield Object(_mgt_tasks_graph_todo__WEBPACK_IMPORTED_MODULE_2__["removeTodoTask"])(this.graph, id, eTag);
        });
    }
    /**
     * if task is assigned in to user logged in
     *
     * @param {ITask} task
     * @param {string} myId
     * @returns {boolean}
     * @memberof TodoTaskSource
     */
    isAssignedToMe(task, myId) {
        return true;
    }
    /**
     * returns promise with all of plans for group id
     *
     * @param {string} id
     * @returns {Promise<ITaskGroup[]>}
     * @memberof PlannerTaskSource
     */
    getTaskGroupsForGroup(id) {
        return __awaiter(this, void 0, void 0, function* () {
            return undefined;
        });
    }
}
//# sourceMappingURL=task-sources.js.map

/***/ }),

/***/ "FEzz":
/*!************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/XHRClient.js ***!
  \************************************************************************************/
/*! exports provided: XhrClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "XhrClient", function() { return XhrClient; });
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/Constants */ "vFME");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */

/**
 * XHR client for JSON endpoints
 * https://www.npmjs.com/package/async-promise
 * @hidden
 */
var XhrClient = /** @class */ (function () {
    function XhrClient() {
    }
    XhrClient.prototype.sendRequestAsync = function (url, method, enableCaching) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var xhr = new XMLHttpRequest();
            xhr.open(method, url, /* async: */ true);
            if (enableCaching) {
                /*
                 * TODO: (shivb) ensure that this can be cached
                 * xhr.setRequestHeader("Cache-Control", "Public");
                 */
            }
            xhr.onload = function () {
                if (xhr.status < 200 || xhr.status >= 300) {
                    reject(_this.handleError(xhr.responseText));
                }
                var jsonResponse;
                try {
                    jsonResponse = JSON.parse(xhr.responseText);
                }
                catch (e) {
                    reject(_this.handleError(xhr.responseText));
                }
                var response = {
                    statusCode: xhr.status,
                    body: jsonResponse
                };
                resolve(response);
            };
            xhr.onerror = function () {
                reject(xhr.status);
            };
            if (method === _utils_Constants__WEBPACK_IMPORTED_MODULE_0__["NetworkRequestType"].GET) {
                xhr.send();
            }
            else {
                throw "not implemented";
            }
        });
    };
    XhrClient.prototype.handleError = function (responseText) {
        var jsonResponse;
        try {
            jsonResponse = JSON.parse(responseText);
            if (jsonResponse.error) {
                return jsonResponse.error;
            }
            else {
                throw responseText;
            }
        }
        catch (e) {
            return responseText;
        }
    };
    return XhrClient;
}());

//# sourceMappingURL=XHRClient.js.map

/***/ }),

/***/ "FFC9":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/authority/TrustedAuthority.js ***!
  \*****************************************************************************************************/
/*! exports provided: TrustedAuthority */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TrustedAuthority", function() { return TrustedAuthority; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _XHRClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../XHRClient */ "FEzz");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/Constants */ "vFME");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/UrlUtils */ "8P3k");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var TrustedAuthority = /** @class */ (function () {
    function TrustedAuthority() {
    }
    /**
     *
     * @param validateAuthority
     * @param knownAuthorities
     */
    TrustedAuthority.setTrustedAuthoritiesFromConfig = function (validateAuthority, knownAuthorities) {
        if (validateAuthority && !this.getTrustedHostList().length) {
            knownAuthorities.forEach(function (authority) {
                TrustedAuthority.TrustedHostList.push(authority.toLowerCase());
            });
        }
    };
    /**
     *
     * @param telemetryManager
     * @param correlationId
     */
    TrustedAuthority.getAliases = function (authorityToVerify, telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, httpMethod, instanceDiscoveryEndpoint, httpEvent;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                client = new _XHRClient__WEBPACK_IMPORTED_MODULE_1__["XhrClient"]();
                httpMethod = _utils_Constants__WEBPACK_IMPORTED_MODULE_2__["NetworkRequestType"].GET;
                instanceDiscoveryEndpoint = "" + _utils_Constants__WEBPACK_IMPORTED_MODULE_2__["AAD_INSTANCE_DISCOVERY_ENDPOINT"] + authorityToVerify + "oauth2/v2.0/authorize";
                httpEvent = telemetryManager.createAndStartHttpEvent(correlationId, httpMethod, instanceDiscoveryEndpoint, "getAliases");
                return [2 /*return*/, client.sendRequestAsync(instanceDiscoveryEndpoint, httpMethod, true)
                        .then(function (response) {
                        httpEvent.httpResponseStatus = response.statusCode;
                        telemetryManager.stopEvent(httpEvent);
                        return response.body.metadata;
                    })
                        .catch(function (err) {
                        httpEvent.serverErrorCode = err;
                        telemetryManager.stopEvent(httpEvent);
                        throw err;
                    })];
            });
        });
    };
    /**
     *
     * @param telemetryManager
     * @param correlationId
     */
    TrustedAuthority.setTrustedAuthoritiesFromNetwork = function (authorityToVerify, telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var metadata, host;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.getAliases(authorityToVerify, telemetryManager, correlationId)];
                    case 1:
                        metadata = _a.sent();
                        metadata.forEach(function (entry) {
                            var authorities = entry.aliases;
                            authorities.forEach(function (authority) {
                                TrustedAuthority.TrustedHostList.push(authority.toLowerCase());
                            });
                        });
                        host = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].GetUrlComponents(authorityToVerify).HostNameAndPort;
                        if (TrustedAuthority.getTrustedHostList().length && !TrustedAuthority.IsInTrustedHostList(host)) {
                            // Custom Domain scenario, host is trusted because Instance Discovery call succeeded
                            TrustedAuthority.TrustedHostList.push(host.toLowerCase());
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    TrustedAuthority.getTrustedHostList = function () {
        return this.TrustedHostList;
    };
    /**
     * Checks to see if the host is in a list of trusted hosts
     * @param host
     */
    TrustedAuthority.IsInTrustedHostList = function (host) {
        return this.TrustedHostList.indexOf(host.toLowerCase()) > -1;
    };
    TrustedAuthority.TrustedHostList = [];
    return TrustedAuthority;
}());

//# sourceMappingURL=TrustedAuthority.js.map

/***/ }),

/***/ "FGIY":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/TelemetryHandler.js ***!
  \**********************************************************************************************/
/*! exports provided: TelemetryHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TelemetryHandler", function() { return TelemetryHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _GraphRequestUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../GraphRequestUtil */ "7eED");
/* harmony import */ var _Version__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Version */ "0Kec");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./MiddlewareControl */ "/M1i");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./MiddlewareUtil */ "z+g4");
/* harmony import */ var _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./options/TelemetryHandlerOptions */ "x9B3");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @module TelemetryHandler
 */





/**
 * @class
 * @implements Middleware
 * Class for TelemetryHandler
 */
class TelemetryHandler {
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const url = typeof context.request === "string" ? context.request : context.request.url;
                if (Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_1__["isGraphURL"])(url)) {
                    // Add telemetry only if the request url is a Graph URL.
                    // Errors are reported as in issue #265 if headers are present when redirecting to a non Graph URL
                    let clientRequestId = Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__["getRequestHeader"])(context.request, context.options, TelemetryHandler.CLIENT_REQUEST_ID_HEADER);
                    if (!clientRequestId) {
                        clientRequestId = Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__["generateUUID"])();
                        Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__["setRequestHeader"])(context.request, context.options, TelemetryHandler.CLIENT_REQUEST_ID_HEADER, clientRequestId);
                    }
                    let sdkVersionValue = `${TelemetryHandler.PRODUCT_NAME}/${_Version__WEBPACK_IMPORTED_MODULE_2__["PACKAGE_VERSION"]}`;
                    let options;
                    if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_3__["MiddlewareControl"]) {
                        options = context.middlewareControl.getMiddlewareOptions(_options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["TelemetryHandlerOptions"]);
                    }
                    if (options) {
                        const featureUsage = options.getFeatureUsage();
                        sdkVersionValue += ` (${TelemetryHandler.FEATURE_USAGE_STRING}=${featureUsage})`;
                    }
                    Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_4__["appendRequestHeader"])(context.request, context.options, TelemetryHandler.SDK_VERSION_HEADER, sdkVersionValue);
                }
                else {
                    // Remove telemetry headers if present during redirection.
                    delete context.options.headers[TelemetryHandler.CLIENT_REQUEST_ID_HEADER];
                    delete context.options.headers[TelemetryHandler.SDK_VERSION_HEADER];
                }
                return yield this.nextMiddleware.execute(context);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
/**
 * @private
 * @static
 * A member holding the name of the client request id header
 */
TelemetryHandler.CLIENT_REQUEST_ID_HEADER = "client-request-id";
/**
 * @private
 * @static
 * A member holding the name of the sdk version header
 */
TelemetryHandler.SDK_VERSION_HEADER = "SdkVersion";
/**
 * @private
 * @static
 * A member holding the language prefix for the sdk version header value
 */
TelemetryHandler.PRODUCT_NAME = "graph-js";
/**
 * @private
 * @static
 * A member holding the key for the feature usage metrics
 */
TelemetryHandler.FEATURE_USAGE_STRING = "featureUsage";
//# sourceMappingURL=TelemetryHandler.js.map

/***/ }),

/***/ "FPR2":
/*!****************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/utils/SvgHelper.js ***!
  \****************************************************************************/
/*! exports provided: SvgIcon, getSvg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SvgIcon", function() { return SvgIcon; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSvg", function() { return getSvg; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * Defines icon used by svgHelper
 *
 * @export
 * @enum {number}
 */
var SvgIcon;
(function (SvgIcon) {
    /**
     * Arrow Icon pointing right
     */
    SvgIcon[SvgIcon["ArrowRight"] = 0] = "ArrowRight";
    /**
     * Arrow Icon pointing down
     */
    SvgIcon[SvgIcon["ArrowDown"] = 1] = "ArrowDown";
    /**
     * Icon separates team from channel in selection
     */
    SvgIcon[SvgIcon["TeamSeparator"] = 2] = "TeamSeparator";
    /**
     * Search icon
     */
    SvgIcon[SvgIcon["Search"] = 3] = "Search";
    /**
     * Skype Arrow icon (out of office status)
     */
    SvgIcon[SvgIcon["SkypeArrow"] = 4] = "SkypeArrow";
    /**
     * Smaller email icon used in top of person card
     */
    SvgIcon[SvgIcon["SmallEmail"] = 5] = "SmallEmail";
    /**
     * Smaller chat icon used in top of person card
     */
    SvgIcon[SvgIcon["SmallChat"] = 6] = "SmallChat";
    /**
     * Downward chevron
     */
    SvgIcon[SvgIcon["ExpandDown"] = 7] = "ExpandDown";
    /**
     * Overview icon
     */
    SvgIcon[SvgIcon["Overview"] = 8] = "Overview";
    /**
     * Paper plane
     */
    SvgIcon[SvgIcon["Send"] = 9] = "Send";
    /**
     * Phone/Mail icon
     */
    SvgIcon[SvgIcon["Contact"] = 10] = "Contact";
    /**
     * Copy to clipboard
     */
    SvgIcon[SvgIcon["Copy"] = 11] = "Copy";
    /**
     * A cellphone
     */
    SvgIcon[SvgIcon["CellPhone"] = 12] = "CellPhone";
    /**
     * Chat message
     */
    SvgIcon[SvgIcon["Chat"] = 13] = "Chat";
    /**
     * Company department
     */
    SvgIcon[SvgIcon["Department"] = 14] = "Department";
    /**
     * Email message
     */
    SvgIcon[SvgIcon["Email"] = 15] = "Email";
    /**
     * Location indicator
     */
    SvgIcon[SvgIcon["OfficeLocation"] = 16] = "OfficeLocation";
    /**
     * A person
     */
    SvgIcon[SvgIcon["Person"] = 17] = "Person";
    /**
     * Messages
     */
    SvgIcon[SvgIcon["Messages"] = 18] = "Messages";
    /**
     * Organization tree
     */
    SvgIcon[SvgIcon["Organization"] = 19] = "Organization";
    /**
     * Right facing chevron
     */
    SvgIcon[SvgIcon["ExpandRight"] = 20] = "ExpandRight";
    /**
     * Person profile
     */
    SvgIcon[SvgIcon["Profile"] = 21] = "Profile";
    /**
     * Balloon
     */
    SvgIcon[SvgIcon["Birthday"] = 22] = "Birthday";
    /**
     * File icon
     */
    SvgIcon[SvgIcon["File"] = 23] = "File";
    /**
     * Files icon
     */
    SvgIcon[SvgIcon["Files"] = 24] = "Files";
    /**
     * Back arrow
     */
    SvgIcon[SvgIcon["Back"] = 25] = "Back";
})(SvgIcon || (SvgIcon = {}));

/**
 * returns an svg
 * @param svgIcon defined by name
 * @param color hex value
 */
function getSvg(svgIcon, color) {
    switch (svgIcon) {
        case SvgIcon.ArrowRight:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 7L4.46481 10.5359L4.46481 7L4.46481 3.46413L8 7Z" />
        </svg>
      `;
        case SvgIcon.ArrowDown:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;
        case SvgIcon.TeamSeparator:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${color}
          />
        </svg>
      `;
        case SvgIcon.Search:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0)">
            <circle cx="5.36377" cy="5.36396" r="4" transform="rotate(45 5.36377 5.36396)" stroke="#B3B0AD" />
            <path
              d="M8.19189 7.48529L12.7881 12.0815C12.9834 12.2767 12.9834 12.5933 12.7881 12.7886V12.7886C12.5928 12.9839 12.2762 12.9839 12.081 12.7886L7.48479 8.1924L8.19189 7.48529Z"
              fill="#B3B0AD"
            />
          </g>
          <defs>
            <clipPath id="clip0">
              <rect width="14" height="14" fill="white" />
            </clipPath>
          </defs>
        </svg>
      `;
        case SvgIcon.SkypeArrow:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;
        case SvgIcon.SmallEmail:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="14" height="10" viewBox="0 0 14 10" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M11.8473 1H2.04886L6.47364 4.18916C6.64273 4.31103 6.86969 4.31522 7.04316 4.19968L11.8473 1ZM1 1.47671V9H13V1.43376L7.59749 5.03198C7.07706 5.3786 6.39621 5.36601 5.88894 5.0004L1 1.47671ZM0 1C0 0.447715 0.447715 0 1 0H13C13.5523 0 14 0.447715 14 1V9C14 9.55228 13.5523 10 13 10H1C0.447716 10 0 9.55229 0 9V1Z"
          />
        </svg>
      `;
        case SvgIcon.SmallChat:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="13" height="13" viewBox="0 0 13 13" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M9.5781 8.26403L9.57811 8.26403C9.68611 8.29867 9.8455 8.36364 10.0125 8.50479C10.1405 8.61294 10.2409 8.73883 10.3235 8.86465L11.9634 10.9944C11.9701 10.9924 11.9753 10.9904 11.9785 10.9889C11.9841 10.9864 11.9918 10.9823 12 10.9768V1.32284C12 1.18078 11.8731 1 11.6207 1H1.37926C1.12692 1 1 1.18078 1 1.32284V7.37377C1 7.45357 1.01415 7.49036 1.02102 7.50507C1.02778 7.51955 1.04342 7.54689 1.09159 7.58705L1.10485 7.5981L1.11771 7.6096C1.13526 7.62529 1.21707 7.69076 1.33937 7.76027C1.46122 7.82952 1.58119 7.87864 1.67944 7.89966L1.69102 7.90214L1.691 7.9022C3.32106 8.27116 6.2626 8.27688 8.67896 8.18036L8.69908 8.17955L8.71921 8.17956L8.7627 8.17954C9.01362 8.17932 9.31313 8.17907 9.5781 8.26403ZM11.2376 11.6908L9.50506 9.44081C9.39493 9.26422 9.32445 9.23285 9.27276 9.21627C9.17534 9.18504 9.0401 9.17966 8.71888 9.17956C6.31879 9.27543 3.24831 9.27999 1.47024 8.87753C1.01314 8.77974 0.600449 8.48852 0.451238 8.35513C0.15593 8.10893 0 7.78958 0 7.37377V1.32284C0 0.593147 0.610664 0 1.37926 0H11.6207C12.3893 0 13 0.593147 13 1.32284V11.0441C13 11.4686 12.6828 11.7689 12.3881 11.9012C12.1048 12.0284 11.673 12.0728 11.3387 11.7993C11.3003 11.7679 11.2678 11.7301 11.2376 11.6908ZM3 3.5C3 3.22386 3.22386 3 3.5 3H9.5C9.77614 3 10 3.22386 10 3.5C10 3.77614 9.77614 4 9.5 4H3.5C3.22386 4 3 3.77614 3 3.5ZM3.5 5C3.22386 5 3 5.22386 3 5.5C3 5.77614 3.22386 6 3.5 6H6.5C6.77614 6 7 5.77614 7 5.5C7 5.22386 6.77614 5 6.5 5H3.5Z"
          />
        </svg>
      `;
        case SvgIcon.ExpandDown: {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="#3078CD" />
        </svg>
      `;
        }
        case SvgIcon.Overview:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12 4V9H2V4H12ZM11 8V5H3V8H11ZM13 4H18V9H13V4ZM17 8V5H14V8H17ZM8 15V10H18V15H8ZM9 11V14H17V11H9ZM2 15V10H7V15H2ZM3 11V14H6V11H3Z"
          />
        </svg>
      `;
        case SvgIcon.Send:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;
        case SvgIcon.Contact:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M11.3315 11.7855L11.3452 11.7913L11.3591 11.7967C11.4057 11.8149 11.4421 11.8389 11.4762 11.8729L12.8836 13.2797C12.9177 13.3137 12.9416 13.35 12.9597 13.3965L12.9651 13.4104L12.971 13.4241C12.9902 13.4693 13 13.5151 13 13.5699C13 13.6248 12.9901 13.6759 12.9676 13.7303L12.9675 13.7302L12.9628 13.7419C12.9458 13.7844 12.9218 13.822 12.8836 13.8602L12.7941 13.9497C12.57 14.1736 12.3673 14.37 12.1855 14.5396C12.0445 14.6712 11.9037 14.7767 11.7639 14.8601C11.6429 14.9284 11.499 14.9865 11.3265 15.0296C11.1716 15.0683 10.9523 15.0957 10.6541 15.0957C10.226 15.0957 9.77339 15.0291 9.29316 14.8873C8.79837 14.7411 8.29897 14.537 7.79466 14.2716C7.29099 14.0043 6.7904 13.6843 6.2931 13.3097C5.79797 12.9334 5.32815 12.5234 4.88351 12.0793C4.44215 11.6299 4.03516 11.1575 3.66219 10.6619C3.2916 10.1652 2.97561 9.66531 2.71228 9.16232C2.44987 8.65684 2.24939 8.16115 2.1072 7.67496C1.96889 7.20203 1.9043 6.75953 1.9043 6.34426C1.9043 6.04676 1.92945 5.8283 1.96505 5.67477C2.00758 5.51024 2.06491 5.36965 2.13346 5.24839C2.21771 5.10725 2.32161 4.96874 2.44802 4.83312C2.61763 4.65148 2.814 4.44899 3.03788 4.22522L3.14024 4.12291C3.18256 4.08061 3.22694 4.05101 3.2785 4.0291C3.32105 4.01103 3.36887 4 3.43131 4C3.48634 4 3.53235 4.00983 3.57773 4.0291L3.57771 4.02914L3.58585 4.03251C3.6411 4.05541 3.68414 4.08469 3.72239 4.12291L5.12984 5.52968C5.16387 5.56369 5.18781 5.60004 5.20594 5.64649L5.21136 5.66038L5.2172 5.6741C5.23642 5.71931 5.24622 5.76513 5.24622 5.81992C5.24622 5.88591 5.23631 5.9178 5.23225 5.92835C5.20132 5.99698 5.16601 6.05438 5.12738 6.10352C5.07447 6.17083 5.01613 6.23146 4.95179 6.28625L4.94467 6.2923L4.93768 6.29849C4.81323 6.40852 4.69584 6.51839 4.58605 6.62811C4.45174 6.76237 4.32909 6.90895 4.22378 7.06908C4.0535 7.32254 3.96032 7.61696 3.96032 7.93007C3.96032 8.35888 4.12439 8.75141 4.42612 9.05299L7.95115 12.5763C8.25285 12.8779 8.64535 13.0417 9.07392 13.0417C9.38687 13.0417 9.68121 12.9486 9.9347 12.7785C10.0949 12.6733 10.2415 12.5507 10.3758 12.4164C10.4856 12.3067 10.5955 12.1894 10.7056 12.065L10.7118 12.058L10.7179 12.0509C10.7727 11.9866 10.8333 11.9283 10.9007 11.8754C10.9499 11.8367 11.0074 11.8014 11.0761 11.7704C11.0868 11.7663 11.1189 11.7564 11.1851 11.7564C11.2401 11.7564 11.2861 11.7662 11.3315 11.7855ZM11.5689 15.9998C11.8248 15.9358 12.0573 15.8442 12.2663 15.7248C12.4753 15.6012 12.6757 15.4499 12.8676 15.2708C13.0596 15.0918 13.2707 14.8872 13.501 14.657L13.5906 14.5674C13.7228 14.4353 13.823 14.284 13.8912 14.1134C13.9637 13.9387 14 13.7575 14 13.5699C14 13.3824 13.9637 13.2033 13.8912 13.0328C13.823 12.858 13.7228 12.7045 13.5906 12.5724L12.1831 11.1656C12.0509 11.0335 11.8974 10.9333 11.7225 10.8651C11.5519 10.7926 11.3728 10.7564 11.1851 10.7564C10.9974 10.7564 10.829 10.7884 10.6797 10.8523C10.5347 10.9163 10.4025 10.9951 10.283 11.0889C10.1636 11.1827 10.0549 11.2871 9.95677 11.4022C9.85868 11.5131 9.76272 11.6154 9.66889 11.7092C9.57506 11.8029 9.47909 11.8818 9.381 11.9457C9.28717 12.0097 9.18481 12.0417 9.07392 12.0417C8.91185 12.0417 8.77323 11.9841 8.65808 11.869L5.13305 8.34571C5.0179 8.23061 4.96032 8.09206 4.96032 7.93007C4.96032 7.81924 4.99231 7.71693 5.05628 7.62314C5.12026 7.52509 5.19916 7.42918 5.29299 7.33539C5.38682 7.24161 5.48918 7.14569 5.60007 7.04765C5.71522 6.9496 5.81972 6.84089 5.91355 6.72153C6.00738 6.60217 6.08628 6.47002 6.15026 6.32508C6.21423 6.17588 6.24622 6.00749 6.24622 5.81992C6.24622 5.63236 6.20997 5.45331 6.13746 5.2828C6.06922 5.10802 5.96899 4.95455 5.83678 4.8224L4.42932 3.41564C4.29711 3.28348 4.14357 3.18117 3.9687 3.1087C3.7981 3.03623 3.61897 3 3.43131 3C3.23939 3 3.05813 3.03623 2.88752 3.1087C2.71692 3.18117 2.56552 3.28348 2.4333 3.41564L2.33094 3.51795C2.10063 3.74814 1.89591 3.95916 1.71678 4.15099C1.54192 4.33856 1.39264 4.53678 1.26895 4.74567C1.14953 4.95455 1.05784 5.18475 0.993862 5.43626C0.934152 5.68777 0.904297 5.99044 0.904297 6.34426C0.904297 6.86434 0.985332 7.40147 1.1474 7.95565C1.30947 8.50983 1.53552 9.06614 1.82554 9.62458C2.11556 10.1788 2.46102 10.7244 2.86193 11.2615C3.26285 11.7944 3.70001 12.3017 4.17342 12.7834C4.65111 13.2609 5.15651 13.7021 5.68963 14.107C6.22703 14.512 6.77295 14.8616 7.3274 15.1557C7.88611 15.4499 8.44696 15.6801 9.00994 15.8463C9.57292 16.0126 10.121 16.0957 10.6541 16.0957C11.0081 16.0957 11.313 16.0637 11.5689 15.9998ZM14.9616 14H17.0002C17.5525 14 18.0002 13.5523 18.0002 13V5C18.0002 4.44772 17.5525 4 17.0002 4H6.43555L6.54385 4.11514C6.77073 4.34192 6.94536 4.60775 7.06365 4.90525C7.07677 4.93665 7.08919 4.96824 7.10089 5H16.8821L10.2238 8.32913C10.083 8.39951 9.91736 8.39951 9.7766 8.32913L7.22381 7.05273L6.7766 7.94716L9.32938 9.22355C9.75167 9.4347 10.2487 9.4347 10.671 9.22356L17.0002 6.05895V13H14.9314C14.9772 13.1858 15.0001 13.3764 15.0001 13.5699C15.0001 13.7154 14.9872 13.8589 14.9616 14Z"
          />
        </svg>
      `;
        case SvgIcon.Copy:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;
        case SvgIcon.CellPhone:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="10" height="15" viewBox="0 0 10 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="0.5" y="0.5" width="9" height="14" rx="0.9" stroke="${color}" />
          <rect x="3" y="12" width="4" height="1" rx="0.5" fill="${color}" />
        </svg>
      `;
        case SvgIcon.Chat:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M2.67824 0C2.3824 0 2.14258 0.239826 2.14258 0.535665C2.14258 0.831505 2.3824 1.07133 2.67824 1.07133H13.9985C14.5508 1.07133 14.9985 1.51905 14.9985 2.07133V12.3203C14.9985 12.6161 15.2384 12.856 15.5342 12.856C15.8301 12.856 16.0699 12.6161 16.0699 12.3203V2C16.0699 0.895431 15.1744 0 14.0699 0H2.67824Z"
            fill="${color}"
          />
          <path
            d="M9.34097 11.4769L9.3309 11.4769L9.32085 11.4773C6.74142 11.5804 3.51639 11.5801 1.6855 11.1657L1.6855 11.1657L1.67972 11.1644C1.30373 11.084 0.937799 10.8292 0.816663 10.7209L0.81023 10.7152L0.803602 10.7096C0.601843 10.5414 0.5 10.3403 0.5 10.0423V3.55978C0.5 3.07185 0.912353 2.64258 1.47765 2.64258H12.4497C13.0149 2.64258 13.4273 3.07185 13.4273 3.55978V13.9745C13.4273 14.1578 13.2827 14.3397 13.067 14.4366C12.8614 14.5288 12.6204 14.5275 12.457 14.3904L10.5932 11.9699C10.5218 11.8587 10.4457 11.7646 10.3579 11.6904C10.2528 11.6015 10.1556 11.5622 10.0869 11.5401L9.93419 12.0163L10.0869 11.5401C9.89097 11.4773 9.65413 11.477 9.34097 11.4769Z"
            stroke="${color}"
          />
        </svg>
      `;
        case SvgIcon.Department:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M9.625 3.5H14V11.375H0V3.5H4.375V1.75H9.625V3.5ZM5.25 2.625V3.5H8.75V2.625H5.25ZM13.125 4.375H0.875V6.125H3.5V5.25H4.375V6.125H9.625V5.25H10.5V6.125H13.125V4.375ZM0.875 10.5H13.125V7H10.5V7.875H9.625V7H4.375V7.875H3.5V7H0.875V10.5Z"
            fill="${color}"
          />
        </svg>
      `;
        case SvgIcon.Email:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M0.5 0.772727C0.5 0.622104 0.622104 0.5 0.772727 0.5H13.2273C13.3779 0.5 13.5 0.622104 13.5 0.772727V9.22727C13.5 9.3779 13.3779 9.5 13.2273 9.5H0.772727C0.622104 9.5 0.5 9.3779 0.5 9.22727V0.772727Z"
            stroke="${color}"
          />
          <path d="M13.5 0.5L7.18923 4.70314C6.92113 4.8817 6.57039 4.87522 6.30907 4.68687L0.5 0.5" stroke="#929292" />
        </svg>
      `;
        case SvgIcon.OfficeLocation:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="14" height="17" viewBox="0 0 14 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M6.78489 16.3832L6.78263 16.3859C6.75278 16.4216 6.71543 16.4503 6.67324 16.4701L6.88498 16.923L6.67324 16.4701C6.63105 16.4898 6.58504 16.5 6.53846 16.5C6.49188 16.5 6.44588 16.4898 6.40368 16.4701C6.36149 16.4503 6.32415 16.4216 6.2943 16.3859L6.29202 16.3832C5.47882 15.4241 4.01597 13.6289 2.75914 11.7172C2.13055 10.7611 1.56021 9.78597 1.14862 8.87887C0.732553 7.96189 0.5 7.15987 0.5 6.53687C0.5 3.20251 3.20343 0.5 6.53846 0.5C9.87349 0.5 12.5769 3.20251 12.5769 6.53687C12.5769 7.16011 12.3444 7.96225 11.9283 8.87925C11.5167 9.78639 10.9464 10.7615 10.3178 11.7175C9.06097 13.6291 7.59812 15.424 6.78489 16.3832Z"
            stroke="${color}"
          />
          <path
            d="M4.40039 6.53921C4.40039 5.37092 5.34748 4.42383 6.51577 4.42383C7.68407 4.42383 8.63116 5.37092 8.63116 6.53921C8.63116 7.70751 7.68407 8.6546 6.51577 8.6546C5.34748 8.6546 4.40039 7.70751 4.40039 6.53921Z"
            stroke="${color}"
          />
        </svg>
      `;
        case SvgIcon.Person:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M8.91699 4C8.91699 5.65685 7.57385 7 5.91699 7C4.26014 7 2.91699 5.65685 2.91699 4C2.91699 2.34315 4.26014 1 5.91699 1C7.57385 1 8.91699 2.34315 8.91699 4ZM8.04431 7.38803C9.16935 6.68014 9.91699 5.42738 9.91699 4C9.91699 1.79086 8.12613 0 5.91699 0C3.70785 0 1.91699 1.79086 1.91699 4C1.91699 5.42739 2.66465 6.68016 3.78972 7.38805C1.82681 8.13254 0.356122 9.8773 0 12H1.01706C1.48033 9.71776 3.49808 8 5.91704 8C8.336 8 10.3538 9.71776 10.817 12H11.8341C11.478 9.87728 10.0072 8.1325 8.04431 7.38803Z"
            fill="${color}"
          />
        </svg>
      `;
        case SvgIcon.Messages:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4 3.5C4 3.22386 4.22386 3 4.5 3H16C17.1046 3 18 3.89543 18 5V12.5C18 12.7761 17.7761 13 17.5 13C17.2239 13 17 12.7761 17 12.5V5C17 4.44772 16.5523 4 16 4H4.5C4.22386 4 4 3.77614 4 3.5ZM4.04886 6H13.8473L9.04316 9.19968C8.86969 9.31522 8.64273 9.31103 8.47364 9.18916L4.04886 6ZM3 14V6.47671L7.88894 10.0004C8.39621 10.366 9.07706 10.3786 9.59749 10.032L15 6.43376V14H3ZM3 5C2.44772 5 2 5.44772 2 6V14C2 14.5523 2.44772 15 3 15H15C15.5523 15 16 14.5523 16 14V6C16 5.44772 15.5523 5 15 5H3Z"
          />
        </svg>
      `;
        case SvgIcon.Organization:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13 4H8V7H13V4ZM8 3C7.44772 3 7 3.44772 7 4V7C7 7.55228 7.44772 8 8 8H10V9H7.5C6.67157 9 6 9.67157 6 10.5V11H4C3.44772 11 3 11.4477 3 12V15C3 15.5523 3.44772 16 4 16H9C9.55228 16 10 15.5523 10 15V12C10 11.4477 9.55228 11 9 11H7V10.5C7 10.2239 7.22386 10 7.5 10H13.5C13.7761 10 14 10.2239 14 10.5V11H12C11.4477 11 11 11.4477 11 12V15C11 15.5523 11.4477 16 12 16H17C17.5523 16 18 15.5523 18 15V12C18 11.4477 17.5523 11 17 11H15V10.5C15 9.67157 14.3284 9 13.5 9H11V8H13C13.5523 8 14 7.55228 14 7V4C14 3.44772 13.5523 3 13 3H8ZM9 12H4L4 15H9V12ZM12 12H17V15H12V12Z"
          />
        </svg>
      `;
        case SvgIcon.ExpandRight:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;
        case SvgIcon.Profile:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M13 8C13 9.65685 11.6569 11 10 11C8.34315 11 7 9.65685 7 8C7 6.34315 8.34315 5 10 5C11.6569 5 13 6.34315 13 8ZM12.1273 11.388C13.2524 10.6801 14 9.42738 14 8C14 5.79086 12.2091 4 10 4C7.79086 4 6 5.79086 6 8C6 9.42739 6.74766 10.6802 7.87272 11.3881C5.90981 12.1325 4.43913 13.8773 4.08301 16H5.10007C5.56334 13.7178 7.58109 12 10 12C12.419 12 14.4368 13.7178 14.9 16H15.9171C15.561 13.8773 14.0903 12.1325 12.1273 11.388Z"
          />
        </svg>
      `;
        case SvgIcon.Profile:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="12" height="14" viewBox="0 0 12 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.5"
            d="M5.125 10.0625C5.125 10.2448 5.15918 10.4157 5.22754 10.5752C5.2959 10.7347 5.38932 10.8737 5.50781 10.9922C5.6263 11.1107 5.7653 11.2041 5.9248 11.2725C6.08431 11.3408 6.25521 11.375 6.4375 11.375H9.0625C9.35872 11.375 9.63672 11.4297 9.89648 11.5391C10.1608 11.6484 10.3978 11.8079 10.6074 12.0176C10.8171 12.2272 10.9766 12.4642 11.0859 12.7285C11.1953 12.9883 11.25 13.2663 11.25 13.5625C11.25 13.681 11.2067 13.7835 11.1201 13.8701C11.0335 13.9567 10.931 14 10.8125 14C10.694 14 10.5915 13.9567 10.5049 13.8701C10.4183 13.7835 10.375 13.681 10.375 13.5625C10.375 13.3802 10.3408 13.2093 10.2725 13.0498C10.2041 12.8903 10.1107 12.7513 9.99219 12.6328C9.8737 12.5143 9.7347 12.4209 9.5752 12.3525C9.41569 12.2842 9.24479 12.25 9.0625 12.25H6.4375C6.14128 12.25 5.861 12.1953 5.59668 12.0859C5.33691 11.9766 5.10221 11.8171 4.89258 11.6074C4.68294 11.3978 4.52344 11.1631 4.41406 10.9033C4.30469 10.639 4.25 10.3587 4.25 10.0625V9.46777C3.7168 9.21712 3.23372 8.89811 2.80078 8.51074C2.36784 8.12337 1.9987 7.69043 1.69336 7.21191C1.39258 6.72884 1.16016 6.21159 0.996094 5.66016C0.832031 5.10417 0.75 4.52995 0.75 3.9375C0.75 3.39518 0.852539 2.88477 1.05762 2.40625C1.26725 1.92773 1.5498 1.51074 1.90527 1.15527C2.26074 0.799805 2.67773 0.519531 3.15625 0.314453C3.63477 0.104818 4.14518 0 4.6875 0C5.22982 0 5.74023 0.104818 6.21875 0.314453C6.69727 0.519531 7.11426 0.799805 7.46973 1.15527C7.8252 1.51074 8.10547 1.92773 8.31055 2.40625C8.52018 2.88477 8.625 3.39518 8.625 3.9375C8.625 4.52995 8.54297 5.10417 8.37891 5.66016C8.21484 6.21615 7.98014 6.7334 7.6748 7.21191C7.37402 7.69043 7.00716 8.12337 6.57422 8.51074C6.14583 8.89811 5.66276 9.21712 5.125 9.46777V10.0625ZM1.625 3.9375C1.625 4.45247 1.69564 4.9515 1.83691 5.43457C1.98275 5.91309 2.18783 6.3597 2.45215 6.77441C2.72103 7.18913 3.04232 7.56283 3.41602 7.89551C3.79427 8.22363 4.2181 8.49479 4.6875 8.70898C5.1569 8.49479 5.57845 8.22363 5.95215 7.89551C6.3304 7.56283 6.65169 7.18913 6.91602 6.77441C7.1849 6.3597 7.38997 5.91309 7.53125 5.43457C7.67708 4.9515 7.75 4.45247 7.75 3.9375C7.75 3.51367 7.66797 3.11719 7.50391 2.74805C7.3444 2.37435 7.12565 2.05078 6.84766 1.77734C6.57422 1.49935 6.25065 1.2806 5.87695 1.12109C5.50781 0.957031 5.11133 0.875 4.6875 0.875C4.26367 0.875 3.86491 0.957031 3.49121 1.12109C3.12207 1.2806 2.7985 1.49935 2.52051 1.77734C2.24707 2.05078 2.02832 2.37435 1.86426 2.74805C1.70475 3.11719 1.625 3.51367 1.625 3.9375ZM6.4375 4.375C6.31901 4.375 6.21647 4.33171 6.12988 4.24512C6.04329 4.15853 6 4.05599 6 3.9375C6 3.75521 5.96582 3.58431 5.89746 3.4248C5.8291 3.2653 5.73568 3.1263 5.61719 3.00781C5.4987 2.88932 5.3597 2.7959 5.2002 2.72754C5.04069 2.65918 4.86979 2.625 4.6875 2.625C4.56901 2.625 4.46647 2.58171 4.37988 2.49512C4.29329 2.40853 4.25 2.30599 4.25 2.1875C4.25 2.06901 4.29329 1.96647 4.37988 1.87988C4.46647 1.79329 4.56901 1.75 4.6875 1.75C4.98828 1.75 5.27083 1.80697 5.53516 1.9209C5.80404 2.03483 6.03646 2.19206 6.23242 2.39258C6.43294 2.58854 6.59017 2.82096 6.7041 3.08984C6.81803 3.35417 6.875 3.63672 6.875 3.9375C6.875 4.05599 6.83171 4.15853 6.74512 4.24512C6.65853 4.33171 6.55599 4.375 6.4375 4.375Z"
            fill="black"
          />
        </svg>
      `;
        case SvgIcon.File:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="20" height="26" viewBox="0 0 20 26" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;
        case SvgIcon.Files:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M17 8C17.1354 8 17.263 8.02604 17.3828 8.07812C17.5078 8.13021 17.6146 8.20312 17.7031 8.29688C17.7969 8.38542 17.8698 8.48958 17.9219 8.60938C17.974 8.72917 18 8.85677 18 8.99219C18 9.14844 17.9635 9.29948 17.8906 9.44531L14.6172 16H2V5C2 4.85938 2.02604 4.72917 2.07812 4.60938C2.13021 4.48958 2.20052 4.38542 2.28906 4.29688C2.38281 4.20312 2.48958 4.13021 2.60938 4.07812C2.72917 4.02604 2.85938 4 3 4H5.75C5.98438 4 6.1849 4.02604 6.35156 4.07812C6.52344 4.125 6.67448 4.1849 6.80469 4.25781C6.9401 4.33073 7.0599 4.41146 7.16406 4.5C7.26823 4.58854 7.3724 4.66927 7.47656 4.74219C7.58594 4.8151 7.70052 4.8776 7.82031 4.92969C7.94531 4.97656 8.08854 5 8.25 5H14C14.1406 5 14.2708 5.02604 14.3906 5.07812C14.5104 5.13021 14.6146 5.20312 14.7031 5.29688C14.7969 5.38542 14.8698 5.48958 14.9219 5.60938C14.974 5.72917 15 5.85938 15 6V8H17ZM3 13.3828L5.41406 8.55469C5.5026 8.38281 5.625 8.2474 5.78125 8.14844C5.94271 8.04948 6.11979 8 6.3125 8H14V6H8.25C8.01562 6 7.8125 5.97656 7.64062 5.92969C7.47396 5.8776 7.32292 5.8151 7.1875 5.74219C7.05729 5.66927 6.9401 5.58854 6.83594 5.5C6.73177 5.41146 6.625 5.33073 6.51562 5.25781C6.41146 5.1849 6.29688 5.125 6.17188 5.07812C6.05208 5.02604 5.91146 5 5.75 5H3V13.3828ZM17 9H6.3125L3.3125 15H14L17 9Z"
          />
        </svg>
      `;
        case SvgIcon.Back:
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `;
    }
}
//# sourceMappingURL=SvgHelper.js.map

/***/ }),

/***/ "FT8K":
/*!********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/Logger.js ***!
  \********************************************************************************************/
/*! exports provided: LogLevel, Logger */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LogLevel", function() { return LogLevel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Logger", function() { return Logger; });
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/StringUtils */ "UjIo");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ "MQw9");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var LogLevel;
(function (LogLevel) {
    LogLevel[LogLevel["Error"] = 0] = "Error";
    LogLevel[LogLevel["Warning"] = 1] = "Warning";
    LogLevel[LogLevel["Info"] = 2] = "Info";
    LogLevel[LogLevel["Verbose"] = 3] = "Verbose";
})(LogLevel || (LogLevel = {}));
var Logger = /** @class */ (function () {
    function Logger(localCallback, options) {
        if (options === void 0) { options = {}; }
        /**
         * @hidden
         */
        this.level = LogLevel.Info;
        var _a = options.correlationId, correlationId = _a === void 0 ? "" : _a, _b = options.level, level = _b === void 0 ? LogLevel.Info : _b, _c = options.piiLoggingEnabled, piiLoggingEnabled = _c === void 0 ? false : _c;
        this.localCallback = localCallback;
        this.correlationId = correlationId;
        this.level = level;
        this.piiLoggingEnabled = piiLoggingEnabled;
    }
    /**
     * @hidden
     */
    Logger.prototype.logMessage = function (logLevel, logMessage, containsPii) {
        if ((logLevel > this.level) || (!this.piiLoggingEnabled && containsPii)) {
            return;
        }
        var timestamp = new Date().toUTCString();
        var log;
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_0__["StringUtils"].isEmpty(this.correlationId)) {
            log = timestamp + ":" + this.correlationId + "-" + Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["libraryVersion"])() + "-" + LogLevel[logLevel] + (containsPii ? "-pii" : "") + " " + logMessage;
        }
        else {
            log = timestamp + ":" + Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["libraryVersion"])() + "-" + LogLevel[logLevel] + (containsPii ? "-pii" : "") + " " + logMessage;
        }
        this.executeCallback(logLevel, log, containsPii);
    };
    /**
     * @hidden
     */
    Logger.prototype.executeCallback = function (level, message, containsPii) {
        if (this.localCallback) {
            this.localCallback(level, message, containsPii);
        }
    };
    /**
     * @hidden
     */
    Logger.prototype.error = function (message) {
        this.logMessage(LogLevel.Error, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.errorPii = function (message) {
        this.logMessage(LogLevel.Error, message, true);
    };
    /**
     * @hidden
     */
    Logger.prototype.warning = function (message) {
        this.logMessage(LogLevel.Warning, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.warningPii = function (message) {
        this.logMessage(LogLevel.Warning, message, true);
    };
    /**
     * @hidden
     */
    Logger.prototype.info = function (message) {
        this.logMessage(LogLevel.Info, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.infoPii = function (message) {
        this.logMessage(LogLevel.Info, message, true);
    };
    /**
     * @hidden
     */
    Logger.prototype.verbose = function (message) {
        this.logMessage(LogLevel.Verbose, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.verbosePii = function (message) {
        this.logMessage(LogLevel.Verbose, message, true);
    };
    Logger.prototype.isPiiLoggingEnabled = function () {
        return this.piiLoggingEnabled;
    };
    return Logger;
}());

//# sourceMappingURL=Logger.js.map

/***/ }),

/***/ "FTWT":
/*!**************************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-organization/mgt-person-card-organization-css.js ***!
  \**************************************************************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 20px 20px}:host .root .subtitle{color:var(--title-color-sub2,#797775);font-size:14px;margin:0 20px 8px 20px}:host .root .divider{display:flex;background:var(--line-seperator-color,#edebe9);height:1px;margin-top:26px;margin-bottom:18px;margin-left:20px;margin-right:20px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--background-color-sub2,#f3f2f1);border:1px solid #0078d4}:host .root .org-member.org-member--direct-report:not(:last-child){border-bottom:none}:host .root .org-member:not(.org-member--target){background-color:var(--background-color-sub1,#faf9f8);border:1px solid var(--line-seperator-color,#edebe9)}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__person mgt-person{--avatar-size:48px;--avatar-size-s:48px;--font-size:16px;--color:#323130;--line2-font-size:14px;--line3-font-size:14px;--line2-text-transform:uppercase;--line2-color:#797775;--line3-color:#797775;--line3-text-transform:uppercase;margin-right:8px;max-width:230px}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--color-sub1,#323130);font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--color-sub2,#797775)}:host .root .org-member__separator{border:1px solid var(--line-seperator-color,#edebe9);box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--background-color--hover,#edebe9)}:host .root .coworker .coworker__person{height:46px;width:46px;border-radius:46px;margin-right:8px}:host .root .coworker .coworker__person mgt-person{--font-size:16px;--line2-text-transform:uppercase;--line2-font-size:14px;--line2-color:set-var(color__sub2, $theme-default, $common);--avatar-size:46px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}
`
];
//# sourceMappingURL=mgt-person-card-organization-css.js.map

/***/ }),

/***/ "FbQe":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/ServerRequestParameters.js ***!
  \*************************************************************************************************************/
/*! exports provided: ServerRequestParameters */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerRequestParameters", function() { return ServerRequestParameters; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ "oish");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ "MQw9");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ "UjIo");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ScopeSet */ "qfGv");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




/**
 * Nonce: OIDC Nonce definition: https://openid.net/specs/openid-connect-core-1_0.html#IDToken
 * State: OAuth Spec: https://tools.ietf.org/html/rfc6749#section-10.12
 * @hidden
 */
var ServerRequestParameters = /** @class */ (function () {
    /**
     * Constructor
     * @param authority
     * @param clientId
     * @param scope
     * @param responseType
     * @param redirectUri
     * @param state
     */
    function ServerRequestParameters(authority, clientId, responseType, redirectUri, scopes, state, correlationId) {
        this.authorityInstance = authority;
        this.clientId = clientId;
        this.nonce = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].createNewGuid();
        // set scope to clientId if null
        this.scopes = scopes ? scopes.slice() : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].oidcScopes;
        this.scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].trimScopes(this.scopes);
        // set state (already set at top level)
        this.state = state;
        // set correlationId
        this.correlationId = correlationId;
        // telemetry information
        this.xClientSku = "MSAL.JS";
        this.xClientVer = Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["libraryVersion"])();
        this.responseType = responseType;
        this.redirectUri = redirectUri;
    }
    Object.defineProperty(ServerRequestParameters.prototype, "authority", {
        get: function () {
            return this.authorityInstance ? this.authorityInstance.CanonicalAuthority : null;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @hidden
     * @ignore
     *
     * Utility to populate QueryParameters and ExtraQueryParameters to ServerRequestParamerers
     * @param request
     * @param serverAuthenticationRequest
     */
    ServerRequestParameters.prototype.populateQueryParams = function (account, request, adalIdTokenObject, silentCall) {
        var queryParameters = {};
        if (request) {
            // add the prompt parameter to serverRequestParameters if passed
            if (request.prompt) {
                this.promptValue = request.prompt;
            }
            // Add claims challenge to serverRequestParameters if passed
            if (request.claimsRequest) {
                this.claimsValue = request.claimsRequest;
            }
            // if the developer provides one of these, give preference to developer choice
            if (ServerRequestParameters.isSSOParam(request)) {
                queryParameters = this.constructUnifiedCacheQueryParameter(request, null);
            }
        }
        if (adalIdTokenObject) {
            queryParameters = this.constructUnifiedCacheQueryParameter(null, adalIdTokenObject);
        }
        /*
         * adds sid/login_hint if not populated
         * this.logger.verbose("Calling addHint parameters");
         */
        queryParameters = this.addHintParameters(account, queryParameters);
        // sanity check for developer passed extraQueryParameters
        var eQParams = request ? request.extraQueryParameters : null;
        // Populate the extraQueryParameters to be sent to the server
        this.queryParameters = ServerRequestParameters.generateQueryParametersString(queryParameters);
        this.extraQueryParameters = ServerRequestParameters.generateQueryParametersString(eQParams, silentCall);
    };
    // #region QueryParam helpers
    /**
     * Constructs extraQueryParameters to be sent to the server for the AuthenticationParameters set by the developer
     * in any login() or acquireToken() calls
     * @param idTokenObject
     * @param extraQueryParameters
     * @param sid
     * @param loginHint
     */
    // TODO: check how this behaves when domain_hint only is sent in extraparameters and idToken has no upn.
    ServerRequestParameters.prototype.constructUnifiedCacheQueryParameter = function (request, idTokenObject) {
        // preference order: account > sid > login_hint
        var ssoType;
        var ssoData;
        var serverReqParam = {};
        // if account info is passed, account.sid > account.login_hint
        if (request) {
            if (request.account) {
                var account = request.account;
                if (account.sid) {
                    ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID;
                    ssoData = account.sid;
                }
                else if (account.userName) {
                    ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT;
                    ssoData = account.userName;
                }
            }
            // sid from request
            else if (request.sid) {
                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID;
                ssoData = request.sid;
            }
            // loginHint from request
            else if (request.loginHint) {
                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT;
                ssoData = request.loginHint;
            }
        }
        // adalIdToken retrieved from cache
        else if (idTokenObject) {
            if (idTokenObject.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].upn)) {
                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].ID_TOKEN;
                ssoData = idTokenObject.upn;
            }
        }
        serverReqParam = this.addSSOParameter(ssoType, ssoData);
        return serverReqParam;
    };
    /**
     * @hidden
     *
     * Adds login_hint to authorization URL which is used to pre-fill the username field of sign in page for the user if known ahead of time
     * domain_hint if added skips the email based discovery process of the user - only supported for interactive calls in implicit_flow
     * domain_req utid received as part of the clientInfo
     * login_req uid received as part of clientInfo
     * Also does a sanity check for extraQueryParameters passed by the user to ensure no repeat queryParameters
     *
     * @param {@link Account} account - Account for which the token is requested
     * @param queryparams
     * @param {@link ServerRequestParameters}
     * @ignore
     */
    ServerRequestParameters.prototype.addHintParameters = function (account, qParams) {
        /*
         * This is a final check for all queryParams added so far; preference order: sid > login_hint
         * sid cannot be passed along with login_hint or domain_hint, hence we check both are not populated yet in queryParameters
         */
        if (account && !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID]) {
            // sid - populate only if login_hint is not already populated and the account has sid
            var populateSID = !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] && account.sid && this.promptValue === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].NONE;
            if (populateSID) {
                qParams = this.addSSOParameter(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID, account.sid, qParams);
            }
            // login_hint - account.userName
            else {
                var populateLoginHint = !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] && account.userName && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(account.userName);
                if (populateLoginHint) {
                    qParams = this.addSSOParameter(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT, account.userName, qParams);
                }
            }
        }
        return qParams;
    };
    /**
     * Add SID to extraQueryParameters
     * @param sid
     */
    ServerRequestParameters.prototype.addSSOParameter = function (ssoType, ssoData, ssoParam) {
        if (!ssoParam) {
            ssoParam = {};
        }
        if (!ssoData) {
            return ssoParam;
        }
        switch (ssoType) {
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID: {
                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID] = ssoData;
                break;
            }
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].ID_TOKEN: {
                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] = ssoData;
                break;
            }
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT: {
                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] = ssoData;
                break;
            }
        }
        return ssoParam;
    };
    /**
     * Utility to generate a QueryParameterString from a Key-Value mapping of extraQueryParameters passed
     * @param extraQueryParameters
     */
    ServerRequestParameters.generateQueryParametersString = function (queryParameters, silentCall) {
        var paramsString = null;
        if (queryParameters) {
            Object.keys(queryParameters).forEach(function (key) {
                // sid cannot be passed along with login_hint or domain_hint
                if (key === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].domain_hint && (silentCall || queryParameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID])) {
                    return;
                }
                if (paramsString == null) {
                    paramsString = key + "=" + encodeURIComponent(queryParameters[key]);
                }
                else {
                    paramsString += "&" + key + "=" + encodeURIComponent(queryParameters[key]);
                }
            });
        }
        return paramsString;
    };
    // #endregion
    /**
     * Check to see if there are SSO params set in the Request
     * @param request
     */
    ServerRequestParameters.isSSOParam = function (request) {
        return request && (request.account || request.sid || request.loginHint);
    };
    /**
     * Returns the correct response_type string attribute for an acquireToken request configuration
     * @param accountsMatch boolean: Determines whether the account in the request matches the cached account
     * @param scopes Array<string>: AuthenticationRequest scopes configuration
     * @param loginScopesOnly boolean: True if the scopes array ONLY contains the clientId or any combination of OIDC scopes, without resource scopes
     */
    ServerRequestParameters.determineResponseType = function (accountsMatch, scopes) {
        // Supports getting an id_token by sending in clientId as only scope or OIDC scopes as only scopes
        if (_ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].onlyContainsOidcScopes(scopes)) {
            return _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token;
        }
        // If accounts match, check if OIDC scopes are included, otherwise return id_token_token
        return (accountsMatch) ? this.responseTypeForMatchingAccounts(scopes) : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token_token;
    };
    /**
     * Returns the correct response_type string attribute for an acquireToken request configuration that contains an
     * account that matches the account in the MSAL cache.
     * @param scopes Array<string>: AuthenticationRequest scopes configuration
     */
    ServerRequestParameters.responseTypeForMatchingAccounts = function (scopes) {
        // Opt-into also requesting an ID token by sending in 'openid', 'profile' or both along with resource scopes when login is not necessary.
        return (_ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].containsAnyOidcScopes(scopes)) ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token_token : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].token;
    };
    return ServerRequestParameters;
}());

//# sourceMappingURL=ServerRequestParameters.js.map

/***/ }),

/***/ "FgoX":
/*!*****************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/GraphError.js ***!
  \*****************************************************************************/
/*! exports provided: GraphError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphError", function() { return GraphError; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module GraphError
 */
/**
 * @class
 * Class for GraphError
 * @NOTE: This is NOT what is returned from the Graph
 * GraphError is created from parsing JSON errors returned from the graph
 * Some fields are renamed ie, "request-id" => requestId so you can use dot notation
 */
class GraphError extends Error {
    /**
     * @public
     * @constructor
     * Creates an instance of GraphError
     * @param {number} [statusCode = -1] - The status code of the error
     * @returns An instance of GraphError
     */
    constructor(statusCode = -1, message, baseError) {
        super(message || (baseError && baseError.message));
        // https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work
        Object.setPrototypeOf(this, GraphError.prototype);
        this.statusCode = statusCode;
        this.code = null;
        this.requestId = null;
        this.date = new Date();
        this.body = null;
        this.stack = baseError ? baseError.stack : this.stack;
    }
}
//# sourceMappingURL=GraphError.js.map

/***/ }),

/***/ "FmRC":
/*!******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/ChaosHandlerData.js ***!
  \******************************************************************************************************/
/*! exports provided: methodStatusCode, httpStatusCode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "methodStatusCode", function() { return methodStatusCode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "httpStatusCode", function() { return httpStatusCode; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module ChaosHandlerData
 */
/**
 * Contains RequestMethod to corresponding array of possible status codes, used for Random mode
 */
const methodStatusCode = {
    GET: [429, 500, 502, 503, 504],
    POST: [429, 500, 502, 503, 504, 507],
    PUT: [429, 500, 502, 503, 504, 507],
    PATCH: [429, 500, 502, 503, 504],
    DELETE: [429, 500, 502, 503, 504, 507],
};
/**
 * Contains statusCode to statusMessage map
 */
const httpStatusCode = {
    100: "Continue",
    101: "Switching Protocols",
    102: "Processing",
    103: "Early Hints",
    200: "OK",
    201: "Created",
    202: "Accepted",
    203: "Non-Authoritative Information",
    204: "No Content",
    205: "Reset Content",
    206: "Partial Content",
    207: "Multi-Status",
    208: "Already Reported",
    226: "IM Used",
    300: "Multiple Choices",
    301: "Moved Permanently",
    302: "Found",
    303: "See Other",
    304: "Not Modified",
    305: "Use Proxy",
    307: "Temporary Redirect",
    308: "Permanent Redirect",
    400: "Bad Request",
    401: "Unauthorized",
    402: "Payment Required",
    403: "Forbidden",
    404: "Not Found",
    405: "Method Not Allowed",
    406: "Not Acceptable",
    407: "Proxy Authentication Required",
    408: "Request Timeout",
    409: "Conflict",
    410: "Gone",
    411: "Length Required",
    412: "Precondition Failed",
    413: "Payload Too Large",
    414: "URI Too Long",
    415: "Unsupported Media Type",
    416: "Range Not Satisfiable",
    417: "Expectation Failed",
    421: "Misdirected Request",
    422: "Unprocessable Entity",
    423: "Locked",
    424: "Failed Dependency",
    425: "Too Early",
    426: "Upgrade Required",
    428: "Precondition Required",
    429: "Too Many Requests",
    431: "Request Header Fields Too Large",
    451: "Unavailable For Legal Reasons",
    500: "Internal Server Error",
    501: "Not Implemented",
    502: "Bad Gateway",
    503: "Service Unavailable",
    504: "Gateway Timeout",
    505: "HTTP Version Not Supported",
    506: "Variant Also Negotiates",
    507: "Insufficient Storage",
    508: "Loop Detected",
    510: "Not Extended",
    511: "Network Authentication Required",
};
//# sourceMappingURL=ChaosHandlerData.js.map

/***/ }),

/***/ "Ft/c":
/*!********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/StringUtils.js ***!
  \********************************************************************************************/
/*! exports provided: StringUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StringUtils", function() { return StringUtils; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var StringUtils = /** @class */ (function () {
    function StringUtils() {
    }
    /**
     * Check if a string is empty
     *
     * @param str
     */
    StringUtils.isEmpty = function (str) {
        return (typeof str === "undefined" || !str || 0 === str.length);
    };
    /**
     * Check if a string's value is a valid JSON object
     *
     * @param str
     */
    StringUtils.validateAndParseJsonCacheKey = function (str) {
        try {
            var parsedKey = JSON.parse(str);
            /**
             * There are edge cases in which JSON.parse will successfully parse a non-valid JSON object
             * (e.g. JSON.parse will parse an escaped string into an unescaped string), so adding a type check
             * of the parsed value is necessary in order to be certain that the string represents a valid JSON object.
             *
             */
            return (parsedKey && typeof parsedKey === "object") ? parsedKey : null;
        }
        catch (error) {
            return null;
        }
    };
    return StringUtils;
}());

//# sourceMappingURL=StringUtils.js.map

/***/ }),

/***/ "G+40":
/*!*******************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/ResponseType.js ***!
  \*******************************************************************************/
/*! exports provided: ResponseType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResponseType", function() { return ResponseType; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @enum
 * Enum for ResponseType values
 * @property {string} ARRAYBUFFER - To download response content as an [ArrayBuffer]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer}
 * @property {string} BLOB - To download content as a [binary/blob] {@link https://developer.mozilla.org/en-US/docs/Web/API/Blob}
 * @property {string} DOCUMENT - This downloads content as a document or stream
 * @property {string} JSON - To download response content as a json
 * @property {string} STREAM - To download response as a [stream]{@link https://nodejs.org/api/stream.html}
 * @property {string} TEXT - For downloading response as a text
 */
var ResponseType;
(function (ResponseType) {
    ResponseType["ARRAYBUFFER"] = "arraybuffer";
    ResponseType["BLOB"] = "blob";
    ResponseType["DOCUMENT"] = "document";
    ResponseType["JSON"] = "json";
    ResponseType["RAW"] = "raw";
    ResponseType["STREAM"] = "stream";
    ResponseType["TEXT"] = "text";
})(ResponseType || (ResponseType = {}));
//# sourceMappingURL=ResponseType.js.map

/***/ }),

/***/ "G4FT":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/telemetry/HttpEvent.js ***!
  \**********************************************************************************************/
/*! exports provided: EVENT_KEYS, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_KEYS", function() { return EVENT_KEYS; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryEvent */ "ZwGo");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryUtils */ "yuSj");
/* harmony import */ var _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ServerRequestParameters */ "KbZT");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var EVENT_KEYS = {
    HTTP_PATH: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("http_path"),
    USER_AGENT: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("user_agent"),
    QUERY_PARAMETERS: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("query_parameters"),
    API_VERSION: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("api_version"),
    RESPONSE_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("response_code"),
    O_AUTH_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("oauth_error_code"),
    HTTP_METHOD: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("http_method"),
    REQUEST_ID_HEADER: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("request_id_header"),
    SPE_INFO: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("spe_info"),
    SERVER_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("server_error_code"),
    SERVER_SUB_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("server_sub_error_code"),
    URL: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("url")
};
var HttpEvent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpEvent, _super);
    function HttpEvent(correlationId, eventLabel) {
        return _super.call(this, Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("http_event"), correlationId, eventLabel) || this;
    }
    Object.defineProperty(HttpEvent.prototype, "url", {
        set: function (url) {
            var scrubbedUri = Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["scrubTenantFromUri"])(url);
            this.event[EVENT_KEYS.URL] = scrubbedUri && scrubbedUri.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "httpPath", {
        set: function (httpPath) {
            this.event[EVENT_KEYS.HTTP_PATH] = Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["scrubTenantFromUri"])(httpPath).toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "userAgent", {
        set: function (userAgent) {
            this.event[EVENT_KEYS.USER_AGENT] = userAgent;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "queryParams", {
        set: function (queryParams) {
            this.event[EVENT_KEYS.QUERY_PARAMETERS] = _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].generateQueryParametersString(queryParams);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "apiVersion", {
        set: function (apiVersion) {
            this.event[EVENT_KEYS.API_VERSION] = apiVersion.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "httpResponseStatus", {
        set: function (statusCode) {
            this.event[EVENT_KEYS.RESPONSE_CODE] = statusCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "oAuthErrorCode", {
        set: function (errorCode) {
            this.event[EVENT_KEYS.O_AUTH_ERROR_CODE] = errorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "httpMethod", {
        set: function (httpMethod) {
            this.event[EVENT_KEYS.HTTP_METHOD] = httpMethod;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "requestIdHeader", {
        set: function (requestIdHeader) {
            this.event[EVENT_KEYS.REQUEST_ID_HEADER] = requestIdHeader;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "speInfo", {
        /**
         * Indicates whether the request was executed on a ring serving SPE traffic.
         * An empty string indicates this occurred on an outer ring, and the string "I"
         * indicates the request occurred on the inner ring
         */
        set: function (speInfo) {
            this.event[EVENT_KEYS.SPE_INFO] = speInfo;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "serverErrorCode", {
        set: function (errorCode) {
            this.event[EVENT_KEYS.SERVER_ERROR_CODE] = errorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "serverSubErrorCode", {
        set: function (subErrorCode) {
            this.event[EVENT_KEYS.SERVER_SUB_ERROR_CODE] = subErrorCode;
        },
        enumerable: true,
        configurable: true
    });
    return HttpEvent;
}(_TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (HttpEvent);
//# sourceMappingURL=HttpEvent.js.map

/***/ }),

/***/ "GMCd":
/*!******************************************************!*\
  !*** ./node_modules/lit-html/lib/template-result.js ***!
  \******************************************************/
/*! exports provided: TemplateResult, SVGTemplateResult */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TemplateResult", function() { return TemplateResult; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SVGTemplateResult", function() { return SVGTemplateResult; });
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom.js */ "tFPJ");
/* harmony import */ var _template_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./template.js */ "4yuk");
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module lit-html
 */


/**
 * Our TrustedTypePolicy for HTML which is declared using the html template
 * tag function.
 *
 * That HTML is a developer-authored constant, and is parsed with innerHTML
 * before any untrusted expressions have been mixed in. Therefor it is
 * considered safe by construction.
 */
const policy = window.trustedTypes &&
    trustedTypes.createPolicy('lit-html', { createHTML: (s) => s });
const commentMarker = ` ${_template_js__WEBPACK_IMPORTED_MODULE_1__["marker"]} `;
/**
 * The return type of `html`, which holds a Template and the values from
 * interpolated expressions.
 */
class TemplateResult {
    constructor(strings, values, type, processor) {
        this.strings = strings;
        this.values = values;
        this.type = type;
        this.processor = processor;
    }
    /**
     * Returns a string of HTML used to create a `<template>` element.
     */
    getHTML() {
        const l = this.strings.length - 1;
        let html = '';
        let isCommentBinding = false;
        for (let i = 0; i < l; i++) {
            const s = this.strings[i];
            // For each binding we want to determine the kind of marker to insert
            // into the template source before it's parsed by the browser's HTML
            // parser. The marker type is based on whether the expression is in an
            // attribute, text, or comment position.
            //   * For node-position bindings we insert a comment with the marker
            //     sentinel as its text content, like <!--{{lit-guid}}-->.
            //   * For attribute bindings we insert just the marker sentinel for the
            //     first binding, so that we support unquoted attribute bindings.
            //     Subsequent bindings can use a comment marker because multi-binding
            //     attributes must be quoted.
            //   * For comment bindings we insert just the marker sentinel so we don't
            //     close the comment.
            //
            // The following code scans the template source, but is *not* an HTML
            // parser. We don't need to track the tree structure of the HTML, only
            // whether a binding is inside a comment, and if not, if it appears to be
            // the first binding in an attribute.
            const commentOpen = s.lastIndexOf('<!--');
            // We're in comment position if we have a comment open with no following
            // comment close. Because <-- can appear in an attribute value there can
            // be false positives.
            isCommentBinding = (commentOpen > -1 || isCommentBinding) &&
                s.indexOf('-->', commentOpen + 1) === -1;
            // Check to see if we have an attribute-like sequence preceding the
            // expression. This can match "name=value" like structures in text,
            // comments, and attribute values, so there can be false-positives.
            const attributeMatch = _template_js__WEBPACK_IMPORTED_MODULE_1__["lastAttributeNameRegex"].exec(s);
            if (attributeMatch === null) {
                // We're only in this branch if we don't have a attribute-like
                // preceding sequence. For comments, this guards against unusual
                // attribute values like <div foo="<!--${'bar'}">. Cases like
                // <!-- foo=${'bar'}--> are handled correctly in the attribute branch
                // below.
                html += s + (isCommentBinding ? commentMarker : _template_js__WEBPACK_IMPORTED_MODULE_1__["nodeMarker"]);
            }
            else {
                // For attributes we use just a marker sentinel, and also append a
                // $lit$ suffix to the name to opt-out of attribute-specific parsing
                // that IE and Edge do for style and certain SVG attributes.
                html += s.substr(0, attributeMatch.index) + attributeMatch[1] +
                    attributeMatch[2] + _template_js__WEBPACK_IMPORTED_MODULE_1__["boundAttributeSuffix"] + attributeMatch[3] +
                    _template_js__WEBPACK_IMPORTED_MODULE_1__["marker"];
            }
        }
        html += this.strings[l];
        return html;
    }
    getTemplateElement() {
        const template = document.createElement('template');
        let value = this.getHTML();
        if (policy !== undefined) {
            // this is secure because `this.strings` is a TemplateStringsArray.
            // TODO: validate this when
            // https://github.com/tc39/proposal-array-is-template-object is
            // implemented.
            value = policy.createHTML(value);
        }
        template.innerHTML = value;
        return template;
    }
}
/**
 * A TemplateResult for SVG fragments.
 *
 * This class wraps HTML in an `<svg>` tag in order to parse its contents in the
 * SVG namespace, then modifies the template to remove the `<svg>` tag so that
 * clones only container the original fragment.
 */
class SVGTemplateResult extends TemplateResult {
    getHTML() {
        return `<svg>${super.getHTML()}</svg>`;
    }
    getTemplateElement() {
        const template = super.getTemplateElement();
        const content = template.content;
        const svgElement = content.firstChild;
        content.removeChild(svgElement);
        Object(_dom_js__WEBPACK_IMPORTED_MODULE_0__["reparentNodes"])(content, svgElement.firstChild);
        return template;
    }
}
//# sourceMappingURL=template-result.js.map

/***/ }),

/***/ "GewD":
/*!***************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/GraphResponseHandler.js ***!
  \***************************************************************************************/
/*! exports provided: DocumentType, GraphResponseHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentType", function() { return DocumentType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphResponseHandler", function() { return GraphResponseHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _ResponseType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ResponseType */ "G+40");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


/**
 * @enum
 * Enum for document types
 * @property {string} TEXT_HTML - The text/html content type
 * @property {string} TEXT_XML - The text/xml content type
 * @property {string} APPLICATION_XML - The application/xml content type
 * @property {string} APPLICATION_XHTML - The application/xhml+xml content type
 */
var DocumentType;
(function (DocumentType) {
    DocumentType["TEXT_HTML"] = "text/html";
    DocumentType["TEXT_XML"] = "text/xml";
    DocumentType["APPLICATION_XML"] = "application/xml";
    DocumentType["APPLICATION_XHTML"] = "application/xhtml+xml";
})(DocumentType || (DocumentType = {}));
/**
 * @enum
 * Enum for Content types
 * @property {string} TEXT_PLAIN - The text/plain content type
 * @property {string} APPLICATION_JSON - The application/json content type
 */
var ContentType;
(function (ContentType) {
    ContentType["TEXT_PLAIN"] = "text/plain";
    ContentType["APPLICATION_JSON"] = "application/json";
})(ContentType || (ContentType = {}));
/**
 * @enum
 * Enum for Content type regex
 * @property {string} DOCUMENT - The regex to match document content types
 * @property {string} IMAGE - The regex to match image content types
 */
var ContentTypeRegexStr;
(function (ContentTypeRegexStr) {
    ContentTypeRegexStr["DOCUMENT"] = "^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$";
    ContentTypeRegexStr["IMAGE"] = "^image\\/.+";
})(ContentTypeRegexStr || (ContentTypeRegexStr = {}));
/**
 * @class
 * Class for GraphResponseHandler
 */
class GraphResponseHandler {
    /**
     * @private
     * @static
     * To parse Document response
     * @param {Response} rawResponse - The response object
     * @param {DocumentType} type - The type to which the document needs to be parsed
     * @returns A promise that resolves to a document content
     */
    static parseDocumentResponse(rawResponse, type) {
        try {
            if (typeof DOMParser !== "undefined") {
                return new Promise((resolve, reject) => {
                    rawResponse.text().then((xmlString) => {
                        try {
                            const parser = new DOMParser();
                            const xmlDoc = parser.parseFromString(xmlString, type);
                            resolve(xmlDoc);
                        }
                        catch (error) {
                            reject(error);
                        }
                    });
                });
            }
            else {
                return Promise.resolve(rawResponse.body);
            }
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * @private
     * @static
     * @async
     * To convert the native Response to response content
     * @param {Response} rawResponse - The response object
     * @param {ResponseType} [responseType] - The response type value
     * @returns A promise that resolves to the converted response content
     */
    static convertResponse(rawResponse, responseType) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            if (rawResponse.status === 204) {
                // NO CONTENT
                return Promise.resolve();
            }
            let responseValue;
            try {
                switch (responseType) {
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].ARRAYBUFFER:
                        responseValue = yield rawResponse.arrayBuffer();
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].BLOB:
                        responseValue = yield rawResponse.blob();
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].DOCUMENT:
                        responseValue = yield GraphResponseHandler.parseDocumentResponse(rawResponse, DocumentType.TEXT_XML);
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].JSON:
                        responseValue = yield rawResponse.json();
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].STREAM:
                        responseValue = yield Promise.resolve(rawResponse.body);
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].TEXT:
                        responseValue = yield rawResponse.text();
                        break;
                    default:
                        const contentType = rawResponse.headers.get("Content-type");
                        if (contentType !== null) {
                            const mimeType = contentType.split(";")[0];
                            if (new RegExp(ContentTypeRegexStr.DOCUMENT).test(mimeType)) {
                                responseValue = yield GraphResponseHandler.parseDocumentResponse(rawResponse, mimeType);
                            }
                            else if (new RegExp(ContentTypeRegexStr.IMAGE).test(mimeType)) {
                                responseValue = rawResponse.blob();
                            }
                            else if (mimeType === ContentType.TEXT_PLAIN) {
                                responseValue = yield rawResponse.text();
                            }
                            else if (mimeType === ContentType.APPLICATION_JSON) {
                                responseValue = yield rawResponse.json();
                            }
                            else {
                                responseValue = Promise.resolve(rawResponse.body);
                            }
                        }
                        else {
                            /**
                             * RFC specification {@link https://tools.ietf.org/html/rfc7231#section-3.1.1.5} says:
                             *  A sender that generates a message containing a payload body SHOULD
                             *  generate a Content-Type header field in that message unless the
                             *  intended media type of the enclosed representation is unknown to the
                             *  sender.  If a Content-Type header field is not present, the recipient
                             *  MAY either assume a media type of "application/octet-stream"
                             *  ([RFC2046], Section 4.5.1) or examine the data to determine its type.
                             *
                             *  So assuming it as a stream type so returning the body.
                             */
                            responseValue = Promise.resolve(rawResponse.body);
                        }
                        break;
                }
            }
            catch (error) {
                throw error;
            }
            return responseValue;
        });
    }
    /**
     * @public
     * @static
     * @async
     * To get the parsed response
     * @param {Response} rawResponse - The response object
     * @param {ResponseType} [responseType] - The response type value
     * @param {GraphRequestCallback} [callback] - The graph request callback function
     * @returns The parsed response
     */
    static getResponse(rawResponse, responseType, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                if (responseType === _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].RAW) {
                    return Promise.resolve(rawResponse);
                }
                else {
                    const response = yield GraphResponseHandler.convertResponse(rawResponse, responseType);
                    if (rawResponse.ok) {
                        // Status Code 2XX
                        if (typeof callback === "function") {
                            callback(null, response);
                        }
                        else {
                            return response;
                        }
                    }
                    else {
                        // NOT OK Response
                        throw response;
                    }
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
}
//# sourceMappingURL=GraphResponseHandler.js.map

/***/ }),

/***/ "GqWT":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/MSALAuthenticationProviderOptions.js ***!
  \****************************************************************************************************************************************/
/*! exports provided: MSALAuthenticationProviderOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MSALAuthenticationProviderOptions", function() { return MSALAuthenticationProviderOptions; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * @implements AuthenticationProviderOptions
 * Class representing MSALAuthenticationProviderOptions
 */
class MSALAuthenticationProviderOptions {
    /**
     * @public
     * @constructor
     * To create an instance of MSALAuthenticationProviderOptions
     * @param {string[]} scopes - An array of scopes
     * @returns An instance of MSALAuthenticationProviderOptions
     */
    constructor(scopes) {
        this.scopes = scopes;
    }
}
//# sourceMappingURL=MSALAuthenticationProviderOptions.js.map

/***/ }),

/***/ "H7XF":
/*!*****************************************!*\
  !*** ./node_modules/base64-js/index.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

// Support decoding URL-safe base64 strings, as Node.js does.
// See: https://en.wikipedia.org/wiki/Base64#URL_applications
revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function getLens (b64) {
  var len = b64.length

  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // Trim off extra bytes after placeholder bytes are found
  // See: https://github.com/beatgammit/base64-js/issues/42
  var validLen = b64.indexOf('=')
  if (validLen === -1) validLen = len

  var placeHoldersLen = validLen === len
    ? 0
    : 4 - (validLen % 4)

  return [validLen, placeHoldersLen]
}

// base64 is 4/3 + up to two characters of the original data
function byteLength (b64) {
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function _byteLength (b64, validLen, placeHoldersLen) {
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function toByteArray (b64) {
  var tmp
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]

  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))

  var curByte = 0

  // if there are placeholders, only get up to the last complete 4 chars
  var len = placeHoldersLen > 0
    ? validLen - 4
    : validLen

  var i
  for (i = 0; i < len; i += 4) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 18) |
      (revLookup[b64.charCodeAt(i + 1)] << 12) |
      (revLookup[b64.charCodeAt(i + 2)] << 6) |
      revLookup[b64.charCodeAt(i + 3)]
    arr[curByte++] = (tmp >> 16) & 0xFF
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 2) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 2) |
      (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 1) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 10) |
      (revLookup[b64.charCodeAt(i + 1)] << 4) |
      (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] +
    lookup[num >> 12 & 0x3F] +
    lookup[num >> 6 & 0x3F] +
    lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp =
      ((uint8[i] << 16) & 0xFF0000) +
      ((uint8[i + 1] << 8) & 0xFF00) +
      (uint8[i + 2] & 0xFF)
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    parts.push(
      lookup[tmp >> 2] +
      lookup[(tmp << 4) & 0x3F] +
      '=='
    )
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + uint8[len - 1]
    parts.push(
      lookup[tmp >> 10] +
      lookup[(tmp >> 4) & 0x3F] +
      lookup[(tmp << 2) & 0x3F] +
      '='
    )
  }

  return parts.join('')
}


/***/ }),

/***/ "Hj1S":
/*!*****************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/HTTPClient.js ***!
  \*****************************************************************************/
/*! exports provided: HTTPClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTPClient", function() { return HTTPClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @class
 * Class representing HTTPClient
 */
class HTTPClient {
    /**
     * @public
     * @constructor
     * Creates an instance of a HTTPClient
     * @param {...Middleware} middleware - The first middleware of the middleware chain or a sequence of all the Middleware handlers
     */
    constructor(...middleware) {
        if (!middleware || !middleware.length) {
            const error = new Error();
            error.name = "InvalidMiddlewareChain";
            error.message = "Please provide a default middleware chain or custom middleware chain";
            throw error;
        }
        this.setMiddleware(...middleware);
    }
    /**
     * @private
     * Processes the middleware parameter passed to set this.middleware property
     * The calling function should validate if middleware is not undefined or not empty.
     * @param {...Middleware} middleware - The middleware passed
     * @returns Nothing
     */
    setMiddleware(...middleware) {
        if (middleware.length > 1) {
            this.parseMiddleWareArray(middleware);
        }
        else {
            this.middleware = middleware[0];
        }
    }
    /**
     * @private
     * Processes the middleware array to construct the chain
     * and sets this.middleware property to the first middlware handler of the array
     * The calling function should validate if middleware is not undefined or not empty
     * @param {Middleware[]} middlewareArray - The array of middleware handlers
     * @returns Nothing
     */
    parseMiddleWareArray(middlewareArray) {
        middlewareArray.forEach((element, index) => {
            if (index < middlewareArray.length - 1) {
                element.setNext(middlewareArray[index + 1]);
            }
        });
        this.middleware = middlewareArray[0];
    }
    /**
     * @public
     * @async
     * To send the request through the middleware chain
     * @param {Context} context - The context of a request
     * @returns A promise that resolves to the Context
     */
    sendRequest(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                if (typeof context.request === "string" && context.options === undefined) {
                    const error = new Error();
                    error.name = "InvalidRequestOptions";
                    error.message = "Unable to execute the middleware, Please provide valid options for a request";
                    throw error;
                }
                yield this.middleware.execute(context);
                return context;
            }
            catch (error) {
                throw error;
            }
        });
    }
}
//# sourceMappingURL=HTTPClient.js.map

/***/ }),

/***/ "I+Kz":
/*!************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/cache/AuthCache.js ***!
  \************************************************************************************************/
/*! exports provided: AuthCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthCache", function() { return AuthCache; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/Constants */ "/pXG");
/* harmony import */ var _AccessTokenCacheItem__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AccessTokenCacheItem */ "cck5");
/* harmony import */ var _BrowserStorage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./BrowserStorage */ "ARSx");
/* harmony import */ var _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/RequestUtils */ "yEX1");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/StringUtils */ "k+Uk");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */






/**
 * @hidden
 */
var AuthCache = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AuthCache, _super);
    function AuthCache(clientId, cacheLocation, storeAuthStateInCookie) {
        var _this = _super.call(this, cacheLocation) || this;
        _this.clientId = clientId;
        // This is hardcoded to true for now. We may make this configurable in the future
        _this.rollbackEnabled = true;
        _this.migrateCacheEntries(storeAuthStateInCookie);
        return _this;
    }
    /**
     * Support roll back to old cache schema until the next major release: true by default now
     * @param storeAuthStateInCookie
     */
    AuthCache.prototype.migrateCacheEntries = function (storeAuthStateInCookie) {
        var _this = this;
        var idTokenKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].IDTOKEN;
        var clientInfoKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].CLIENT_INFO;
        var errorKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR;
        var errorDescKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR_DESC;
        var idTokenValue = _super.prototype.getItem.call(this, idTokenKey);
        var clientInfoValue = _super.prototype.getItem.call(this, clientInfoKey);
        var errorValue = _super.prototype.getItem.call(this, errorKey);
        var errorDescValue = _super.prototype.getItem.call(this, errorDescKey);
        var values = [idTokenValue, clientInfoValue, errorValue, errorDescValue];
        var keysToMigrate = [_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].IDTOKEN, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].CLIENT_INFO, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR_DESC];
        keysToMigrate.forEach(function (cacheKey, index) { return _this.duplicateCacheEntry(cacheKey, values[index], storeAuthStateInCookie); });
    };
    /**
     * Utility function to help with roll back keys
     * @param newKey
     * @param value
     * @param storeAuthStateInCookie
     */
    AuthCache.prototype.duplicateCacheEntry = function (newKey, value, storeAuthStateInCookie) {
        if (value) {
            this.setItem(newKey, value, storeAuthStateInCookie);
        }
    };
    /**
     * Prepend msal.<client-id> to each key; Skip for any JSON object as Key (defined schemas do not need the key appended: AccessToken Keys or the upcoming schema)
     * @param key
     * @param addInstanceId
     */
    AuthCache.prototype.generateCacheKey = function (key, addInstanceId) {
        try {
            // Defined schemas do not need the key appended
            JSON.parse(key);
            return key;
        }
        catch (e) {
            if (key.indexOf("" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix) === 0 || key.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].adalIdToken) === 0) {
                return key;
            }
            return addInstanceId ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + this.clientId + "." + key : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + key;
        }
    };
    /**
     * Validates that the input cache key contains the account search terms (clientId and homeAccountIdentifier) and
     * then whether or not it contains the "scopes", depending on the token type being searched for. With matching account
     * search terms, Access Token search tries to match the "scopes" keyword, while Id Token search expects "scopes" to not be included.
     * @param key
     * @param clientId
     * @param homeAccountIdentifier
     * @param tokenType
     */
    AuthCache.prototype.matchKeyForType = function (key, clientId, homeAccountIdentifier, tokenType) {
        // All valid token cache item keys are valid JSON objects, ignore keys that aren't
        var parsedKey = _utils_StringUtils__WEBPACK_IMPORTED_MODULE_5__["StringUtils"].validateAndParseJsonCacheKey(key);
        if (!parsedKey) {
            return null;
        }
        // Does the cache item match the request account
        var accountMatches = key.match(clientId) && key.match(homeAccountIdentifier);
        // Does the cache item match the requested token type
        var tokenTypeMatches = false;
        switch (tokenType) {
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ACCESS_TOKEN:
                // Cache item is an access token if scopes are included in the cache item key
                tokenTypeMatches = !!key.match(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].scopes);
                break;
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ID_TOKEN:
                // Cache may be an ID token if scopes are NOT included in the cache item key
                tokenTypeMatches = !key.match(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].scopes);
                break;
        }
        return (accountMatches && tokenTypeMatches) ? parsedKey : null;
    };
    /**
     * add value to storage
     * @param key
     * @param value
     * @param enableCookieStorage
     */
    AuthCache.prototype.setItem = function (key, value, enableCookieStorage) {
        _super.prototype.setItem.call(this, this.generateCacheKey(key, true), value, enableCookieStorage);
        // Values stored in cookies will have rollback disabled to minimize cookie length
        if (this.rollbackEnabled && !enableCookieStorage) {
            _super.prototype.setItem.call(this, this.generateCacheKey(key, false), value, enableCookieStorage);
        }
    };
    /**
     * get one item by key from storage
     * @param key
     * @param enableCookieStorage
     */
    AuthCache.prototype.getItem = function (key, enableCookieStorage) {
        return _super.prototype.getItem.call(this, this.generateCacheKey(key, true), enableCookieStorage);
    };
    /**
     * remove value from storage
     * @param key
     */
    AuthCache.prototype.removeItem = function (key) {
        _super.prototype.removeItem.call(this, this.generateCacheKey(key, true));
        if (this.rollbackEnabled) {
            _super.prototype.removeItem.call(this, this.generateCacheKey(key, false));
        }
    };
    /**
     * Reset the cache items
     */
    AuthCache.prototype.resetCacheItems = function () {
        var storage = window[this.cacheLocation];
        var key;
        for (key in storage) {
            // Check if key contains msal prefix; For now, we are clearing all cache items created by MSAL.js
            if (storage.hasOwnProperty(key) && (key.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix) !== -1)) {
                _super.prototype.removeItem.call(this, key);
                // TODO: Clear cache based on client id (clarify use cases where this is needed)
            }
        }
    };
    /**
     * Reset all temporary cache items
     */
    AuthCache.prototype.resetTempCacheItems = function (state) {
        var _this = this;
        var stateId = state && _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__["RequestUtils"].parseLibraryState(state).id;
        var isTokenRenewalInProgress = this.tokenRenewalInProgress(state);
        var storage = window[this.cacheLocation];
        // check state and remove associated cache
        if (stateId && !isTokenRenewalInProgress) {
            Object.keys(storage).forEach(function (key) {
                if (key.indexOf(stateId) !== -1) {
                    _this.removeItem(key);
                    _super.prototype.clearItemCookie.call(_this, key);
                }
            });
        }
        // delete the interaction status cache
        this.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].INTERACTION_STATUS);
        this.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].REDIRECT_REQUEST);
    };
    /**
     * Set cookies for IE
     * @param cName
     * @param cValue
     * @param expires
     */
    AuthCache.prototype.setItemCookie = function (cName, cValue, expires) {
        _super.prototype.setItemCookie.call(this, this.generateCacheKey(cName, true), cValue, expires);
        if (this.rollbackEnabled) {
            _super.prototype.setItemCookie.call(this, this.generateCacheKey(cName, false), cValue, expires);
        }
    };
    AuthCache.prototype.clearItemCookie = function (cName) {
        _super.prototype.clearItemCookie.call(this, this.generateCacheKey(cName, true));
        if (this.rollbackEnabled) {
            _super.prototype.clearItemCookie.call(this, this.generateCacheKey(cName, false));
        }
    };
    /**
     * get one item by key from cookies
     * @param cName
     */
    AuthCache.prototype.getItemCookie = function (cName) {
        return _super.prototype.getItemCookie.call(this, this.generateCacheKey(cName, true));
    };
    /**
     * Get all tokens of a certain type from the cache
     * @param clientId
     * @param homeAccountIdentifier
     * @param tokenType
     */
    AuthCache.prototype.getAllTokensByType = function (clientId, homeAccountIdentifier, tokenType) {
        var _this = this;
        var results = Object.keys(window[this.cacheLocation]).reduce(function (tokens, key) {
            var matchedTokenKey = _this.matchKeyForType(key, clientId, homeAccountIdentifier, tokenType);
            if (matchedTokenKey) {
                var value = _this.getItem(key);
                if (value) {
                    try {
                        var newAccessTokenCacheItem = new _AccessTokenCacheItem__WEBPACK_IMPORTED_MODULE_2__["AccessTokenCacheItem"](matchedTokenKey, JSON.parse(value));
                        return tokens.concat([newAccessTokenCacheItem]);
                    }
                    catch (err) {
                        // Skip cache items with non-valid JSON values
                        return tokens;
                    }
                }
            }
            return tokens;
        }, []);
        return results;
    };
    /**
     * Get all access tokens in the cache
     * @param clientId
     * @param homeAccountIdentifier
     */
    AuthCache.prototype.getAllAccessTokens = function (clientId, homeAccountIdentifier) {
        return this.getAllTokensByType(clientId, homeAccountIdentifier, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ACCESS_TOKEN);
    };
    /**
     * Get all id tokens in the cache in the form of AccessTokenCacheItem objects so they are
     * in a normalized format and can make use of the existing cached access token validation logic
     */
    AuthCache.prototype.getAllIdTokens = function (clientId, homeAccountIdentifier) {
        return this.getAllTokensByType(clientId, homeAccountIdentifier, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ID_TOKEN);
    };
    /**
     * Get all access and ID tokens in the cache
     * @param clientId
     * @param homeAccountIdentifier
     */
    AuthCache.prototype.getAllTokens = function (clientId, homeAccountIdentifier) {
        var accessTokens = this.getAllAccessTokens(clientId, homeAccountIdentifier);
        var idTokens = this.getAllIdTokens(clientId, homeAccountIdentifier);
        return accessTokens.concat(idTokens);
    };
    /**
     * Return if the token renewal is still in progress
     *
     * @param stateValue
     */
    AuthCache.prototype.tokenRenewalInProgress = function (stateValue) {
        var renewStatus = this.getItem(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].RENEW_STATUS, stateValue));
        return !!(renewStatus && renewStatus === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].inProgress);
    };
    /**
     * Clear all cookies
     */
    AuthCache.prototype.clearMsalCookie = function (state) {
        var _this = this;
        /*
         * If state is truthy, remove values associated with that request.
         * Otherwise, remove all MSAL cookies.
         */
        if (state) {
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].NONCE_IDTOKEN, state));
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].STATE_LOGIN, state));
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].LOGIN_REQUEST, state));
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].STATE_ACQ_TOKEN, state));
        }
        else {
            var cookies = document.cookie.split(";");
            cookies.forEach(function (cookieString) {
                var cookieName = cookieString.trim().split("=")[0];
                if (cookieName.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix) > -1) {
                    _super.prototype.clearItemCookie.call(_this, cookieName);
                }
            });
        }
    };
    /**
     * Create acquireTokenAccountKey to cache account object
     * @param accountId
     * @param state
     */
    AuthCache.generateAcquireTokenAccountKey = function (accountId, state) {
        var stateId = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__["RequestUtils"].parseLibraryState(state).id;
        return "" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].ACQUIRE_TOKEN_ACCOUNT + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + accountId + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + stateId;
    };
    /**
     * Create authorityKey to cache authority
     * @param state
     */
    AuthCache.generateAuthorityKey = function (state) {
        return AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].AUTHORITY, state);
    };
    /**
     * Generates the cache key for temporary cache items, using request state
     * @param tempCacheKey Cache key prefix
     * @param state Request state value
     */
    AuthCache.generateTemporaryCacheKey = function (tempCacheKey, state) {
        // Use the state id (a guid), in the interest of shorter key names, which is important for cookies.
        var stateId = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__["RequestUtils"].parseLibraryState(state).id;
        return "" + tempCacheKey + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + stateId;
    };
    return AuthCache;
}(_BrowserStorage__WEBPACK_IMPORTED_MODULE_3__["BrowserStorage"]));

//# sourceMappingURL=AuthCache.js.map

/***/ }),

/***/ "I2eE":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-files/strings.js ***!
  \******************************************************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    filesSectionTitle: 'Files',
    sharedTextSubtitle: 'Shared'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "IBxc":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/telemetry/TelemetryManager.js ***!
  \***********************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _DefaultEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultEvent */ "6USQ");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/Constants */ "/pXG");
/* harmony import */ var _ApiEvent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ApiEvent */ "jxkD");
/* harmony import */ var _HttpEvent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./HttpEvent */ "Nh4n");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */





var TelemetryManager = /** @class */ (function () {
    function TelemetryManager(config, telemetryEmitter, logger) {
        // correlation Id to list of events
        this.completedEvents = {};
        // event key to event
        this.inProgressEvents = {};
        // correlation id to map of eventname to count
        this.eventCountByCorrelationId = {};
        // Implement after API EVENT
        this.onlySendFailureTelemetry = false;
        // TODO THROW if bad options
        this.telemetryPlatform = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ sdk: _utils_Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].libraryName, sdkVersion: Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_2__["libraryVersion"])(), networkInformation: {
                // @ts-ignore
                connectionSpeed: typeof navigator !== "undefined" && navigator.connection && navigator.connection.effectiveType
            } }, config.platform);
        this.clientId = config.clientId;
        this.onlySendFailureTelemetry = config.onlySendFailureTelemetry;
        /*
         * TODO, when i get to wiring this through, think about what it means if
         * a developer does not implement telem at all, we still instrument, but telemetryEmitter can be
         * optional?
         */
        this.telemetryEmitter = telemetryEmitter;
        this.logger = logger;
    }
    TelemetryManager.getTelemetrymanagerStub = function (clientId, logger) {
        var applicationName = "UnSetStub";
        var applicationVersion = "0.0";
        var telemetryEmitter = function () { };
        var telemetryPlatform = {
            applicationName: applicationName,
            applicationVersion: applicationVersion
        };
        var telemetryManagerConfig = {
            platform: telemetryPlatform,
            clientId: clientId
        };
        return new this(telemetryManagerConfig, telemetryEmitter, logger);
    };
    TelemetryManager.prototype.startEvent = function (event) {
        this.logger.verbose("Telemetry Event started: " + event.key);
        if (!this.telemetryEmitter) {
            return;
        }
        event.start();
        this.inProgressEvents[event.key] = event;
    };
    TelemetryManager.prototype.stopEvent = function (event) {
        this.logger.verbose("Telemetry Event stopped: " + event.key);
        if (!this.telemetryEmitter || !this.inProgressEvents[event.key]) {
            return;
        }
        event.stop();
        this.incrementEventCount(event);
        var completedEvents = this.completedEvents[event.telemetryCorrelationId];
        this.completedEvents[event.telemetryCorrelationId] = (completedEvents || []).concat([event]);
        delete this.inProgressEvents[event.key];
    };
    TelemetryManager.prototype.flush = function (correlationId) {
        var _this = this;
        this.logger.verbose("Flushing telemetry events: " + correlationId);
        // If there is only unfinished events should this still return them?
        if (!this.telemetryEmitter || !this.completedEvents[correlationId]) {
            return;
        }
        var orphanedEvents = this.getOrphanedEvents(correlationId);
        orphanedEvents.forEach(function (event) { return _this.incrementEventCount(event); });
        var eventsToFlush = this.completedEvents[correlationId].concat(orphanedEvents);
        delete this.completedEvents[correlationId];
        var eventCountsToFlush = this.eventCountByCorrelationId[correlationId];
        delete this.eventCountByCorrelationId[correlationId];
        // TODO add funcitonality for onlyFlushFailures after implementing api event? ??
        if (!eventsToFlush || !eventsToFlush.length) {
            return;
        }
        var defaultEvent = new _DefaultEvent__WEBPACK_IMPORTED_MODULE_1__["default"](this.telemetryPlatform, correlationId, this.clientId, eventCountsToFlush);
        var eventsWithDefaultEvent = eventsToFlush.concat([defaultEvent]);
        this.telemetryEmitter(eventsWithDefaultEvent.map(function (e) { return e.get(); }));
    };
    TelemetryManager.prototype.createAndStartApiEvent = function (correlationId, apiEventIdentifier) {
        var apiEvent = new _ApiEvent__WEBPACK_IMPORTED_MODULE_3__["default"](correlationId, this.logger.isPiiLoggingEnabled(), apiEventIdentifier);
        this.startEvent(apiEvent);
        return apiEvent;
    };
    TelemetryManager.prototype.stopAndFlushApiEvent = function (correlationId, apiEvent, wasSuccessful, errorCode) {
        apiEvent.wasSuccessful = wasSuccessful;
        if (errorCode) {
            apiEvent.apiErrorCode = errorCode;
        }
        this.stopEvent(apiEvent);
        this.flush(correlationId);
    };
    TelemetryManager.prototype.createAndStartHttpEvent = function (correlation, httpMethod, url, eventLabel) {
        var httpEvent = new _HttpEvent__WEBPACK_IMPORTED_MODULE_4__["default"](correlation, eventLabel);
        httpEvent.url = url;
        httpEvent.httpMethod = httpMethod;
        this.startEvent(httpEvent);
        return httpEvent;
    };
    TelemetryManager.prototype.incrementEventCount = function (event) {
        var _a;
        /*
         * TODO, name cache event different?
         * if type is cache event, change name
         */
        var eventName = event.eventName;
        var eventCount = this.eventCountByCorrelationId[event.telemetryCorrelationId];
        if (!eventCount) {
            this.eventCountByCorrelationId[event.telemetryCorrelationId] = (_a = {},
                _a[eventName] = 1,
                _a);
        }
        else {
            eventCount[eventName] = eventCount[eventName] ? eventCount[eventName] + 1 : 1;
        }
    };
    TelemetryManager.prototype.getOrphanedEvents = function (correlationId) {
        var _this = this;
        return Object.keys(this.inProgressEvents)
            .reduce(function (memo, eventKey) {
            if (eventKey.indexOf(correlationId) !== -1) {
                var event_1 = _this.inProgressEvents[eventKey];
                delete _this.inProgressEvents[eventKey];
                return memo.concat([event_1]);
            }
            return memo;
        }, []);
    };
    return TelemetryManager;
}());
/* harmony default export */ __webpack_exports__["default"] = (TelemetryManager);
//# sourceMappingURL=TelemetryManager.js.map

/***/ }),

/***/ "IOsI":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-teams-channel-picker/strings.js ***!
  \********************************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    inputPlaceholderText: 'Select a channel',
    noResultsFound: `We didn't find any matches.`,
    loadingMessage: 'Loading...'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "IURE":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/authority/AuthorityFactory.js ***!
  \*****************************************************************************************************/
/*! exports provided: AuthorityFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthorityFactory", function() { return AuthorityFactory; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Authority__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Authority */ "43Tr");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StringUtils */ "Ft/c");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "ovzL");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */

/**
 * @hidden
 */



var AuthorityFactory = /** @class */ (function () {
    function AuthorityFactory() {
    }
    AuthorityFactory.saveMetadataFromNetwork = function (authorityInstance, telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var metadata;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, authorityInstance.resolveEndpointsAsync(telemetryManager, correlationId)];
                    case 1:
                        metadata = _a.sent();
                        this.metadataMap.set(authorityInstance.CanonicalAuthority, metadata);
                        return [2 /*return*/, metadata];
                }
            });
        });
    };
    AuthorityFactory.getMetadata = function (authorityUrl) {
        return this.metadataMap.get(authorityUrl);
    };
    AuthorityFactory.saveMetadataFromConfig = function (authorityUrl, authorityMetadataJson) {
        try {
            if (authorityMetadataJson) {
                var parsedMetadata = JSON.parse(authorityMetadataJson);
                if (!parsedMetadata.authorization_endpoint || !parsedMetadata.end_session_endpoint || !parsedMetadata.issuer) {
                    throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__["ClientConfigurationError"].createInvalidAuthorityMetadataError();
                }
                this.metadataMap.set(authorityUrl, {
                    AuthorizationEndpoint: parsedMetadata.authorization_endpoint,
                    EndSessionEndpoint: parsedMetadata.end_session_endpoint,
                    Issuer: parsedMetadata.issuer
                });
            }
        }
        catch (e) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__["ClientConfigurationError"].createInvalidAuthorityMetadataError();
        }
    };
    /**
     * Create an authority object of the correct type based on the url
     * Performs basic authority validation - checks to see if the authority is of a valid type (eg aad, b2c)
     */
    AuthorityFactory.CreateInstance = function (authorityUrl, validateAuthority, authorityMetadata) {
        if (_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(authorityUrl)) {
            return null;
        }
        if (authorityMetadata) {
            // todo: log statements
            this.saveMetadataFromConfig(authorityUrl, authorityMetadata);
        }
        return new _Authority__WEBPACK_IMPORTED_MODULE_1__["Authority"](authorityUrl, validateAuthority, this.metadataMap.get(authorityUrl));
    };
    AuthorityFactory.metadataMap = new Map();
    return AuthorityFactory;
}());

//# sourceMappingURL=AuthorityFactory.js.map

/***/ }),

/***/ "IW+q":
/*!***************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/AuthResponse.js ***!
  \***************************************************************************************/
/*! exports provided: buildResponseStateOnly */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "buildResponseStateOnly", function() { return buildResponseStateOnly; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
function buildResponseStateOnly(state) {
    return {
        uniqueId: "",
        tenantId: "",
        tokenType: "",
        idToken: null,
        idTokenClaims: null,
        accessToken: "",
        scopes: null,
        expiresOn: null,
        account: null,
        accountState: state,
        fromCache: false
    };
}
//# sourceMappingURL=AuthResponse.js.map

/***/ }),

/***/ "JHPj":
/*!********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/mock/mgt-mock-provider.js ***!
  \********************************************************************************/
/*! exports provided: MgtMockProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtMockProvider", function() { return MgtMockProvider; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _components_baseProvider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/baseProvider */ "7elE");
/* harmony import */ var _providers_Providers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../providers/Providers */ "Viiq");
/* harmony import */ var _MockProvider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./MockProvider */ "RjF+");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




/**
 * Sets global provider to a mock Provider
 *
 * @export
 * @class MgtMockProvider
 * @extends {LitElement}
 */
let MgtMockProvider = class MgtMockProvider extends _components_baseProvider__WEBPACK_IMPORTED_MODULE_1__["MgtBaseProvider"] {
    /**
     * method called to initialize the provider. Each derived class should provide
     * their own implementation
     *
     * @protected
     * @memberof MgtBaseProvider
     */
    initializeProvider() {
        _providers_Providers__WEBPACK_IMPORTED_MODULE_2__["Providers"].globalProvider = new _MockProvider__WEBPACK_IMPORTED_MODULE_3__["MockProvider"](!this.signedOut);
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'signed-out',
        type: Boolean
    }),
    __metadata("design:type", Object)
], MgtMockProvider.prototype, "signedOut", void 0);
MgtMockProvider = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-mock-provider')
], MgtMockProvider);

//# sourceMappingURL=mgt-mock-provider.js.map

/***/ }),

/***/ "JUi9":
/*!************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/TimeUtils.js ***!
  \************************************************************************************************/
/*! exports provided: TimeUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TimeUtils", function() { return TimeUtils; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var TimeUtils = /** @class */ (function () {
    function TimeUtils() {
    }
    /**
     * Returns time in seconds for expiration based on string value passed in.
     *
     * @param expiresIn
     */
    TimeUtils.parseExpiresIn = function (expiresIn) {
        // if AAD did not send "expires_in" property, use default expiration of 3599 seconds, for some reason AAD sends 3599 as "expires_in" value instead of 3600
        if (!expiresIn) {
            expiresIn = "3599";
        }
        return parseInt(expiresIn, 10);
    };
    /**
     * Return the current time in Unix time (seconds). Date.getTime() returns in milliseconds.
     */
    TimeUtils.now = function () {
        return Math.round(new Date().getTime() / 1000.0);
    };
    /**
     * Returns the amount of time in milliseconds since the page loaded.
     */
    TimeUtils.relativeNowMs = function () {
        return window.performance.now();
    };
    return TimeUtils;
}());

//# sourceMappingURL=TimeUtils.js.map

/***/ }),

/***/ "Jdg0":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-todo/graph.todo.js ***!
  \*******************************************************************************************/
/*! exports provided: TaskStatus, TaskImportance, WellknownListName, getTodoTasks, getTodoTask, getTodoTaskLists, getTodoTaskList, createTodoTask, createTodoTaskList, deleteTodoTask, deleteTodoTaskList, updateTodoTask, updateTodoTaskList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskStatus", function() { return TaskStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskImportance", function() { return TaskImportance; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WellknownListName", function() { return WellknownListName; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTodoTasks", function() { return getTodoTasks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTodoTask", function() { return getTodoTask; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTodoTaskLists", function() { return getTodoTaskLists; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTodoTaskList", function() { return getTodoTaskList; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createTodoTask", function() { return createTodoTask; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createTodoTaskList", function() { return createTodoTaskList; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deleteTodoTask", function() { return deleteTodoTask; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deleteTodoTaskList", function() { return deleteTodoTaskList; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateTodoTask", function() { return updateTodoTask; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateTodoTaskList", function() { return updateTodoTaskList; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

var TaskStatus;
(function (TaskStatus) {
    TaskStatus[TaskStatus["notStarted"] = 0] = "notStarted";
    TaskStatus[TaskStatus["inProgress"] = 1] = "inProgress";
    TaskStatus[TaskStatus["completed"] = 2] = "completed";
    TaskStatus[TaskStatus["deferred"] = 3] = "deferred";
    TaskStatus[TaskStatus["waitingOnOthers"] = 4] = "waitingOnOthers";
})(TaskStatus || (TaskStatus = {}));
var TaskImportance;
(function (TaskImportance) {
    TaskImportance[TaskImportance["low"] = 0] = "low";
    TaskImportance[TaskImportance["normal"] = 1] = "normal";
    TaskImportance[TaskImportance["high"] = 2] = "high";
})(TaskImportance || (TaskImportance = {}));
var WellknownListName;
(function (WellknownListName) {
    WellknownListName[WellknownListName["none"] = 0] = "none";
    WellknownListName[WellknownListName["default"] = 1] = "default";
    WellknownListName[WellknownListName["flaggedEmails"] = 2] = "flaggedEmails";
    WellknownListName[WellknownListName["unknownFutureValue"] = 3] = "unknownFutureValue";
})(WellknownListName || (WellknownListName = {}));
// tslint:enable
/**
 * Get all todo tasks for a specific task list.
 *
 * @export
 * @param {IGraph} graph
 * @param {string} listId
 * @returns {Promise<TodoTask[]>}
 */
function getTodoTasks(graph, listId) {
    return __awaiter(this, void 0, void 0, function* () {
        const tasks = yield graph
            .api(`/me/todo/lists/${listId}/tasks`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.Read'))
            .get();
        return tasks && tasks.value;
    });
}
/**
 * Get a specific todo task.
 *
 * @export
 * @param {IGraph} graph
 * @param {string} listId
 * @param {string} taskId
 * @returns {Promise<TodoTask>}
 */
function getTodoTask(graph, listId, taskId) {
    return __awaiter(this, void 0, void 0, function* () {
        const task = yield graph
            .api(`/me/todo/lists/${listId}/tasks/${taskId}`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.Read'))
            .get();
        return task;
    });
}
/**
 * get all todo task lists
 *
 * @export
 * @param {IGraph} graph
 * @returns {Promise<TodoTaskList[]>}
 */
function getTodoTaskLists(graph) {
    return __awaiter(this, void 0, void 0, function* () {
        const taskLists = yield graph
            .api('/me/todo/lists')
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.Read'))
            .get();
        return taskLists && taskLists.value;
    });
}
/**
 * Get a specific todo task list.
 *
 * @export
 * @param {IGraph} graph
 * @param {string} listId
 * @returns {Promise<TodoTaskList>}
 */
function getTodoTaskList(graph, listId) {
    return __awaiter(this, void 0, void 0, function* () {
        const taskList = yield graph
            .api(`/me/todo/lists/${listId}`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.Read'))
            .get();
        return taskList;
    });
}
/**
 * Create a new todo task.
 *
 * @export
 * @param {IGraph} graph
 * @param {string} listId
 * @param {{ title: string; dueDateTime: { dateTime: string; timeZone: string } }} taskData
 * @returns {Promise<TodoTask>}
 */
function createTodoTask(graph, listId, 
// tslint:disable-next-line: completed-docs
taskData) {
    return __awaiter(this, void 0, void 0, function* () {
        const task = yield graph
            .api(`/me/todo/lists/${listId}/tasks`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
            .post(taskData);
        return task;
    });
}
/**
 * Create a new todo task list.
 *
 * @export
 * @param {IGraph} graph
 * @param {{ displayName: string }} list
 * @returns {Promise<TodoTaskList>}
 */
// tslint:disable-next-line: completed-docs
function createTodoTaskList(graph, listData) {
    return __awaiter(this, void 0, void 0, function* () {
        const list = yield graph
            .api('/me/todo/lists')
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
            .post(listData);
        return list;
    });
}
/**
 * Delete a todo task.
 *
 * @export
 * @param {IGraph} graph
 * @param {string} listId
 * @param {string} taskId
 * @returns {Promise<void>}
 */
function deleteTodoTask(graph, listId, taskId) {
    return __awaiter(this, void 0, void 0, function* () {
        yield graph
            .api(`/me/todo/lists/${listId}/tasks/${taskId}`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
            .delete();
    });
}
/**
 * Delete a todo task list.
 *
 * @export
 * @param {IGraph} graph
 * @param {string} listId
 * @returns {Promise<void>}
 */
function deleteTodoTaskList(graph, listId) {
    return __awaiter(this, void 0, void 0, function* () {
        yield graph
            .api(`/me/todo/lists/${listId}`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
            .delete();
    });
}
/**
 * Update a todo task.
 *
 * @export
 * @param {IGraph} graph
 * @param {string} listId
 * @param {string} taskId
 * @param {TodoTask} taskData
 * @returns {Promise<TodoTask>}
 */
function updateTodoTask(graph, listId, taskId, taskData) {
    return __awaiter(this, void 0, void 0, function* () {
        const task = yield graph
            .api(`/me/todo/lists/${listId}/tasks/${taskId}`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
            .patch(taskData);
        return task;
    });
}
/**
 * Update a todo task list.
 *
 * @export
 * @param {IGraph} graph
 * @param {string} listId
 * @param {TodoTaskList} taskListData
 * @returns {Promise<TodoTaskList>}
 */
function updateTodoTaskList(graph, listId, taskListData) {
    return __awaiter(this, void 0, void 0, function* () {
        const task = yield graph
            .api(`/me/todo/lists/${listId}`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
            .patch(taskListData);
        return task;
    });
}
//# sourceMappingURL=graph.todo.js.map

/***/ }),

/***/ "JeFn":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/RequestUtils.js ***!
  \********************************************************************************************************/
/*! exports provided: RequestUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RequestUtils", function() { return RequestUtils; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Constants */ "MQw9");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "UBea");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ScopeSet */ "qfGv");
/* harmony import */ var _StringUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./StringUtils */ "UjIo");
/* harmony import */ var _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./CryptoUtils */ "oish");
/* harmony import */ var _TimeUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TimeUtils */ "b7Qq");
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../error/ClientAuthError */ "L9Ey");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */








/**
 * @hidden
 */
var RequestUtils = /** @class */ (function () {
    function RequestUtils() {
    }
    /**
     * @ignore
     *
     * @param request
     * @param isLoginCall
     * @param cacheStorage
     * @param clientId
     *
     * validates all request parameters and generates a consumable request object
     */
    RequestUtils.validateRequest = function (request, isLoginCall, clientId, interactionType) {
        // Throw error if request is empty for acquire * calls
        if (!isLoginCall && !request) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createEmptyRequestError();
        }
        var scopes;
        var extraQueryParameters;
        if (request) {
            // if extraScopesToConsent is passed in loginCall, append them to the login request; Validate and filter scopes (the validate function will throw if validation fails)
            scopes = isLoginCall ? _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].appendScopes(request.scopes, request.extraScopesToConsent) : request.scopes;
            _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].validateInputScope(scopes, !isLoginCall);
            scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].translateClientIdIfSingleScope(scopes, clientId);
            // validate prompt parameter
            this.validatePromptParameter(request.prompt);
            // validate extraQueryParameters
            extraQueryParameters = this.validateEQParameters(request.extraQueryParameters, request.claimsRequest);
            // validate claimsRequest
            this.validateClaimsRequest(request.claimsRequest);
        }
        // validate and generate state and correlationId
        var state = this.validateAndGenerateState(request && request.state, interactionType);
        var correlationId = this.validateAndGenerateCorrelationId(request && request.correlationId);
        var validatedRequest = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, request, { extraQueryParameters: extraQueryParameters,
            scopes: scopes,
            state: state,
            correlationId: correlationId });
        return validatedRequest;
    };
    /**
     * @ignore
     *
     * Utility to test if valid prompt value is passed in the request
     * @param request
     */
    RequestUtils.validatePromptParameter = function (prompt) {
        if (prompt) {
            if ([_Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].LOGIN, _Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].SELECT_ACCOUNT, _Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].CONSENT, _Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].NONE].indexOf(prompt) < 0) {
                throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createInvalidPromptError(prompt);
            }
        }
    };
    /**
     * @ignore
     *
     * Removes unnecessary or duplicate query parameters from extraQueryParameters
     * @param request
     */
    RequestUtils.validateEQParameters = function (extraQueryParameters, claimsRequest) {
        var eQParams = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, extraQueryParameters);
        if (!eQParams) {
            return null;
        }
        if (claimsRequest) {
            // this.logger.warning("Removed duplicate claims from extraQueryParameters. Please use either the claimsRequest field OR pass as extraQueryParameter - not both.");
            delete eQParams[_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].claims];
        }
        _Constants__WEBPACK_IMPORTED_MODULE_1__["BlacklistedEQParams"].forEach(function (param) {
            if (eQParams[param]) {
                // this.logger.warning("Removed duplicate " + param + " from extraQueryParameters. Please use the " + param + " field in request object.");
                delete eQParams[param];
            }
        });
        return eQParams;
    };
    /**
     * @ignore
     *
     * Validates the claims passed in request is a JSON
     * TODO: More validation will be added when the server team tells us how they have actually implemented claims
     * @param claimsRequest
     */
    RequestUtils.validateClaimsRequest = function (claimsRequest) {
        if (!claimsRequest) {
            return;
        }
        try {
            JSON.parse(claimsRequest);
        }
        catch (e) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createClaimsRequestParsingError(e);
        }
    };
    /**
     * @ignore
     *
     * generate unique state per request
     * @param userState User-provided state value
     * @returns State string include library state and user state
     */
    RequestUtils.validateAndGenerateState = function (userState, interactionType) {
        return !_StringUtils__WEBPACK_IMPORTED_MODULE_4__["StringUtils"].isEmpty(userState) ? "" + RequestUtils.generateLibraryState(interactionType) + _Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + userState : RequestUtils.generateLibraryState(interactionType);
    };
    /**
     * Generates the state value used by the library.
     *
     * @returns Base64 encoded string representing the state
     */
    RequestUtils.generateLibraryState = function (interactionType) {
        var stateObject = {
            id: _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].createNewGuid(),
            ts: _TimeUtils__WEBPACK_IMPORTED_MODULE_6__["TimeUtils"].now(),
            method: interactionType
        };
        var stateString = JSON.stringify(stateObject);
        return _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].base64Encode(stateString);
    };
    /**
     * Decodes the state value into a StateObject
     *
     * @param state State value returned in the request
     * @returns Parsed values from the encoded state value
     */
    RequestUtils.parseLibraryState = function (state) {
        var libraryState = decodeURIComponent(state).split(_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter)[0];
        if (_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].isGuid(libraryState)) {
            // If state is guid, assume timestamp is now and is redirect, as redirect should be only method where this can happen.
            return {
                id: libraryState,
                ts: _TimeUtils__WEBPACK_IMPORTED_MODULE_6__["TimeUtils"].now(),
                method: _Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].interactionTypeRedirect
            };
        }
        try {
            var stateString = _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].base64Decode(libraryState);
            var stateObject = JSON.parse(stateString);
            return stateObject;
        }
        catch (e) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_7__["ClientAuthError"].createInvalidStateError(state, null);
        }
    };
    /**
     * @ignore
     *
     * validate correlationId and generate if not valid or not set by the user
     * @param correlationId
     */
    RequestUtils.validateAndGenerateCorrelationId = function (correlationId) {
        // validate user set correlationId or set one for the user if null
        if (correlationId && !_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].isGuid(correlationId)) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createInvalidCorrelationIdError();
        }
        return _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].isGuid(correlationId) ? correlationId : _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].createNewGuid();
    };
    /**
     * Create a request signature
     * @param request
     */
    RequestUtils.createRequestSignature = function (request) {
        return "" + request.scopes.join(" ").toLowerCase() + _Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + request.authority;
    };
    return RequestUtils;
}());

//# sourceMappingURL=RequestUtils.js.map

/***/ }),

/***/ "Jics":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/sub-components/mgt-spinner/mgt-spinner.js ***!
  \**************************************************************************************************************/
/*! exports provided: MgtSpinner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtSpinner", function() { return MgtSpinner; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _mgt_spinner_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mgt-spinner-css */ "E6hj");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};



/**
 * Custom Component used to handle loading state in components.
 *
 * @export MgtSpinner
 * @class MgtSpinner
 * @extends {MgtBaseComponent}
 */
let MgtSpinner = class MgtSpinner extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["MgtBaseComponent"] {
    /**
     * Array of styles to apply to the element. The styles should be defined
     * user the `css` tag function.
     */
    static get styles() {
        return _mgt_spinner_css__WEBPACK_IMPORTED_MODULE_2__["styles"];
    }
    /**
     * Render the loading spinner
     *
     * @returns
     * @memberof MgtSpinner
     */
    render() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="spinner"></div>
    `;
    }
};
MgtSpinner = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-spinner')
], MgtSpinner);

//# sourceMappingURL=mgt-spinner.js.map

/***/ }),

/***/ "K6T8":
/*!****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/Account.js ***!
  \****************************************************************************************/
/*! exports provided: Account */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Account", function() { return Account; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ "RDZQ");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/StringUtils */ "k+Uk");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * accountIdentifier       combination of idToken.uid and idToken.utid
 * homeAccountIdentifier   combination of clientInfo.uid and clientInfo.utid
 * userName                idToken.preferred_username
 * name                    idToken.name
 * idToken                 idToken
 * sid                     idToken.sid - session identifier
 * environment             idtoken.issuer (the authority that issues the token)
 */
var Account = /** @class */ (function () {
    /**
     * Creates an Account Object
     * @praram accountIdentifier
     * @param homeAccountIdentifier
     * @param userName
     * @param name
     * @param idToken
     * @param sid
     * @param environment
     */
    function Account(accountIdentifier, homeAccountIdentifier, userName, name, idTokenClaims, sid, environment) {
        this.accountIdentifier = accountIdentifier;
        this.homeAccountIdentifier = homeAccountIdentifier;
        this.userName = userName;
        this.name = name;
        // will be deprecated soon
        this.idToken = idTokenClaims;
        this.idTokenClaims = idTokenClaims;
        this.sid = sid;
        this.environment = environment;
    }
    /**
     * @hidden
     * @param idToken
     * @param clientInfo
     */
    Account.createAccount = function (idToken, clientInfo) {
        // create accountIdentifier
        var accountIdentifier = idToken.objectId || idToken.subject;
        // create homeAccountIdentifier
        var uid = clientInfo ? clientInfo.uid : "";
        var utid = clientInfo ? clientInfo.utid : "";
        var homeAccountIdentifier;
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_1__["StringUtils"].isEmpty(uid)) {
            homeAccountIdentifier = _utils_StringUtils__WEBPACK_IMPORTED_MODULE_1__["StringUtils"].isEmpty(utid) ? _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(uid) : _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(uid) + "." + _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(utid);
        }
        return new Account(accountIdentifier, homeAccountIdentifier, idToken.preferredName, idToken.name, idToken.claims, idToken.sid, idToken.issuer);
    };
    /**
     * Utils function to compare two Account objects - used to check if the same user account is logged in
     *
     * @param a1: Account object
     * @param a2: Account object
     */
    Account.compareAccounts = function (a1, a2) {
        if (!a1 || !a2) {
            return false;
        }
        if (a1.homeAccountIdentifier && a2.homeAccountIdentifier) {
            if (a1.homeAccountIdentifier === a2.homeAccountIdentifier) {
                return true;
            }
        }
        return false;
    };
    return Account;
}());

//# sourceMappingURL=Account.js.map

/***/ }),

/***/ "KTOQ":
/*!***************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/index.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _IBatch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./IBatch */ "Xol0");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchResponse", function() { return _IBatch__WEBPACK_IMPORTED_MODULE_0__["BatchResponse"]; });

/* harmony import */ var _IGraph__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./IGraph */ "crAU");
/* harmony import */ var _IGraph__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_IGraph__WEBPACK_IMPORTED_MODULE_1__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _IGraph__WEBPACK_IMPORTED_MODULE_1__) if(["BatchResponse","default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _IGraph__WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _Graph__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Graph */ "WOkV");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Graph", function() { return _Graph__WEBPACK_IMPORTED_MODULE_2__["Graph"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createFromProvider", function() { return _Graph__WEBPACK_IMPORTED_MODULE_2__["createFromProvider"]; });

/* harmony import */ var _BetaGraph__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./BetaGraph */ "yMgu");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BetaGraph", function() { return _BetaGraph__WEBPACK_IMPORTED_MODULE_3__["BetaGraph"]; });

/* harmony import */ var _components_baseComponent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./components/baseComponent */ "zoxn");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ComponentMediaQuery", function() { return _components_baseComponent__WEBPACK_IMPORTED_MODULE_4__["ComponentMediaQuery"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtBaseComponent", function() { return _components_baseComponent__WEBPACK_IMPORTED_MODULE_4__["MgtBaseComponent"]; });

/* harmony import */ var _components_baseProvider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./components/baseProvider */ "7elE");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtBaseProvider", function() { return _components_baseProvider__WEBPACK_IMPORTED_MODULE_5__["MgtBaseProvider"]; });

/* harmony import */ var _components_templatedComponent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./components/templatedComponent */ "e00e");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtTemplatedComponent", function() { return _components_templatedComponent__WEBPACK_IMPORTED_MODULE_6__["MgtTemplatedComponent"]; });

/* harmony import */ var _providers_IProvider__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./providers/IProvider */ "DmZw");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "IProvider", function() { return _providers_IProvider__WEBPACK_IMPORTED_MODULE_7__["IProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LoginType", function() { return _providers_IProvider__WEBPACK_IMPORTED_MODULE_7__["LoginType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ProviderState", function() { return _providers_IProvider__WEBPACK_IMPORTED_MODULE_7__["ProviderState"]; });

/* harmony import */ var _providers_Providers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./providers/Providers */ "Viiq");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Providers", function() { return _providers_Providers__WEBPACK_IMPORTED_MODULE_8__["Providers"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ProvidersChangedState", function() { return _providers_Providers__WEBPACK_IMPORTED_MODULE_8__["ProvidersChangedState"]; });

/* harmony import */ var _providers_SimpleProvider__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./providers/SimpleProvider */ "4q16");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SimpleProvider", function() { return _providers_SimpleProvider__WEBPACK_IMPORTED_MODULE_9__["SimpleProvider"]; });

/* harmony import */ var _utils_Cache__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./utils/Cache */ "C1WP");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CacheService", function() { return _utils_Cache__WEBPACK_IMPORTED_MODULE_10__["CacheService"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CacheStore", function() { return _utils_Cache__WEBPACK_IMPORTED_MODULE_10__["CacheStore"]; });

/* harmony import */ var _utils_EventDispatcher__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./utils/EventDispatcher */ "kDYw");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EventDispatcher", function() { return _utils_EventDispatcher__WEBPACK_IMPORTED_MODULE_11__["EventDispatcher"]; });

/* harmony import */ var _utils_equals__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./utils/equals */ "sJXD");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "equals", function() { return _utils_equals__WEBPACK_IMPORTED_MODULE_12__["equals"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "arraysAreEqual", function() { return _utils_equals__WEBPACK_IMPORTED_MODULE_12__["arraysAreEqual"]; });

/* harmony import */ var _utils_GraphHelpers__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./utils/GraphHelpers */ "yLtT");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "prepScopes", function() { return _utils_GraphHelpers__WEBPACK_IMPORTED_MODULE_13__["prepScopes"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "chainMiddleware", function() { return _utils_GraphHelpers__WEBPACK_IMPORTED_MODULE_13__["chainMiddleware"]; });

/* harmony import */ var _utils_TeamsHelper__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./utils/TeamsHelper */ "/lxw");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TeamsHelper", function() { return _utils_TeamsHelper__WEBPACK_IMPORTED_MODULE_14__["TeamsHelper"]; });

/* harmony import */ var _utils_TemplateContext__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./utils/TemplateContext */ "72nD");
/* harmony import */ var _utils_TemplateContext__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(_utils_TemplateContext__WEBPACK_IMPORTED_MODULE_15__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _utils_TemplateContext__WEBPACK_IMPORTED_MODULE_15__) if(["BatchResponse","Graph","createFromProvider","BetaGraph","ComponentMediaQuery","MgtBaseComponent","MgtBaseProvider","MgtTemplatedComponent","IProvider","LoginType","ProviderState","Providers","ProvidersChangedState","SimpleProvider","CacheService","CacheStore","EventDispatcher","equals","arraysAreEqual","prepScopes","chainMiddleware","TeamsHelper","default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _utils_TemplateContext__WEBPACK_IMPORTED_MODULE_15__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _utils_TemplateHelper__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./utils/TemplateHelper */ "jVY4");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TemplateHelper", function() { return _utils_TemplateHelper__WEBPACK_IMPORTED_MODULE_16__["TemplateHelper"]; });

/* harmony import */ var _utils_GraphPageIterator__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./utils/GraphPageIterator */ "ozJC");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GraphPageIterator", function() { return _utils_GraphPageIterator__WEBPACK_IMPORTED_MODULE_17__["GraphPageIterator"]; });

/* harmony import */ var _utils_LocalizationHelper__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./utils/LocalizationHelper */ "u7Q3");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LocalizationHelper", function() { return _utils_LocalizationHelper__WEBPACK_IMPORTED_MODULE_18__["LocalizationHelper"]; });

/* harmony import */ var _mock_MockProvider__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./mock/MockProvider */ "RjF+");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MockProvider", function() { return _mock_MockProvider__WEBPACK_IMPORTED_MODULE_19__["MockProvider"]; });

/* harmony import */ var _mock_mgt_mock_provider__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./mock/mgt-mock-provider */ "JHPj");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtMockProvider", function() { return _mock_mgt_mock_provider__WEBPACK_IMPORTED_MODULE_20__["MgtMockProvider"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */





















//# sourceMappingURL=index.js.map

/***/ }),

/***/ "KbZT":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/ServerRequestParameters.js ***!
  \**************************************************************************************************/
/*! exports provided: ServerRequestParameters */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerRequestParameters", function() { return ServerRequestParameters; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ "qD3l");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ "vFME");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ "Ft/c");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ScopeSet */ "mb9z");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




/**
 * Nonce: OIDC Nonce definition: https://openid.net/specs/openid-connect-core-1_0.html#IDToken
 * State: OAuth Spec: https://tools.ietf.org/html/rfc6749#section-10.12
 * @hidden
 */
var ServerRequestParameters = /** @class */ (function () {
    /**
     * Constructor
     * @param authority
     * @param clientId
     * @param scope
     * @param responseType
     * @param redirectUri
     * @param state
     */
    function ServerRequestParameters(authority, clientId, responseType, redirectUri, scopes, state, correlationId) {
        this.authorityInstance = authority;
        this.clientId = clientId;
        this.nonce = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].createNewGuid();
        // set scope to clientId if null
        this.scopes = scopes ? scopes.slice() : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].oidcScopes;
        this.scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].trimScopes(this.scopes);
        // set state (already set at top level)
        this.state = state;
        // set correlationId
        this.correlationId = correlationId;
        // telemetry information
        this.xClientSku = "MSAL.JS";
        this.xClientVer = Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["libraryVersion"])();
        this.responseType = responseType;
        this.redirectUri = redirectUri;
    }
    Object.defineProperty(ServerRequestParameters.prototype, "authority", {
        get: function () {
            return this.authorityInstance ? this.authorityInstance.CanonicalAuthority : null;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @hidden
     * @ignore
     *
     * Utility to populate QueryParameters and ExtraQueryParameters to ServerRequestParamerers
     * @param request
     * @param serverAuthenticationRequest
     */
    ServerRequestParameters.prototype.populateQueryParams = function (account, request, adalIdTokenObject, silentCall) {
        var queryParameters = {};
        if (request) {
            // add the prompt parameter to serverRequestParameters if passed
            if (request.prompt) {
                this.promptValue = request.prompt;
            }
            // Add claims challenge to serverRequestParameters if passed
            if (request.claimsRequest) {
                this.claimsValue = request.claimsRequest;
            }
            // if the developer provides one of these, give preference to developer choice
            if (ServerRequestParameters.isSSOParam(request)) {
                queryParameters = this.constructUnifiedCacheQueryParameter(request, null);
            }
        }
        if (adalIdTokenObject) {
            queryParameters = this.constructUnifiedCacheQueryParameter(null, adalIdTokenObject);
        }
        /*
         * adds sid/login_hint if not populated
         * this.logger.verbose("Calling addHint parameters");
         */
        queryParameters = this.addHintParameters(account, queryParameters);
        // sanity check for developer passed extraQueryParameters
        var eQParams = request ? request.extraQueryParameters : null;
        // Populate the extraQueryParameters to be sent to the server
        this.queryParameters = ServerRequestParameters.generateQueryParametersString(queryParameters);
        this.extraQueryParameters = ServerRequestParameters.generateQueryParametersString(eQParams, silentCall);
    };
    // #region QueryParam helpers
    /**
     * Constructs extraQueryParameters to be sent to the server for the AuthenticationParameters set by the developer
     * in any login() or acquireToken() calls
     * @param idTokenObject
     * @param extraQueryParameters
     * @param sid
     * @param loginHint
     */
    // TODO: check how this behaves when domain_hint only is sent in extraparameters and idToken has no upn.
    ServerRequestParameters.prototype.constructUnifiedCacheQueryParameter = function (request, idTokenObject) {
        // preference order: account > sid > login_hint
        var ssoType;
        var ssoData;
        var serverReqParam = {};
        // if account info is passed, account.sid > account.login_hint
        if (request) {
            if (request.account) {
                var account = request.account;
                if (account.sid) {
                    ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID;
                    ssoData = account.sid;
                }
                else if (account.userName) {
                    ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT;
                    ssoData = account.userName;
                }
            }
            // sid from request
            else if (request.sid) {
                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID;
                ssoData = request.sid;
            }
            // loginHint from request
            else if (request.loginHint) {
                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT;
                ssoData = request.loginHint;
            }
        }
        // adalIdToken retrieved from cache
        else if (idTokenObject) {
            if (idTokenObject.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].upn)) {
                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].ID_TOKEN;
                ssoData = idTokenObject.upn;
            }
        }
        serverReqParam = this.addSSOParameter(ssoType, ssoData);
        return serverReqParam;
    };
    /**
     * @hidden
     *
     * Adds login_hint to authorization URL which is used to pre-fill the username field of sign in page for the user if known ahead of time
     * domain_hint if added skips the email based discovery process of the user - only supported for interactive calls in implicit_flow
     * domain_req utid received as part of the clientInfo
     * login_req uid received as part of clientInfo
     * Also does a sanity check for extraQueryParameters passed by the user to ensure no repeat queryParameters
     *
     * @param {@link Account} account - Account for which the token is requested
     * @param queryparams
     * @param {@link ServerRequestParameters}
     * @ignore
     */
    ServerRequestParameters.prototype.addHintParameters = function (account, qParams) {
        /*
         * This is a final check for all queryParams added so far; preference order: sid > login_hint
         * sid cannot be passed along with login_hint or domain_hint, hence we check both are not populated yet in queryParameters
         */
        if (account && !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID]) {
            // sid - populate only if login_hint is not already populated and the account has sid
            var populateSID = !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] && account.sid && this.promptValue === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].NONE;
            if (populateSID) {
                qParams = this.addSSOParameter(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID, account.sid, qParams);
            }
            // login_hint - account.userName
            else {
                var populateLoginHint = !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] && account.userName && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(account.userName);
                if (populateLoginHint) {
                    qParams = this.addSSOParameter(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT, account.userName, qParams);
                }
            }
        }
        return qParams;
    };
    /**
     * Add SID to extraQueryParameters
     * @param sid
     */
    ServerRequestParameters.prototype.addSSOParameter = function (ssoType, ssoData, ssoParam) {
        if (!ssoParam) {
            ssoParam = {};
        }
        if (!ssoData) {
            return ssoParam;
        }
        switch (ssoType) {
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID: {
                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID] = ssoData;
                break;
            }
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].ID_TOKEN: {
                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] = ssoData;
                break;
            }
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT: {
                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] = ssoData;
                break;
            }
        }
        return ssoParam;
    };
    /**
     * Utility to generate a QueryParameterString from a Key-Value mapping of extraQueryParameters passed
     * @param extraQueryParameters
     */
    ServerRequestParameters.generateQueryParametersString = function (queryParameters, silentCall) {
        var paramsString = null;
        if (queryParameters) {
            Object.keys(queryParameters).forEach(function (key) {
                // sid cannot be passed along with login_hint or domain_hint
                if (key === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].domain_hint && (silentCall || queryParameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID])) {
                    return;
                }
                if (paramsString == null) {
                    paramsString = key + "=" + encodeURIComponent(queryParameters[key]);
                }
                else {
                    paramsString += "&" + key + "=" + encodeURIComponent(queryParameters[key]);
                }
            });
        }
        return paramsString;
    };
    // #endregion
    /**
     * Check to see if there are SSO params set in the Request
     * @param request
     */
    ServerRequestParameters.isSSOParam = function (request) {
        return request && (request.account || request.sid || request.loginHint);
    };
    /**
     * Returns the correct response_type string attribute for an acquireToken request configuration
     * @param accountsMatch boolean: Determines whether the account in the request matches the cached account
     * @param scopes Array<string>: AuthenticationRequest scopes configuration
     * @param loginScopesOnly boolean: True if the scopes array ONLY contains the clientId or any combination of OIDC scopes, without resource scopes
     */
    ServerRequestParameters.determineResponseType = function (accountsMatch, scopes) {
        // Supports getting an id_token by sending in clientId as only scope or OIDC scopes as only scopes
        if (_ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].onlyContainsOidcScopes(scopes)) {
            return _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token;
        }
        // If accounts match, check if OIDC scopes are included, otherwise return id_token_token
        return (accountsMatch) ? this.responseTypeForMatchingAccounts(scopes) : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token_token;
    };
    /**
     * Returns the correct response_type string attribute for an acquireToken request configuration that contains an
     * account that matches the account in the MSAL cache.
     * @param scopes Array<string>: AuthenticationRequest scopes configuration
     */
    ServerRequestParameters.responseTypeForMatchingAccounts = function (scopes) {
        // Opt-into also requesting an ID token by sending in 'openid', 'profile' or both along with resource scopes when login is not necessary.
        return (_ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].containsAnyOidcScopes(scopes)) ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token_token : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].token;
    };
    return ServerRequestParameters;
}());

//# sourceMappingURL=ServerRequestParameters.js.map

/***/ }),

/***/ "KdcN":
/*!*************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/ClientInfo.js ***!
  \*************************************************************************************/
/*! exports provided: ClientInfo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientInfo", function() { return ClientInfo; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ "qD3l");
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./error/ClientAuthError */ "859E");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ "Ft/c");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * @hidden
 */
var ClientInfo = /** @class */ (function () {
    function ClientInfo(rawClientInfo, authority) {
        if (!rawClientInfo || _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(rawClientInfo)) {
            this.uid = "";
            this.utid = "";
            return;
        }
        try {
            var decodedClientInfo = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Decode(rawClientInfo);
            var clientInfo = JSON.parse(decodedClientInfo);
            if (clientInfo) {
                if (clientInfo.hasOwnProperty("uid")) {
                    this.uid = authority ? ClientInfo.stripPolicyFromUid(clientInfo.uid, authority) : clientInfo.uid;
                }
                if (clientInfo.hasOwnProperty("utid")) {
                    this.utid = clientInfo.utid;
                }
            }
        }
        catch (e) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__["ClientAuthError"].createClientInfoDecodingError(e);
        }
    }
    Object.defineProperty(ClientInfo.prototype, "uid", {
        get: function () {
            return this._uid ? this._uid : "";
        },
        set: function (uid) {
            this._uid = uid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ClientInfo.prototype, "utid", {
        get: function () {
            return this._utid ? this._utid : "";
        },
        set: function (utid) {
            this._utid = utid;
        },
        enumerable: true,
        configurable: true
    });
    ClientInfo.createClientInfoFromIdToken = function (idToken, authority) {
        var clientInfo = {
            uid: idToken.subject,
            utid: ""
        };
        return new ClientInfo(_utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(JSON.stringify(clientInfo)), authority);
    };
    ClientInfo.stripPolicyFromUid = function (uid, authority) {
        var uidSegments = uid.split("-");
        // Reverse the url segments so the last one is more easily accessible
        var urlSegments = authority.split("/").reverse();
        var policy = "";
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(urlSegments[0])) {
            policy = urlSegments[0];
        }
        else if (urlSegments.length > 1) {
            // If the original url had a trailing slash, urlSegments[0] would be "" so take the next element
            policy = urlSegments[1];
        }
        if (uidSegments[uidSegments.length - 1] === policy) {
            // If the last segment of uid matches the last segment of authority url, remove the last segment of uid
            return uidSegments.slice(0, uidSegments.length - 1).join("-");
        }
        return uid;
    };
    ClientInfo.prototype.encodeClientInfo = function () {
        var clientInfo = JSON.stringify({ uid: this.uid, utid: this.utid });
        return _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(clientInfo);
    };
    return ClientInfo;
}());

//# sourceMappingURL=ClientInfo.js.map

/***/ }),

/***/ "Kxp5":
/*!********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/index.js ***!
  \********************************************************************************/
/*! exports provided: UserAgentApplication, Logger, LogLevel, Account, Constants, ServerHashParamKeys, Authority, CryptoUtils, UrlUtils, WindowUtils, AuthError, ClientAuthError, ServerError, ClientConfigurationError, InteractionRequiredAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _UserAgentApplication__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./UserAgentApplication */ "aos8");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UserAgentApplication", function() { return _UserAgentApplication__WEBPACK_IMPORTED_MODULE_0__["UserAgentApplication"]; });

/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Logger */ "yJyd");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Logger", function() { return _Logger__WEBPACK_IMPORTED_MODULE_1__["Logger"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LogLevel", function() { return _Logger__WEBPACK_IMPORTED_MODULE_1__["LogLevel"]; });

/* harmony import */ var _Account__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Account */ "mWN4");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Account", function() { return _Account__WEBPACK_IMPORTED_MODULE_2__["Account"]; });

/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/Constants */ "vFME");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Constants", function() { return _utils_Constants__WEBPACK_IMPORTED_MODULE_3__["Constants"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ServerHashParamKeys", function() { return _utils_Constants__WEBPACK_IMPORTED_MODULE_3__["ServerHashParamKeys"]; });

/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./authority/Authority */ "43Tr");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Authority", function() { return _authority_Authority__WEBPACK_IMPORTED_MODULE_4__["Authority"]; });

/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils/CryptoUtils */ "qD3l");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CryptoUtils", function() { return _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"]; });

/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils/UrlUtils */ "8P3k");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UrlUtils", function() { return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_6__["UrlUtils"]; });

/* harmony import */ var _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utils/WindowUtils */ "rPdB");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WindowUtils", function() { return _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_7__["WindowUtils"]; });

/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./error/AuthError */ "a+UN");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AuthError", function() { return _error_AuthError__WEBPACK_IMPORTED_MODULE_8__["AuthError"]; });

/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./error/ClientAuthError */ "859E");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClientAuthError", function() { return _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_9__["ClientAuthError"]; });

/* harmony import */ var _error_ServerError__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./error/ServerError */ "53Y/");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ServerError", function() { return _error_ServerError__WEBPACK_IMPORTED_MODULE_10__["ServerError"]; });

/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./error/ClientConfigurationError */ "ovzL");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClientConfigurationError", function() { return _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_11__["ClientConfigurationError"]; });

/* harmony import */ var _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./error/InteractionRequiredAuthError */ "v0vZ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "InteractionRequiredAuthError", function() { return _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_12__["InteractionRequiredAuthError"]; });

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */









// Errors





//# sourceMappingURL=index.js.map

/***/ }),

/***/ "L8Mc":
/*!**************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-messages/mgt-person-card-messages.js ***!
  \**************************************************************************************************************************************************/
/*! exports provided: MgtPersonCardMessages */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtPersonCardMessages", function() { return MgtPersonCardMessages; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../BasePersonCardSection */ "8z1x");
/* harmony import */ var _utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/SvgHelper */ "FPR2");
/* harmony import */ var _utils_Utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../utils/Utils */ "vQVX");
/* harmony import */ var _mgt_person_card_messages_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mgt-person-card-messages-css */ "X0kX");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./strings */ "71h5");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






/**
 * The email messages subsection of the person card
 *
 * @export
 * @class MgtPersonCardMessages
 * @extends {MgtTemplatedComponent}
 */
let MgtPersonCardMessages = class MgtPersonCardMessages extends _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_1__["BasePersonCardSection"] {
    constructor(messages) {
        super();
        this._messages = messages;
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_person_card_messages_css__WEBPACK_IMPORTED_MODULE_4__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_5__["strings"];
    }
    /**
     * The name for display in the overview section.
     *
     * @readonly
     * @type {string}
     * @memberof MgtPersonCardMessages
     */
    get displayName() {
        return this.strings.emailsSectionTitle;
    }
    /**
     * Reset any state in the section
     *
     * @protected
     * @memberof MgtPersonCardMessages
     */
    clearState() {
        this._messages = [];
    }
    /**
     * Render the icon for display in the navigation ribbon.
     *
     * @returns {TemplateResult}
     * @memberof MgtPersonCardMessages
     */
    renderIcon() {
        return Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["SvgIcon"].Messages);
    }
    /**
     * Render the compact view
     *
     * @returns {TemplateResult}
     * @memberof MgtPersonCardMessages
     */
    renderCompactView() {
        let contentTemplate;
        if (this.isLoadingState) {
            contentTemplate = this.renderLoading();
        }
        else if (!this._messages || !this._messages.length) {
            contentTemplate = this.renderNoData();
        }
        else {
            const messageTemplates = this._messages
                ? this._messages.slice(0, 3).map(message => this.renderMessage(message))
                : [];
            contentTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        ${messageTemplates}
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root compact">
        ${contentTemplate}
      </div>
    `;
    }
    /**
     * Render the full view
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardMessages
     */
    renderFullView() {
        let contentTemplate;
        if (this.isLoadingState) {
            contentTemplate = this.renderLoading();
        }
        else if (!this._messages || !this._messages.length) {
            contentTemplate = this.renderNoData();
        }
        else {
            contentTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        ${this._messages.slice(0, 5).map(message => this.renderMessage(message))}
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root">
        <div class="title">${this.strings.emailsSectionTitle}</div>
        ${contentTemplate}
      </div>
    `;
    }
    /**
     * Render a message item
     *
     * @protected
     * @param {IMessage} message
     * @returns {TemplateResult}
     * @memberof MgtPersonCardMessages
     */
    renderMessage(message) {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="message" @click=${() => this.handleMessageClick(message)}>
        <div class="message__detail">
          <div class="message__subject">${message.subject}</div>
          <div class="message__from">${message.from.emailAddress.name}</div>
          <div class="message__message">${message.bodyPreview}</div>
        </div>
        <div class="message__date">${Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_3__["getRelativeDisplayDate"])(new Date(message.receivedDateTime))}</div>
      </div>
    `;
    }
    handleMessageClick(message) {
        window.open(message.webLink, '_blank');
    }
};
MgtPersonCardMessages = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-person-card-messages'),
    __metadata("design:paramtypes", [Array])
], MgtPersonCardMessages);

//# sourceMappingURL=mgt-person-card-messages.js.map

/***/ }),

/***/ "L9Ey":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/error/ClientAuthError.js ***!
  \***********************************************************************************************************/
/*! exports provided: ClientAuthErrorMessage, ClientAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientAuthErrorMessage", function() { return ClientAuthErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientAuthError", function() { return ClientAuthError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuthError */ "MEWQ");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StringUtils */ "UjIo");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



var ClientAuthErrorMessage = {
    multipleCacheAuthorities: {
        code: "multiple_authorities",
        desc: "Multiple authorities found in the cache. Pass authority in the API overload."
    },
    endpointResolutionError: {
        code: "endpoints_resolution_error",
        desc: "Error: could not resolve endpoints. Please check network and try again."
    },
    popUpWindowError: {
        code: "popup_window_error",
        desc: "Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."
    },
    tokenRenewalError: {
        code: "token_renewal_error",
        desc: "Token renewal operation failed due to timeout."
    },
    invalidIdToken: {
        code: "invalid_id_token",
        desc: "Invalid ID token format."
    },
    invalidStateError: {
        code: "invalid_state_error",
        desc: "Invalid state."
    },
    nonceMismatchError: {
        code: "nonce_mismatch_error",
        desc: "Nonce is not matching, Nonce received: "
    },
    loginProgressError: {
        code: "login_progress_error",
        desc: "Login_In_Progress: Error during login call - login is already in progress."
    },
    acquireTokenProgressError: {
        code: "acquiretoken_progress_error",
        desc: "AcquireToken_In_Progress: Error during login call - login is already in progress."
    },
    userCancelledError: {
        code: "user_cancelled",
        desc: "User cancelled the flow."
    },
    callbackError: {
        code: "callback_error",
        desc: "Error occurred in token received callback function."
    },
    userLoginRequiredError: {
        code: "user_login_error",
        desc: "User login is required. For silent calls, request must contain either sid or login_hint"
    },
    userDoesNotExistError: {
        code: "user_non_existent",
        desc: "User object does not exist. Please call a login API."
    },
    clientInfoDecodingError: {
        code: "client_info_decoding_error",
        desc: "The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."
    },
    clientInfoNotPopulatedError: {
        code: "client_info_not_populated_error",
        desc: "The service did not populate client_info in the response, Please verify with the service team"
    },
    nullOrEmptyIdToken: {
        code: "null_or_empty_id_token",
        desc: "The idToken is null or empty. Please review the trace to determine the root cause."
    },
    idTokenNotParsed: {
        code: "id_token_parsing_error",
        desc: "ID token cannot be parsed. Please review stack trace to determine root cause."
    },
    tokenEncodingError: {
        code: "token_encoding_error",
        desc: "The token to be decoded is not encoded correctly."
    },
    invalidInteractionType: {
        code: "invalid_interaction_type",
        desc: "The interaction type passed to the handler was incorrect or unknown"
    },
    cacheParseError: {
        code: "cannot_parse_cache",
        desc: "The cached token key is not a valid JSON and cannot be parsed"
    },
    blockTokenRequestsInHiddenIframe: {
        code: "block_token_requests",
        desc: "Token calls are blocked in hidden iframes"
    }
};
/**
 * Error thrown when there is an error in the client code running on the browser.
 */
var ClientAuthError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ClientAuthError, _super);
    function ClientAuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ClientAuthError";
        Object.setPrototypeOf(_this, ClientAuthError.prototype);
        return _this;
    }
    ClientAuthError.createEndpointResolutionError = function (errDetail) {
        var errorMessage = ClientAuthErrorMessage.endpointResolutionError.desc;
        if (errDetail && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(errDetail)) {
            errorMessage += " Details: " + errDetail;
        }
        return new ClientAuthError(ClientAuthErrorMessage.endpointResolutionError.code, errorMessage);
    };
    ClientAuthError.createMultipleAuthoritiesInCacheError = function (scope) {
        return new ClientAuthError(ClientAuthErrorMessage.multipleCacheAuthorities.code, "Cache error for scope " + scope + ": " + ClientAuthErrorMessage.multipleCacheAuthorities.desc + ".");
    };
    ClientAuthError.createPopupWindowError = function (errDetail) {
        var errorMessage = ClientAuthErrorMessage.popUpWindowError.desc;
        if (errDetail && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(errDetail)) {
            errorMessage += " Details: " + errDetail;
        }
        return new ClientAuthError(ClientAuthErrorMessage.popUpWindowError.code, errorMessage);
    };
    ClientAuthError.createTokenRenewalTimeoutError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.tokenRenewalError.code, ClientAuthErrorMessage.tokenRenewalError.desc);
    };
    ClientAuthError.createInvalidIdTokenError = function (idToken) {
        return new ClientAuthError(ClientAuthErrorMessage.invalidIdToken.code, ClientAuthErrorMessage.invalidIdToken.desc + " Given token: " + idToken);
    };
    // TODO: Is this not a security flaw to send the user the state expected??
    ClientAuthError.createInvalidStateError = function (invalidState, actualState) {
        return new ClientAuthError(ClientAuthErrorMessage.invalidStateError.code, ClientAuthErrorMessage.invalidStateError.desc + " " + invalidState + ", state expected : " + actualState + ".");
    };
    // TODO: Is this not a security flaw to send the user the Nonce expected??
    ClientAuthError.createNonceMismatchError = function (invalidNonce, actualNonce) {
        return new ClientAuthError(ClientAuthErrorMessage.nonceMismatchError.code, ClientAuthErrorMessage.nonceMismatchError.desc + " " + invalidNonce + ", nonce expected : " + actualNonce + ".");
    };
    ClientAuthError.createLoginInProgressError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.loginProgressError.code, ClientAuthErrorMessage.loginProgressError.desc);
    };
    ClientAuthError.createAcquireTokenInProgressError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.acquireTokenProgressError.code, ClientAuthErrorMessage.acquireTokenProgressError.desc);
    };
    ClientAuthError.createUserCancelledError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userCancelledError.code, ClientAuthErrorMessage.userCancelledError.desc);
    };
    ClientAuthError.createErrorInCallbackFunction = function (errorDesc) {
        return new ClientAuthError(ClientAuthErrorMessage.callbackError.code, ClientAuthErrorMessage.callbackError.desc + " " + errorDesc + ".");
    };
    ClientAuthError.createUserLoginRequiredError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userLoginRequiredError.code, ClientAuthErrorMessage.userLoginRequiredError.desc);
    };
    ClientAuthError.createUserDoesNotExistError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userDoesNotExistError.code, ClientAuthErrorMessage.userDoesNotExistError.desc);
    };
    ClientAuthError.createClientInfoDecodingError = function (caughtError) {
        return new ClientAuthError(ClientAuthErrorMessage.clientInfoDecodingError.code, ClientAuthErrorMessage.clientInfoDecodingError.desc + " Failed with error: " + caughtError);
    };
    ClientAuthError.createClientInfoNotPopulatedError = function (caughtError) {
        return new ClientAuthError(ClientAuthErrorMessage.clientInfoNotPopulatedError.code, ClientAuthErrorMessage.clientInfoNotPopulatedError.desc + " Failed with error: " + caughtError);
    };
    ClientAuthError.createIdTokenNullOrEmptyError = function (invalidRawTokenString) {
        return new ClientAuthError(ClientAuthErrorMessage.nullOrEmptyIdToken.code, ClientAuthErrorMessage.nullOrEmptyIdToken.desc + " Raw ID Token Value: " + invalidRawTokenString);
    };
    ClientAuthError.createIdTokenParsingError = function (caughtParsingError) {
        return new ClientAuthError(ClientAuthErrorMessage.idTokenNotParsed.code, ClientAuthErrorMessage.idTokenNotParsed.desc + " Failed with error: " + caughtParsingError);
    };
    ClientAuthError.createTokenEncodingError = function (incorrectlyEncodedToken) {
        return new ClientAuthError(ClientAuthErrorMessage.tokenEncodingError.code, ClientAuthErrorMessage.tokenEncodingError.desc + " Attempted to decode: " + incorrectlyEncodedToken);
    };
    ClientAuthError.createInvalidInteractionTypeError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.invalidInteractionType.code, ClientAuthErrorMessage.invalidInteractionType.desc);
    };
    ClientAuthError.createCacheParseError = function (key) {
        var errorMessage = "invalid key: " + key + ", " + ClientAuthErrorMessage.cacheParseError.desc;
        return new ClientAuthError(ClientAuthErrorMessage.cacheParseError.code, errorMessage);
    };
    ClientAuthError.createBlockTokenRequestsInHiddenIframeError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.code, ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.desc);
    };
    return ClientAuthError;
}(_AuthError__WEBPACK_IMPORTED_MODULE_1__["AuthError"]));

//# sourceMappingURL=ClientAuthError.js.map

/***/ }),

/***/ "LG2h":
/*!*************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/tasks/PageIterator.js ***!
  \*************************************************************************************/
/*! exports provided: PageIterator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PageIterator", function() { return PageIterator; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @class
 * Class for PageIterator
 */
class PageIterator {
    /**
     * @public
     * @constructor
     * Creates new instance for PageIterator
     * @param {Client} client - The graph client instance
     * @param {PageCollection} pageCollection - The page collection object
     * @param {PageIteratorCallback} callBack - The callback function
     * @param {GraphRequestOptions} requestOptions - The request options
     * @returns An instance of a PageIterator
     */
    constructor(client, pageCollection, callback, requestOptions) {
        this.client = client;
        this.collection = pageCollection.value;
        this.nextLink = pageCollection["@odata.nextLink"];
        this.deltaLink = pageCollection["@odata.deltaLink"];
        this.callback = callback;
        this.complete = false;
        this.requestOptions = requestOptions;
    }
    /**
     * @private
     * Iterates over a collection by enqueuing entries one by one and kicking the callback with the enqueued entry
     * @returns A boolean indicating the continue flag to process next page
     */
    iterationHelper() {
        if (this.collection === undefined) {
            return false;
        }
        let advance = true;
        while (advance && this.collection.length !== 0) {
            const item = this.collection.shift();
            advance = this.callback(item);
        }
        return advance;
    }
    /**
     * @private
     * @async
     * Helper to make a get request to fetch next page with nextLink url and update the page iterator instance with the returned response
     * @returns A promise that resolves to a response data with next page collection
     */
    fetchAndUpdateNextPageData() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                let graphRequest = this.client.api(this.nextLink);
                if (this.requestOptions) {
                    if (this.requestOptions.headers) {
                        graphRequest = graphRequest.headers(this.requestOptions.headers);
                    }
                    if (this.requestOptions.middlewareOptions) {
                        graphRequest = graphRequest.middlewareOptions(this.requestOptions.middlewareOptions);
                    }
                    if (this.requestOptions.options) {
                        graphRequest = graphRequest.options(this.requestOptions.options);
                    }
                }
                const response = yield graphRequest.get();
                this.collection = response.value;
                this.nextLink = response["@odata.nextLink"];
                this.deltaLink = response["@odata.deltaLink"];
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * Getter to get the deltaLink in the current response
     * @returns A deltaLink which is being used to make delta requests in future
     */
    getDeltaLink() {
        return this.deltaLink;
    }
    /**
     * @public
     * @async
     * Iterates over the collection and kicks callback for each item on iteration. Fetches next set of data through nextLink and iterates over again
     * This happens until the nextLink is drained out or the user responds with a red flag to continue from callback
     * @returns A Promise that resolves to nothing on completion and throws error incase of any discrepancy.
     */
    iterate() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                let advance = this.iterationHelper();
                while (advance) {
                    if (this.nextLink !== undefined) {
                        yield this.fetchAndUpdateNextPageData();
                        advance = this.iterationHelper();
                    }
                    else {
                        advance = false;
                    }
                }
                if (this.nextLink === undefined && this.collection.length === 0) {
                    this.complete = true;
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * To resume the iteration
     * Note: This internally calls the iterate method, It's just for more readability.
     * @returns A Promise that resolves to nothing on completion and throws error incase of any discrepancy
     */
    resume() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return this.iterate();
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To get the completeness status of the iterator
     * @returns Boolean indicating the completeness
     */
    isComplete() {
        return this.complete;
    }
}
//# sourceMappingURL=PageIterator.js.map

/***/ }),

/***/ "LaBb":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-teams-channel-picker/mgt-teams-channel-picker.js ***!
  \*************************************************************************************************************************/
/*! exports provided: MgtTeamsChannelPicker */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtTeamsChannelPicker", function() { return MgtTeamsChannelPicker; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _styles_style_helper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../styles/style-helper */ "XyBC");
/* harmony import */ var _sub_components_mgt_spinner_mgt_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sub-components/mgt-spinner/mgt-spinner */ "Jics");
/* harmony import */ var _utils_SvgHelper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/SvgHelper */ "FPR2");
/* harmony import */ var _utils_Utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/Utils */ "vQVX");
/* harmony import */ var _mgt_teams_channel_picker_css__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./mgt-teams-channel-picker-css */ "NqkU");
/* harmony import */ var _mgt_teams_channel_picker_graph__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./mgt-teams-channel-picker.graph */ "Va2N");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./strings */ "IOsI");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};










/**
 * Web component used to select channels from a User's Microsoft Teams profile
 *
 *
 * @class MgtTeamsChannelPicker
 * @extends {MgtTemplatedComponent}
 *
 * @fires selectionChanged - Fired when the selection changes
 *
 * @cssprop --color - {font} Default font color
 *
 * @cssprop --input-border - {String} Input section entire border
 * @cssprop --input-border-top - {String} Input section border top only
 * @cssprop --input-border-right - {String} Input section border right only
 * @cssprop --input-border-bottom - {String} Input section border bottom only
 * @cssprop --input-border-left - {String} Input section border left only
 * @cssprop --input-background-color - {Color} Input section background color
 * @cssprop --input-border-color--hover - {Color} Input border hover color
 * @cssprop --input-border-color--focus - {Color} Input border focus color
 *
 * @cssprop --dropdown-background-color - {Color} Background color of dropdown area
 * @cssprop --dropdown-item-hover-background - {Color} Background color of channel or team during hover
 * @cssprop --dropdown-item-selected-background - {Color} Background color of selected channel
 *
 * @cssprop --arrow-fill - {Color} Color of arrow svg
 * @cssprop --placeholder-color--focus - {Color} Color of placeholder text during focus state
 * @cssprop --placeholder-color - {Color} Color of placeholder text
 *
 */
let MgtTeamsChannelPicker = class MgtTeamsChannelPicker extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["MgtTemplatedComponent"] {
    constructor() {
        super();
        this._inputValue = '';
        this._isFocused = false;
        this._treeViewState = [];
        // focus state
        this._focusList = [];
        this._focusedIndex = -1;
        this.handleWindowClick = this.handleWindowClick.bind(this);
        this.addEventListener('keydown', e => this.onUserKeyDown(e));
        this.addEventListener('focus', _ => this.loadTeamsIfNotLoaded());
        this.addEventListener('mouseover', _ => this.loadTeamsIfNotLoaded());
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * user the `css` tag function.
     */
    static get styles() {
        return _mgt_teams_channel_picker_css__WEBPACK_IMPORTED_MODULE_7__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_9__["strings"];
    }
    /**
     * Gets Selected item to be used
     *
     * @readonly
     * @type {SelectedChannel}
     * @memberof MgtTeamsChannelPicker
     */
    get selectedItem() {
        if (this._selectedItemState) {
            return { channel: this._selectedItemState.item, team: this._selectedItemState.parent.item };
        }
        else {
            return null;
        }
    }
    set items(value) {
        if (this._items === value) {
            return;
        }
        this._items = value;
        this._treeViewState = value ? this.generateTreeViewState(value) : [];
        this.resetFocusState();
    }
    get items() {
        return this._items;
    }
    // User input in search
    get _input() {
        return this.renderRoot.querySelector('.team-chosen-input');
    }
    /**
     * Invoked each time the custom element is appended into a document-connected element
     *
     * @memberof MgtTeamsChannelPicker
     */
    connectedCallback() {
        super.connectedCallback();
        window.addEventListener('click', this.handleWindowClick);
    }
    /**
     * Invoked each time the custom element is disconnected from the document's DOM
     *
     * @memberof MgtTeamsChannelPicker
     */
    disconnectedCallback() {
        window.removeEventListener('click', this.handleWindowClick);
        super.disconnectedCallback();
    }
    /**
     * selects a channel by looking up the id in the Graph
     *
     * @param {string} channelId MicrosoftGraph.Channel.id
     * @returns {Promise<return>} A promise that will resolve to true if channel was selected
     * @memberof MgtTeamsChannelPicker
     */
    selectChannelById(channelId) {
        return __awaiter(this, void 0, void 0, function* () {
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["Providers"].globalProvider;
            if (provider && provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["ProviderState"].SignedIn) {
                // since the component normally handles loading on hover, forces the load for items
                if (!this.items) {
                    yield this.requestStateUpdate();
                }
                for (const item of this._treeViewState) {
                    for (const channel of item.channels) {
                        if (channel.item.id === channelId) {
                            this.selectChannel(channel);
                            return true;
                        }
                    }
                }
            }
            return false;
        });
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return a lit-html TemplateResult.
     * Setting properties inside this method will not trigger the element to update.
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    render() {
        const inputClasses = {
            focused: this._isFocused,
            'input-wrapper': true
        };
        const iconClasses = {
            focused: this._isFocused && !!this._selectedItemState,
            'search-icon': true
        };
        const dropdownClasses = {
            dropdown: true,
            visible: this._isDropdownVisible
        };
        return (this.renderTemplate('default', { teams: this.items }) ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="root" @blur=${this.lostFocus} dir=${this.direction}>
          <div class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(inputClasses)} @click=${this.gainedFocus}>
            ${this.renderSelected()}
            <div class="search-wrapper">${this.renderSearchIcon()} ${this.renderInput()}</div>
          </div>
          ${this.renderCloseButton()}
          <div class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(dropdownClasses)}>${this.renderDropdown()}</div>
        </div>
      `);
    }
    /**
     * Renders selected channel
     *
     * @protected
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderSelected() {
        if (!this._selectedItemState) {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <li class="selected-team" title=${this._selectedItemState.item.displayName}>
        <div class="selected-team-name">${this._selectedItemState.parent.item.displayName}</div>
        <div class="arrow">${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_5__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_5__["SvgIcon"].TeamSeparator, '#B3B0AD')}</div>
        ${this._selectedItemState.item.displayName}
      </li>
    `;
    }
    /**
     * Renders search icon
     *
     * @protected
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderSearchIcon() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="search-icon">
        ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_5__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_5__["SvgIcon"].Search, '#252424')}
      </div>
    `;
    }
    /**
     * Renders input field
     *
     * @protected
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderInput() {
        const rootClasses = {
            'input-search': !!this._selectedItemState,
            'input-search-start': !this._selectedItemState
        };
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(rootClasses)}">
        <span
          id="teams-channel-picker-input"
          class="team-chosen-input"
          type="text"
          label="teams-channel-picker-input"
          aria-label="Select a channel"
          data-placeholder="${!!this._selectedItemState ? '' : this.strings.inputPlaceholderText} "
          role="input"
          @keyup=${e => this.handleInputChanged(e)}
          contenteditable
        ></span>
      </div>
    `;
    }
    /**
     * Renders close button
     *
     * @protected
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderCloseButton() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="close-icon" @click="${() => this.selectChannel(null)}">
        
      </div>
    `;
    }
    /**
     * Renders dropdown content
     *
     * @param {ChannelPickerItemState[]} items
     * @param {number} [level=0]
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderDropdown() {
        if (this.isLoadingState || !this._treeViewState) {
            return this.renderLoading();
        }
        if (this._treeViewState) {
            if (!this.isLoadingState && this._treeViewState.length === 0 && this._inputValue.length > 0) {
                return this.renderError();
            }
            return this.renderDropdownList(this._treeViewState);
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
    }
    /**
     * Renders the dropdown list recursively
     *
     * @protected
     * @param {ChannelPickerItemState[]} items
     * @param {number} [level=0]
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderDropdownList(items, level = 0) {
        if (items && items.length) {
            return items.map((treeItem, index) => {
                const isLeaf = !treeItem.channels;
                const renderChannels = !isLeaf && treeItem.isExpanded;
                return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          ${this.renderItem(treeItem)}
          ${renderChannels ? this.renderDropdownList(treeItem.channels, level + 1) : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``}
        `;
            });
        }
        return null;
    }
    /**
     * Renders each Channel or Team
     *
     * @param {ChannelPickerItemState} itemState
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderItem(itemState) {
        let icon = null;
        if (itemState.channels) {
            // must be team with channels
            icon = itemState.isExpanded ? Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_5__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_5__["SvgIcon"].ArrowDown, '#252424') : Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_5__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_5__["SvgIcon"].ArrowRight, '#252424');
        }
        let isSelected = false;
        if (this.selectedItem) {
            if (this.selectedItem.channel === itemState.item) {
                isSelected = true;
            }
        }
        const classes = {
            focused: this._focusList[this._focusedIndex] === itemState,
            item: true,
            'list-team': itemState.channels ? true : false,
            selected: isSelected
        };
        const dropDown = this.renderRoot.querySelector('.dropdown');
        if (dropDown.children[this._focusedIndex]) {
            dropDown.children[this._focusedIndex].scrollIntoView(false);
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div @click=${() => this.handleItemClick(itemState)} class="${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(classes)}">
        <div class="arrow">
          ${icon}
        </div>
        ${itemState.channels ? itemState.item.displayName : this.renderHighlightedText(itemState.item)}
      </div>
    `;
    }
    /**
     * Renders the channel with the query text higlighted
     *
     * @protected
     * @param {*} channel
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderHighlightedText(channel) {
        // tslint:disable-next-line: prefer-const
        let channels = {};
        const highlightLocation = channel.displayName.toLowerCase().indexOf(this._inputValue.toLowerCase());
        if (highlightLocation !== -1) {
            // no location
            if (highlightLocation === 0) {
                // highlight is at the beginning of sentence
                channels.first = '';
                channels.highlight = channel.displayName.slice(0, this._inputValue.length);
                channels.last = channel.displayName.slice(this._inputValue.length, channel.displayName.length);
            }
            else if (highlightLocation === channel.displayName.length) {
                // highlight is at end of the sentence
                channels.first = channel.displayName.slice(0, highlightLocation);
                channels.highlight = channel.displayName.slice(highlightLocation, channel.displayName.length);
                channels.last = '';
            }
            else {
                // highlight is in middle of sentence
                channels.first = channel.displayName.slice(0, highlightLocation);
                channels.highlight = channel.displayName.slice(highlightLocation, highlightLocation + this._inputValue.length);
                channels.last = channel.displayName.slice(highlightLocation + this._inputValue.length, channel.displayName.length);
            }
        }
        else {
            channels.last = channel.displayName;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="channel-display">
        <div class="showing">
          <span class="channel-name-text">${channels.first}</span
          ><span class="channel-name-text highlight-search-text">${channels.highlight}</span
          ><span class="channel-name-text">${channels.last}</span>
        </div>
      </div>
    `;
    }
    /**
     * Renders an error message when no channel or teams match the query
     *
     * @protected
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderError() {
        const template = this.renderTemplate('error', null, 'error');
        return (template ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="message-parent">
          <div label="search-error-text" aria-label="We didn't find any matches." class="search-error-text">
            ${this.strings.noResultsFound}
          </div>
        </div>
      `);
    }
    /**
     * Renders loading spinner while channels are fetched from the Graph
     *
     * @protected
     * @returns
     * @memberof MgtTeamsChannelPicker
     */
    renderLoading() {
        const template = this.renderTemplate('loading', null, 'loading');
        return (template ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `);
    }
    /**
     * Queries Microsoft Graph for Teams & respective channels then sets to items list
     *
     * @protected
     * @memberof MgtTeamsChannelPicker
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["Providers"].globalProvider;
            let teams;
            if (provider && provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["ProviderState"].SignedIn) {
                const graph = provider.graph.forComponent(this);
                teams = yield Object(_mgt_teams_channel_picker_graph__WEBPACK_IMPORTED_MODULE_8__["getAllMyTeams"])(graph);
                teams = teams.filter(t => !t.isArchived);
                const batch = provider.graph.createBatch();
                for (const team of teams) {
                    batch.get(team.id, `teams/${team.id}/channels`, ['group.read.all']);
                }
                const responses = yield batch.executeAll();
                for (const team of teams) {
                    const response = responses.get(team.id);
                    if (response && response.content && response.content.value) {
                        team.channels = response.content.value.map(c => {
                            return {
                                item: c
                            };
                        });
                    }
                }
                this.items = teams.map(t => {
                    return {
                        channels: t.channels,
                        item: t
                    };
                });
            }
            this.filterList();
            this.resetFocusState();
        });
    }
    handleItemClick(item) {
        if (item.channels) {
            item.isExpanded = !item.isExpanded;
        }
        else {
            this.selectChannel(item);
        }
        this._focusedIndex = -1;
        this.resetFocusState();
    }
    handleInputChanged(e) {
        if (this._inputValue !== e.target.textContent) {
            this._inputValue = e.target.textContent;
        }
        else {
            return;
        }
        // shows list
        this.gainedFocus();
        if (!this.debouncedSearch) {
            this.debouncedSearch = Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_6__["debounce"])(() => {
                this.filterList();
            }, 400);
        }
        this.debouncedSearch();
    }
    filterList() {
        if (this.items) {
            this._treeViewState = this.generateTreeViewState(this.items, this._inputValue);
            this._focusedIndex = -1;
            this.resetFocusState();
        }
    }
    generateTreeViewState(tree, filterString = '', parent = null) {
        const treeView = [];
        filterString = filterString.toLowerCase();
        if (tree) {
            for (const state of tree) {
                let stateItem;
                if (filterString.length === 0 || state.item.displayName.toLowerCase().includes(filterString)) {
                    stateItem = { item: state.item, parent };
                    if (state.channels) {
                        stateItem.channels = this.generateTreeViewState(state.channels, '', stateItem);
                        stateItem.isExpanded = filterString.length > 0;
                    }
                }
                else if (state.channels) {
                    const newStateItem = { item: state.item, parent };
                    const channels = this.generateTreeViewState(state.channels, filterString, newStateItem);
                    if (channels.length > 0) {
                        stateItem = newStateItem;
                        stateItem.channels = channels;
                        stateItem.isExpanded = true;
                    }
                }
                if (stateItem) {
                    treeView.push(stateItem);
                }
            }
        }
        return treeView;
    }
    // generates a flat list from a tree to facilitate easier focus
    // navigation
    generateFocusList(items) {
        if (!items || items.length === 0) {
            return [];
        }
        let array = [];
        for (const item of items) {
            array.push(item);
            if (item.channels && item.isExpanded) {
                array = [...array, ...this.generateFocusList(item.channels)];
            }
        }
        return array;
    }
    resetFocusState() {
        this._focusList = this.generateFocusList(this._treeViewState);
        this.requestUpdate();
    }
    loadTeamsIfNotLoaded() {
        if (!this.items && !this.isLoadingState) {
            this.requestStateUpdate();
        }
    }
    handleWindowClick(e) {
        if (e.target !== this) {
            this.lostFocus();
        }
    }
    onUserKeyDown(event) {
        if (event.keyCode === 13) {
            // No new line
            event.preventDefault();
        }
        if (this._treeViewState.length === 0) {
            return;
        }
        const currentFocusedItem = this._focusList[this._focusedIndex];
        switch (event.keyCode) {
            case 40: // down
                this._focusedIndex = (this._focusedIndex + 1) % this._focusList.length;
                this.requestUpdate();
                event.preventDefault();
                break;
            case 38: // up
                if (this._focusedIndex === -1) {
                    this._focusedIndex = this._focusList.length;
                }
                this._focusedIndex = (this._focusedIndex - 1 + this._focusList.length) % this._focusList.length;
                this.requestUpdate();
                event.preventDefault();
                break;
            case 39: // right
                if (currentFocusedItem && currentFocusedItem.channels && !currentFocusedItem.isExpanded) {
                    currentFocusedItem.isExpanded = true;
                    this.resetFocusState();
                    event.preventDefault();
                }
                break;
            case 37: // left
                if (currentFocusedItem && currentFocusedItem.channels && currentFocusedItem.isExpanded) {
                    currentFocusedItem.isExpanded = false;
                    this.resetFocusState();
                    event.preventDefault();
                }
                break;
            case 9: // tab
                if (!currentFocusedItem) {
                    this.lostFocus();
                    break;
                }
            case 13: // return/enter
                if (currentFocusedItem && currentFocusedItem.channels) {
                    // focus item is a Team
                    currentFocusedItem.isExpanded = !currentFocusedItem.isExpanded;
                    this.resetFocusState();
                    event.preventDefault();
                }
                else if (currentFocusedItem && !currentFocusedItem.channels) {
                    this.selectChannel(currentFocusedItem);
                    // refocus to new textbox on initial selection
                    this.resetFocusState();
                    this._focusedIndex = -1;
                    event.preventDefault();
                }
                break;
            case 8: // backspace
                if (this._inputValue.length === 0 && this._selectedItemState) {
                    this.selectChannel(null);
                    event.preventDefault();
                }
                break;
            case 27: // esc
                this.selectChannel(this._selectedItemState);
                this._focusedIndex = -1;
                this.resetFocusState();
                event.preventDefault();
                break;
        }
    }
    gainedFocus() {
        this._isFocused = true;
        const input = this._input;
        if (input) {
            input.focus();
        }
        this._isDropdownVisible = true;
    }
    lostFocus() {
        this._isFocused = false;
        const input = this._input;
        if (input) {
            input.textContent = this._inputValue = '';
        }
        this._isDropdownVisible = false;
        this.filterList();
    }
    selectChannel(item) {
        if (this._selectedItemState !== item) {
            this._selectedItemState = item;
            this.fireCustomEvent('selectionChanged', item ? [this.selectedItem] : []);
        }
        const input = this._input;
        if (input) {
            input.textContent = this._inputValue = '';
        }
        this.requestUpdate();
        this.lostFocus();
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: false }),
    __metadata("design:type", Object)
], MgtTeamsChannelPicker.prototype, "_isDropdownVisible", void 0);
MgtTeamsChannelPicker = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-teams-channel-picker'),
    __metadata("design:paramtypes", [])
], MgtTeamsChannelPicker);

//# sourceMappingURL=mgt-teams-channel-picker.js.map

/***/ }),

/***/ "LmLl":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-tasks/strings.js ***!
  \*****************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    removeTaskSubtitle: 'Delete Task',
    cancelNewTaskSubtitle: 'cancel',
    newTaskPlaceholder: 'Task...',
    addTaskButtonSubtitle: 'Add'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "LrMb":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/ResponseType.js ***!
  \*******************************************************************************************************************/
/*! exports provided: ResponseType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResponseType", function() { return ResponseType; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @enum
 * Enum for ResponseType values
 * @property {string} ARRAYBUFFER - To download response content as an [ArrayBuffer]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer}
 * @property {string} BLOB - To download content as a [binary/blob] {@link https://developer.mozilla.org/en-US/docs/Web/API/Blob}
 * @property {string} DOCUMENT - This downloads content as a document or stream
 * @property {string} JSON - To download response content as a json
 * @property {string} STREAM - To download response as a [stream]{@link https://nodejs.org/api/stream.html}
 * @property {string} TEXT - For downloading response as a text
 */
var ResponseType;
(function (ResponseType) {
    ResponseType["ARRAYBUFFER"] = "arraybuffer";
    ResponseType["BLOB"] = "blob";
    ResponseType["DOCUMENT"] = "document";
    ResponseType["JSON"] = "json";
    ResponseType["RAW"] = "raw";
    ResponseType["STREAM"] = "stream";
    ResponseType["TEXT"] = "text";
})(ResponseType || (ResponseType = {}));
//# sourceMappingURL=ResponseType.js.map

/***/ }),

/***/ "M4Ox":
/*!******************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-proxy-provider/dist/es6/ProxyProvider.js ***!
  \******************************************************************************/
/*! exports provided: ProxyProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ProxyProvider", function() { return ProxyProvider; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _ProxyGraph__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ProxyGraph */ "CZFO");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


/**
 * Proxy Provider access token for Microsoft Graph APIs
 *
 * @export
 * @class ProxyProvider
 * @extends {IProvider}
 */
class ProxyProvider extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["IProvider"] {
    constructor(graphProxyUrl, getCustomHeaders = null) {
        super();
        this.graph = new _ProxyGraph__WEBPACK_IMPORTED_MODULE_1__["ProxyGraph"](graphProxyUrl, getCustomHeaders);
        this.graph
            .api('me')
            .get()
            .then(user => {
            if (user != null) {
                this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedIn);
            }
            else {
                this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
            }
        }, err => {
            this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
        });
    }
    /**
     * Promise returning token
     *
     * @returns {Promise<string>}
     * @memberof ProxyProvider
     */
    getAccessToken() {
        return null;
    }
}
//# sourceMappingURL=ProxyProvider.js.map

/***/ }),

/***/ "MEWQ":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/error/AuthError.js ***!
  \*****************************************************************************************************/
/*! exports provided: AuthErrorMessage, AuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthErrorMessage", function() { return AuthErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthError", function() { return AuthError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */

var AuthErrorMessage = {
    unexpectedError: {
        code: "unexpected_error",
        desc: "Unexpected error in authentication."
    },
    noWindowObjectError: {
        code: "no_window_object",
        desc: "No window object available. Details:"
    }
};
/**
 * General error class thrown by the MSAL.js library.
 */
var AuthError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AuthError, _super);
    function AuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorMessage) || this;
        Object.setPrototypeOf(_this, AuthError.prototype);
        _this.errorCode = errorCode;
        _this.errorMessage = errorMessage;
        _this.name = "AuthError";
        return _this;
    }
    AuthError.createUnexpectedError = function (errDesc) {
        return new AuthError(AuthErrorMessage.unexpectedError.code, AuthErrorMessage.unexpectedError.desc + ": " + errDesc);
    };
    AuthError.createNoWindowObjectError = function (errDesc) {
        return new AuthError(AuthErrorMessage.noWindowObjectError.code, AuthErrorMessage.noWindowObjectError.desc + " " + errDesc);
    };
    return AuthError;
}(Error));

//# sourceMappingURL=AuthError.js.map

/***/ }),

/***/ "MQw9":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/Constants.js ***!
  \*****************************************************************************************************/
/*! exports provided: Constants, ServerHashParamKeys, ResponseTypes, TemporaryCacheKeys, PersistentCacheKeys, ErrorCacheKeys, DEFAULT_AUTHORITY, AAD_INSTANCE_DISCOVERY_ENDPOINT, WELL_KNOWN_SUFFIX, SSOTypes, BlacklistedEQParams, NetworkRequestType, PromptState, FramePrefix, libraryVersion */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Constants", function() { return Constants; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerHashParamKeys", function() { return ServerHashParamKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResponseTypes", function() { return ResponseTypes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TemporaryCacheKeys", function() { return TemporaryCacheKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PersistentCacheKeys", function() { return PersistentCacheKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ErrorCacheKeys", function() { return ErrorCacheKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFAULT_AUTHORITY", function() { return DEFAULT_AUTHORITY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AAD_INSTANCE_DISCOVERY_ENDPOINT", function() { return AAD_INSTANCE_DISCOVERY_ENDPOINT; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WELL_KNOWN_SUFFIX", function() { return WELL_KNOWN_SUFFIX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SSOTypes", function() { return SSOTypes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlacklistedEQParams", function() { return BlacklistedEQParams; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NetworkRequestType", function() { return NetworkRequestType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PromptState", function() { return PromptState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FramePrefix", function() { return FramePrefix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "libraryVersion", function() { return libraryVersion; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 * Constants
 */
var Constants = /** @class */ (function () {
    function Constants() {
    }
    Object.defineProperty(Constants, "libraryName", {
        get: function () { return "Msal.js"; } // used in telemetry sdkName
        ,
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "claims", {
        get: function () { return "claims"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "clientId", {
        get: function () { return "clientId"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "adalIdToken", {
        get: function () { return "adal.idtoken"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "cachePrefix", {
        get: function () { return "msal"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "scopes", {
        get: function () { return "scopes"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "no_account", {
        get: function () { return "NO_ACCOUNT"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "upn", {
        get: function () { return "upn"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "domain_hint", {
        get: function () { return "domain_hint"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "prompt_select_account", {
        get: function () { return "&prompt=select_account"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "prompt_none", {
        get: function () { return "&prompt=none"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "prompt", {
        get: function () { return "prompt"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "response_mode_fragment", {
        get: function () { return "&response_mode=fragment"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "resourceDelimiter", {
        get: function () { return "|"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "cacheDelimiter", {
        get: function () { return "."; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "popUpWidth", {
        get: function () { return this._popUpWidth; },
        set: function (width) {
            this._popUpWidth = width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "popUpHeight", {
        get: function () { return this._popUpHeight; },
        set: function (height) {
            this._popUpHeight = height;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "login", {
        get: function () { return "LOGIN"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "renewToken", {
        get: function () { return "RENEW_TOKEN"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "unknown", {
        get: function () { return "UNKNOWN"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "ADFS", {
        get: function () { return "adfs"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "homeAccountIdentifier", {
        get: function () { return "homeAccountIdentifier"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "common", {
        get: function () { return "common"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "openidScope", {
        get: function () { return "openid"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "profileScope", {
        get: function () { return "profile"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "oidcScopes", {
        get: function () { return [this.openidScope, this.profileScope]; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "interactionTypeRedirect", {
        get: function () { return "redirectInteraction"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "interactionTypePopup", {
        get: function () { return "popupInteraction"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "interactionTypeSilent", {
        get: function () { return "silentInteraction"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "inProgress", {
        get: function () { return "inProgress"; },
        enumerable: true,
        configurable: true
    });
    Constants._popUpWidth = 483;
    Constants._popUpHeight = 600;
    return Constants;
}());

/**
 * Keys in the hashParams
 */
var ServerHashParamKeys;
(function (ServerHashParamKeys) {
    ServerHashParamKeys["SCOPE"] = "scope";
    ServerHashParamKeys["STATE"] = "state";
    ServerHashParamKeys["ERROR"] = "error";
    ServerHashParamKeys["ERROR_DESCRIPTION"] = "error_description";
    ServerHashParamKeys["ACCESS_TOKEN"] = "access_token";
    ServerHashParamKeys["ID_TOKEN"] = "id_token";
    ServerHashParamKeys["EXPIRES_IN"] = "expires_in";
    ServerHashParamKeys["SESSION_STATE"] = "session_state";
    ServerHashParamKeys["CLIENT_INFO"] = "client_info";
})(ServerHashParamKeys || (ServerHashParamKeys = {}));
/**
 * @hidden
 * @ignore
 * response_type from OpenIDConnect
 * References: https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html & https://tools.ietf.org/html/rfc6749#section-4.2.1
 *
 */
var ResponseTypes = {
    id_token: "id_token",
    token: "token",
    id_token_token: "id_token token"
};
/**
 * @hidden
 * CacheKeys for MSAL
 */
var TemporaryCacheKeys;
(function (TemporaryCacheKeys) {
    TemporaryCacheKeys["AUTHORITY"] = "authority";
    TemporaryCacheKeys["ACQUIRE_TOKEN_ACCOUNT"] = "acquireTokenAccount";
    TemporaryCacheKeys["SESSION_STATE"] = "session.state";
    TemporaryCacheKeys["STATE_LOGIN"] = "state.login";
    TemporaryCacheKeys["STATE_ACQ_TOKEN"] = "state.acquireToken";
    TemporaryCacheKeys["STATE_RENEW"] = "state.renew";
    TemporaryCacheKeys["NONCE_IDTOKEN"] = "nonce.idtoken";
    TemporaryCacheKeys["LOGIN_REQUEST"] = "login.request";
    TemporaryCacheKeys["RENEW_STATUS"] = "token.renew.status";
    TemporaryCacheKeys["URL_HASH"] = "urlHash";
    TemporaryCacheKeys["INTERACTION_STATUS"] = "interaction_status";
    TemporaryCacheKeys["REDIRECT_REQUEST"] = "redirect_request";
})(TemporaryCacheKeys || (TemporaryCacheKeys = {}));
var PersistentCacheKeys;
(function (PersistentCacheKeys) {
    PersistentCacheKeys["IDTOKEN"] = "idtoken";
    PersistentCacheKeys["CLIENT_INFO"] = "client.info";
})(PersistentCacheKeys || (PersistentCacheKeys = {}));
var ErrorCacheKeys;
(function (ErrorCacheKeys) {
    ErrorCacheKeys["LOGIN_ERROR"] = "login.error";
    ErrorCacheKeys["ERROR"] = "error";
    ErrorCacheKeys["ERROR_DESC"] = "error.description";
})(ErrorCacheKeys || (ErrorCacheKeys = {}));
var DEFAULT_AUTHORITY = "https://login.microsoftonline.com/common/";
var AAD_INSTANCE_DISCOVERY_ENDPOINT = DEFAULT_AUTHORITY + "/discovery/instance?api-version=1.1&authorization_endpoint=";
var WELL_KNOWN_SUFFIX = ".well-known/openid-configuration";
/**
 * @hidden
 * SSO Types - generated to populate hints
 */
var SSOTypes;
(function (SSOTypes) {
    SSOTypes["ACCOUNT"] = "account";
    SSOTypes["SID"] = "sid";
    SSOTypes["LOGIN_HINT"] = "login_hint";
    SSOTypes["ORGANIZATIONS"] = "organizations";
    SSOTypes["ID_TOKEN"] = "id_token";
    SSOTypes["ACCOUNT_ID"] = "accountIdentifier";
    SSOTypes["HOMEACCOUNT_ID"] = "homeAccountIdentifier";
})(SSOTypes || (SSOTypes = {}));
/**
 * @hidden
 */
var BlacklistedEQParams = [
    SSOTypes.SID,
    SSOTypes.LOGIN_HINT
];
var NetworkRequestType = {
    GET: "GET",
    POST: "POST"
};
/**
 * we considered making this "enum" in the request instead of string, however it looks like the allowed list of
 * prompt values kept changing over past couple of years. There are some undocumented prompt values for some
 * internal partners too, hence the choice of generic "string" type instead of the "enum"
 * @hidden
 */
var PromptState = {
    LOGIN: "login",
    SELECT_ACCOUNT: "select_account",
    CONSENT: "consent",
    NONE: "none"
};
/**
 * Frame name prefixes for the hidden iframe created in silent frames
 */
var FramePrefix = {
    ID_TOKEN_FRAME: "msalIdTokenFrame",
    TOKEN_FRAME: "msalRenewFrame"
};
/**
 * MSAL JS Library Version
 */
function libraryVersion() {
    return "1.4.4";
}
//# sourceMappingURL=Constants.js.map

/***/ }),

/***/ "N+A/":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-people-picker/strings.js ***!
  \*************************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    inputPlaceholderText: 'Start typing a name',
    noResultsFound: `We didn't find any matches.`,
    loadingMessage: 'Loading...'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "NBYW":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/cache/AccessTokenKey.js ***!
  \*****************************************************************************************************/
/*! exports provided: AccessTokenKey */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccessTokenKey", function() { return AccessTokenKey; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/CryptoUtils */ "RDZQ");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/UrlUtils */ "j0B3");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * @hidden
 */
var AccessTokenKey = /** @class */ (function () {
    function AccessTokenKey(authority, clientId, scopes, uid, utid) {
        this.authority = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].CanonicalizeUri(authority);
        this.clientId = clientId;
        this.scopes = scopes;
        this.homeAccountIdentifier = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(uid) + "." + _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(utid);
    }
    return AccessTokenKey;
}());

//# sourceMappingURL=AccessTokenKey.js.map

/***/ }),

/***/ "Nh4n":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/telemetry/HttpEvent.js ***!
  \****************************************************************************************************/
/*! exports provided: EVENT_KEYS, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_KEYS", function() { return EVENT_KEYS; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryEvent */ "31fH");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryUtils */ "Rgi7");
/* harmony import */ var _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ServerRequestParameters */ "b91I");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var EVENT_KEYS = {
    HTTP_PATH: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("http_path"),
    USER_AGENT: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("user_agent"),
    QUERY_PARAMETERS: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("query_parameters"),
    API_VERSION: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("api_version"),
    RESPONSE_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("response_code"),
    O_AUTH_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("oauth_error_code"),
    HTTP_METHOD: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("http_method"),
    REQUEST_ID_HEADER: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("request_id_header"),
    SPE_INFO: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("spe_info"),
    SERVER_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("server_error_code"),
    SERVER_SUB_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("server_sub_error_code"),
    URL: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("url")
};
var HttpEvent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpEvent, _super);
    function HttpEvent(correlationId, eventLabel) {
        return _super.call(this, Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("http_event"), correlationId, eventLabel) || this;
    }
    Object.defineProperty(HttpEvent.prototype, "url", {
        set: function (url) {
            var scrubbedUri = Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["scrubTenantFromUri"])(url);
            this.event[EVENT_KEYS.URL] = scrubbedUri && scrubbedUri.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "httpPath", {
        set: function (httpPath) {
            this.event[EVENT_KEYS.HTTP_PATH] = Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["scrubTenantFromUri"])(httpPath).toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "userAgent", {
        set: function (userAgent) {
            this.event[EVENT_KEYS.USER_AGENT] = userAgent;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "queryParams", {
        set: function (queryParams) {
            this.event[EVENT_KEYS.QUERY_PARAMETERS] = _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].generateQueryParametersString(queryParams);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "apiVersion", {
        set: function (apiVersion) {
            this.event[EVENT_KEYS.API_VERSION] = apiVersion.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "httpResponseStatus", {
        set: function (statusCode) {
            this.event[EVENT_KEYS.RESPONSE_CODE] = statusCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "oAuthErrorCode", {
        set: function (errorCode) {
            this.event[EVENT_KEYS.O_AUTH_ERROR_CODE] = errorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "httpMethod", {
        set: function (httpMethod) {
            this.event[EVENT_KEYS.HTTP_METHOD] = httpMethod;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "requestIdHeader", {
        set: function (requestIdHeader) {
            this.event[EVENT_KEYS.REQUEST_ID_HEADER] = requestIdHeader;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "speInfo", {
        /**
         * Indicates whether the request was executed on a ring serving SPE traffic.
         * An empty string indicates this occurred on an outer ring, and the string "I"
         * indicates the request occurred on the inner ring
         */
        set: function (speInfo) {
            this.event[EVENT_KEYS.SPE_INFO] = speInfo;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "serverErrorCode", {
        set: function (errorCode) {
            this.event[EVENT_KEYS.SERVER_ERROR_CODE] = errorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "serverSubErrorCode", {
        set: function (subErrorCode) {
            this.event[EVENT_KEYS.SERVER_SUB_ERROR_CODE] = subErrorCode;
        },
        enumerable: true,
        configurable: true
    });
    return HttpEvent;
}(_TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (HttpEvent);
//# sourceMappingURL=HttpEvent.js.map

/***/ }),

/***/ "Nnp4":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-tasks/mgt-tasks.graph.planner.js ***!
  \*********************************************************************************************************/
/*! exports provided: addPlannerTask, assignPeopleToPlannerTask, removePlannerTask, setPlannerTaskComplete, setPlannerTaskIncomplete, setPlannerTaskDetails, getPlansForGroup, getSinglePlannerPlan, getBucketsForPlannerPlan, getAllMyPlannerPlans, getTasksForPlannerBucket */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addPlannerTask", function() { return addPlannerTask; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "assignPeopleToPlannerTask", function() { return assignPeopleToPlannerTask; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removePlannerTask", function() { return removePlannerTask; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setPlannerTaskComplete", function() { return setPlannerTaskComplete; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setPlannerTaskIncomplete", function() { return setPlannerTaskIncomplete; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setPlannerTaskDetails", function() { return setPlannerTaskDetails; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPlansForGroup", function() { return getPlansForGroup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSinglePlannerPlan", function() { return getSinglePlannerPlan; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getBucketsForPlannerPlan", function() { return getBucketsForPlannerPlan; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getAllMyPlannerPlans", function() { return getAllMyPlannerPlans; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTasksForPlannerBucket", function() { return getTasksForPlannerBucket; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

/**
 * async promise, allows developer to create new Planner task
 *
 * @param {(PlannerTask)} newTask
 * @returns {Promise<any>}
 * @memberof Graph
 */
function addPlannerTask(graph, newTask) {
    return graph
        .api('/planner/tasks')
        .header('Cache-Control', 'no-store')
        .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Group.ReadWrite.All'))
        .post(newTask);
}
/**
 * async promise, allows developer to assign people to task
 *
 * @param {string} taskId
 * @param {*} people
 * @param {string} eTag
 * @returns {Promise<any>}
 * @memberof Graph
 */
function assignPeopleToPlannerTask(graph, taskId, people, eTag) {
    return setPlannerTaskDetails(graph, taskId, {
        assignments: people
    }, eTag);
}
/**
 * async promise, allows developer to remove Planner task associated with taskId
 *
 * @param {string} taskId
 * @param {string} eTag
 * @returns {Promise<any>}
 * @memberof Graph
 */
function removePlannerTask(graph, taskId, eTag) {
    return graph
        .api(`/planner/tasks/${taskId}`)
        .header('Cache-Control', 'no-store')
        .header('If-Match', eTag)
        .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Group.ReadWrite.All'))
        .delete();
}
/**
 * async promise, allows developer to set a task to complete, associated with taskId
 *
 * @param {string} taskId
 * @param {string} eTag
 * @returns {Promise<any>}
 * @memberof Graph
 */
function setPlannerTaskComplete(graph, taskId, eTag) {
    return setPlannerTaskDetails(graph, taskId, {
        percentComplete: 100
    }, eTag);
}
/**
 * async promise, allows developer to set a task to incomplete, associated with taskId
 *
 * @param {string} taskId
 * @param {string} eTag
 * @returns {Promise<any>}
 * @memberof Graph
 */
function setPlannerTaskIncomplete(graph, taskId, eTag) {
    return setPlannerTaskDetails(graph, taskId, {
        percentComplete: 0
    }, eTag);
}
/**
 * async promise, allows developer to set details of planner task associated with a taskId
 *
 * @param {string} taskId
 * @param {(PlannerTask)} details
 * @param {string} eTag
 * @returns {Promise<any>}
 * @memberof Graph
 */
function setPlannerTaskDetails(graph, taskId, details, eTag) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield graph
            .api(`/planner/tasks/${taskId}`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Group.ReadWrite.All'))
            .header('If-Match', eTag)
            .patch(JSON.stringify(details));
    });
}
/**
 * async promise, returns all planner plans associated with the group id
 *
 * @param {string} groupId
 * @returns {(Promise<PlannerPlan[]>)}
 * @memberof Graph
 */
function getPlansForGroup(graph, groupId) {
    return __awaiter(this, void 0, void 0, function* () {
        const scopes = 'Group.Read.All';
        const uri = `/groups/${groupId}/planner/plans`;
        const plans = yield graph
            .api(uri)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(scopes))
            .get();
        return plans ? plans.value : null;
    });
}
/**
 * async promise, returns a single plan from the Graph associated with the planId
 *
 * @param {string} planId
 * @returns {(Promise<PlannerPlan>)}
 * @memberof Graph
 */
function getSinglePlannerPlan(graph, planId) {
    return __awaiter(this, void 0, void 0, function* () {
        const plan = yield graph
            .api(`/planner/plans/${planId}`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Group.Read.All'))
            .get();
        return plan;
    });
}
/**
 * async promise, returns bucket (for tasks) associated with a planId
 *
 * @param {string} planId
 * @returns {(Promise<PlannerBucket[]>)}
 * @memberof Graph
 */
function getBucketsForPlannerPlan(graph, planId) {
    return __awaiter(this, void 0, void 0, function* () {
        const buckets = yield graph
            .api(`/planner/plans/${planId}/buckets`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Group.Read.All'))
            .get();
        return buckets && buckets.value;
    });
}
/**
 * async promise, returns all planner plans associated with the user logged in
 *
 * @returns {(Promise<PlannerPlan[]>)}
 * @memberof Graph
 */
function getAllMyPlannerPlans(graph) {
    return __awaiter(this, void 0, void 0, function* () {
        const plans = yield graph
            .api('/me/planner/plans')
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Group.Read.All'))
            .get();
        return plans && plans.value;
    });
}
/**
 * async promise, returns all tasks from planner associated with a bucketId
 *
 * @param {string} bucketId
 * @returns {(Promise<PlannerTask[][]>)}
 * @memberof Graph
 */
function getTasksForPlannerBucket(graph, bucketId) {
    return __awaiter(this, void 0, void 0, function* () {
        const tasks = yield graph
            .api(`/planner/buckets/${bucketId}/tasks`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Group.Read.All'))
            .get();
        return tasks && tasks.value;
    });
}
//# sourceMappingURL=mgt-tasks.graph.planner.js.map

/***/ }),

/***/ "NqkU":
/*!*****************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-teams-channel-picker/mgt-teams-channel-picker-css.js ***!
  \*****************************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}:host{font-family:var(--default-font-family)}.root{position:relative}.root .input-wrapper{font-family:var(--default-font-family);display:flex;flex-wrap:wrap;align-items:center;padding:4px 10px;position:relative;background-color:var(--input-background-color,#fff);font-size:14px;color:var(--color-sub1,#323130);height:29px;line-height:19px;cursor:text;border-top:var(--input-border-top,2px solid #605e5c);border-right:var(--input-border-right,2px solid #605e5c);border-bottom:var(--input-border-bottom,2px solid #605e5c);border-left:var(--input-border-left,2px solid #605e5c);border:var(--input-border,2px solid #605e5c)}.root .input-wrapper:hover{border-color:var(--input-border-color--hover,#323130)}.root .input-wrapper.focused{border-color:var(--input-border-color--focus,#0078d4)}.root .input-wrapper .selected-team{padding-right:10px;border:none;display:flex;position:relative;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;align-items:center;height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.root .input-wrapper .selected-team .arrow{margin-left:8px;margin-right:8px}.root .input-wrapper .selected-team .selected-team-name{font-weight:700}.root .input-wrapper .search-wrapper{height:14px;display:flex;flex-wrap:nowrap;align-items:center;margin-right:30px}.root .input-wrapper .team-chosen-input{display:inline-block;border:none;line-height:normal;outline:0;font-family:var(--default-font-family);font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:transparent;color:var(--color-sub1,#323130);padding-left:5px}.root .input-wrapper .team-chosen-input::placeholder{color:var(--placeholder-color,#605e5c)}.root .input-wrapper .team-chosen-input[contenteditable]:empty::after{content:attr(data-placeholder);color:var(--placeholder-color,#605e5c)}.root .input-wrapper .search-icon{align-self:flex-start;font-family:FabricMDL2Icons;color:var(--accent-color,#0078d4);line-height:normal}.root .input-wrapper .input-search{height:19px}.root .input-wrapper .input-search-start{line-height:normal;margin-inline-start:0;margin-inline-end:0}.root .input-wrapper::after{content:'';position:absolute;width:100%;height:90%;top:2px;right:2px;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}.root .close-icon{display:inline-block;position:absolute;right:10px;top:12px;line-height:normal;font-family:FabricMDL2Icons;cursor:pointer;color:var(--placeholder-color,#605e5c);background-color:var(--input-background-color,#fff)}.root .close-icon:hover{color:var(--color-sub1,#323130)}.root .dropdown{padding-top:5px;padding-bottom:11px;position:absolute;box-shadow:0 1.3289px 2.65781px rgba(180,180,180,.182),0 1.3289px 2.65781px rgba(68,68,68,.3);border-radius:2px;background-color:var(--dropdown-background-color,var(--list-background-color,#fff));z-index:1;width:100%;text-align:left;list-style-type:none;font-family:var(--default-font-family);font-style:normal;font-weight:400;color:var(--color-sub1,#323130);display:none;max-height:346px;overflow-y:auto}.root .dropdown.visible{display:block}.root .dropdown .item .arrow svg{fill:var(--arrow-fill,#000)}.root .dropdown .item.list-team{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;display:flex;flex-direction:row;align-items:center;padding:5px 12px 6px 14px;margin-top:6px;font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:16px;color:var(--color-sub1,#323130);flex-flow:nowrap;position:relative;overflow:hidden;white-space:nowrap;background-color:transparent}.root .dropdown .item.list-team:after{content:'';position:absolute;width:36px;height:100%;top:0;right:0;background-image:-webkit-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-moz-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-ms-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:-o-linear-gradient(right,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0));background-image:linear-gradient(to left,var(--dropdown-background-color,var(--list-background-color,#fff)),rgba(var(--dropdown-background-color,var(--list-background-color,#fff)),0))}.root .dropdown .item.list-team:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .item.list-team .arrow{margin-right:5px;margin-bottom:1px}.root .dropdown .item.selected{background-color:var(--dropdown-item-selected-background,#deecf9)}.root .dropdown .item.focused{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .channel-display{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-o-user-select:none;cursor:pointer;padding-left:21px;padding-right:10px}.root .dropdown .channel-display .showing{padding-left:10px;padding-top:4px;padding-bottom:4px}.root .dropdown .channel-display .showing .channel-name-text{font-size:14px;font-weight:400;color:var(--color-sub1,#323130);margin:0;padding:0}.root .dropdown .channel-display .showing .channel-name-text.highlight-search-text{font-weight:700}.root .dropdown .channel-display:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.root .dropdown .loading-text,.root .dropdown .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;color:var(--color-sub1,#323130);line-height:19px;text-align:center}.root .dropdown .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}.root .dropdown .message-parent .loading-text{margin-top:3px;margin-left:9px;color:#0078d4}[dir=rtl] .input-wrapper::after{content:'';position:absolute;width:99%;height:90%;top:2px;left:0;background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-moz-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-o-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-ms-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%);background-image:-webkit-linear-gradient(right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 80%,var(--input-background-color,#fff) 100%)}[dir=rtl] .search-wrapper{margin-right:0!important}[dir=rtl] .search-icon{margin-left:8px!important}[dir=rtl] .channel-display{padding:0 34px 0 10px!important}[dir=rtl] .close-icon{right:auto;left:10px}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}
`
];
//# sourceMappingURL=mgt-teams-channel-picker-css.js.map

/***/ }),

/***/ "NzbG":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/XHRClient.js ***!
  \***********************************************************************************************/
/*! exports provided: XhrClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "XhrClient", function() { return XhrClient; });
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/Constants */ "MQw9");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */

/**
 * XHR client for JSON endpoints
 * https://www.npmjs.com/package/async-promise
 * @hidden
 */
var XhrClient = /** @class */ (function () {
    function XhrClient() {
    }
    XhrClient.prototype.sendRequestAsync = function (url, method, enableCaching) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var xhr = new XMLHttpRequest();
            xhr.open(method, url, /* async: */ true);
            if (enableCaching) {
                /*
                 * TODO: (shivb) ensure that this can be cached
                 * xhr.setRequestHeader("Cache-Control", "Public");
                 */
            }
            xhr.onload = function () {
                if (xhr.status < 200 || xhr.status >= 300) {
                    reject(_this.handleError(xhr.responseText));
                }
                var jsonResponse;
                try {
                    jsonResponse = JSON.parse(xhr.responseText);
                }
                catch (e) {
                    reject(_this.handleError(xhr.responseText));
                }
                var response = {
                    statusCode: xhr.status,
                    body: jsonResponse
                };
                resolve(response);
            };
            xhr.onerror = function () {
                reject(xhr.status);
            };
            if (method === _utils_Constants__WEBPACK_IMPORTED_MODULE_0__["NetworkRequestType"].GET) {
                xhr.send();
            }
            else {
                throw "not implemented";
            }
        });
    };
    XhrClient.prototype.handleError = function (responseText) {
        var jsonResponse;
        try {
            jsonResponse = JSON.parse(responseText);
            if (jsonResponse.error) {
                return jsonResponse.error;
            }
            else {
                throw responseText;
            }
        }
        catch (e) {
            return responseText;
        }
    };
    return XhrClient;
}());

//# sourceMappingURL=XHRClient.js.map

/***/ }),

/***/ "O34b":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/index.js ***!
  \*******************************************************************************************/
/*! exports provided: UserAgentApplication, Logger, LogLevel, Account, Constants, ServerHashParamKeys, Authority, CryptoUtils, UrlUtils, WindowUtils, AuthError, ClientAuthError, ServerError, ClientConfigurationError, InteractionRequiredAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _UserAgentApplication__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./UserAgentApplication */ "lRz9");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UserAgentApplication", function() { return _UserAgentApplication__WEBPACK_IMPORTED_MODULE_0__["UserAgentApplication"]; });

/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Logger */ "FT8K");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Logger", function() { return _Logger__WEBPACK_IMPORTED_MODULE_1__["Logger"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LogLevel", function() { return _Logger__WEBPACK_IMPORTED_MODULE_1__["LogLevel"]; });

/* harmony import */ var _Account__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Account */ "cY1T");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Account", function() { return _Account__WEBPACK_IMPORTED_MODULE_2__["Account"]; });

/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/Constants */ "MQw9");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Constants", function() { return _utils_Constants__WEBPACK_IMPORTED_MODULE_3__["Constants"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ServerHashParamKeys", function() { return _utils_Constants__WEBPACK_IMPORTED_MODULE_3__["ServerHashParamKeys"]; });

/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./authority/Authority */ "UYCr");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Authority", function() { return _authority_Authority__WEBPACK_IMPORTED_MODULE_4__["Authority"]; });

/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils/CryptoUtils */ "oish");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CryptoUtils", function() { return _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"]; });

/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils/UrlUtils */ "6r4W");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UrlUtils", function() { return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_6__["UrlUtils"]; });

/* harmony import */ var _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utils/WindowUtils */ "ZVnu");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WindowUtils", function() { return _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_7__["WindowUtils"]; });

/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./error/AuthError */ "MEWQ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AuthError", function() { return _error_AuthError__WEBPACK_IMPORTED_MODULE_8__["AuthError"]; });

/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./error/ClientAuthError */ "L9Ey");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClientAuthError", function() { return _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_9__["ClientAuthError"]; });

/* harmony import */ var _error_ServerError__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./error/ServerError */ "n3St");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ServerError", function() { return _error_ServerError__WEBPACK_IMPORTED_MODULE_10__["ServerError"]; });

/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./error/ClientConfigurationError */ "UBea");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClientConfigurationError", function() { return _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_11__["ClientConfigurationError"]; });

/* harmony import */ var _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./error/InteractionRequiredAuthError */ "pgW6");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "InteractionRequiredAuthError", function() { return _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_12__["InteractionRequiredAuthError"]; });

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */









// Errors





//# sourceMappingURL=index.js.map

/***/ }),

/***/ "P0+2":
/*!*********************************************!*\
  !*** ./node_modules/idb/build/esm/index.js ***!
  \*********************************************/
/*! exports provided: unwrap, wrap, deleteDB, openDB */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deleteDB", function() { return deleteDB; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "openDB", function() { return openDB; });
/* harmony import */ var _wrap_idb_value_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./wrap-idb-value.js */ "edJK");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "unwrap", function() { return _wrap_idb_value_js__WEBPACK_IMPORTED_MODULE_0__["u"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "wrap", function() { return _wrap_idb_value_js__WEBPACK_IMPORTED_MODULE_0__["w"]; });




/**
 * Open a database.
 *
 * @param name Name of the database.
 * @param version Schema version.
 * @param callbacks Additional callbacks.
 */
function openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {
    const request = indexedDB.open(name, version);
    const openPromise = Object(_wrap_idb_value_js__WEBPACK_IMPORTED_MODULE_0__["w"])(request);
    if (upgrade) {
        request.addEventListener('upgradeneeded', (event) => {
            upgrade(Object(_wrap_idb_value_js__WEBPACK_IMPORTED_MODULE_0__["w"])(request.result), event.oldVersion, event.newVersion, Object(_wrap_idb_value_js__WEBPACK_IMPORTED_MODULE_0__["w"])(request.transaction));
        });
    }
    if (blocked)
        request.addEventListener('blocked', () => blocked());
    openPromise
        .then((db) => {
        if (terminated)
            db.addEventListener('close', () => terminated());
        if (blocking)
            db.addEventListener('versionchange', () => blocking());
    })
        .catch(() => { });
    return openPromise;
}
/**
 * Delete a database.
 *
 * @param name Name of the database.
 */
function deleteDB(name, { blocked } = {}) {
    const request = indexedDB.deleteDatabase(name);
    if (blocked)
        request.addEventListener('blocked', () => blocked());
    return Object(_wrap_idb_value_js__WEBPACK_IMPORTED_MODULE_0__["w"])(request).then(() => undefined);
}

const readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];
const writeMethods = ['put', 'add', 'delete', 'clear'];
const cachedMethods = new Map();
function getMethod(target, prop) {
    if (!(target instanceof IDBDatabase &&
        !(prop in target) &&
        typeof prop === 'string')) {
        return;
    }
    if (cachedMethods.get(prop))
        return cachedMethods.get(prop);
    const targetFuncName = prop.replace(/FromIndex$/, '');
    const useIndex = prop !== targetFuncName;
    const isWrite = writeMethods.includes(targetFuncName);
    if (
    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.
    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||
        !(isWrite || readMethods.includes(targetFuncName))) {
        return;
    }
    const method = async function (storeName, ...args) {
        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(
        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');
        let target = tx.store;
        if (useIndex)
            target = target.index(args.shift());
        const returnVal = await target[targetFuncName](...args);
        if (isWrite)
            await tx.done;
        return returnVal;
    };
    cachedMethods.set(prop, method);
    return method;
}
Object(_wrap_idb_value_js__WEBPACK_IMPORTED_MODULE_0__["r"])((oldTraps) => ({
    ...oldTraps,
    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),
    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),
}));




/***/ }),

/***/ "P6yO":
/*!********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/tasks/LargeFileUploadTask.js ***!
  \********************************************************************************************/
/*! exports provided: LargeFileUploadTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LargeFileUploadTask", function() { return LargeFileUploadTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Range__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Range */ "bKjy");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


/**
 * @class
 * Class representing LargeFileUploadTask
 */
class LargeFileUploadTask {
    /**
     * @public
     * @constructor
     * Constructs a LargeFileUploadTask
     * @param {Client} client - The GraphClient instance
     * @param {FileObject} file - The FileObject holding details of a file that needs to be uploaded
     * @param {LargeFileUploadSession} uploadSession - The upload session to which the upload has to be done
     * @param {LargeFileUploadTaskOptions} options - The upload task options
     * @returns An instance of LargeFileUploadTask
     */
    constructor(client, file, uploadSession, options = {}) {
        /**
         * @private
         * Default value for the rangeSize
         */
        this.DEFAULT_FILE_SIZE = 5 * 1024 * 1024;
        this.client = client;
        this.file = file;
        if (options.rangeSize === undefined) {
            options.rangeSize = this.DEFAULT_FILE_SIZE;
        }
        this.options = options;
        this.uploadSession = uploadSession;
        this.nextRange = new _Range__WEBPACK_IMPORTED_MODULE_1__["Range"](0, this.options.rangeSize - 1);
    }
    /**
     * @public
     * @static
     * @async
     * Makes request to the server to create an upload session
     * @param {Client} client - The GraphClient instance
     * @param {any} payload - The payload that needs to be sent
     * @param {KeyValuePairObjectStringNumber} headers - The headers that needs to be sent
     * @returns The promise that resolves to LargeFileUploadSession
     */
    static createUploadSession(client, requestUrl, payload, headers = {}) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const session = yield client
                    .api(requestUrl)
                    .headers(headers)
                    .post(payload);
                const largeFileUploadSession = {
                    url: session.uploadUrl,
                    expiry: new Date(session.expirationDateTime),
                };
                return largeFileUploadSession;
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @private
     * Parses given range string to the Range instance
     * @param {string[]} ranges - The ranges value
     * @returns The range instance
     */
    parseRange(ranges) {
        const rangeStr = ranges[0];
        if (typeof rangeStr === "undefined" || rangeStr === "") {
            return new _Range__WEBPACK_IMPORTED_MODULE_1__["Range"]();
        }
        const firstRange = rangeStr.split("-");
        const minVal = parseInt(firstRange[0], 10);
        let maxVal = parseInt(firstRange[1], 10);
        if (Number.isNaN(maxVal)) {
            maxVal = this.file.size - 1;
        }
        return new _Range__WEBPACK_IMPORTED_MODULE_1__["Range"](minVal, maxVal);
    }
    /**
     * @private
     * Updates the expiration date and the next range
     * @param {UploadStatusResponse} response - The response of the upload status
     * @returns Nothing
     */
    updateTaskStatus(response) {
        this.uploadSession.expiry = new Date(response.expirationDateTime);
        this.nextRange = this.parseRange(response.nextExpectedRanges);
    }
    /**
     * @public
     * Gets next range that needs to be uploaded
     * @returns The range instance
     */
    getNextRange() {
        if (this.nextRange.minValue === -1) {
            return this.nextRange;
        }
        const minVal = this.nextRange.minValue;
        let maxValue = minVal + this.options.rangeSize - 1;
        if (maxValue >= this.file.size) {
            maxValue = this.file.size - 1;
        }
        return new _Range__WEBPACK_IMPORTED_MODULE_1__["Range"](minVal, maxValue);
    }
    /**
     * @public
     * Slices the file content to the given range
     * @param {Range} range - The range value
     * @returns The sliced ArrayBuffer or Blob
     */
    sliceFile(range) {
        const blob = this.file.content.slice(range.minValue, range.maxValue + 1);
        return blob;
    }
    /**
     * @public
     * @async
     * Uploads file to the server in a sequential order by slicing the file
     * @returns The promise resolves to uploaded response
     */
    upload() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                while (true) {
                    const nextRange = this.getNextRange();
                    if (nextRange.maxValue === -1) {
                        const err = new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");
                        err.name = "Invalid Session";
                        throw err;
                    }
                    const fileSlice = this.sliceFile(nextRange);
                    const response = yield this.uploadSlice(fileSlice, nextRange, this.file.size);
                    // Upon completion of upload process incase of onedrive, driveItem is returned, which contains id
                    if (response.id !== undefined) {
                        return response;
                    }
                    else {
                        this.updateTaskStatus(response);
                    }
                }
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @async
     * Uploads given slice to the server
     * @param {ArrayBuffer | Blob | File} fileSlice - The file slice
     * @param {Range} range - The range value
     * @param {number} totalSize - The total size of a complete file
     */
    uploadSlice(fileSlice, range, totalSize) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.client
                    .api(this.uploadSession.url)
                    .headers({
                    "Content-Length": `${range.maxValue - range.minValue + 1}`,
                    "Content-Range": `bytes ${range.minValue}-${range.maxValue}/${totalSize}`,
                })
                    .put(fileSlice);
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @async
     * Deletes upload session in the server
     * @returns The promise resolves to cancelled response
     */
    cancel() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.client.api(this.uploadSession.url).delete();
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @async
     * Gets status for the upload session
     * @returns The promise resolves to the status enquiry response
     */
    getStatus() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const response = yield this.client.api(this.uploadSession.url).get();
                this.updateTaskStatus(response);
                return response;
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @async
     * Resumes upload session and continue uploading the file from the last sent range
     * @returns The promise resolves to the uploaded response
     */
    resume() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                yield this.getStatus();
                return yield this.upload();
            }
            catch (err) {
                throw err;
            }
        });
    }
}
//# sourceMappingURL=LargeFileUploadTask.js.map

/***/ }),

/***/ "P7jh":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-todo/mgt-todo.js ***!
  \*****************************************************************************************/
/*! exports provided: MgtTodo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtTodo", function() { return MgtTodo; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var lit_html_directives_repeat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit-html/directives/repeat */ "2Fb8");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _utils_Utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/Utils */ "vQVX");
/* harmony import */ var _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../mgt-person/mgt-person */ "lBzc");
/* harmony import */ var _mgt_tasks_base_mgt_tasks_base__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../mgt-tasks-base/mgt-tasks-base */ "/5+p");
/* harmony import */ var _sub_components_mgt_arrow_options_mgt_arrow_options__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sub-components/mgt-arrow-options/mgt-arrow-options */ "29R+");
/* harmony import */ var _sub_components_mgt_dot_options_mgt_dot_options__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sub-components/mgt-dot-options/mgt-dot-options */ "4J3T");
/* harmony import */ var _graph_todo__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./graph.todo */ "Jdg0");
/* harmony import */ var _mgt_todo_css__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./mgt-todo-css */ "eK1D");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./strings */ "BZLG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};












/**
 * component enables the user to view, add, remove, complete, or edit todo tasks. It works with tasks in Microsoft Planner or Microsoft To-Do.
 *
 * @export
 * @class MgtTodo
 * @extends {MgtTasksBase}
 *
 * @cssprop --tasks-background-color - {Color} Task background color
 * @cssprop --tasks-header-padding - {String} Tasks header padding
 * @cssprop --tasks-title-padding - {String} Tasks title padding
 * @cssprop --tasks-plan-title-font-size - {Length} Tasks plan title font size
 * @cssprop --tasks-plan-title-padding - {String} Tasks plan title padding
 * @cssprop --tasks-new-button-width - {String} Tasks new button width
 * @cssprop --tasks-new-button-height - {String} Tasks new button height
 * @cssprop --tasks-new-button-color - {Color} Tasks new button color
 * @cssprop --tasks-new-button-background - {String} Tasks new button background
 * @cssprop --tasks-new-button-border - {String} Tasks new button border
 * @cssprop --tasks-new-button-hover-background - {Color} Tasks new button hover background
 * @cssprop --tasks-new-button-active-background - {Color} Tasks new button active background
 * @cssprop --task-margin - {String} Task margin
 * @cssprop --task-background - {Color} Task background
 * @cssprop --task-border - {String} Task border
 * @cssprop --task-header-color - {Color} Task header color
 * @cssprop --task-header-margin - {String} Task header margin
 * @cssprop --task-new-margin - {String} Task new margin
 * @cssprop --task-new-border - {String} Task new border
 * @cssprop --task-new-input-margin - {String} Task new input margin
 * @cssprop --task-new-input-padding - {String} Task new input padding
 * @cssprop --task-new-input-font-size - {Length} Task new input font size
 * @cssprop --task-new-select-border - {String} Task new select border
 * @cssprop --task-new-add-button-background - {Color} Task new add button background
 * @cssprop --task-new-add-button-disabled-background - {Color} Task new add button disabled background
 * @cssprop --task-new-cancel-button-color - {Color} Task new cancel button color
 * @cssprop --task-complete-background - {Color} Task complete background
 * @cssprop --task-complete-border - {String} Task complete border
 * @cssprop --task-icon-alignment - {String} Task icon alignment
 * @cssprop --task-icon-background - {Color} Task icon color
 * @cssprop --task-icon-background-completed - {Color} Task icon background color when completed
 * @cssprop --task-icon-border - {String} Task icon border styles
 * @cssprop --task-icon-border-completed - {String} Task icon border style when task is completed
 * @cssprop --task-icon-border-radius - {String} Task icon border radius
 * @cssprop --task-icon-color - {Color} Task icon color
 * @cssprop --task-icon-color-completed - {Color} Task icon color when completed
 */
let MgtTodo = class MgtTodo extends _mgt_tasks_base_mgt_tasks_base__WEBPACK_IMPORTED_MODULE_6__["MgtTasksBase"] {
    constructor() {
        super();
        this._graph = null;
        this._newTaskDueDate = null;
        this._newTaskListId = '';
        this._currentList = null;
        this._lists = [];
        this._tasks = [];
        this._loadingTasks = [];
        this._isLoadingTasks = false;
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_todo_css__WEBPACK_IMPORTED_MODULE_10__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_11__["strings"];
    }
    /**
     * Render the list of todo tasks
     */
    renderTasks() {
        if (this._isLoadingTasks) {
            return this.renderLoadingTask();
        }
        let tasks = this._tasks;
        if (tasks && this.taskFilter) {
            tasks = tasks.filter(task => this.taskFilter(task));
        }
        const taskTemplates = Object(lit_html_directives_repeat__WEBPACK_IMPORTED_MODULE_2__["repeat"])(tasks, task => task.id, task => this.renderTask(task));
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      ${taskTemplates}
    `;
    }
    /**
     * Render the details part of the new task panel
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtTodo
     */
    renderNewTaskDetails() {
        const lists = this._lists.filter(list => (this._currentList && list.id === this._currentList.id) ||
            (!this._currentList && list.id === this._newTaskListId));
        if (lists.length > 0 && !this._newTaskListId) {
            this._newTaskListId = lists[0].id;
        }
        const taskList = this._currentList
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <span>${this._currentList.displayName}</span>
          </span>
        `
            : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <span class="NewTaskGroup">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskListId}"
              @change="${(e) => {
                this._newTaskListId = e.target.value;
            }}"
            >
              ${lists.map(list => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
                  <option value="${list.id}">${list.displayName}</option>
                `)}
            </select>
          </span>
        `;
        const taskDue = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <span class="NewTaskDue">
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="input"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${(e) => {
            const value = e.target.value;
            if (value) {
                this._newTaskDueDate = new Date(value + 'T17:00');
            }
            else {
                this._newTaskDueDate = null;
            }
        }}"
        />
      </span>
    `;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      ${taskList} ${taskDue}
    `;
    }
    /**
     * Render the header part of the component.
     *
     * @protected
     * @returns
     * @memberof MgtTodo
     */
    renderHeaderContent() {
        if (this.isLoadingState) {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="header__loading"></div>
      `;
        }
        const lists = this._lists || [];
        const currentList = this._currentList;
        const targetId = this.targetId;
        let listSelect;
        if (targetId && lists.length) {
            const list = lists.find(l => l.id === targetId);
            if (list) {
                listSelect = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <span class="PlanTitle">
            ${list.displayName}
          </span>
        `;
            }
        }
        else if (currentList) {
            const listOptions = {};
            for (const l of lists) {
                listOptions[l.displayName] = () => this.loadTaskList(l);
            }
            listSelect = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <mgt-arrow-options .value="${currentList.displayName}" .options="${listOptions}"></mgt-arrow-options>
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <span class="TitleCont">
        ${listSelect}
      </span>
    `;
    }
    /**
     * Render a task in the list.
     *
     * @protected
     * @param {TodoTask} task
     * @returns
     * @memberof MgtTodo
     */
    renderTask(task) {
        const context = { task, list: this._currentList };
        if (this.hasTemplate('task')) {
            return this.renderTemplate('task', context, task.id);
        }
        const isCompleted = _graph_todo__WEBPACK_IMPORTED_MODULE_9__["TaskStatus"][task.status] === _graph_todo__WEBPACK_IMPORTED_MODULE_9__["TaskStatus"].completed;
        const isLoading = this._loadingTasks.includes(task.id);
        const taskCheckClasses = {
            Complete: !isLoading && isCompleted,
            Loading: isLoading,
            TaskCheck: true,
            TaskIcon: true
        };
        const taskCheckContent = isLoading
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          
        `
            : isCompleted
                ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          
        `
                : null;
        let taskDetailsTemplate = null;
        if (this.hasTemplate('task-details')) {
            taskDetailsTemplate = this.renderTemplate('task-details', context, `task-details-${task.id}`);
        }
        else {
            const taskDueTemplate = task.dueDateTime
                ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="TaskDetail TaskDue">
              <span>Due ${Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_4__["getShortDateString"])(new Date(task.dueDateTime.dateTime))}</span>
            </div>
          `
                : null;
            taskDetailsTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="TaskTitle">
          ${task.title}
        </div>
        <div class="TaskDetail TaskBucket">
          ${this.renderBucketIcon()}
          <span>${this._currentList.displayName}</span>
        </div>
        ${taskDueTemplate}
      `;
        }
        const taskOptionsTemplate = !this.readOnly && !this.hideOptions
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{
                [this.strings.removeTaskSubtitle]: e => this.removeTask(e, task.id)
            }}"
              ></mgt-dot-options>
            </div>
          `
            : null;
        const taskClasses = Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({
            Complete: isCompleted,
            Incomplete: !isCompleted,
            ReadOnly: this.readOnly,
            Task: true
        });
        const taskCheckContainerClasses = Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({
            Complete: isCompleted,
            Incomplete: !isCompleted,
            TaskCheckContainer: true
        });
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class=${taskClasses}>
        <div class="TaskContent" @click="${(e) => this.handleTaskClick(e, task)}}">
          <span class=${taskCheckContainerClasses} @click="${(e) => this.handleTaskCheckClick(e, task)}">
            <span class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(taskCheckClasses)}>
              <span class="TaskCheckContent">${taskCheckContent}</span>
            </span>
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery}">
            ${taskDetailsTemplate}
          </div>
          ${taskOptionsTemplate}
          <div class="Divider"></div>
        </div>
      </div>
    `;
    }
    /**
     * loads tasks from dataSource
     *
     * @returns
     * @memberof MgtTasks
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__["Providers"].globalProvider;
            if (!provider || provider.state !== _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__["ProviderState"].SignedIn) {
                return;
            }
            if (!this._graph) {
                const graph = provider.graph.forComponent(this);
                this._graph = graph;
            }
            let lists = this._lists;
            if (!lists || !lists.length) {
                if (this.targetId) {
                    const targetList = yield Object(_graph_todo__WEBPACK_IMPORTED_MODULE_9__["getTodoTaskList"])(this._graph, this.targetId);
                    lists = targetList ? [targetList] : [];
                }
                else {
                    lists = yield Object(_graph_todo__WEBPACK_IMPORTED_MODULE_9__["getTodoTaskLists"])(this._graph);
                }
                this._tasks = [];
                this._currentList = null;
                this._lists = lists;
            }
            let currentList = this._currentList;
            if (!currentList && lists && lists.length) {
                if (this.initialId) {
                    currentList = lists.find(l => l.id === this.initialId);
                }
                if (!currentList) {
                    currentList = lists[0];
                }
                this._tasks = [];
                this._currentList = currentList;
            }
            if (currentList) {
                yield this.loadTaskList(currentList);
            }
        });
    }
    /**
     * Send a request the Graph to create a new todo task item
     *
     * @protected
     * @returns {Promise<any>}
     * @memberof MgtTodo
     */
    createNewTask() {
        return __awaiter(this, void 0, void 0, function* () {
            const listId = this._currentList.id;
            const taskData = {
                title: this.newTaskName
            };
            if (this._newTaskDueDate) {
                // tslint:disable-next-line: no-string-literal
                taskData['dueDateTime'] = {
                    dateTime: this._newTaskDueDate.toISOString(),
                    timeZone: 'UTC'
                };
            }
            const task = yield Object(_graph_todo__WEBPACK_IMPORTED_MODULE_9__["createTodoTask"])(this._graph, listId, taskData);
            this._tasks.unshift(task);
        });
    }
    /**
     * Clear out the new task metadata input fields
     *
     * @protected
     * @memberof MgtTodo
     */
    clearNewTaskData() {
        super.clearNewTaskData();
        this._newTaskDueDate = null;
        this._newTaskListId = null;
    }
    /**
     * Clear the state of the component
     *
     * @protected
     * @memberof MgtTodo
     */
    clearState() {
        super.clearState();
        this._currentList = null;
        this._lists = [];
        this._tasks = [];
        this._loadingTasks = [];
        this._isLoadingTasks = false;
    }
    loadTaskList(list) {
        return __awaiter(this, void 0, void 0, function* () {
            this._isLoadingTasks = true;
            this._currentList = list;
            this.requestUpdate();
            this._tasks = yield Object(_graph_todo__WEBPACK_IMPORTED_MODULE_9__["getTodoTasks"])(this._graph, list.id);
            this._isLoadingTasks = false;
            this.requestUpdate();
        });
    }
    updateTaskStatus(task, taskStatus) {
        return __awaiter(this, void 0, void 0, function* () {
            this._loadingTasks = [...this._loadingTasks, task.id];
            this.requestUpdate();
            // Change the task status
            task.status = taskStatus;
            // Send update request
            const listId = this._currentList.id;
            task = yield Object(_graph_todo__WEBPACK_IMPORTED_MODULE_9__["updateTodoTask"])(this._graph, listId, task.id, task);
            const taskIndex = this._tasks.findIndex(t => t.id === task.id);
            this._tasks[taskIndex] = task;
            this._loadingTasks = this._loadingTasks.filter(id => id !== task.id);
            this.requestUpdate();
        });
    }
    // tslint:disable-next-line: completed-docs
    removeTask(e, taskId) {
        return __awaiter(this, void 0, void 0, function* () {
            this._tasks = this._tasks.filter(t => t.id !== taskId);
            this.requestUpdate();
            const listId = this._currentList.id;
            yield Object(_graph_todo__WEBPACK_IMPORTED_MODULE_9__["deleteTodoTask"])(this._graph, listId, taskId);
            this._tasks = this._tasks.filter(t => t.id !== taskId);
        });
    }
    handleTaskCheckClick(e, task) {
        if (!this.readOnly) {
            if (_graph_todo__WEBPACK_IMPORTED_MODULE_9__["TaskStatus"][task.status] === _graph_todo__WEBPACK_IMPORTED_MODULE_9__["TaskStatus"].completed) {
                this.updateTaskStatus(task, _graph_todo__WEBPACK_IMPORTED_MODULE_9__["TaskStatus"].notStarted);
            }
            else {
                this.updateTaskStatus(task, _graph_todo__WEBPACK_IMPORTED_MODULE_9__["TaskStatus"].completed);
            }
            e.stopPropagation();
            e.preventDefault();
        }
    }
};
MgtTodo = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-todo'),
    __metadata("design:paramtypes", [])
], MgtTodo);

//# sourceMappingURL=mgt-todo.js.map

/***/ }),

/***/ "PQPV":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/telemetry/HttpEvent.js ***!
  \*********************************************************************************************************/
/*! exports provided: EVENT_KEYS, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_KEYS", function() { return EVENT_KEYS; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryEvent */ "aklA");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryUtils */ "E5LX");
/* harmony import */ var _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ServerRequestParameters */ "FbQe");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var EVENT_KEYS = {
    HTTP_PATH: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("http_path"),
    USER_AGENT: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("user_agent"),
    QUERY_PARAMETERS: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("query_parameters"),
    API_VERSION: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("api_version"),
    RESPONSE_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("response_code"),
    O_AUTH_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("oauth_error_code"),
    HTTP_METHOD: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("http_method"),
    REQUEST_ID_HEADER: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("request_id_header"),
    SPE_INFO: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("spe_info"),
    SERVER_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("server_error_code"),
    SERVER_SUB_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("server_sub_error_code"),
    URL: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("url")
};
var HttpEvent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpEvent, _super);
    function HttpEvent(correlationId, eventLabel) {
        return _super.call(this, Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])("http_event"), correlationId, eventLabel) || this;
    }
    Object.defineProperty(HttpEvent.prototype, "url", {
        set: function (url) {
            var scrubbedUri = Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["scrubTenantFromUri"])(url);
            this.event[EVENT_KEYS.URL] = scrubbedUri && scrubbedUri.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "httpPath", {
        set: function (httpPath) {
            this.event[EVENT_KEYS.HTTP_PATH] = Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["scrubTenantFromUri"])(httpPath).toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "userAgent", {
        set: function (userAgent) {
            this.event[EVENT_KEYS.USER_AGENT] = userAgent;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "queryParams", {
        set: function (queryParams) {
            this.event[EVENT_KEYS.QUERY_PARAMETERS] = _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].generateQueryParametersString(queryParams);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "apiVersion", {
        set: function (apiVersion) {
            this.event[EVENT_KEYS.API_VERSION] = apiVersion.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "httpResponseStatus", {
        set: function (statusCode) {
            this.event[EVENT_KEYS.RESPONSE_CODE] = statusCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "oAuthErrorCode", {
        set: function (errorCode) {
            this.event[EVENT_KEYS.O_AUTH_ERROR_CODE] = errorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "httpMethod", {
        set: function (httpMethod) {
            this.event[EVENT_KEYS.HTTP_METHOD] = httpMethod;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "requestIdHeader", {
        set: function (requestIdHeader) {
            this.event[EVENT_KEYS.REQUEST_ID_HEADER] = requestIdHeader;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "speInfo", {
        /**
         * Indicates whether the request was executed on a ring serving SPE traffic.
         * An empty string indicates this occurred on an outer ring, and the string "I"
         * indicates the request occurred on the inner ring
         */
        set: function (speInfo) {
            this.event[EVENT_KEYS.SPE_INFO] = speInfo;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "serverErrorCode", {
        set: function (errorCode) {
            this.event[EVENT_KEYS.SERVER_ERROR_CODE] = errorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(HttpEvent.prototype, "serverSubErrorCode", {
        set: function (subErrorCode) {
            this.event[EVENT_KEYS.SERVER_SUB_ERROR_CODE] = subErrorCode;
        },
        enumerable: true,
        configurable: true
    });
    return HttpEvent;
}(_TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (HttpEvent);
//# sourceMappingURL=HttpEvent.js.map

/***/ }),

/***/ "Pd+Y":
/*!*******************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/graph/graph.groups.js ***!
  \*******************************************************************************/
/*! exports provided: GroupType, findGroups, findGroupsFromGroup */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GroupType", function() { return GroupType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findGroups", function() { return findGroups; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findGroupsFromGroup", function() { return findGroupsFromGroup; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

/**
 * Group Type enumeration
 *
 * @export
 * @enum {number}
 */
var GroupType;
(function (GroupType) {
    /**
     * Any group Type
     */
    GroupType[GroupType["any"] = 0] = "any";
    /**
     * Office 365 group
     */
    // tslint:disable-next-line:no-bitwise
    GroupType[GroupType["unified"] = 1] = "unified";
    /**
     * Security group
     */
    // tslint:disable-next-line:no-bitwise
    GroupType[GroupType["security"] = 2] = "security";
    /**
     * Mail Enabled Security group
     */
    // tslint:disable-next-line:no-bitwise
    GroupType[GroupType["mailenabledsecurity"] = 4] = "mailenabledsecurity";
    /**
     * Distribution Group
     */
    // tslint:disable-next-line:no-bitwise
    GroupType[GroupType["distribution"] = 8] = "distribution";
})(GroupType || (GroupType = {}));
/**
 * Definition of cache structure
 */
const cacheSchema = {
    name: 'groups',
    stores: {
        groupsQuery: {}
    },
    version: 1
};
/**
 * Defines the expiration time
 */
const getGroupsInvalidationTime = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.groups.invalidationPeriod || _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.defaultInvalidationPeriod;
/**
 * Whether the groups store is enabled
 */
const groupsCacheEnabled = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.groups.isEnabled && _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.isEnabled;
/**
 * Searches the Graph for Groups
 *
 * @export
 * @param {IGraph} graph
 * @param {string} query - what to search for
 * @param {number} [top=10] - number of groups to return
 * @param {GroupType} [groupTypes=GroupType.any] - the type of group to search for
 * @returns {Promise<Group[]>} An array of Groups
 */
function findGroups(graph, query, top = 10, groupTypes = GroupType.any) {
    return __awaiter(this, void 0, void 0, function* () {
        const scopes = 'Group.Read.All';
        let cache;
        const key = query || '*' + groupTypes;
        if (groupsCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, 'groupsQuery');
            const cacheGroupQuery = yield cache.getValue(key);
            if (cacheGroupQuery && getGroupsInvalidationTime() > Date.now() - cacheGroupQuery.timeCached) {
                if (cacheGroupQuery.top >= top) {
                    // if request is less than the cache's requests, return a slice of the results
                    return cacheGroupQuery.groups.map(x => JSON.parse(x)).slice(0, top + 1);
                }
                // if the new request needs more results than what's presently in the cache, graph must be called again
            }
        }
        let filterQuery = '';
        if (query !== '') {
            filterQuery = `(startswith(displayName,'${query}') or startswith(mailNickname,'${query}') or startswith(mail,'${query}'))`;
        }
        if (groupTypes !== GroupType.any) {
            const filterGroups = [];
            // tslint:disable-next-line:no-bitwise
            if (GroupType.unified === (groupTypes & GroupType.unified)) {
                filterGroups.push("groupTypes/any(c:c+eq+'Unified')");
            }
            // tslint:disable-next-line:no-bitwise
            if (GroupType.security === (groupTypes & GroupType.security)) {
                filterGroups.push('(mailEnabled eq false and securityEnabled eq true)');
            }
            // tslint:disable-next-line:no-bitwise
            if (GroupType.mailenabledsecurity === (groupTypes & GroupType.mailenabledsecurity)) {
                filterGroups.push('(mailEnabled eq true and securityEnabled eq true)');
            }
            // tslint:disable-next-line:no-bitwise
            if (GroupType.distribution === (groupTypes & GroupType.distribution)) {
                filterGroups.push('(mailEnabled eq true and securityEnabled eq false)');
            }
            filterQuery += (query !== '' ? ' and ' : '') + filterGroups.join(' or ');
        }
        const result = yield graph
            .api('groups')
            .filter(filterQuery)
            .top(top)
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(scopes))
            .get();
        if (groupsCacheEnabled() && result) {
            cache.putValue(key, { groups: result.value.map(x => JSON.stringify(x)), top: top });
        }
        return result ? result.value : null;
    });
}
/**
 * Searches the Graph for Groups
 *
 * @export
 * @param {IGraph} graph
 * @param {string} query - what to search for
 * @param {string} groupId - what to search for
 * @param {number} [top=10] - number of groups to return
 * @param {boolean} [transitive=false] - whether the return should contain a flat list of all nested members
 * @param {GroupType} [groupTypes=GroupType.any] - the type of group to search for
 * @returns {Promise<Group[]>} An array of Groups
 */
function findGroupsFromGroup(graph, query, groupId, top = 10, transitive = false, groupTypes = GroupType.any) {
    return __awaiter(this, void 0, void 0, function* () {
        const scopes = 'Group.Read.All';
        let cache;
        const key = `${groupId}:${query || '*'}:${groupTypes}:${transitive}`;
        if (groupsCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, 'groupsQuery');
            const cacheGroupQuery = yield cache.getValue(key);
            if (cacheGroupQuery && getGroupsInvalidationTime() > Date.now() - cacheGroupQuery.timeCached) {
                if (cacheGroupQuery.top >= top) {
                    // if request is less than the cache's requests, return a slice of the results
                    return cacheGroupQuery.groups.map(x => JSON.parse(x)).slice(0, top + 1);
                }
                // if the new request needs more results than what's presently in the cache, graph must be called again
            }
        }
        const apiUrl = `groups/${groupId}/${transitive ? 'transitiveMembers' : 'members'}/microsoft.graph.group`;
        let filterQuery = '';
        if (query !== '') {
            filterQuery = `(startswith(displayName,'${query}') or startswith(mailNickname,'${query}') or startswith(mail,'${query}'))`;
        }
        if (groupTypes !== GroupType.any) {
            const filterGroups = [];
            // tslint:disable-next-line:no-bitwise
            if (GroupType.unified === (groupTypes & GroupType.unified)) {
                filterGroups.push("groupTypes/any(c:c+eq+'Unified')");
            }
            // tslint:disable-next-line:no-bitwise
            if (GroupType.security === (groupTypes & GroupType.security)) {
                filterGroups.push('(mailEnabled eq false and securityEnabled eq true)');
            }
            // tslint:disable-next-line:no-bitwise
            if (GroupType.mailenabledsecurity === (groupTypes & GroupType.mailenabledsecurity)) {
                filterGroups.push('(mailEnabled eq true and securityEnabled eq true)');
            }
            // tslint:disable-next-line:no-bitwise
            if (GroupType.distribution === (groupTypes & GroupType.distribution)) {
                filterGroups.push('(mailEnabled eq true and securityEnabled eq false)');
            }
            filterQuery += (query !== '' ? ' and ' : '') + filterGroups.join(' or ');
        }
        const result = yield graph
            .api(apiUrl)
            .filter(filterQuery)
            .count(true)
            .top(top)
            .header('ConsistencyLevel', 'eventual')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(scopes))
            .get();
        if (groupsCacheEnabled() && result) {
            cache.putValue(key, { groups: result.value.map(x => JSON.stringify(x)), top: top });
        }
        return result ? result.value : null;
    });
}
//# sourceMappingURL=graph.groups.js.map

/***/ }),

/***/ "Pich":
/*!******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/XHRClient.js ***!
  \******************************************************************************************/
/*! exports provided: XhrClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "XhrClient", function() { return XhrClient; });
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/Constants */ "/pXG");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */

/**
 * XHR client for JSON endpoints
 * https://www.npmjs.com/package/async-promise
 * @hidden
 */
var XhrClient = /** @class */ (function () {
    function XhrClient() {
    }
    XhrClient.prototype.sendRequestAsync = function (url, method, enableCaching) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var xhr = new XMLHttpRequest();
            xhr.open(method, url, /* async: */ true);
            if (enableCaching) {
                /*
                 * TODO: (shivb) ensure that this can be cached
                 * xhr.setRequestHeader("Cache-Control", "Public");
                 */
            }
            xhr.onload = function () {
                if (xhr.status < 200 || xhr.status >= 300) {
                    reject(_this.handleError(xhr.responseText));
                }
                var jsonResponse;
                try {
                    jsonResponse = JSON.parse(xhr.responseText);
                }
                catch (e) {
                    reject(_this.handleError(xhr.responseText));
                }
                var response = {
                    statusCode: xhr.status,
                    body: jsonResponse
                };
                resolve(response);
            };
            xhr.onerror = function () {
                reject(xhr.status);
            };
            if (method === _utils_Constants__WEBPACK_IMPORTED_MODULE_0__["NetworkRequestType"].GET) {
                xhr.send();
            }
            else {
                throw "not implemented";
            }
        });
    };
    XhrClient.prototype.handleError = function (responseText) {
        var jsonResponse;
        try {
            jsonResponse = JSON.parse(responseText);
            if (jsonResponse.error) {
                return jsonResponse.error;
            }
            else {
                throw responseText;
            }
        }
        catch (e) {
            return responseText;
        }
    };
    return XhrClient;
}());

//# sourceMappingURL=XHRClient.js.map

/***/ }),

/***/ "PqmH":
/*!*******************************************************!*\
  !*** ./node_modules/lit-html/lib/template-factory.js ***!
  \*******************************************************/
/*! exports provided: templateFactory, templateCaches */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "templateFactory", function() { return templateFactory; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "templateCaches", function() { return templateCaches; });
/* harmony import */ var _template_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./template.js */ "4yuk");
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */

/**
 * The default TemplateFactory which caches Templates keyed on
 * result.type and result.strings.
 */
function templateFactory(result) {
    let templateCache = templateCaches.get(result.type);
    if (templateCache === undefined) {
        templateCache = {
            stringsArray: new WeakMap(),
            keyString: new Map()
        };
        templateCaches.set(result.type, templateCache);
    }
    let template = templateCache.stringsArray.get(result.strings);
    if (template !== undefined) {
        return template;
    }
    // If the TemplateStringsArray is new, generate a key from the strings
    // This key is shared between all templates with identical content
    const key = result.strings.join(_template_js__WEBPACK_IMPORTED_MODULE_0__["marker"]);
    // Check if we already have a Template for this key
    template = templateCache.keyString.get(key);
    if (template === undefined) {
        // If we have not seen this key before, create a new Template
        template = new _template_js__WEBPACK_IMPORTED_MODULE_0__["Template"](result, result.getTemplateElement());
        // Cache the Template for this key
        templateCache.keyString.set(key, template);
    }
    // Cache all future queries for this TemplateStringsArray
    templateCache.stringsArray.set(result.strings, template);
    return template;
}
const templateCaches = new Map();
//# sourceMappingURL=template-factory.js.map

/***/ }),

/***/ "Ptj7":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/TokenUtils.js ***!
  \*************************************************************************************************/
/*! exports provided: TokenUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TokenUtils", function() { return TokenUtils; });
/* harmony import */ var _CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CryptoUtils */ "RDZQ");
/* harmony import */ var _StringUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./StringUtils */ "k+Uk");
/* harmony import */ var _TimeUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TimeUtils */ "JUi9");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * @hidden
 */
var TokenUtils = /** @class */ (function () {
    function TokenUtils() {
    }
    /**
     * decode a JWT
     *
     * @param jwtToken
     */
    TokenUtils.decodeJwt = function (jwtToken) {
        if (_StringUtils__WEBPACK_IMPORTED_MODULE_1__["StringUtils"].isEmpty(jwtToken)) {
            return null;
        }
        var idTokenPartsRegex = /^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/;
        var matches = idTokenPartsRegex.exec(jwtToken);
        if (!matches || matches.length < 4) {
            // this._requestContext.logger.warn("The returned id_token is not parseable.");
            return null;
        }
        var crackedToken = {
            header: matches[1],
            JWSPayload: matches[2],
            JWSSig: matches[3]
        };
        return crackedToken;
    };
    /**
     * Evaluates whether token cache item expiration is within expiration offset range
     * @param tokenCacheItem
     */
    TokenUtils.validateExpirationIsWithinOffset = function (expiration, tokenRenewalOffsetSeconds) {
        var offset = tokenRenewalOffsetSeconds || 300;
        return expiration && (expiration > _TimeUtils__WEBPACK_IMPORTED_MODULE_2__["TimeUtils"].now() + offset);
    };
    /**
     * Extract IdToken by decoding the RAWIdToken
     *
     * @param encodedIdToken
     */
    TokenUtils.extractIdToken = function (encodedIdToken) {
        // id token will be decoded to get the username
        var decodedToken = this.decodeJwt(encodedIdToken);
        if (!decodedToken) {
            return null;
        }
        try {
            var base64IdToken = decodedToken.JWSPayload;
            var base64Decoded = _CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Decode(base64IdToken);
            if (!base64Decoded) {
                // this._requestContext.logger.info("The returned id_token could not be base64 url safe decoded.");
                return null;
            }
            // ECMA script has JSON built-in support
            return JSON.parse(base64Decoded);
        }
        catch (err) {
            // this._requestContext.logger.error("The returned id_token could not be decoded" + err);
        }
        return null;
    };
    return TokenUtils;
}());

//# sourceMappingURL=TokenUtils.js.map

/***/ }),

/***/ "QoAq":
/*!******************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/AuthenticationHandlerOptions.js ***!
  \******************************************************************************************************************************************************/
/*! exports provided: AuthenticationHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthenticationHandlerOptions", function() { return AuthenticationHandlerOptions; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * @implements MiddlewareOptions
 * Class representing AuthenticationHandlerOptions
 */
class AuthenticationHandlerOptions {
    /**
     * @public
     * @constructor
     * To create an instance of AuthenticationHandlerOptions
     * @param {AuthenticationProvider} [authenticationProvider] - The authentication provider instance
     * @param {AuthenticationProviderOptions} [authenticationProviderOptions] - The authentication provider options instance
     * @returns An instance of AuthenticationHandlerOptions
     */
    constructor(authenticationProvider, authenticationProviderOptions) {
        this.authenticationProvider = authenticationProvider;
        this.authenticationProviderOptions = authenticationProviderOptions;
    }
}
//# sourceMappingURL=AuthenticationHandlerOptions.js.map

/***/ }),

/***/ "RDZQ":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/CryptoUtils.js ***!
  \**************************************************************************************************/
/*! exports provided: CryptoUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CryptoUtils", function() { return CryptoUtils; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var CryptoUtils = /** @class */ (function () {
    function CryptoUtils() {
    }
    /**
     * Creates a new random GUID
     * @returns string (GUID)
     */
    CryptoUtils.createNewGuid = function () {
        /*
         * RFC4122: The version 4 UUID is meant for generating UUIDs from truly-random or
         * pseudo-random numbers.
         * The algorithm is as follows:
         *     Set the two most significant bits (bits 6 and 7) of the
         *        clock_seq_hi_and_reserved to zero and one, respectively.
         *     Set the four most significant bits (bits 12 through 15) of the
         *        time_hi_and_version field to the 4-bit version number from
         *        Section 4.1.3. Version4
         *     Set all the other bits to randomly (or pseudo-randomly) chosen
         *     values.
         * UUID                   = time-low "-" time-mid "-"time-high-and-version "-"clock-seq-reserved and low(2hexOctet)"-" node
         * time-low               = 4hexOctet
         * time-mid               = 2hexOctet
         * time-high-and-version  = 2hexOctet
         * clock-seq-and-reserved = hexOctet:
         * clock-seq-low          = hexOctet
         * node                   = 6hexOctet
         * Format: xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx
         * y could be 1000, 1001, 1010, 1011 since most significant two bits needs to be 10
         * y values are 8, 9, A, B
         */
        var cryptoObj = window.crypto; // for IE 11
        if (cryptoObj && cryptoObj.getRandomValues) {
            var buffer = new Uint8Array(16);
            cryptoObj.getRandomValues(buffer);
            // buffer[6] and buffer[7] represents the time_hi_and_version field. We will set the four most significant bits (4 through 7) of buffer[6] to represent decimal number 4 (UUID version number).
            buffer[6] |= 0x40; // buffer[6] | 01000000 will set the 6 bit to 1.
            buffer[6] &= 0x4f; // buffer[6] & 01001111 will set the 4, 5, and 7 bit to 0 such that bits 4-7 == 0100 = "4".
            // buffer[8] represents the clock_seq_hi_and_reserved field. We will set the two most significant bits (6 and 7) of the clock_seq_hi_and_reserved to zero and one, respectively.
            buffer[8] |= 0x80; // buffer[8] | 10000000 will set the 7 bit to 1.
            buffer[8] &= 0xbf; // buffer[8] & 10111111 will set the 6 bit to 0.
            return CryptoUtils.decimalToHex(buffer[0]) + CryptoUtils.decimalToHex(buffer[1])
                + CryptoUtils.decimalToHex(buffer[2]) + CryptoUtils.decimalToHex(buffer[3])
                + "-" + CryptoUtils.decimalToHex(buffer[4]) + CryptoUtils.decimalToHex(buffer[5])
                + "-" + CryptoUtils.decimalToHex(buffer[6]) + CryptoUtils.decimalToHex(buffer[7])
                + "-" + CryptoUtils.decimalToHex(buffer[8]) + CryptoUtils.decimalToHex(buffer[9])
                + "-" + CryptoUtils.decimalToHex(buffer[10]) + CryptoUtils.decimalToHex(buffer[11])
                + CryptoUtils.decimalToHex(buffer[12]) + CryptoUtils.decimalToHex(buffer[13])
                + CryptoUtils.decimalToHex(buffer[14]) + CryptoUtils.decimalToHex(buffer[15]);
        }
        else {
            var guidHolder = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";
            var hex = "0123456789abcdef";
            var r = 0;
            var guidResponse = "";
            for (var i = 0; i < 36; i++) {
                if (guidHolder[i] !== "-" && guidHolder[i] !== "4") {
                    // each x and y needs to be random
                    r = Math.random() * 16 | 0;
                }
                if (guidHolder[i] === "x") {
                    guidResponse += hex[r];
                }
                else if (guidHolder[i] === "y") {
                    // clock-seq-and-reserved first hex is filtered and remaining hex values are random
                    r &= 0x3; // bit and with 0011 to set pos 2 to zero ?0??
                    r |= 0x8; // set pos 3 to 1 as 1???
                    guidResponse += hex[r];
                }
                else {
                    guidResponse += guidHolder[i];
                }
            }
            return guidResponse;
        }
    };
    /**
     * verifies if a string is  GUID
     * @param guid
     */
    CryptoUtils.isGuid = function (guid) {
        var regexGuid = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;
        return regexGuid.test(guid);
    };
    /**
     * Decimal to Hex
     *
     * @param num
     */
    CryptoUtils.decimalToHex = function (num) {
        var hex = num.toString(16);
        while (hex.length < 2) {
            hex = "0" + hex;
        }
        return hex;
    };
    // See: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#Solution_4_%E2%80%93_escaping_the_string_before_encoding_it
    /**
     * encoding string to base64 - platform specific check
     *
     * @param input
     */
    CryptoUtils.base64Encode = function (input) {
        return btoa(encodeURIComponent(input).replace(/%([0-9A-F]{2})/g, function toSolidBytes(match, p1) {
            return String.fromCharCode(Number("0x" + p1));
        }));
    };
    /**
     * Decodes a base64 encoded string.
     *
     * @param input
     */
    CryptoUtils.base64Decode = function (input) {
        var encodedString = input.replace(/-/g, "+").replace(/_/g, "/");
        switch (encodedString.length % 4) {
            case 0:
                break;
            case 2:
                encodedString += "==";
                break;
            case 3:
                encodedString += "=";
                break;
            default:
                throw new Error("Invalid base64 string");
        }
        return decodeURIComponent(atob(encodedString).split("").map(function (c) {
            return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(""));
    };
    /**
     * deserialize a string
     *
     * @param query
     */
    CryptoUtils.deserialize = function (query) {
        var match; // Regex for replacing addition symbol with a space
        var pl = /\+/g;
        var search = /([^&=]+)=([^&]*)/g;
        var decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); };
        var obj = {};
        match = search.exec(query);
        while (match) {
            obj[decode(match[1])] = decode(match[2]);
            match = search.exec(query);
        }
        return obj;
    };
    return CryptoUtils;
}());

//# sourceMappingURL=CryptoUtils.js.map

/***/ }),

/***/ "Rgfv":
/*!*************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/TelemetryHandlerOptions.js ***!
  \*************************************************************************************************************************************************/
/*! exports provided: FeatureUsageFlag, TelemetryHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FeatureUsageFlag", function() { return FeatureUsageFlag; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TelemetryHandlerOptions", function() { return TelemetryHandlerOptions; });
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../MiddlewareControl */ "ocZF");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @enum
 * @property {number} NONE - The hexadecimal flag value for nothing enabled
 * @property {number} REDIRECT_HANDLER_ENABLED - The hexadecimal flag value for redirect handler enabled
 * @property {number} RETRY_HANDLER_ENABLED - The hexadecimal flag value for retry handler enabled
 * @property {number} AUTHENTICATION_HANDLER_ENABLED - The hexadecimal flag value for the authentication handler enabled
 */
var FeatureUsageFlag;
(function (FeatureUsageFlag) {
    FeatureUsageFlag[FeatureUsageFlag["NONE"] = 0] = "NONE";
    FeatureUsageFlag[FeatureUsageFlag["REDIRECT_HANDLER_ENABLED"] = 1] = "REDIRECT_HANDLER_ENABLED";
    FeatureUsageFlag[FeatureUsageFlag["RETRY_HANDLER_ENABLED"] = 2] = "RETRY_HANDLER_ENABLED";
    FeatureUsageFlag[FeatureUsageFlag["AUTHENTICATION_HANDLER_ENABLED"] = 4] = "AUTHENTICATION_HANDLER_ENABLED";
})(FeatureUsageFlag || (FeatureUsageFlag = {}));
/**
 * @class
 * @implements MiddlewareOptions
 * Class for TelemetryHandlerOptions
 */
class TelemetryHandlerOptions {
    constructor() {
        /**
         * @private
         * A member to hold the OR of feature usage flags
         */
        this.featureUsage = FeatureUsageFlag.NONE;
    }
    /**
     * @public
     * @static
     * To update the feature usage in the context object
     * @param {Context} context - The request context object containing middleware options
     * @param {FeatureUsageFlag} flag - The flag value
     * @returns nothing
     */
    static updateFeatureUsageFlag(context, flag) {
        let options;
        if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_0__["MiddlewareControl"]) {
            options = context.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions);
        }
        else {
            context.middlewareControl = new _MiddlewareControl__WEBPACK_IMPORTED_MODULE_0__["MiddlewareControl"]();
        }
        if (typeof options === "undefined") {
            options = new TelemetryHandlerOptions();
            context.middlewareControl.setMiddlewareOptions(TelemetryHandlerOptions, options);
        }
        options.setFeatureUsage(flag);
    }
    /**
     * @private
     * To set the feature usage flag
     * @param {FeatureUsageFlag} flag - The flag value
     * @returns nothing
     */
    setFeatureUsage(flag) {
        /* tslint:disable: no-bitwise */
        this.featureUsage = this.featureUsage | flag;
        /* tslint:enable: no-bitwise */
    }
    /**
     * @public
     * To get the feature usage
     * @returns A feature usage flag as hexadecimal string
     */
    getFeatureUsage() {
        return this.featureUsage.toString(16);
    }
}
//# sourceMappingURL=TelemetryHandlerOptions.js.map

/***/ }),

/***/ "Rgi7":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/telemetry/TelemetryUtils.js ***!
  \*********************************************************************************************************/
/*! exports provided: scrubTenantFromUri, hashPersonalIdentifier, prependEventNamePrefix, supportsBrowserPerformance, endBrowserPerformanceMeasurement, startBrowserPerformanceMeasurement */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "scrubTenantFromUri", function() { return scrubTenantFromUri; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hashPersonalIdentifier", function() { return hashPersonalIdentifier; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prependEventNamePrefix", function() { return prependEventNamePrefix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "supportsBrowserPerformance", function() { return supportsBrowserPerformance; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "endBrowserPerformanceMeasurement", function() { return endBrowserPerformanceMeasurement; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "startBrowserPerformanceMeasurement", function() { return startBrowserPerformanceMeasurement; });
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TelemetryConstants */ "tekO");
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/CryptoUtils */ "RDZQ");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/UrlUtils */ "j0B3");
/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../authority/Authority */ "Si2r");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var scrubTenantFromUri = function (uri) {
    var url = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__["UrlUtils"].GetUrlComponents(uri);
    // validate trusted host
    if (_authority_Authority__WEBPACK_IMPORTED_MODULE_3__["Authority"].isAdfs(uri)) {
        /**
         * returning what was passed because the library needs to work with uris that are non
         * AAD trusted but passed by users such as B2C or others.
         * HTTP Events for instance can take a url to the open id config endpoint
         */
        return uri;
    }
    var pathParams = url.PathSegments;
    if (pathParams && pathParams.length >= 2) {
        var tenantPosition = pathParams[1] === "tfp" ? 2 : 1;
        if (tenantPosition < pathParams.length) {
            pathParams[tenantPosition] = _TelemetryConstants__WEBPACK_IMPORTED_MODULE_0__["TENANT_PLACEHOLDER"];
        }
    }
    return url.Protocol + "//" + url.HostNameAndPort + "/" + pathParams.join("/");
};
var hashPersonalIdentifier = function (valueToHash) {
    /*
     * TODO sha256 this
     * Current test runner is being funny with node libs that are webpacked anyway
     * need a different solution
     */
    return _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_1__["CryptoUtils"].base64Encode(valueToHash);
};
var prependEventNamePrefix = function (suffix) { return "" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_0__["EVENT_NAME_PREFIX"] + (suffix || ""); };
var supportsBrowserPerformance = function () { return !!(typeof window !== "undefined" &&
    "performance" in window &&
    window.performance.mark &&
    window.performance.measure); };
var endBrowserPerformanceMeasurement = function (measureName, startMark, endMark) {
    if (supportsBrowserPerformance()) {
        window.performance.mark(endMark);
        window.performance.measure(measureName, startMark, endMark);
        window.performance.clearMeasures(measureName);
        window.performance.clearMarks(startMark);
        window.performance.clearMarks(endMark);
    }
};
var startBrowserPerformanceMeasurement = function (startMark) {
    if (supportsBrowserPerformance()) {
        window.performance.mark(startMark);
    }
};
//# sourceMappingURL=TelemetryUtils.js.map

/***/ }),

/***/ "RjF+":
/*!***************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/mock/MockProvider.js ***!
  \***************************************************************************/
/*! exports provided: MockProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MockProvider", function() { return MockProvider; });
/* harmony import */ var _providers_IProvider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../providers/IProvider */ "DmZw");
/* harmony import */ var _MockGraph__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MockGraph */ "7TLm");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


/**
 * Mock Provider access token for Microsoft Graph APIs
 *
 * @export
 * @class MockProvider
 * @extends {IProvider}
 */
class MockProvider extends _providers_IProvider__WEBPACK_IMPORTED_MODULE_0__["IProvider"] {
    constructor(signedIn = false) {
        super();
        /**
         * new instance of mock graph provider
         *
         * @memberof MockProvider
         */
        this.graph = new _MockGraph__WEBPACK_IMPORTED_MODULE_1__["MockGraph"](this);
        if (signedIn) {
            this.setState(_providers_IProvider__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedIn);
        }
        else {
            this.setState(_providers_IProvider__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
        }
    }
    /**
     * sets Provider state to SignedIn
     *
     * @returns {Promise<void>}
     * @memberof MockProvider
     */
    login() {
        return __awaiter(this, void 0, void 0, function* () {
            this.setState(_providers_IProvider__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].Loading);
            yield new Promise(resolve => setTimeout(resolve, 3000));
            this.setState(_providers_IProvider__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedIn);
        });
    }
    /**
     * sets Provider state to signed out
     *
     * @returns {Promise<void>}
     * @memberof MockProvider
     */
    logout() {
        return __awaiter(this, void 0, void 0, function* () {
            this.setState(_providers_IProvider__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].Loading);
            yield new Promise(resolve => setTimeout(resolve, 3000));
            this.setState(_providers_IProvider__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
        });
    }
    /**
     * Promise returning token from graph.microsoft.com
     *
     * @returns {Promise<string>}
     * @memberof MockProvider
     */
    getAccessToken() {
        return Promise.resolve('{token:https://graph.microsoft.com/}');
    }
}
//# sourceMappingURL=MockProvider.js.map

/***/ }),

/***/ "Rmnq":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/Version.js ***!
  \**************************************************************************************************************/
/*! exports provided: PACKAGE_VERSION */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PACKAGE_VERSION", function() { return PACKAGE_VERSION; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
/**
 * @module Version
 */
const PACKAGE_VERSION = "2.2.1";
//# sourceMappingURL=Version.js.map

/***/ }),

/***/ "RsRP":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/AuthenticationHandler.js ***!
  \***************************************************************************************************/
/*! exports provided: AuthenticationHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthenticationHandler", function() { return AuthenticationHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MiddlewareControl */ "/M1i");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MiddlewareUtil */ "z+g4");
/* harmony import */ var _options_AuthenticationHandlerOptions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./options/AuthenticationHandlerOptions */ "jMoM");
/* harmony import */ var _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./options/TelemetryHandlerOptions */ "x9B3");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */





/**
 * @class
 * @implements Middleware
 * Class representing AuthenticationHandler
 */
class AuthenticationHandler {
    /**
     * @public
     * @constructor
     * Creates an instance of AuthenticationHandler
     * @param {AuthenticationProvider} authenticationProvider - The authentication provider for the authentication handler
     */
    constructor(authenticationProvider) {
        this.authenticationProvider = authenticationProvider;
    }
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                let options;
                if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_1__["MiddlewareControl"]) {
                    options = context.middlewareControl.getMiddlewareOptions(_options_AuthenticationHandlerOptions__WEBPACK_IMPORTED_MODULE_3__["AuthenticationHandlerOptions"]);
                }
                let authenticationProvider;
                let authenticationProviderOptions;
                if (typeof options !== "undefined") {
                    authenticationProvider = options.authenticationProvider;
                    authenticationProviderOptions = options.authenticationProviderOptions;
                }
                if (typeof authenticationProvider === "undefined") {
                    authenticationProvider = this.authenticationProvider;
                }
                const token = yield authenticationProvider.getAccessToken(authenticationProviderOptions);
                const bearerKey = `Bearer ${token}`;
                Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_2__["appendRequestHeader"])(context.request, context.options, AuthenticationHandler.AUTHORIZATION_HEADER, bearerKey);
                _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["TelemetryHandlerOptions"].updateFeatureUsageFlag(context, _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["FeatureUsageFlag"].AUTHENTICATION_HANDLER_ENABLED);
                return yield this.nextMiddleware.execute(context);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
/**
 * @private
 * A member representing the authorization header name
 */
AuthenticationHandler.AUTHORIZATION_HEADER = "Authorization";
//# sourceMappingURL=AuthenticationHandler.js.map

/***/ }),

/***/ "Rtth":
/*!******************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/RetryHandler.js ***!
  \******************************************************************************************/
/*! exports provided: RetryHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RetryHandler", function() { return RetryHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _RequestMethod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../RequestMethod */ "wmib");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MiddlewareControl */ "/M1i");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./MiddlewareUtil */ "z+g4");
/* harmony import */ var _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./options/RetryHandlerOptions */ "q5Kr");
/* harmony import */ var _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./options/TelemetryHandlerOptions */ "x9B3");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */






/**
 * @class
 * @implements Middleware
 * Class for RetryHandler
 */
class RetryHandler {
    /**
     * @public
     * @constructor
     * To create an instance of RetryHandler
     * @param {RetryHandlerOptions} [options = new RetryHandlerOptions()] - The retry handler options value
     * @returns An instance of RetryHandler
     */
    constructor(options = new _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RetryHandlerOptions"]()) {
        this.options = options;
    }
    /**
     *
     * @private
     * To check whether the response has the retry status code
     * @param {Response} response - The response object
     * @returns Whether the response has retry status code or not
     */
    isRetry(response) {
        return RetryHandler.RETRY_STATUS_CODES.indexOf(response.status) !== -1;
    }
    /**
     * @private
     * To check whether the payload is buffered or not
     * @param {RequestInfo} request - The url string or the request object value
     * @param {FetchOptions} options - The options of a request
     * @returns Whether the payload is buffered or not
     */
    isBuffered(request, options) {
        const method = typeof request === "string" ? options.method : request.method;
        const isPutPatchOrPost = method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].PUT || method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].PATCH || method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].POST;
        if (isPutPatchOrPost) {
            const isStream = Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__["getRequestHeader"])(request, options, "Content-Type") === "application/octet-stream";
            if (isStream) {
                return false;
            }
        }
        return true;
    }
    /**
     * @private
     * To get the delay for a retry
     * @param {Response} response - The response object
     * @param {number} retryAttempts - The current attempt count
     * @param {number} delay - The delay value in seconds
     * @returns A delay for a retry
     */
    getDelay(response, retryAttempts, delay) {
        const getRandomness = () => Number(Math.random().toFixed(3));
        const retryAfter = response.headers !== undefined ? response.headers.get(RetryHandler.RETRY_AFTER_HEADER) : null;
        let newDelay;
        if (retryAfter !== null) {
            // tslint:disable: prefer-conditional-expression
            if (Number.isNaN(Number(retryAfter))) {
                newDelay = Math.round((new Date(retryAfter).getTime() - Date.now()) / 1000);
            }
            else {
                newDelay = Number(retryAfter);
            }
            // tslint:enable: prefer-conditional-expression
        }
        else {
            // Adding randomness to avoid retrying at a same
            newDelay = retryAttempts >= 2 ? this.getExponentialBackOffTime(retryAttempts) + delay + getRandomness() : delay + getRandomness();
        }
        return Math.min(newDelay, this.options.getMaxDelay() + getRandomness());
    }
    /**
     * @private
     * To get an exponential back off value
     * @param {number} attempts - The current attempt count
     * @returns An exponential back off value
     */
    getExponentialBackOffTime(attempts) {
        return Math.round((1 / 2) * (Math.pow(2, attempts) - 1));
    }
    /**
     * @private
     * @async
     * To add delay for the execution
     * @param {number} delaySeconds - The delay value in seconds
     * @returns Nothing
     */
    sleep(delaySeconds) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const delayMilliseconds = delaySeconds * 1000;
            return new Promise((resolve) => setTimeout(resolve, delayMilliseconds));
        });
    }
    getOptions(context) {
        let options;
        if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_2__["MiddlewareControl"]) {
            options = context.middlewareControl.getMiddlewareOptions(this.options.constructor);
        }
        if (typeof options === "undefined") {
            options = Object.assign(new _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RetryHandlerOptions"](), this.options);
        }
        return options;
    }
    /**
     * @private
     * @async
     * To execute the middleware with retries
     * @param {Context} context - The context object
     * @param {number} retryAttempts - The current attempt count
     * @param {RetryHandlerOptions} options - The retry middleware options instance
     * @returns A Promise that resolves to nothing
     */
    executeWithRetry(context, retryAttempts, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                yield this.nextMiddleware.execute(context);
                if (retryAttempts < options.maxRetries && this.isRetry(context.response) && this.isBuffered(context.request, context.options) && options.shouldRetry(options.delay, retryAttempts, context.request, context.options, context.response)) {
                    ++retryAttempts;
                    Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__["setRequestHeader"])(context.request, context.options, RetryHandler.RETRY_ATTEMPT_HEADER, retryAttempts.toString());
                    const delay = this.getDelay(context.response, retryAttempts, options.delay);
                    yield this.sleep(delay);
                    return yield this.executeWithRetry(context, retryAttempts, options);
                }
                else {
                    return;
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const retryAttempts = 0;
                const options = this.getOptions(context);
                _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["TelemetryHandlerOptions"].updateFeatureUsageFlag(context, _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["FeatureUsageFlag"].RETRY_HANDLER_ENABLED);
                return yield this.executeWithRetry(context, retryAttempts, options);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
/**
 * @private
 * @static
 * A list of status codes that needs to be retried
 */
RetryHandler.RETRY_STATUS_CODES = [
    429,
    503,
    504,
];
/**
 * @private
 * @static
 * A member holding the name of retry attempt header
 */
RetryHandler.RETRY_ATTEMPT_HEADER = "Retry-Attempt";
/**
 * @private
 * @static
 * A member holding the name of retry after header
 */
RetryHandler.RETRY_AFTER_HEADER = "Retry-After";
//# sourceMappingURL=RetryHandler.js.map

/***/ }),

/***/ "S3To":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/MiddlewareFactory.js ***!
  \***********************************************************************************************************************************/
/*! exports provided: MiddlewareFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(process) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MiddlewareFactory", function() { return MiddlewareFactory; });
/* harmony import */ var _AuthenticationHandler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AuthenticationHandler */ "WEFG");
/* harmony import */ var _HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./HTTPMessageHandler */ "ehPe");
/* harmony import */ var _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./options/RedirectHandlerOptions */ "Ytee");
/* harmony import */ var _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./options/RetryHandlerOptions */ "Eakl");
/* harmony import */ var _RedirectHandler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./RedirectHandler */ "rQCx");
/* harmony import */ var _RetryHandler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./RetryHandler */ "1pLI");
/* harmony import */ var _TelemetryHandler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TelemetryHandler */ "13ek");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */







/**
 * @private
 * To check whether the environment is node or not
 * @returns A boolean representing the environment is node or not
 */
const isNodeEnvironment = () => {
    return typeof process === "object" && "function" === "function";
};
/**
 * @class
 * Class containing function(s) related to the middleware pipelines.
 */
class MiddlewareFactory {
    /**
     * @public
     * @static
     * Returns the default middleware chain an array with the  middleware handlers
     * @param {AuthenticationProvider} authProvider - The authentication provider instance
     * @returns an array of the middleware handlers of the default middleware chain
     */
    static getDefaultMiddlewareChain(authProvider) {
        const middleware = [];
        const authenticationHandler = new _AuthenticationHandler__WEBPACK_IMPORTED_MODULE_0__["AuthenticationHandler"](authProvider);
        const retryHandler = new _RetryHandler__WEBPACK_IMPORTED_MODULE_5__["RetryHandler"](new _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_3__["RetryHandlerOptions"]());
        const telemetryHandler = new _TelemetryHandler__WEBPACK_IMPORTED_MODULE_6__["TelemetryHandler"]();
        const httpMessageHandler = new _HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_1__["HTTPMessageHandler"]();
        middleware.push(authenticationHandler);
        middleware.push(retryHandler);
        if (isNodeEnvironment()) {
            const redirectHandler = new _RedirectHandler__WEBPACK_IMPORTED_MODULE_4__["RedirectHandler"](new _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_2__["RedirectHandlerOptions"]());
            middleware.push(redirectHandler);
        }
        middleware.push(telemetryHandler);
        middleware.push(httpMessageHandler);
        return middleware;
    }
}
//# sourceMappingURL=MiddlewareFactory.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../../../../process/browser.js */ "8oxB")))

/***/ }),

/***/ "SRUK":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/error/ClientConfigurationError.js ***!
  \***************************************************************************************************************/
/*! exports provided: ClientConfigurationErrorMessage, ClientConfigurationError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientConfigurationErrorMessage", function() { return ClientConfigurationErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientConfigurationError", function() { return ClientConfigurationError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _ClientAuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ClientAuthError */ "n82g");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var ClientConfigurationErrorMessage = {
    configurationNotSet: {
        code: "no_config_set",
        desc: "Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."
    },
    storageNotSupported: {
        code: "storage_not_supported",
        desc: "The value for the cacheLocation is not supported."
    },
    noRedirectCallbacksSet: {
        code: "no_redirect_callbacks",
        desc: "No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. " +
            "More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."
    },
    invalidCallbackObject: {
        code: "invalid_callback_object",
        desc: "The object passed for the callback was invalid. " +
            "More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."
    },
    scopesRequired: {
        code: "scopes_required",
        desc: "Scopes are required to obtain an access token."
    },
    emptyScopes: {
        code: "empty_input_scopes_error",
        desc: "Scopes cannot be passed as empty array."
    },
    nonArrayScopes: {
        code: "nonarray_input_scopes_error",
        desc: "Scopes cannot be passed as non-array."
    },
    invalidPrompt: {
        code: "invalid_prompt_value",
        desc: "Supported prompt values are 'login', 'select_account', 'consent' and 'none'",
    },
    invalidAuthorityType: {
        code: "invalid_authority_type",
        desc: "The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."
    },
    authorityUriInsecure: {
        code: "authority_uri_insecure",
        desc: "Authority URIs must use https."
    },
    authorityUriInvalidPath: {
        code: "authority_uri_invalid_path",
        desc: "Given authority URI is invalid."
    },
    unsupportedAuthorityValidation: {
        code: "unsupported_authority_validation",
        desc: "The authority validation is not supported for this authority type."
    },
    untrustedAuthority: {
        code: "untrusted_authority",
        desc: "The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."
    },
    b2cAuthorityUriInvalidPath: {
        code: "b2c_authority_uri_invalid_path",
        desc: "The given URI for the B2C authority is invalid."
    },
    b2cKnownAuthoritiesNotSet: {
        code: "b2c_known_authorities_not_set",
        desc: "Must set known authorities when validateAuthority is set to True and using B2C"
    },
    claimsRequestParsingError: {
        code: "claims_request_parsing_error",
        desc: "Could not parse the given claims request object."
    },
    emptyRequestError: {
        code: "empty_request_error",
        desc: "Request object is required."
    },
    invalidCorrelationIdError: {
        code: "invalid_guid_sent_as_correlationId",
        desc: "Please set the correlationId as a valid guid"
    },
    telemetryConfigError: {
        code: "telemetry_config_error",
        desc: "Telemetry config is not configured with required values"
    },
    ssoSilentError: {
        code: "sso_silent_error",
        desc: "request must contain either sid or login_hint"
    },
    invalidAuthorityMetadataError: {
        code: "authority_metadata_error",
        desc: "Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."
    }
};
/**
 * Error thrown when there is an error in configuration of the .js library.
 */
var ClientConfigurationError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ClientConfigurationError, _super);
    function ClientConfigurationError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ClientConfigurationError";
        Object.setPrototypeOf(_this, ClientConfigurationError.prototype);
        return _this;
    }
    ClientConfigurationError.createNoSetConfigurationError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.configurationNotSet.code, "" + ClientConfigurationErrorMessage.configurationNotSet.desc);
    };
    ClientConfigurationError.createStorageNotSupportedError = function (givenCacheLocation) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.storageNotSupported.code, ClientConfigurationErrorMessage.storageNotSupported.desc + " Given location: " + givenCacheLocation);
    };
    ClientConfigurationError.createRedirectCallbacksNotSetError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.noRedirectCallbacksSet.code, ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc);
    };
    ClientConfigurationError.createInvalidCallbackObjectError = function (callbackObject) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidCallbackObject.code, ClientConfigurationErrorMessage.invalidCallbackObject.desc + " Given value for callback function: " + callbackObject);
    };
    ClientConfigurationError.createEmptyScopesArrayError = function (scopesValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.emptyScopes.code, ClientConfigurationErrorMessage.emptyScopes.desc + " Given value: " + scopesValue + ".");
    };
    ClientConfigurationError.createScopesNonArrayError = function (scopesValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.nonArrayScopes.code, ClientConfigurationErrorMessage.nonArrayScopes.desc + " Given value: " + scopesValue + ".");
    };
    ClientConfigurationError.createScopesRequiredError = function (scopesValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.scopesRequired.code, ClientConfigurationErrorMessage.scopesRequired.desc + " Given value: " + scopesValue);
    };
    ClientConfigurationError.createInvalidPromptError = function (promptValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidPrompt.code, ClientConfigurationErrorMessage.invalidPrompt.desc + " Given value: " + promptValue);
    };
    ClientConfigurationError.createClaimsRequestParsingError = function (claimsRequestParseError) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.claimsRequestParsingError.code, ClientConfigurationErrorMessage.claimsRequestParsingError.desc + " Given value: " + claimsRequestParseError);
    };
    ClientConfigurationError.createEmptyRequestError = function () {
        var _a = ClientConfigurationErrorMessage.emptyRequestError, code = _a.code, desc = _a.desc;
        return new ClientConfigurationError(code, desc);
    };
    ClientConfigurationError.createInvalidCorrelationIdError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidCorrelationIdError.code, ClientConfigurationErrorMessage.invalidCorrelationIdError.desc);
    };
    ClientConfigurationError.createKnownAuthoritiesNotSetError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.code, ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.desc);
    };
    ClientConfigurationError.createInvalidAuthorityTypeError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidAuthorityType.code, ClientConfigurationErrorMessage.invalidAuthorityType.desc);
    };
    ClientConfigurationError.createUntrustedAuthorityError = function (host) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.untrustedAuthority.code, ClientConfigurationErrorMessage.untrustedAuthority.desc + " Provided Authority: " + host);
    };
    ClientConfigurationError.createTelemetryConfigError = function (config) {
        var _a = ClientConfigurationErrorMessage.telemetryConfigError, code = _a.code, desc = _a.desc;
        var requiredKeys = {
            applicationName: "string",
            applicationVersion: "string",
            telemetryEmitter: "function"
        };
        var missingKeys = Object.keys(requiredKeys)
            .reduce(function (keys, key) {
            return config[key] ? keys : keys.concat([key + " (" + requiredKeys[key] + ")"]);
        }, []);
        return new ClientConfigurationError(code, desc + " mising values: " + missingKeys.join(","));
    };
    ClientConfigurationError.createSsoSilentError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.ssoSilentError.code, ClientConfigurationErrorMessage.ssoSilentError.desc);
    };
    ClientConfigurationError.createInvalidAuthorityMetadataError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidAuthorityMetadataError.code, ClientConfigurationErrorMessage.invalidAuthorityMetadataError.desc);
    };
    return ClientConfigurationError;
}(_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__["ClientAuthError"]));

//# sourceMappingURL=ClientConfigurationError.js.map

/***/ }),

/***/ "SZAC":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/mgt-person-card-css.js ***!
  \***********************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}:host{background:var(--person-card-background-color,var(--background-color-sub1,#faf9f8));width:var(--mgt-flyout-set-width,340px);font-family:var(--default-font-family);overflow:hidden;user-select:none;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132));border:1px solid var(--background-color-sub1,#faf9f8)}:host .nav{height:0;position:relative;z-index:100}:host .nav .nav__back{padding:8px;height:32px;width:32px;align-items:center;justify-content:center}:host .nav .nav__back svg{fill:#0078d4}:host .nav .nav__back:hover{cursor:pointer}:host .nav .nav__back:hover svg{fill:#000}:host .person-details-container{display:flex;flex-direction:column;width:calc(var(--mgt-flyout-set-width,340px) - 40px);padding:20px}:host .person-details-container .person-image{--presence-background-color:var(--person-card-background-color, var(--background-color-sub1, #faf9f8));--presence-icon-color:var(--person-card-background-color, var(--background-color-sub1, #faf9f8));--avatar-size:75px;--font-size:20px;--line2-font-size:14px;--line3-font-size:12px}:host .person-details-container .base-icons{display:flex;-webkit-align-items:center;align-items:center;max-width:120px;margin-top:16px}:host .person-details-container .base-icons .icon{display:flex;align-items:center;cursor:pointer;font-size:12px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-right:20px}:host .person-details-container .base-icons .icon svg{fill:var(--icon-color,#605e5c)}:host .person-details-container .base-icons .icon span{margin-left:8px;color:#0078d4}:host .person-details-container .base-icons .icon:hover{color:#005a9e}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;align-items:center;height:28px;background:var(--person-card-background-color,var(--background-color-sub1,#faf9f8));border-top:1px solid var(--line-seperator-color,#edebe9)}:host .expanded-details-container .expanded-details-button .expanded-details-svg{margin-bottom:3px}:host .expanded-details-container .expanded-details-button:hover{background-color:var(--background-color--hover,#edebe9)}:host .expanded-details-container .expanded-details-info{padding:18px;display:flex;flex-direction:column}:host .expanded-details-container .expanded-details-info .contact-text{margin:0 0 24px 0;font-weight:600;font-size:var(--person-card-details-title-font-size,14px);color:var(--person-card-details-title-color,var(--color,#000))}:host .expanded-details-container .expanded-details-info .icons{line-height:normal;font-style:normal;font-weight:400;font-size:var(--person-card-details-item-font-size,15px);color:var(--person-card-details-item-color,#201f1e);text-align:left}:host .expanded-details-container .expanded-details-info .icons .details-icon{margin:0 0 10px 0;display:flex;flex-direction:row;align-items:center}:host .expanded-details-container .expanded-details-info .data{display:block;margin:0 0 0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:280px}:host .expanded-details-container .expanded-details-info .normal-subtitle{padding-top:2px}:host .expanded-details-container .expanded-details-info .link-subtitle{color:#0078d4;cursor:pointer}:host .expanded-details-container .expanded-details-info .link-subtitle:hover{opacity:.6}:host .expanded-details-container .section-divider{width:96%;min-height:1px;background:var(--line-seperator-color,#edebe9);align-self:center}:host .section-nav{display:flex;padding:0 14px;border-bottom:1px solid var(--tab-line-color,#edebe9)}:host .section-nav .section-nav__icon{all:initial;box-sizing:border-box;width:48px;padding:12px;display:flex;align-items:center;justify-content:center;border-bottom:2px solid transparent;margin-bottom:-1px;cursor:pointer}:host .section-nav .section-nav__icon svg{width:20px;height:20px;fill:var(--icon-color,#605e5c)}:host .section-nav .section-nav__icon:hover{background:var(--tab-background-color--hover,#edebe9);border-color:var(--tab-line-color--hover,#979593)}:host .section-nav .section-nav__icon.active{border-color:#0078d4}:host .section-nav .section-nav__icon.active svg{fill:#0078d4}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .section-host{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden}:host .quick-message{display:flex;flex-direction:row;border-bottom:1px solid var(--tab-line-color,#edebe9);padding:12px 10px 8px 10px}:host .quick-message .quick-message__input{flex-grow:1;padding-left:8px;border:none;border-radius:2px;color:var(--color-sub1,#323130);background-color:var(--background-color-sub2,#f3f2f1)}:host .quick-message .quick-message__send{all:initial;height:32px;width:32px;display:flex;align-items:center;justify-content:center}:host .quick-message .quick-message__send svg{fill:var(--color-sub2,#797775);height:18px;width:18px}:host .quick-message .quick-message__send:hover svg{fill:var(--color-sub1,#323130)}:host .sections .section{padding:14px 0;display:flex;flex-direction:column;position:relative}:host .sections .section:not(:last-child):after{position:absolute;content:'';width:90%;transform:translateX(-50%);border-bottom:1px solid var(--tab-line-color,#edebe9);left:50%;bottom:0}:host .sections .section .section__header{display:flex;flex-direction:row;padding:0 20px}:host .sections .section .section__title{flex-grow:1;color:var(--title-color-subtitle,#323130);font-size:14px;font-weight:600}:host .sections .section .section__show-more{color:#0078d4;font-size:12px;font-weight:600;align-self:center}:host .sections .section .section__show-more:hover{cursor:pointer;color:#005a9e}:host .sections .section .section__content{margin-top:14px}:host .sections .section .additional-details{padding:0 20px}[dir=rtl] .base-icons span{margin-right:8px}[dir=rtl] .nav__back{width:20px!important;-moz-transform:scaleX(-1);-o-transform:scaleX(-1);-webkit-transform:scaleX(-1);transform:scaleX(-1);filter:FlipH;-ms-filter:FlipH}
`
];
//# sourceMappingURL=mgt-person-card-css.js.map

/***/ }),

/***/ "SdJ9":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/CustomAuthenticationProvider.js ***!
  \***********************************************************************************************/
/*! exports provided: CustomAuthenticationProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomAuthenticationProvider", function() { return CustomAuthenticationProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @class
 * Class representing CustomAuthenticationProvider
 * @extends AuthenticationProvider
 */
class CustomAuthenticationProvider {
    /**
     * @public
     * @constructor
     * Creates an instance of CustomAuthenticationProvider
     * @param {AuthProviderCallback} provider - An authProvider function
     * @returns An instance of CustomAuthenticationProvider
     */
    constructor(provider) {
        this.provider = provider;
    }
    /**
     * @public
     * @async
     * To get the access token
     * @returns The promise that resolves to an access token
     */
    getAccessToken() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            return new Promise((resolve, reject) => {
                this.provider((error, accessToken) => {
                    if (accessToken) {
                        resolve(accessToken);
                    }
                    else {
                        reject(error);
                    }
                });
            });
        });
    }
}
//# sourceMappingURL=CustomAuthenticationProvider.js.map

/***/ }),

/***/ "Si2r":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/authority/Authority.js ***!
  \****************************************************************************************************/
/*! exports provided: AuthorityType, Authority */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthorityType", function() { return AuthorityType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Authority", function() { return Authority; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "SRUK");
/* harmony import */ var _XHRClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../XHRClient */ "Pich");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/UrlUtils */ "j0B3");
/* harmony import */ var _TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TrustedAuthority */ "9FZN");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/Constants */ "/pXG");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */






/**
 * @hidden
 */
var AuthorityType;
(function (AuthorityType) {
    AuthorityType[AuthorityType["Default"] = 0] = "Default";
    AuthorityType[AuthorityType["Adfs"] = 1] = "Adfs";
})(AuthorityType || (AuthorityType = {}));
/**
 * @hidden
 */
var Authority = /** @class */ (function () {
    function Authority(authority, validateAuthority, authorityMetadata) {
        this.IsValidationEnabled = validateAuthority;
        this.CanonicalAuthority = authority;
        this.validateAsUri();
        this.tenantDiscoveryResponse = authorityMetadata;
    }
    Authority.isAdfs = function (authorityUrl) {
        var components = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].GetUrlComponents(authorityUrl);
        var pathSegments = components.PathSegments;
        return (pathSegments.length && pathSegments[0].toLowerCase() === _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["Constants"].ADFS);
    };
    Object.defineProperty(Authority.prototype, "AuthorityType", {
        get: function () {
            return Authority.isAdfs(this.canonicalAuthority) ? AuthorityType.Adfs : AuthorityType.Default;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "Tenant", {
        get: function () {
            return this.CanonicalAuthorityUrlComponents.PathSegments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "AuthorizationEndpoint", {
        get: function () {
            this.validateResolved();
            return this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g, this.Tenant);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "EndSessionEndpoint", {
        get: function () {
            this.validateResolved();
            return this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g, this.Tenant);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "SelfSignedJwtAudience", {
        get: function () {
            this.validateResolved();
            return this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g, this.Tenant);
        },
        enumerable: true,
        configurable: true
    });
    Authority.prototype.validateResolved = function () {
        if (!this.hasCachedMetadata()) {
            throw "Please call ResolveEndpointsAsync first";
        }
    };
    Object.defineProperty(Authority.prototype, "CanonicalAuthority", {
        /**
         * A URL that is the authority set by the developer
         */
        get: function () {
            return this.canonicalAuthority;
        },
        set: function (url) {
            this.canonicalAuthority = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].CanonicalizeUri(url);
            this.canonicalAuthorityUrlComponents = null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "CanonicalAuthorityUrlComponents", {
        get: function () {
            if (!this.canonicalAuthorityUrlComponents) {
                this.canonicalAuthorityUrlComponents = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].GetUrlComponents(this.CanonicalAuthority);
            }
            return this.canonicalAuthorityUrlComponents;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "DefaultOpenIdConfigurationEndpoint", {
        // http://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata
        get: function () {
            return (this.AuthorityType === AuthorityType.Adfs) ? "" + this.CanonicalAuthority + _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["WELL_KNOWN_SUFFIX"] : this.CanonicalAuthority + "v2.0/" + _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["WELL_KNOWN_SUFFIX"];
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Given a string, validate that it is of the form https://domain/path
     */
    Authority.prototype.validateAsUri = function () {
        var components;
        try {
            components = this.CanonicalAuthorityUrlComponents;
        }
        catch (e) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationErrorMessage"].invalidAuthorityType;
        }
        if (!components.Protocol || components.Protocol.toLowerCase() !== "https:") {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationErrorMessage"].authorityUriInsecure;
        }
        if (!components.PathSegments || components.PathSegments.length < 1) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationErrorMessage"].authorityUriInvalidPath;
        }
    };
    /**
     * Calls the OIDC endpoint and returns the response
     */
    Authority.prototype.DiscoverEndpoints = function (openIdConfigurationEndpoint, telemetryManager, correlationId) {
        var client = new _XHRClient__WEBPACK_IMPORTED_MODULE_2__["XhrClient"]();
        var httpMethod = _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["NetworkRequestType"].GET;
        var httpEvent = telemetryManager.createAndStartHttpEvent(correlationId, httpMethod, openIdConfigurationEndpoint, "openIdConfigurationEndpoint");
        return client.sendRequestAsync(openIdConfigurationEndpoint, httpMethod, /* enableCaching: */ true)
            .then(function (response) {
            httpEvent.httpResponseStatus = response.statusCode;
            telemetryManager.stopEvent(httpEvent);
            return {
                AuthorizationEndpoint: response.body.authorization_endpoint,
                EndSessionEndpoint: response.body.end_session_endpoint,
                Issuer: response.body.issuer
            };
        })
            .catch(function (err) {
            httpEvent.serverErrorCode = err;
            telemetryManager.stopEvent(httpEvent);
            throw err;
        });
    };
    /**
     * Returns a promise.
     * Checks to see if the authority is in the cache
     * Discover endpoints via openid-configuration
     * If successful, caches the endpoint for later use in OIDC
     */
    Authority.prototype.resolveEndpointsAsync = function (telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var host, openIdConfigurationEndpointResponse, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!this.IsValidationEnabled) return [3 /*break*/, 3];
                        host = this.canonicalAuthorityUrlComponents.HostNameAndPort;
                        if (!(_TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__["TrustedAuthority"].getTrustedHostList().length === 0)) return [3 /*break*/, 2];
                        return [4 /*yield*/, _TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__["TrustedAuthority"].setTrustedAuthoritiesFromNetwork(this.canonicalAuthority, telemetryManager, correlationId)];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!_TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__["TrustedAuthority"].IsInTrustedHostList(host)) {
                            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationError"].createUntrustedAuthorityError(host);
                        }
                        _b.label = 3;
                    case 3:
                        openIdConfigurationEndpointResponse = this.GetOpenIdConfigurationEndpoint();
                        _a = this;
                        return [4 /*yield*/, this.DiscoverEndpoints(openIdConfigurationEndpointResponse, telemetryManager, correlationId)];
                    case 4:
                        _a.tenantDiscoveryResponse = _b.sent();
                        return [2 /*return*/, this.tenantDiscoveryResponse];
                }
            });
        });
    };
    /**
     * Checks if there is a cached tenant discovery response with required fields.
     */
    Authority.prototype.hasCachedMetadata = function () {
        return !!(this.tenantDiscoveryResponse &&
            this.tenantDiscoveryResponse.AuthorizationEndpoint &&
            this.tenantDiscoveryResponse.EndSessionEndpoint &&
            this.tenantDiscoveryResponse.Issuer);
    };
    /**
     * Returns a promise which resolves to the OIDC endpoint
     * Only responds with the endpoint
     */
    Authority.prototype.GetOpenIdConfigurationEndpoint = function () {
        return this.DefaultOpenIdConfigurationEndpoint;
    };
    return Authority;
}());

//# sourceMappingURL=Authority.js.map

/***/ }),

/***/ "Sje5":
/*!************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/ClientInfo.js ***!
  \************************************************************************************************/
/*! exports provided: ClientInfo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientInfo", function() { return ClientInfo; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ "oish");
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./error/ClientAuthError */ "L9Ey");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ "UjIo");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * @hidden
 */
var ClientInfo = /** @class */ (function () {
    function ClientInfo(rawClientInfo, authority) {
        if (!rawClientInfo || _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(rawClientInfo)) {
            this.uid = "";
            this.utid = "";
            return;
        }
        try {
            var decodedClientInfo = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Decode(rawClientInfo);
            var clientInfo = JSON.parse(decodedClientInfo);
            if (clientInfo) {
                if (clientInfo.hasOwnProperty("uid")) {
                    this.uid = authority ? ClientInfo.stripPolicyFromUid(clientInfo.uid, authority) : clientInfo.uid;
                }
                if (clientInfo.hasOwnProperty("utid")) {
                    this.utid = clientInfo.utid;
                }
            }
        }
        catch (e) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__["ClientAuthError"].createClientInfoDecodingError(e);
        }
    }
    Object.defineProperty(ClientInfo.prototype, "uid", {
        get: function () {
            return this._uid ? this._uid : "";
        },
        set: function (uid) {
            this._uid = uid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ClientInfo.prototype, "utid", {
        get: function () {
            return this._utid ? this._utid : "";
        },
        set: function (utid) {
            this._utid = utid;
        },
        enumerable: true,
        configurable: true
    });
    ClientInfo.createClientInfoFromIdToken = function (idToken, authority) {
        var clientInfo = {
            uid: idToken.subject,
            utid: ""
        };
        return new ClientInfo(_utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(JSON.stringify(clientInfo)), authority);
    };
    ClientInfo.stripPolicyFromUid = function (uid, authority) {
        var uidSegments = uid.split("-");
        // Reverse the url segments so the last one is more easily accessible
        var urlSegments = authority.split("/").reverse();
        var policy = "";
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(urlSegments[0])) {
            policy = urlSegments[0];
        }
        else if (urlSegments.length > 1) {
            // If the original url had a trailing slash, urlSegments[0] would be "" so take the next element
            policy = urlSegments[1];
        }
        if (uidSegments[uidSegments.length - 1] === policy) {
            // If the last segment of uid matches the last segment of authority url, remove the last segment of uid
            return uidSegments.slice(0, uidSegments.length - 1).join("-");
        }
        return uid;
    };
    ClientInfo.prototype.encodeClientInfo = function () {
        var clientInfo = JSON.stringify({ uid: this.uid, utid: this.utid });
        return _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(clientInfo);
    };
    return ClientInfo;
}());

//# sourceMappingURL=ClientInfo.js.map

/***/ }),

/***/ "T1gI":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/GraphRequest.js ***!
  \*******************************************************************************************************************/
/*! exports provided: GraphRequest */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphRequest", function() { return GraphRequest; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _GraphErrorHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GraphErrorHandler */ "Z3M6");
/* harmony import */ var _GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GraphRequestUtil */ "kC25");
/* harmony import */ var _GraphResponseHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GraphResponseHandler */ "wLax");
/* harmony import */ var _middleware_MiddlewareControl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./middleware/MiddlewareControl */ "ocZF");
/* harmony import */ var _RequestMethod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./RequestMethod */ "umkM");
/* harmony import */ var _ResponseType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ResponseType */ "LrMb");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */







/**
 * @class
 * A Class representing GraphRequest
 */
class GraphRequest {
    /* tslint:enable: variable-name */
    /**
     * @public
     * @constructor
     * Creates an instance of GraphRequest
     * @param {HTTPClient} httpClient - The HTTPClient instance
     * @param {ClientOptions} config - The options for making request
     * @param {string} path - A path string
     */
    constructor(httpClient, config, path) {
        /**
         * @private
         * Parses the path string and creates URLComponents out of it
         * @param {string} path - The request path string
         * @returns Nothing
         */
        this.parsePath = (path) => {
            // Strips out the base of the url if they passed in
            if (path.indexOf("https://") !== -1) {
                path = path.replace("https://", "");
                // Find where the host ends
                const endOfHostStrPos = path.indexOf("/");
                if (endOfHostStrPos !== -1) {
                    // Parse out the host
                    this.urlComponents.host = "https://" + path.substring(0, endOfHostStrPos);
                    // Strip the host from path
                    path = path.substring(endOfHostStrPos + 1, path.length);
                }
                // Remove the following version
                const endOfVersionStrPos = path.indexOf("/");
                if (endOfVersionStrPos !== -1) {
                    // Parse out the version
                    this.urlComponents.version = path.substring(0, endOfVersionStrPos);
                    // Strip version from path
                    path = path.substring(endOfVersionStrPos + 1, path.length);
                }
            }
            // Strip out any leading "/"
            if (path.charAt(0) === "/") {
                path = path.substr(1);
            }
            const queryStrPos = path.indexOf("?");
            if (queryStrPos === -1) {
                // No query string
                this.urlComponents.path = path;
            }
            else {
                this.urlComponents.path = path.substr(0, queryStrPos);
                // Capture query string into oDataQueryParams and otherURLQueryParams
                const queryParams = path.substring(queryStrPos + 1, path.length).split("&");
                for (const queryParam of queryParams) {
                    this.parseQueryParameter(queryParam);
                }
            }
        };
        this.httpClient = httpClient;
        this.config = config;
        this.urlComponents = {
            host: this.config.baseUrl,
            version: this.config.defaultVersion,
            oDataQueryParams: {},
            otherURLQueryParams: {},
            otherURLQueryOptions: [],
        };
        this._headers = {};
        this._options = {};
        this._middlewareOptions = [];
        this.parsePath(path);
    }
    /**
     * @private
     * Adds the query parameter as comma separated values
     * @param {string} propertyName - The name of a property
     * @param {string|string[]} propertyValue - The vale of a property
     * @param {IArguments} additionalProperties - The additional properties
     * @returns Nothing
     */
    addCsvQueryParameter(propertyName, propertyValue, additionalProperties) {
        // If there are already $propertyName value there, append a ","
        this.urlComponents.oDataQueryParams[propertyName] = this.urlComponents.oDataQueryParams[propertyName] ? this.urlComponents.oDataQueryParams[propertyName] + "," : "";
        let allValues = [];
        if (additionalProperties.length > 1 && typeof propertyValue === "string") {
            allValues = Array.prototype.slice.call(additionalProperties);
        }
        else if (typeof propertyValue === "string") {
            allValues.push(propertyValue);
        }
        else {
            allValues = allValues.concat(propertyValue);
        }
        this.urlComponents.oDataQueryParams[propertyName] += allValues.join(",");
    }
    /**
     * @private
     * Builds the full url from the URLComponents to make a request
     * @returns The URL string that is qualified to make a request to graph endpoint
     */
    buildFullUrl() {
        const url = Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["urlJoin"])([this.urlComponents.host, this.urlComponents.version, this.urlComponents.path]) + this.createQueryString();
        if (this.config.debugLogging) {
            console.log(url); // tslint:disable-line: no-console
        }
        return url;
    }
    /**
     * @private
     * Builds the query string from the URLComponents
     * @returns The Constructed query string
     */
    createQueryString() {
        // Combining query params from oDataQueryParams and otherURLQueryParams
        const urlComponents = this.urlComponents;
        const query = [];
        if (Object.keys(urlComponents.oDataQueryParams).length !== 0) {
            for (const property in urlComponents.oDataQueryParams) {
                if (urlComponents.oDataQueryParams.hasOwnProperty(property)) {
                    query.push(property + "=" + urlComponents.oDataQueryParams[property]);
                }
            }
        }
        if (Object.keys(urlComponents.otherURLQueryParams).length !== 0) {
            for (const property in urlComponents.otherURLQueryParams) {
                if (urlComponents.otherURLQueryParams.hasOwnProperty(property)) {
                    query.push(property + "=" + urlComponents.otherURLQueryParams[property]);
                }
            }
        }
        if (urlComponents.otherURLQueryOptions.length !== 0) {
            for (const str of urlComponents.otherURLQueryOptions) {
                query.push(str);
            }
        }
        return query.length > 0 ? "?" + query.join("&") : "";
    }
    /**
     * @private
     * Parses the query parameters to set the urlComponents property of the GraphRequest object
     * @param {string|KeyValuePairObjectStringNumber} queryDictionaryOrString - The query parameter
     * @returns The same GraphRequest instance that is being called with
     */
    parseQueryParameter(queryDictionaryOrString) {
        if (typeof queryDictionaryOrString === "string") {
            if (queryDictionaryOrString.charAt(0) === "?") {
                queryDictionaryOrString = queryDictionaryOrString.substring(1);
            }
            if (queryDictionaryOrString.indexOf("&") !== -1) {
                const queryParams = queryDictionaryOrString.split("&");
                for (const str of queryParams) {
                    this.parseQueryParamenterString(str);
                }
            }
            else {
                this.parseQueryParamenterString(queryDictionaryOrString);
            }
        }
        else if (queryDictionaryOrString.constructor === Object) {
            for (const key in queryDictionaryOrString) {
                if (queryDictionaryOrString.hasOwnProperty(key)) {
                    this.setURLComponentsQueryParamater(key, queryDictionaryOrString[key]);
                }
            }
        }
        return this;
    }
    /**
     * @private
     * Parses the query parameter of string type to set the urlComponents property of the GraphRequest object
     * @param {string} queryParameter - the query parameters
     * returns nothing
     */
    parseQueryParamenterString(queryParameter) {
        /* The query key-value pair must be split on the first equals sign to avoid errors in parsing nested query parameters.
                 Example-> "/me?$expand=home($select=city)" */
        if (this.isValidQueryKeyValuePair(queryParameter)) {
            const indexOfFirstEquals = queryParameter.indexOf("=");
            const paramKey = queryParameter.substring(0, indexOfFirstEquals);
            const paramValue = queryParameter.substring(indexOfFirstEquals + 1);
            this.setURLComponentsQueryParamater(paramKey, paramValue);
        }
        else {
            /* Push values which are not of key-value structure.
            Example-> Handle an invalid input->.query(test), .query($select($select=name)) and let the Graph API respond with the error in the URL*/
            this.urlComponents.otherURLQueryOptions.push(queryParameter);
        }
    }
    /**
     * @private
     * Sets values into the urlComponents property of GraphRequest object.
     * @param {string} paramKey - the query parameter key
     * @param {string} paramValue - the query paramter value
     * @returns nothing
     */
    setURLComponentsQueryParamater(paramKey, paramValue) {
        if (_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["oDataQueryNames"].indexOf(paramKey) !== -1) {
            const currentValue = this.urlComponents.oDataQueryParams[paramKey];
            const isValueAppendable = currentValue && (paramKey === "$expand" || paramKey === "$select" || paramKey === "$orderby");
            this.urlComponents.oDataQueryParams[paramKey] = isValueAppendable ? currentValue + "," + paramValue : paramValue;
        }
        else {
            this.urlComponents.otherURLQueryParams[paramKey] = paramValue;
        }
    }
    /**
     * @private
     * Check if the query parameter string has a valid key-value structure
     * @param {string} queryString - the query parameter string. Example -> "name=value"
     * #returns true if the query string has a valid key-value structure else false
     */
    isValidQueryKeyValuePair(queryString) {
        const indexofFirstEquals = queryString.indexOf("=");
        if (indexofFirstEquals === -1) {
            return false;
        }
        const indexofOpeningParanthesis = queryString.indexOf("(");
        if (indexofOpeningParanthesis !== -1 && queryString.indexOf("(") < indexofFirstEquals) {
            // Example -> .query($select($expand=true));
            return false;
        }
        return true;
    }
    /**
     * @private
     * Updates the custom headers and options for a request
     * @param {FetchOptions} options - The request options object
     * @returns Nothing
     */
    updateRequestOptions(options) {
        const optionsHeaders = Object.assign({}, options.headers);
        if (this.config.fetchOptions !== undefined) {
            const fetchOptions = Object.assign({}, this.config.fetchOptions);
            Object.assign(options, fetchOptions);
            if (typeof this.config.fetchOptions.headers !== undefined) {
                options.headers = Object.assign({}, this.config.fetchOptions.headers);
            }
        }
        Object.assign(options, this._options);
        if (options.headers !== undefined) {
            Object.assign(optionsHeaders, options.headers);
        }
        Object.assign(optionsHeaders, this._headers);
        options.headers = optionsHeaders;
    }
    /**
     * @private
     * @async
     * Adds the custom headers and options to the request and makes the HTTPClient send request call
     * @param {RequestInfo} request - The request url string or the Request object value
     * @param {FetchOptions} options - The options to make a request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the response content
     */
    send(request, options, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            let rawResponse;
            const middlewareControl = new _middleware_MiddlewareControl__WEBPACK_IMPORTED_MODULE_4__["MiddlewareControl"](this._middlewareOptions);
            this.updateRequestOptions(options);
            try {
                const context = yield this.httpClient.sendRequest({
                    request,
                    options,
                    middlewareControl,
                });
                rawResponse = context.response;
                const response = yield _GraphResponseHandler__WEBPACK_IMPORTED_MODULE_3__["GraphResponseHandler"].getResponse(rawResponse, this._responseType, callback);
                return response;
            }
            catch (error) {
                let statusCode;
                if (typeof rawResponse !== "undefined") {
                    statusCode = rawResponse.status;
                }
                const gError = yield _GraphErrorHandler__WEBPACK_IMPORTED_MODULE_1__["GraphErrorHandler"].getError(error, statusCode, callback);
                throw gError;
            }
        });
    }
    /**
     * @private
     * Checks if the content-type is present in the _headers property. If not present, defaults the content-type to application/json
     * @param none
     * @returns nothing
     */
    setHeaderContentType() {
        if (!this._headers) {
            this.header("Content-Type", "application/json");
            return;
        }
        const headerKeys = Object.keys(this._headers);
        for (const headerKey of headerKeys) {
            if (headerKey.toLowerCase() === "content-type") {
                return;
            }
        }
        // Default the content-type to application/json in case the content-type is not present in the header
        this.header("Content-Type", "application/json");
    }
    /**
     * @public
     * Sets the custom header for a request
     * @param {string} headerKey - A header key
     * @param {string} headerValue - A header value
     * @returns The same GraphRequest instance that is being called with
     */
    header(headerKey, headerValue) {
        this._headers[headerKey] = headerValue;
        return this;
    }
    /**
     * @public
     * Sets the custom headers for a request
     * @param {KeyValuePairObjectStringNumber | HeadersInit} headers - The request headers
     * @returns The same GraphRequest instance that is being called with
     */
    headers(headers) {
        for (const key in headers) {
            if (headers.hasOwnProperty(key)) {
                this._headers[key] = headers[key];
            }
        }
        return this;
    }
    /**
     * @public
     * Sets the option for making a request
     * @param {string} key - The key value
     * @param {any} value - The value
     * @returns The same GraphRequest instance that is being called with
     */
    option(key, value) {
        this._options[key] = value;
        return this;
    }
    /**
     * @public
     * Sets the options for making a request
     * @param {{ [key: string]: any }} options - The options key value pair
     * @returns The same GraphRequest instance that is being called with
     */
    options(options) {
        for (const key in options) {
            if (options.hasOwnProperty(key)) {
                this._options[key] = options[key];
            }
        }
        return this;
    }
    /**
     * @public
     * Sets the middleware options for a request
     * @param {MiddlewareOptions[]} options - The array of middleware options
     * @returns The same GraphRequest instance that is being called with
     */
    middlewareOptions(options) {
        this._middlewareOptions = options;
        return this;
    }
    /**
     * @public
     * Sets the api endpoint version for a request
     * @param {string} version - The version value
     * @returns The same GraphRequest instance that is being called with
     */
    version(version) {
        this.urlComponents.version = version;
        return this;
    }
    /**
     * @public
     * Sets the api endpoint version for a request
     * @param {ResponseType} responseType - The response type value
     * @returns The same GraphRequest instance that is being called with
     */
    responseType(responseType) {
        this._responseType = responseType;
        return this;
    }
    /**
     * @public
     * To add properties for select OData Query param
     * @param {string|string[]} properties - The Properties value
     * @returns The same GraphRequest instance that is being called with, after adding the properties for $select query
     */
    /*
     * Accepts .select("displayName,birthday")
     *     and .select(["displayName", "birthday"])
     *     and .select("displayName", "birthday")
     *
     */
    select(properties) {
        this.addCsvQueryParameter("$select", properties, arguments);
        return this;
    }
    /**
     * @public
     * To add properties for expand OData Query param
     * @param {string|string[]} properties - The Properties value
     * @returns The same GraphRequest instance that is being called with, after adding the properties for $expand query
     */
    expand(properties) {
        this.addCsvQueryParameter("$expand", properties, arguments);
        return this;
    }
    /**
     * @public
     * To add properties for orderby OData Query param
     * @param {string|string[]} properties - The Properties value
     * @returns The same GraphRequest instance that is being called with, after adding the properties for $orderby query
     */
    orderby(properties) {
        this.addCsvQueryParameter("$orderby", properties, arguments);
        return this;
    }
    /**
     * @public
     * To add query string for filter OData Query param. The request URL accepts only one $filter Odata Query option and its value is set to the most recently passed filter query string.
     * @param {string} filterStr - The filter query string
     * @returns The same GraphRequest instance that is being called with, after adding the $filter query
     */
    filter(filterStr) {
        this.urlComponents.oDataQueryParams.$filter = filterStr;
        return this;
    }
    /**
     * @public
     * To add criterion for search OData Query param. The request URL accepts only one $search Odata Query option and its value is set to the most recently passed search criterion string.
     * @param {string} searchStr - The search criterion string
     * @returns The same GraphRequest instance that is being called with, after adding the $search query criteria
     */
    search(searchStr) {
        this.urlComponents.oDataQueryParams.$search = searchStr;
        return this;
    }
    /**
     * @public
     * To add number for top OData Query param. The request URL accepts only one $top Odata Query option and its value is set to the most recently passed number value.
     * @param {number} n - The number value
     * @returns The same GraphRequest instance that is being called with, after adding the number for $top query
     */
    top(n) {
        this.urlComponents.oDataQueryParams.$top = n;
        return this;
    }
    /**
     * @public
     * To add number for skip OData Query param. The request URL accepts only one $skip Odata Query option and its value is set to the most recently passed number value.
     * @param {number} n - The number value
     * @returns The same GraphRequest instance that is being called with, after adding the number for the $skip query
     */
    skip(n) {
        this.urlComponents.oDataQueryParams.$skip = n;
        return this;
    }
    /**
     * @public
     * To add token string for skipToken OData Query param. The request URL accepts only one $skipToken Odata Query option and its value is set to the most recently passed token value.
     * @param {string} token - The token value
     * @returns The same GraphRequest instance that is being called with, after adding the token string for $skipToken query option
     */
    skipToken(token) {
        this.urlComponents.oDataQueryParams.$skipToken = token;
        return this;
    }
    /**
     * @public
     * To add boolean for count OData Query param. The URL accepts only one $count Odata Query option and its value is set to the most recently passed boolean value.
     * @param {boolean} isCount - The count boolean
     * @returns The same GraphRequest instance that is being called with, after adding the boolean value for the $count query option
     */
    count(isCount = false) {
        this.urlComponents.oDataQueryParams.$count = isCount.toString();
        return this;
    }
    /**
     * @public
     * Appends query string to the urlComponent
     * @param {string|KeyValuePairObjectStringNumber} queryDictionaryOrString - The query value
     * @returns The same GraphRequest instance that is being called with, after appending the query string to the url component
     */
    /*
     * Accepts .query("displayName=xyz")
     *     and .select({ name: "value" })
     */
    query(queryDictionaryOrString) {
        return this.parseQueryParameter(queryDictionaryOrString);
    }
    /**
     * @public
     * @async
     * Makes a http request with GET method
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the get response
     */
    get(callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].GET,
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes a http request with POST method
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the post response
     */
    post(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].POST,
                body: Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["serializeContent"])(content),
            };
            const className = content && content.constructor && content.constructor.name;
            if (className === "FormData") {
                // Content-Type headers should not be specified in case the of FormData type content
                options.headers = {};
            }
            else {
                this.setHeaderContentType();
                options.headers = this._headers;
            }
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Alias for Post request call
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the post response
     */
    create(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.post(content, callback);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes http request with PUT method
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the put response
     */
    put(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            this.setHeaderContentType();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].PUT,
                body: Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["serializeContent"])(content),
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes http request with PATCH method
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the patch response
     */
    patch(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            this.setHeaderContentType();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].PATCH,
                body: Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["serializeContent"])(content),
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Alias for PATCH request
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the patch response
     */
    update(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.patch(content, callback);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes http request with DELETE method
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the delete response
     */
    delete(callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].DELETE,
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Alias for delete request call
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the delete response
     */
    del(callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.delete(callback);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes a http request with GET method to read response as a stream.
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the getStream response
     */
    getStream(callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].GET,
            };
            this.responseType(_ResponseType__WEBPACK_IMPORTED_MODULE_6__["ResponseType"].STREAM);
            try {
                const stream = yield this.send(url, options, callback);
                return stream;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes a http request with GET method to read response as a stream.
     * @param {any} stream - The stream instance
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the putStream response
     */
    putStream(stream, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].PUT,
                headers: {
                    "Content-Type": "application/octet-stream",
                },
                body: stream,
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
}
//# sourceMappingURL=GraphRequest.js.map

/***/ }),

/***/ "TXhN":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/MSALAuthenticationProviderOptions.js ***!
  \****************************************************************************************************/
/*! exports provided: MSALAuthenticationProviderOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MSALAuthenticationProviderOptions", function() { return MSALAuthenticationProviderOptions; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * @implements AuthenticationProviderOptions
 * Class representing MSALAuthenticationProviderOptions
 */
class MSALAuthenticationProviderOptions {
    /**
     * @public
     * @constructor
     * To create an instance of MSALAuthenticationProviderOptions
     * @param {string[]} scopes - An array of scopes
     * @returns An instance of MSALAuthenticationProviderOptions
     */
    constructor(scopes) {
        this.scopes = scopes;
    }
}
//# sourceMappingURL=MSALAuthenticationProviderOptions.js.map

/***/ }),

/***/ "Tq/z":
/*!******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/TokenUtils.js ***!
  \******************************************************************************************************/
/*! exports provided: TokenUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TokenUtils", function() { return TokenUtils; });
/* harmony import */ var _CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CryptoUtils */ "oish");
/* harmony import */ var _StringUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./StringUtils */ "UjIo");
/* harmony import */ var _TimeUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TimeUtils */ "b7Qq");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * @hidden
 */
var TokenUtils = /** @class */ (function () {
    function TokenUtils() {
    }
    /**
     * decode a JWT
     *
     * @param jwtToken
     */
    TokenUtils.decodeJwt = function (jwtToken) {
        if (_StringUtils__WEBPACK_IMPORTED_MODULE_1__["StringUtils"].isEmpty(jwtToken)) {
            return null;
        }
        var idTokenPartsRegex = /^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/;
        var matches = idTokenPartsRegex.exec(jwtToken);
        if (!matches || matches.length < 4) {
            // this._requestContext.logger.warn("The returned id_token is not parseable.");
            return null;
        }
        var crackedToken = {
            header: matches[1],
            JWSPayload: matches[2],
            JWSSig: matches[3]
        };
        return crackedToken;
    };
    /**
     * Evaluates whether token cache item expiration is within expiration offset range
     * @param tokenCacheItem
     */
    TokenUtils.validateExpirationIsWithinOffset = function (expiration, tokenRenewalOffsetSeconds) {
        var offset = tokenRenewalOffsetSeconds || 300;
        return expiration && (expiration > _TimeUtils__WEBPACK_IMPORTED_MODULE_2__["TimeUtils"].now() + offset);
    };
    /**
     * Extract IdToken by decoding the RAWIdToken
     *
     * @param encodedIdToken
     */
    TokenUtils.extractIdToken = function (encodedIdToken) {
        // id token will be decoded to get the username
        var decodedToken = this.decodeJwt(encodedIdToken);
        if (!decodedToken) {
            return null;
        }
        try {
            var base64IdToken = decodedToken.JWSPayload;
            var base64Decoded = _CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Decode(base64IdToken);
            if (!base64Decoded) {
                // this._requestContext.logger.info("The returned id_token could not be base64 url safe decoded.");
                return null;
            }
            // ECMA script has JSON built-in support
            return JSON.parse(base64Decoded);
        }
        catch (err) {
            // this._requestContext.logger.error("The returned id_token could not be decoded" + err);
        }
        return null;
    };
    return TokenUtils;
}());

//# sourceMappingURL=TokenUtils.js.map

/***/ }),

/***/ "TsON":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person/mgt-person-css.js ***!
  \*************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
@charset "UTF-8";:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}:host([hidden]){display:none}:host{display:inline-block;font-family:var(--font-family,var(--default-font-family));vertical-align:top}:host .root{display:block}:host svg,mgt-person svg{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;color:var(--color-sub1,#323130)}:host .person-root .user-avatar,mgt-person .person-root .user-avatar{width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));display:flex;justify-content:center;align-items:center;flex-shrink:0}:host .person-root .user-avatar .user-presence,mgt-person .person-root .user-avatar .user-presence{margin:0;position:absolute;left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);top:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .72 - 4px);width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28);border:2px solid var(--presence-background-color,var(--background-color,#fff));border-radius:50%}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#b4009e}:host .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg,mgt-person .person-root .user-avatar .user-presence .presence-oof-offline-wrapper .presence-oof-offline svg{color:#b4009e;width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-basic,mgt-person .person-root .user-avatar .user-presence .presence-basic{width:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);height:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .28 - 4px);border-style:solid;border-width:2px;border-radius:50%;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .14);vertical-align:top;display:flex;align-items:center}:host .person-root .user-avatar .user-presence .presence-basic.presence-offline,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-offline{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#8a8886}:host .person-root .user-avatar .user-presence .presence-basic.presence-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-available{background-color:#6bb700;border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-available,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-available{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#6bb700}:host .person-root .user-avatar .user-presence .presence-basic.presence-away,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-away{background-color:#fa4;border-color:#fa4}:host .person-root .user-avatar .user-presence .presence-basic.presence-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-dnd{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-dnd{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-busy{background-color:#c50f1f;border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy,mgt-person .person-root .user-avatar .user-presence .presence-basic.presence-oof-busy{background-color:var(--presence-background-color,var(--background-color,#fff));border-color:#c50f1f}:host .person-root .user-avatar .user-presence .presence-offline::before,mgt-person .person-root .user-avatar .user-presence .presence-offline::before{content:"";color:#8a8886;font-weight:700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-available::before,mgt-person .person-root .user-avatar .user-presence .presence-available::before{content:"";color:var(--presence-icon-color,var(--color,#000));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-available::before{content:"";color:#6bb700;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-away::before,mgt-person .person-root .user-avatar .user-presence .presence-away::before{content:"";color:var(--presence-icon-color,var(--color,#000));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-dnd::before{content:"";color:var(--presence-icon-color,var(--color,#000));margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar .user-presence .presence-oof-dnd::before{content:"";color:#c50f1f;margin-left:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}:host .person-root .user-avatar.initials,mgt-person .person-root .user-avatar.initials{color:var(--initials-color,#fff);border-radius:var(--avatar-border-radius,50%);font-weight:400}:host .person-root .user-avatar.initials .contact-icon,:host .person-root .user-avatar.initials .initials-text,mgt-person .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .initials-text{cursor:default;margin-top:-1px;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .4)}:host .person-root .user-avatar.initials .contact-icon,mgt-person .person-root .user-avatar.initials .contact-icon{display:inline}:host .person-root .user-avatar.small,mgt-person .person-root .user-avatar.small{width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}:host .person-root .user-avatar.small .contact-icon,:host .person-root .user-avatar.small .initials-text,mgt-person .person-root .user-avatar.small .contact-icon,mgt-person .person-root .user-avatar.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}:host .person-root .user-avatar.small .user-presence,mgt-person .person-root .user-avatar.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}:host .person-root .user-avatar.small .user-presence .presence-basic,mgt-person .person-root .user-avatar.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}:host .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg,mgt-person .person-root .user-avatar.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}:host .person-root .user-avatar.small .user-presence .presence-available::before,:host .person-root .user-avatar.small .user-presence .presence-away::before,:host .person-root .user-avatar.small .user-presence .presence-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-offline::before,:host .person-root .user-avatar.small .user-presence .presence-oof-available::before,:host .person-root .user-avatar.small .user-presence .presence-oof-away::before,:host .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,:host .person-root .user-avatar.small .user-presence .presence-oof-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-offline::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-available::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-away::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-dnd::before,mgt-person .person-root .user-avatar.small .user-presence .presence-oof-offline::before{content:''}:host .person-root .user-avatar .img-wrapper,mgt-person .person-root .user-avatar .img-wrapper{height:100%;width:100%;display:flex;overflow:hidden;border:var(--avatar-border,0);border-radius:var(--avatar-border-radius,50%);position:relative}:host .person-root .user-avatar .img-wrapper img,mgt-person .person-root .user-avatar .img-wrapper img{position:absolute;display:block;top:-100%;right:-100%;bottom:-100%;left:-100%;margin:auto;height:100%;width:auto}:host .person-root .user-avatar.pinkRed10,mgt-person .person-root .user-avatar.pinkRed10{background-color:var(--initials-background-color,#750b1c)}:host .person-root .user-avatar.red20,mgt-person .person-root .user-avatar.red20{background-color:var(--initials-background-color,#a4262c)}:host .person-root .user-avatar.red10,mgt-person .person-root .user-avatar.red10{background-color:var(--initials-background-color,#d13438)}:host .person-root .user-avatar.orange20,mgt-person .person-root .user-avatar.orange20{background-color:var(--initials-background-color,#ca5010)}:host .person-root .user-avatar.orangeYellow20,mgt-person .person-root .user-avatar.orangeYellow20{background-color:var(--initials-background-color,#986f0b)}:host .person-root .user-avatar.green10,mgt-person .person-root .user-avatar.green10{background-color:var(--initials-background-color,#498205)}:host .person-root .user-avatar.green20,mgt-person .person-root .user-avatar.green20{background-color:var(--initials-background-color,#0b6a0b)}:host .person-root .user-avatar.cyan20,mgt-person .person-root .user-avatar.cyan20{background-color:var(--initials-background-color,#038387)}:host .person-root .user-avatar.cyan30,mgt-person .person-root .user-avatar.cyan30{background-color:var(--initials-background-color,#005b70)}:host .person-root .user-avatar.cyanBlue10,mgt-person .person-root .user-avatar.cyanBlue10{background-color:var(--initials-background-color,#0078d4)}:host .person-root .user-avatar.cyanBlue20,mgt-person .person-root .user-avatar.cyanBlue20{background-color:var(--initials-background-color,#004e8c)}:host .person-root .user-avatar.blue10,mgt-person .person-root .user-avatar.blue10{background-color:var(--initials-background-color,#4f6bed)}:host .person-root .user-avatar.blueMagenta30,mgt-person .person-root .user-avatar.blueMagenta30{background-color:var(--initials-background-color,#5c2e91)}:host .person-root .user-avatar.blueMagenta20,mgt-person .person-root .user-avatar.blueMagenta20{background-color:var(--initials-background-color,#8764b8)}:host .person-root .user-avatar.magenta20,mgt-person .person-root .user-avatar.magenta20{background-color:var(--initials-background-color,#881798)}:host .person-root .user-avatar.magenta10,mgt-person .person-root .user-avatar.magenta10{background-color:var(--initials-background-color,#c239b3)}:host .person-root .user-avatar.magentaPink10,mgt-person .person-root .user-avatar.magentaPink10{background-color:var(--initials-background-color,#e3008c)}:host .person-root .user-avatar.orange30,mgt-person .person-root .user-avatar.orange30{background-color:var(--initials-background-color,#8e562e)}:host .person-root .user-avatar.gray30,mgt-person .person-root .user-avatar.gray30{background-color:var(--initials-background-color,#7a7574)}:host .person-root .user-avatar.gray20,mgt-person .person-root .user-avatar.gray20{background-color:var(--initials-background-color,#69797e)}:host .person-root .details,mgt-person .person-root .details{flex-shrink:1;display:flex;flex-direction:column;overflow:hidden;line-height:1.4;margin:var(--details-spacing,0 0 0 12px)}:host .person-root .details.small,mgt-person .person-root .details.small{margin:var(--details-spacing,0 0 0 6px)}:host .person-root .details>div,mgt-person .person-root .details>div{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}:host .person-root .details .line1,mgt-person .person-root .details .line1{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);text-transform:var(text-transform,none)}:host .person-root .details .line2,mgt-person .person-root .details .line2{color:var(--line2-color,var(--color-sub1,#323130));font-size:var(--line2-font-size,var(--email-font-size,12px));font-weight:var(--line2-font-weight,400);text-transform:var(--line2-text-transform,var(text-transform,none))}:host .person-root .details .line3,mgt-person .person-root .details .line3{color:var(--line3-color,var(--color-sub2,#797775));font-size:var(--line3-font-size,var(--email-font-size,12px));font-weight:var(--line3-font-weight,400);text-transform:var(--line3-text-transform,var(text-transform,none))}:host .avatar-icon,mgt-person .avatar-icon{display:flex;align-items:center;justify-content:center;line-height:1;margin:0;font-size:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .5);width:var(--avatar-size,var(--avatar-size-s,48px));height:var(--avatar-size,var(--avatar-size-s,48px));overflow:hidden;border-radius:var(--avatar-border-radius,50%)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,var(--avatar-size,24px));width:var(--avatar-size-s,var(--avatar-size,24px));height:var(--avatar-size-s,var(--avatar-size,24px))}[dir=rtl] .root{direction:rtl}[dir=rtl] svg{direction:rtl}[dir=rtl] .person-root .user-avatar{position:relative}[dir=rtl] .person-root .details{margin:var(--details-spacing,0 12px 0 0)}[dir=rtl] .person-root .details.small{margin:var(--details-spacing,0 6px 0 0)}[dir=rtl] .person-root .user-presence .presence-oof-offline svg{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-offline::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-available::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-away::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root .user-presence .presence-oof-dnd::before{margin-right:calc(var(--avatar-size,var(--avatar-size-s,48px)) * .07 - 2px)}[dir=rtl] .person-root.small .contact-icon,[dir=rtl] .person-root.small .initials-text{font-size:calc(var(--avatar-size-s,var(--avatar-size,24px)) * .4)}[dir=rtl] .person-root.small .user-presence{left:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);top:calc(var(--avatar-size-s,var(--avatar-size,24px)) - 8px);width:8px;height:8px}[dir=rtl] .person-root.small .user-presence .presence-basic{width:4px;height:4px;border-radius:4px;padding:0}[dir=rtl] .person-root.small .user-presence .presence-basic .presence-oof-offline svg{height:0;width:0}
`
];
//# sourceMappingURL=mgt-person-css.js.map

/***/ }),

/***/ "TxoH":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/ResponseUtils.js ***!
  \****************************************************************************************************/
/*! exports provided: ResponseUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResponseUtils", function() { return ResponseUtils; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Constants */ "/pXG");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var ResponseUtils = /** @class */ (function () {
    function ResponseUtils() {
    }
    ResponseUtils.setResponseIdToken = function (originalResponse, idTokenObj) {
        if (!originalResponse) {
            return null;
        }
        else if (!idTokenObj) {
            return originalResponse;
        }
        var exp = Number(idTokenObj.expiration);
        if (exp && !originalResponse.expiresOn) {
            originalResponse.expiresOn = new Date(exp * 1000);
        }
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, originalResponse, { idToken: idTokenObj, idTokenClaims: idTokenObj.claims, uniqueId: idTokenObj.objectId || idTokenObj.subject, tenantId: idTokenObj.tenantId });
    };
    ResponseUtils.buildAuthResponse = function (idToken, authResponse, serverAuthenticationRequest, account, scopes, accountState) {
        switch (serverAuthenticationRequest.responseType) {
            case _Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token:
                authResponse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, authResponse, { tokenType: _Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ID_TOKEN, account: account, scopes: scopes, accountState: accountState });
                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);
                return (authResponse.idToken) ? authResponse : null;
            case _Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token_token:
                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);
                return (authResponse && authResponse.accessToken && authResponse.idToken) ? authResponse : null;
            case _Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].token:
                authResponse = ResponseUtils.setResponseIdToken(authResponse, idToken);
                return authResponse;
            default:
                return null;
        }
    };
    return ResponseUtils;
}());

//# sourceMappingURL=ResponseUtils.js.map

/***/ }),

/***/ "UBea":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/error/ClientConfigurationError.js ***!
  \********************************************************************************************************************/
/*! exports provided: ClientConfigurationErrorMessage, ClientConfigurationError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientConfigurationErrorMessage", function() { return ClientConfigurationErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientConfigurationError", function() { return ClientConfigurationError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _ClientAuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ClientAuthError */ "L9Ey");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var ClientConfigurationErrorMessage = {
    configurationNotSet: {
        code: "no_config_set",
        desc: "Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."
    },
    storageNotSupported: {
        code: "storage_not_supported",
        desc: "The value for the cacheLocation is not supported."
    },
    noRedirectCallbacksSet: {
        code: "no_redirect_callbacks",
        desc: "No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. " +
            "More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."
    },
    invalidCallbackObject: {
        code: "invalid_callback_object",
        desc: "The object passed for the callback was invalid. " +
            "More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."
    },
    scopesRequired: {
        code: "scopes_required",
        desc: "Scopes are required to obtain an access token."
    },
    emptyScopes: {
        code: "empty_input_scopes_error",
        desc: "Scopes cannot be passed as empty array."
    },
    nonArrayScopes: {
        code: "nonarray_input_scopes_error",
        desc: "Scopes cannot be passed as non-array."
    },
    invalidPrompt: {
        code: "invalid_prompt_value",
        desc: "Supported prompt values are 'login', 'select_account', 'consent' and 'none'",
    },
    invalidAuthorityType: {
        code: "invalid_authority_type",
        desc: "The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."
    },
    authorityUriInsecure: {
        code: "authority_uri_insecure",
        desc: "Authority URIs must use https."
    },
    authorityUriInvalidPath: {
        code: "authority_uri_invalid_path",
        desc: "Given authority URI is invalid."
    },
    unsupportedAuthorityValidation: {
        code: "unsupported_authority_validation",
        desc: "The authority validation is not supported for this authority type."
    },
    untrustedAuthority: {
        code: "untrusted_authority",
        desc: "The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."
    },
    b2cAuthorityUriInvalidPath: {
        code: "b2c_authority_uri_invalid_path",
        desc: "The given URI for the B2C authority is invalid."
    },
    b2cKnownAuthoritiesNotSet: {
        code: "b2c_known_authorities_not_set",
        desc: "Must set known authorities when validateAuthority is set to True and using B2C"
    },
    claimsRequestParsingError: {
        code: "claims_request_parsing_error",
        desc: "Could not parse the given claims request object."
    },
    emptyRequestError: {
        code: "empty_request_error",
        desc: "Request object is required."
    },
    invalidCorrelationIdError: {
        code: "invalid_guid_sent_as_correlationId",
        desc: "Please set the correlationId as a valid guid"
    },
    telemetryConfigError: {
        code: "telemetry_config_error",
        desc: "Telemetry config is not configured with required values"
    },
    ssoSilentError: {
        code: "sso_silent_error",
        desc: "request must contain either sid or login_hint"
    },
    invalidAuthorityMetadataError: {
        code: "authority_metadata_error",
        desc: "Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."
    }
};
/**
 * Error thrown when there is an error in configuration of the .js library.
 */
var ClientConfigurationError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ClientConfigurationError, _super);
    function ClientConfigurationError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ClientConfigurationError";
        Object.setPrototypeOf(_this, ClientConfigurationError.prototype);
        return _this;
    }
    ClientConfigurationError.createNoSetConfigurationError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.configurationNotSet.code, "" + ClientConfigurationErrorMessage.configurationNotSet.desc);
    };
    ClientConfigurationError.createStorageNotSupportedError = function (givenCacheLocation) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.storageNotSupported.code, ClientConfigurationErrorMessage.storageNotSupported.desc + " Given location: " + givenCacheLocation);
    };
    ClientConfigurationError.createRedirectCallbacksNotSetError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.noRedirectCallbacksSet.code, ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc);
    };
    ClientConfigurationError.createInvalidCallbackObjectError = function (callbackObject) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidCallbackObject.code, ClientConfigurationErrorMessage.invalidCallbackObject.desc + " Given value for callback function: " + callbackObject);
    };
    ClientConfigurationError.createEmptyScopesArrayError = function (scopesValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.emptyScopes.code, ClientConfigurationErrorMessage.emptyScopes.desc + " Given value: " + scopesValue + ".");
    };
    ClientConfigurationError.createScopesNonArrayError = function (scopesValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.nonArrayScopes.code, ClientConfigurationErrorMessage.nonArrayScopes.desc + " Given value: " + scopesValue + ".");
    };
    ClientConfigurationError.createScopesRequiredError = function (scopesValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.scopesRequired.code, ClientConfigurationErrorMessage.scopesRequired.desc + " Given value: " + scopesValue);
    };
    ClientConfigurationError.createInvalidPromptError = function (promptValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidPrompt.code, ClientConfigurationErrorMessage.invalidPrompt.desc + " Given value: " + promptValue);
    };
    ClientConfigurationError.createClaimsRequestParsingError = function (claimsRequestParseError) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.claimsRequestParsingError.code, ClientConfigurationErrorMessage.claimsRequestParsingError.desc + " Given value: " + claimsRequestParseError);
    };
    ClientConfigurationError.createEmptyRequestError = function () {
        var _a = ClientConfigurationErrorMessage.emptyRequestError, code = _a.code, desc = _a.desc;
        return new ClientConfigurationError(code, desc);
    };
    ClientConfigurationError.createInvalidCorrelationIdError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidCorrelationIdError.code, ClientConfigurationErrorMessage.invalidCorrelationIdError.desc);
    };
    ClientConfigurationError.createKnownAuthoritiesNotSetError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.code, ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.desc);
    };
    ClientConfigurationError.createInvalidAuthorityTypeError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidAuthorityType.code, ClientConfigurationErrorMessage.invalidAuthorityType.desc);
    };
    ClientConfigurationError.createUntrustedAuthorityError = function (host) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.untrustedAuthority.code, ClientConfigurationErrorMessage.untrustedAuthority.desc + " Provided Authority: " + host);
    };
    ClientConfigurationError.createTelemetryConfigError = function (config) {
        var _a = ClientConfigurationErrorMessage.telemetryConfigError, code = _a.code, desc = _a.desc;
        var requiredKeys = {
            applicationName: "string",
            applicationVersion: "string",
            telemetryEmitter: "function"
        };
        var missingKeys = Object.keys(requiredKeys)
            .reduce(function (keys, key) {
            return config[key] ? keys : keys.concat([key + " (" + requiredKeys[key] + ")"]);
        }, []);
        return new ClientConfigurationError(code, desc + " mising values: " + missingKeys.join(","));
    };
    ClientConfigurationError.createSsoSilentError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.ssoSilentError.code, ClientConfigurationErrorMessage.ssoSilentError.desc);
    };
    ClientConfigurationError.createInvalidAuthorityMetadataError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidAuthorityMetadataError.code, ClientConfigurationErrorMessage.invalidAuthorityMetadataError.desc);
    };
    return ClientConfigurationError;
}(_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__["ClientAuthError"]));

//# sourceMappingURL=ClientConfigurationError.js.map

/***/ }),

/***/ "UOdp":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/AuthCacheUtils.js ***!
  \**********************************************************************************************************/
/*! exports provided: AuthCacheUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthCacheUtils", function() { return AuthCacheUtils; });
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ScopeSet */ "qfGv");
/* harmony import */ var _UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UrlUtils */ "6r4W");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * @hidden
 */
var AuthCacheUtils = /** @class */ (function () {
    function AuthCacheUtils() {
    }
    AuthCacheUtils.filterTokenCacheItemsByScope = function (tokenCacheItems, requestScopes) {
        return tokenCacheItems.filter(function (cacheItem) {
            var cachedScopes = cacheItem.key.scopes.split(" ");
            var searchScopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_0__["ScopeSet"].removeDefaultScopes(requestScopes);
            // If requestScopes contain only default scopes search for default scopes otherwise search for everything but default scopes
            return searchScopes.length === 0 ? _ScopeSet__WEBPACK_IMPORTED_MODULE_0__["ScopeSet"].containsScope(cachedScopes, requestScopes) : _ScopeSet__WEBPACK_IMPORTED_MODULE_0__["ScopeSet"].containsScope(cachedScopes, searchScopes);
        });
    };
    AuthCacheUtils.filterTokenCacheItemsByAuthority = function (tokenCacheItems, authority) {
        return tokenCacheItems.filter(function (cacheItem) { return _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].CanonicalizeUri(cacheItem.key.authority) === authority; });
    };
    AuthCacheUtils.filterTokenCacheItemsByDomain = function (tokenCacheItems, requestDomain) {
        return tokenCacheItems.filter(function (cacheItem) {
            var cacheItemDomain = _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].GetUrlComponents(cacheItem.key.authority).HostNameAndPort;
            return cacheItemDomain === requestDomain;
        });
    };
    return AuthCacheUtils;
}());

//# sourceMappingURL=AuthCacheUtils.js.map

/***/ }),

/***/ "UYCr":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/authority/Authority.js ***!
  \*********************************************************************************************************/
/*! exports provided: AuthorityType, Authority */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthorityType", function() { return AuthorityType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Authority", function() { return Authority; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "UBea");
/* harmony import */ var _XHRClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../XHRClient */ "NzbG");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/UrlUtils */ "6r4W");
/* harmony import */ var _TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TrustedAuthority */ "bYYR");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/Constants */ "MQw9");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */






/**
 * @hidden
 */
var AuthorityType;
(function (AuthorityType) {
    AuthorityType[AuthorityType["Default"] = 0] = "Default";
    AuthorityType[AuthorityType["Adfs"] = 1] = "Adfs";
})(AuthorityType || (AuthorityType = {}));
/**
 * @hidden
 */
var Authority = /** @class */ (function () {
    function Authority(authority, validateAuthority, authorityMetadata) {
        this.IsValidationEnabled = validateAuthority;
        this.CanonicalAuthority = authority;
        this.validateAsUri();
        this.tenantDiscoveryResponse = authorityMetadata;
    }
    Authority.isAdfs = function (authorityUrl) {
        var components = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].GetUrlComponents(authorityUrl);
        var pathSegments = components.PathSegments;
        return (pathSegments.length && pathSegments[0].toLowerCase() === _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["Constants"].ADFS);
    };
    Object.defineProperty(Authority.prototype, "AuthorityType", {
        get: function () {
            return Authority.isAdfs(this.canonicalAuthority) ? AuthorityType.Adfs : AuthorityType.Default;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "Tenant", {
        get: function () {
            return this.CanonicalAuthorityUrlComponents.PathSegments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "AuthorizationEndpoint", {
        get: function () {
            this.validateResolved();
            return this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g, this.Tenant);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "EndSessionEndpoint", {
        get: function () {
            this.validateResolved();
            return this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g, this.Tenant);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "SelfSignedJwtAudience", {
        get: function () {
            this.validateResolved();
            return this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g, this.Tenant);
        },
        enumerable: true,
        configurable: true
    });
    Authority.prototype.validateResolved = function () {
        if (!this.hasCachedMetadata()) {
            throw "Please call ResolveEndpointsAsync first";
        }
    };
    Object.defineProperty(Authority.prototype, "CanonicalAuthority", {
        /**
         * A URL that is the authority set by the developer
         */
        get: function () {
            return this.canonicalAuthority;
        },
        set: function (url) {
            this.canonicalAuthority = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].CanonicalizeUri(url);
            this.canonicalAuthorityUrlComponents = null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "CanonicalAuthorityUrlComponents", {
        get: function () {
            if (!this.canonicalAuthorityUrlComponents) {
                this.canonicalAuthorityUrlComponents = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].GetUrlComponents(this.CanonicalAuthority);
            }
            return this.canonicalAuthorityUrlComponents;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Authority.prototype, "DefaultOpenIdConfigurationEndpoint", {
        // http://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata
        get: function () {
            return (this.AuthorityType === AuthorityType.Adfs) ? "" + this.CanonicalAuthority + _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["WELL_KNOWN_SUFFIX"] : this.CanonicalAuthority + "v2.0/" + _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["WELL_KNOWN_SUFFIX"];
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Given a string, validate that it is of the form https://domain/path
     */
    Authority.prototype.validateAsUri = function () {
        var components;
        try {
            components = this.CanonicalAuthorityUrlComponents;
        }
        catch (e) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationErrorMessage"].invalidAuthorityType;
        }
        if (!components.Protocol || components.Protocol.toLowerCase() !== "https:") {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationErrorMessage"].authorityUriInsecure;
        }
        if (!components.PathSegments || components.PathSegments.length < 1) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationErrorMessage"].authorityUriInvalidPath;
        }
    };
    /**
     * Calls the OIDC endpoint and returns the response
     */
    Authority.prototype.DiscoverEndpoints = function (openIdConfigurationEndpoint, telemetryManager, correlationId) {
        var client = new _XHRClient__WEBPACK_IMPORTED_MODULE_2__["XhrClient"]();
        var httpMethod = _utils_Constants__WEBPACK_IMPORTED_MODULE_5__["NetworkRequestType"].GET;
        var httpEvent = telemetryManager.createAndStartHttpEvent(correlationId, httpMethod, openIdConfigurationEndpoint, "openIdConfigurationEndpoint");
        return client.sendRequestAsync(openIdConfigurationEndpoint, httpMethod, /* enableCaching: */ true)
            .then(function (response) {
            httpEvent.httpResponseStatus = response.statusCode;
            telemetryManager.stopEvent(httpEvent);
            return {
                AuthorizationEndpoint: response.body.authorization_endpoint,
                EndSessionEndpoint: response.body.end_session_endpoint,
                Issuer: response.body.issuer
            };
        })
            .catch(function (err) {
            httpEvent.serverErrorCode = err;
            telemetryManager.stopEvent(httpEvent);
            throw err;
        });
    };
    /**
     * Returns a promise.
     * Checks to see if the authority is in the cache
     * Discover endpoints via openid-configuration
     * If successful, caches the endpoint for later use in OIDC
     */
    Authority.prototype.resolveEndpointsAsync = function (telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var host, openIdConfigurationEndpointResponse, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!this.IsValidationEnabled) return [3 /*break*/, 3];
                        host = this.canonicalAuthorityUrlComponents.HostNameAndPort;
                        if (!(_TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__["TrustedAuthority"].getTrustedHostList().length === 0)) return [3 /*break*/, 2];
                        return [4 /*yield*/, _TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__["TrustedAuthority"].setTrustedAuthoritiesFromNetwork(this.canonicalAuthority, telemetryManager, correlationId)];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!_TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__["TrustedAuthority"].IsInTrustedHostList(host)) {
                            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__["ClientConfigurationError"].createUntrustedAuthorityError(host);
                        }
                        _b.label = 3;
                    case 3:
                        openIdConfigurationEndpointResponse = this.GetOpenIdConfigurationEndpoint();
                        _a = this;
                        return [4 /*yield*/, this.DiscoverEndpoints(openIdConfigurationEndpointResponse, telemetryManager, correlationId)];
                    case 4:
                        _a.tenantDiscoveryResponse = _b.sent();
                        return [2 /*return*/, this.tenantDiscoveryResponse];
                }
            });
        });
    };
    /**
     * Checks if there is a cached tenant discovery response with required fields.
     */
    Authority.prototype.hasCachedMetadata = function () {
        return !!(this.tenantDiscoveryResponse &&
            this.tenantDiscoveryResponse.AuthorizationEndpoint &&
            this.tenantDiscoveryResponse.EndSessionEndpoint &&
            this.tenantDiscoveryResponse.Issuer);
    };
    /**
     * Returns a promise which resolves to the OIDC endpoint
     * Only responds with the endpoint
     */
    Authority.prototype.GetOpenIdConfigurationEndpoint = function () {
        return this.DefaultOpenIdConfigurationEndpoint;
    };
    return Authority;
}());

//# sourceMappingURL=Authority.js.map

/***/ }),

/***/ "UjIo":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/StringUtils.js ***!
  \*******************************************************************************************************/
/*! exports provided: StringUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StringUtils", function() { return StringUtils; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var StringUtils = /** @class */ (function () {
    function StringUtils() {
    }
    /**
     * Check if a string is empty
     *
     * @param str
     */
    StringUtils.isEmpty = function (str) {
        return (typeof str === "undefined" || !str || 0 === str.length);
    };
    /**
     * Check if a string's value is a valid JSON object
     *
     * @param str
     */
    StringUtils.validateAndParseJsonCacheKey = function (str) {
        try {
            var parsedKey = JSON.parse(str);
            /**
             * There are edge cases in which JSON.parse will successfully parse a non-valid JSON object
             * (e.g. JSON.parse will parse an escaped string into an unescaped string), so adding a type check
             * of the parsed value is necessary in order to be certain that the string represents a valid JSON object.
             *
             */
            return (parsedKey && typeof parsedKey === "object") ? parsedKey : null;
        }
        catch (error) {
            return null;
        }
    };
    return StringUtils;
}());

//# sourceMappingURL=StringUtils.js.map

/***/ }),

/***/ "UrvO":
/*!************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/error/AuthError.js ***!
  \************************************************************************************************/
/*! exports provided: AuthErrorMessage, AuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthErrorMessage", function() { return AuthErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthError", function() { return AuthError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */

var AuthErrorMessage = {
    unexpectedError: {
        code: "unexpected_error",
        desc: "Unexpected error in authentication."
    },
    noWindowObjectError: {
        code: "no_window_object",
        desc: "No window object available. Details:"
    }
};
/**
 * General error class thrown by the MSAL.js library.
 */
var AuthError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AuthError, _super);
    function AuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorMessage) || this;
        Object.setPrototypeOf(_this, AuthError.prototype);
        _this.errorCode = errorCode;
        _this.errorMessage = errorMessage;
        _this.name = "AuthError";
        return _this;
    }
    AuthError.createUnexpectedError = function (errDesc) {
        return new AuthError(AuthErrorMessage.unexpectedError.code, AuthErrorMessage.unexpectedError.desc + ": " + errDesc);
    };
    AuthError.createNoWindowObjectError = function (errDesc) {
        return new AuthError(AuthErrorMessage.noWindowObjectError.code, AuthErrorMessage.noWindowObjectError.desc + " " + errDesc);
    };
    return AuthError;
}(Error));

//# sourceMappingURL=AuthError.js.map

/***/ }),

/***/ "VZ59":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-login/strings.js ***!
  \*****************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    signInLinkSubtitle: 'Sign In',
    signOutLinkSubtitle: 'Sign Out'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "Va2N":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-teams-channel-picker/mgt-teams-channel-picker.graph.js ***!
  \*******************************************************************************************************************************/
/*! exports provided: getAllMyTeams */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getAllMyTeams", function() { return getAllMyTeams; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

/**
 * async promise, returns all Teams associated with the user logged in
 *
 * @returns {Promise<Team[]>}
 * @memberof Graph
 */
function getAllMyTeams(graph) {
    return __awaiter(this, void 0, void 0, function* () {
        const teams = yield graph
            .api('/me/joinedTeams')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('User.Read.All'))
            .select(['displayName', 'id', 'isArchived'])
            .get();
        return teams ? teams.value : null;
    });
}
//# sourceMappingURL=mgt-teams-channel-picker.graph.js.map

/***/ }),

/***/ "Vb7E":
/*!************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/GraphErrorHandler.js ***!
  \************************************************************************************/
/*! exports provided: GraphErrorHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphErrorHandler", function() { return GraphErrorHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _GraphError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GraphError */ "FgoX");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @module GraphErrorHandler
 */

/**
 * @class
 * Class for GraphErrorHandler
 */
class GraphErrorHandler {
    /**
     * @private
     * @static
     * Populates the GraphError instance with Error instance values
     * @param {Error} error - The error returned by graph service or some native error
     * @param {number} [statusCode] - The status code of the response
     * @returns The GraphError instance
     */
    static constructError(error, statusCode) {
        const gError = new _GraphError__WEBPACK_IMPORTED_MODULE_1__["GraphError"](statusCode, "", error);
        if (error.name !== undefined) {
            gError.code = error.name;
        }
        gError.body = error.toString();
        gError.date = new Date();
        return gError;
    }
    /**
     * @private
     * @static
     * @async
     * Populates the GraphError instance from the Error returned by graph service
     * @param {any} error - The error returned by graph service or some native error
     * @param {number} statusCode - The status code of the response
     * @returns A promise that resolves to GraphError instance
     *
     * Example error for https://graph.microsoft.com/v1.0/me/events?$top=3&$search=foo
     * {
     *      "error": {
     *          "code": "SearchEvents",
     *          "message": "The parameter $search is not currently supported on the Events resource.",
     *          "innerError": {
     *              "request-id": "b31c83fd-944c-4663-aa50-5d9ceb367e19",
     *              "date": "2016-11-17T18:37:45"
     *          }
     *      }
     *  }
     */
    static constructErrorFromResponse(error, statusCode) {
        error = error.error;
        const gError = new _GraphError__WEBPACK_IMPORTED_MODULE_1__["GraphError"](statusCode, error.message);
        gError.code = error.code;
        if (error.innerError !== undefined) {
            gError.requestId = error.innerError["request-id"];
            gError.date = new Date(error.innerError.date);
        }
        try {
            gError.body = JSON.stringify(error);
        }
        catch (error) {
            // tslint:disable-line: no-empty
        }
        return gError;
    }
    /**
     * @public
     * @static
     * @async
     * To get the GraphError object
     * @param {any} [error = null] - The error returned by graph service or some native error
     * @param {number} [statusCode = -1] - The status code of the response
     * @param {GraphRequestCallback} [callback] - The graph request callback function
     * @returns A promise that resolves to GraphError instance
     */
    static getError(error = null, statusCode = -1, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            let gError;
            if (error && error.error) {
                gError = GraphErrorHandler.constructErrorFromResponse(error, statusCode);
            }
            else if (typeof Error !== "undefined" && error instanceof Error) {
                gError = GraphErrorHandler.constructError(error, statusCode);
            }
            else {
                gError = new _GraphError__WEBPACK_IMPORTED_MODULE_1__["GraphError"](statusCode);
            }
            if (typeof callback === "function") {
                callback(gError, null);
            }
            else {
                return gError;
            }
        });
    }
}
//# sourceMappingURL=GraphErrorHandler.js.map

/***/ }),

/***/ "Viiq":
/*!*****************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/providers/Providers.js ***!
  \*****************************************************************************/
/*! exports provided: Providers, ProvidersChangedState */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Providers", function() { return Providers; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ProvidersChangedState", function() { return ProvidersChangedState; });
/* harmony import */ var _utils_EventDispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/EventDispatcher */ "kDYw");
/* harmony import */ var _IProvider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./IProvider */ "DmZw");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


/**
 * Provides implementation for acquiring the necessary access token for calling the Microsoft Graph APIs.
 *
 * @export
 * @class Providers
 */
class Providers {
    /**
     * returns the value of provider used globally. All components use this property to get a reference to the provider.
     *
     * @static
     * @type {IProvider}
     * @memberof Providers
     */
    static get globalProvider() {
        return this._globalProvider;
    }
    static set globalProvider(provider) {
        if (provider !== this._globalProvider) {
            if (this._globalProvider) {
                this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged);
            }
            if (provider) {
                provider.onStateChanged(this.handleProviderStateChanged);
            }
            this._globalProvider = provider;
            this._eventDispatcher.fire(ProvidersChangedState.ProviderChanged);
        }
    }
    /**
     * Fires event when Provider changes state
     *
     * @static
     * @param {EventHandler<ProvidersChangedState>} event
     * @memberof Providers
     */
    static onProviderUpdated(event) {
        this._eventDispatcher.add(event);
    }
    /**
     * Remove event handler
     *
     * @static
     * @param {EventHandler<ProvidersChangedState>} event
     * @memberof Providers
     */
    static removeProviderUpdatedListener(event) {
        this._eventDispatcher.remove(event);
    }
    /**
     * Gets the current signed in user
     *
     * @static
     * @memberof Providers
     */
    static me() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this._me) {
                const client = this.client;
                if (client) {
                    try {
                        const response = yield client.api('me').get();
                        if (response && response.id) {
                            this._me = response;
                        }
                    }
                    catch (_a) { }
                }
            }
            return this._me;
        });
    }
    /**
     * Gets the current graph client
     *
     * @readonly
     * @static
     * @type {Client}
     * @memberof Providers
     */
    static get client() {
        if (Providers.globalProvider && Providers.globalProvider.state === _IProvider__WEBPACK_IMPORTED_MODULE_1__["ProviderState"].SignedIn) {
            return Providers.globalProvider.graph.client;
        }
        return null;
    }
    static handleProviderStateChanged() {
        if (!Providers.globalProvider || Providers.globalProvider.state !== _IProvider__WEBPACK_IMPORTED_MODULE_1__["ProviderState"].SignedIn) {
            // clear current signed in user info
            Providers._me = null;
        }
        Providers._eventDispatcher.fire(ProvidersChangedState.ProviderStateChanged);
    }
}
Providers._eventDispatcher = new _utils_EventDispatcher__WEBPACK_IMPORTED_MODULE_0__["EventDispatcher"]();
/**
 * on Provider Change State
 *
 * @export
 * @enum {number}
 */
var ProvidersChangedState;
(function (ProvidersChangedState) {
    /**
     * ProviderChanged = 0
     */
    ProvidersChangedState[ProvidersChangedState["ProviderChanged"] = 0] = "ProviderChanged";
    /**
     * ProviderStateChanged = 1
     */
    ProvidersChangedState[ProvidersChangedState["ProviderStateChanged"] = 1] = "ProviderStateChanged";
})(ProvidersChangedState || (ProvidersChangedState = {}));
//# sourceMappingURL=Providers.js.map

/***/ }),

/***/ "WEFG":
/*!***************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/AuthenticationHandler.js ***!
  \***************************************************************************************************************************************/
/*! exports provided: AuthenticationHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthenticationHandler", function() { return AuthenticationHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MiddlewareControl */ "ocZF");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MiddlewareUtil */ "kM4i");
/* harmony import */ var _options_AuthenticationHandlerOptions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./options/AuthenticationHandlerOptions */ "QoAq");
/* harmony import */ var _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./options/TelemetryHandlerOptions */ "Rgfv");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */





/**
 * @class
 * @implements Middleware
 * Class representing AuthenticationHandler
 */
class AuthenticationHandler {
    /**
     * @public
     * @constructor
     * Creates an instance of AuthenticationHandler
     * @param {AuthenticationProvider} authenticationProvider - The authentication provider for the authentication handler
     */
    constructor(authenticationProvider) {
        this.authenticationProvider = authenticationProvider;
    }
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                let options;
                if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_1__["MiddlewareControl"]) {
                    options = context.middlewareControl.getMiddlewareOptions(_options_AuthenticationHandlerOptions__WEBPACK_IMPORTED_MODULE_3__["AuthenticationHandlerOptions"]);
                }
                let authenticationProvider;
                let authenticationProviderOptions;
                if (typeof options !== "undefined") {
                    authenticationProvider = options.authenticationProvider;
                    authenticationProviderOptions = options.authenticationProviderOptions;
                }
                if (typeof authenticationProvider === "undefined") {
                    authenticationProvider = this.authenticationProvider;
                }
                const token = yield authenticationProvider.getAccessToken(authenticationProviderOptions);
                const bearerKey = `Bearer ${token}`;
                Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_2__["appendRequestHeader"])(context.request, context.options, AuthenticationHandler.AUTHORIZATION_HEADER, bearerKey);
                _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["TelemetryHandlerOptions"].updateFeatureUsageFlag(context, _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["FeatureUsageFlag"].AUTHENTICATION_HANDLER_ENABLED);
                return yield this.nextMiddleware.execute(context);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
/**
 * @private
 * A member representing the authorization header name
 */
AuthenticationHandler.AUTHORIZATION_HEADER = "Authorization";
//# sourceMappingURL=AuthenticationHandler.js.map

/***/ }),

/***/ "WJ2Y":
/*!***************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/ChaosStrategy.js ***!
  \***************************************************************************************************************************************/
/*! exports provided: ChaosStrategy */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChaosStrategy", function() { return ChaosStrategy; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module ChaosStrategy
 */
/**
 * Strategy used for Testing Handler
 * @enum
 */
var ChaosStrategy;
(function (ChaosStrategy) {
    ChaosStrategy[ChaosStrategy["MANUAL"] = 0] = "MANUAL";
    ChaosStrategy[ChaosStrategy["RANDOM"] = 1] = "RANDOM";
})(ChaosStrategy || (ChaosStrategy = {}));
//# sourceMappingURL=ChaosStrategy.js.map

/***/ }),

/***/ "WOkV":
/*!***************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/Graph.js ***!
  \***************************************************************/
/*! exports provided: Graph, createFromProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Graph", function() { return Graph; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createFromProvider", function() { return createFromProvider; });
/* harmony import */ var _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/microsoft-graph-client */ "9F8r");
/* harmony import */ var _utils_Batch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Batch */ "3GTD");
/* harmony import */ var _utils_ComponentMiddlewareOptions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/ComponentMiddlewareOptions */ "nz8i");
/* harmony import */ var _utils_GraphHelpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/GraphHelpers */ "yLtT");
/* harmony import */ var _utils_SdkVersionMiddleware__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils/SdkVersionMiddleware */ "ZiRd");
/* harmony import */ var _utils_version__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils/version */ "YdX3");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */






/**
 * The version of the Graph to use for making requests.
 */
const GRAPH_VERSION = 'v1.0';
/**
 * The base Graph implementation.
 *
 * @export
 * @abstract
 * @class Graph
 */
class Graph {
    constructor(client, version = GRAPH_VERSION) {
        this._client = client;
        this._version = version;
    }
    /**
     * the internal client used to make graph calls
     *
     * @readonly
     * @type {Client}
     * @memberof Graph
     */
    get client() {
        return this._client;
    }
    /**
     * the component name appended to Graph request headers
     *
     * @readonly
     * @type {string}
     * @memberof Graph
     */
    get componentName() {
        return this._componentName;
    }
    /**
     * the version of the graph to query
     *
     * @readonly
     * @type {string}
     * @memberof Graph
     */
    get version() {
        return this._version;
    }
    /**
     * Returns a new instance of the Graph using the same
     * client within the context of the provider.
     *
     * @param {Element} component
     * @returns {IGraph}
     * @memberof Graph
     */
    forComponent(component) {
        const graph = new Graph(this._client, this._version);
        graph.setComponent(component);
        return graph;
    }
    /**
     * Returns a new graph request for a specific component
     * Used internally for analytics purposes
     *
     * @param {string} path
     * @memberof Graph
     */
    api(path) {
        let request = this._client.api(path).version(this._version);
        if (this._componentName) {
            request.middlewareOptions = (options) => {
                const requestObj = request;
                requestObj._middlewareOptions = requestObj._middlewareOptions.concat(options);
                return request;
            };
            request = request.middlewareOptions([new _utils_ComponentMiddlewareOptions__WEBPACK_IMPORTED_MODULE_2__["ComponentMiddlewareOptions"](this._componentName)]);
        }
        return request;
    }
    /**
     * creates a new batch request
     *
     * @returns {Batch}
     * @memberof Graph
     */
    createBatch() {
        return new _utils_Batch__WEBPACK_IMPORTED_MODULE_1__["Batch"](this);
    }
    /**
     * sets the component name used in request headers.
     *
     * @protected
     * @param {Element} component
     * @memberof Graph
     */
    setComponent(component) {
        this._componentName = component instanceof Element ? component.tagName : component;
    }
}
/**
 * create a new Graph instance using the specified provider.
 *
 * @static
 * @param {IProvider} provider
 * @returns {Graph}
 * @memberof Graph
 */
function createFromProvider(provider, version, component) {
    const middleware = [
        new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["AuthenticationHandler"](provider),
        new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["RetryHandler"](new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["RetryHandlerOptions"]()),
        new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["TelemetryHandler"](),
        new _utils_SdkVersionMiddleware__WEBPACK_IMPORTED_MODULE_4__["SdkVersionMiddleware"](_utils_version__WEBPACK_IMPORTED_MODULE_5__["PACKAGE_VERSION"]),
        new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["HTTPMessageHandler"]()
    ];
    const client = _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["Client"].initWithMiddleware({
        middleware: Object(_utils_GraphHelpers__WEBPACK_IMPORTED_MODULE_3__["chainMiddleware"])(...middleware)
    });
    const graph = new Graph(client, version);
    return component ? graph.forComponent(component) : graph;
}
//# sourceMappingURL=Graph.js.map

/***/ }),

/***/ "X0kX":
/*!******************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-messages/mgt-person-card-messages-css.js ***!
  \******************************************************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--color,#000);font-size:16px}:host .root .message .message__detail .message__from{font-size:12px;color:var(--color-sub1,#323130)}:host .root .message .message__detail .message__message{font-size:12px;color:var(--color-sub2,#797775)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{font-size:12px;color:var(--color-sub2,#797775);margin-left:10px;white-space:nowrap}
`
];
//# sourceMappingURL=mgt-person-card-messages-css.js.map

/***/ }),

/***/ "XG4p":
/*!*********************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/index.js ***!
  \*********************************************************************/
/*! exports provided: delay */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "delay", function() { return delay; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * returns a promise that resolves after specified time
 * @param time in milliseconds
 */
function delay(ms) {
    return new Promise(resolve => {
        setTimeout(resolve, ms);
    });
}
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "XI78":
/*!********************************************!*\
  !*** ./node_modules/lit-html/lib/parts.js ***!
  \********************************************/
/*! exports provided: isPrimitive, isIterable, AttributeCommitter, AttributePart, NodePart, BooleanAttributePart, PropertyCommitter, PropertyPart, EventPart */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isPrimitive", function() { return isPrimitive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isIterable", function() { return isIterable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AttributeCommitter", function() { return AttributeCommitter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AttributePart", function() { return AttributePart; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NodePart", function() { return NodePart; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BooleanAttributePart", function() { return BooleanAttributePart; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PropertyCommitter", function() { return PropertyCommitter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PropertyPart", function() { return PropertyPart; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventPart", function() { return EventPart; });
/* harmony import */ var _directive_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./directive.js */ "eByC");
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom.js */ "tFPJ");
/* harmony import */ var _part_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./part.js */ "1VLE");
/* harmony import */ var _template_instance_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./template-instance.js */ "6unr");
/* harmony import */ var _template_result_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./template-result.js */ "GMCd");
/* harmony import */ var _template_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./template.js */ "4yuk");
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */






const isPrimitive = (value) => {
    return (value === null ||
        !(typeof value === 'object' || typeof value === 'function'));
};
const isIterable = (value) => {
    return Array.isArray(value) ||
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        !!(value && value[Symbol.iterator]);
};
/**
 * Writes attribute values to the DOM for a group of AttributeParts bound to a
 * single attribute. The value is only set once even if there are multiple parts
 * for an attribute.
 */
class AttributeCommitter {
    constructor(element, name, strings) {
        this.dirty = true;
        this.element = element;
        this.name = name;
        this.strings = strings;
        this.parts = [];
        for (let i = 0; i < strings.length - 1; i++) {
            this.parts[i] = this._createPart();
        }
    }
    /**
     * Creates a single part. Override this to create a differnt type of part.
     */
    _createPart() {
        return new AttributePart(this);
    }
    _getValue() {
        const strings = this.strings;
        const l = strings.length - 1;
        const parts = this.parts;
        // If we're assigning an attribute via syntax like:
        //    attr="${foo}"  or  attr=${foo}
        // but not
        //    attr="${foo} ${bar}" or attr="${foo} baz"
        // then we don't want to coerce the attribute value into one long
        // string. Instead we want to just return the value itself directly,
        // so that sanitizeDOMValue can get the actual value rather than
        // String(value)
        // The exception is if v is an array, in which case we do want to smash
        // it together into a string without calling String() on the array.
        //
        // This also allows trusted values (when using TrustedTypes) being
        // assigned to DOM sinks without being stringified in the process.
        if (l === 1 && strings[0] === '' && strings[1] === '') {
            const v = parts[0].value;
            if (typeof v === 'symbol') {
                return String(v);
            }
            if (typeof v === 'string' || !isIterable(v)) {
                return v;
            }
        }
        let text = '';
        for (let i = 0; i < l; i++) {
            text += strings[i];
            const part = parts[i];
            if (part !== undefined) {
                const v = part.value;
                if (isPrimitive(v) || !isIterable(v)) {
                    text += typeof v === 'string' ? v : String(v);
                }
                else {
                    for (const t of v) {
                        text += typeof t === 'string' ? t : String(t);
                    }
                }
            }
        }
        text += strings[l];
        return text;
    }
    commit() {
        if (this.dirty) {
            this.dirty = false;
            this.element.setAttribute(this.name, this._getValue());
        }
    }
}
/**
 * A Part that controls all or part of an attribute value.
 */
class AttributePart {
    constructor(committer) {
        this.value = undefined;
        this.committer = committer;
    }
    setValue(value) {
        if (value !== _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"] && (!isPrimitive(value) || value !== this.value)) {
            this.value = value;
            // If the value is a not a directive, dirty the committer so that it'll
            // call setAttribute. If the value is a directive, it'll dirty the
            // committer if it calls setValue().
            if (!Object(_directive_js__WEBPACK_IMPORTED_MODULE_0__["isDirective"])(value)) {
                this.committer.dirty = true;
            }
        }
    }
    commit() {
        while (Object(_directive_js__WEBPACK_IMPORTED_MODULE_0__["isDirective"])(this.value)) {
            const directive = this.value;
            this.value = _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"];
            directive(this);
        }
        if (this.value === _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"]) {
            return;
        }
        this.committer.commit();
    }
}
/**
 * A Part that controls a location within a Node tree. Like a Range, NodePart
 * has start and end locations and can set and update the Nodes between those
 * locations.
 *
 * NodeParts support several value types: primitives, Nodes, TemplateResults,
 * as well as arrays and iterables of those types.
 */
class NodePart {
    constructor(options) {
        this.value = undefined;
        this.__pendingValue = undefined;
        this.options = options;
    }
    /**
     * Appends this part into a container.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    appendInto(container) {
        this.startNode = container.appendChild(Object(_template_js__WEBPACK_IMPORTED_MODULE_5__["createMarker"])());
        this.endNode = container.appendChild(Object(_template_js__WEBPACK_IMPORTED_MODULE_5__["createMarker"])());
    }
    /**
     * Inserts this part after the `ref` node (between `ref` and `ref`'s next
     * sibling). Both `ref` and its next sibling must be static, unchanging nodes
     * such as those that appear in a literal section of a template.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    insertAfterNode(ref) {
        this.startNode = ref;
        this.endNode = ref.nextSibling;
    }
    /**
     * Appends this part into a parent part.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    appendIntoPart(part) {
        part.__insert(this.startNode = Object(_template_js__WEBPACK_IMPORTED_MODULE_5__["createMarker"])());
        part.__insert(this.endNode = Object(_template_js__WEBPACK_IMPORTED_MODULE_5__["createMarker"])());
    }
    /**
     * Inserts this part after the `ref` part.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    insertAfterPart(ref) {
        ref.__insert(this.startNode = Object(_template_js__WEBPACK_IMPORTED_MODULE_5__["createMarker"])());
        this.endNode = ref.endNode;
        ref.endNode = this.startNode;
    }
    setValue(value) {
        this.__pendingValue = value;
    }
    commit() {
        if (this.startNode.parentNode === null) {
            return;
        }
        while (Object(_directive_js__WEBPACK_IMPORTED_MODULE_0__["isDirective"])(this.__pendingValue)) {
            const directive = this.__pendingValue;
            this.__pendingValue = _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"];
            directive(this);
        }
        const value = this.__pendingValue;
        if (value === _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"]) {
            return;
        }
        if (isPrimitive(value)) {
            if (value !== this.value) {
                this.__commitText(value);
            }
        }
        else if (value instanceof _template_result_js__WEBPACK_IMPORTED_MODULE_4__["TemplateResult"]) {
            this.__commitTemplateResult(value);
        }
        else if (value instanceof Node) {
            this.__commitNode(value);
        }
        else if (isIterable(value)) {
            this.__commitIterable(value);
        }
        else if (value === _part_js__WEBPACK_IMPORTED_MODULE_2__["nothing"]) {
            this.value = _part_js__WEBPACK_IMPORTED_MODULE_2__["nothing"];
            this.clear();
        }
        else {
            // Fallback, will render the string representation
            this.__commitText(value);
        }
    }
    __insert(node) {
        this.endNode.parentNode.insertBefore(node, this.endNode);
    }
    __commitNode(value) {
        if (this.value === value) {
            return;
        }
        this.clear();
        this.__insert(value);
        this.value = value;
    }
    __commitText(value) {
        const node = this.startNode.nextSibling;
        value = value == null ? '' : value;
        // If `value` isn't already a string, we explicitly convert it here in case
        // it can't be implicitly converted - i.e. it's a symbol.
        const valueAsString = typeof value === 'string' ? value : String(value);
        if (node === this.endNode.previousSibling &&
            node.nodeType === 3 /* Node.TEXT_NODE */) {
            // If we only have a single text node between the markers, we can just
            // set its value, rather than replacing it.
            // TODO(justinfagnani): Can we just check if this.value is primitive?
            node.data = valueAsString;
        }
        else {
            this.__commitNode(document.createTextNode(valueAsString));
        }
        this.value = value;
    }
    __commitTemplateResult(value) {
        const template = this.options.templateFactory(value);
        if (this.value instanceof _template_instance_js__WEBPACK_IMPORTED_MODULE_3__["TemplateInstance"] &&
            this.value.template === template) {
            this.value.update(value.values);
        }
        else {
            // Make sure we propagate the template processor from the TemplateResult
            // so that we use its syntax extension, etc. The template factory comes
            // from the render function options so that it can control template
            // caching and preprocessing.
            const instance = new _template_instance_js__WEBPACK_IMPORTED_MODULE_3__["TemplateInstance"](template, value.processor, this.options);
            const fragment = instance._clone();
            instance.update(value.values);
            this.__commitNode(fragment);
            this.value = instance;
        }
    }
    __commitIterable(value) {
        // For an Iterable, we create a new InstancePart per item, then set its
        // value to the item. This is a little bit of overhead for every item in
        // an Iterable, but it lets us recurse easily and efficiently update Arrays
        // of TemplateResults that will be commonly returned from expressions like:
        // array.map((i) => html`${i}`), by reusing existing TemplateInstances.
        // If _value is an array, then the previous render was of an
        // iterable and _value will contain the NodeParts from the previous
        // render. If _value is not an array, clear this part and make a new
        // array for NodeParts.
        if (!Array.isArray(this.value)) {
            this.value = [];
            this.clear();
        }
        // Lets us keep track of how many items we stamped so we can clear leftover
        // items from a previous render
        const itemParts = this.value;
        let partIndex = 0;
        let itemPart;
        for (const item of value) {
            // Try to reuse an existing part
            itemPart = itemParts[partIndex];
            // If no existing part, create a new one
            if (itemPart === undefined) {
                itemPart = new NodePart(this.options);
                itemParts.push(itemPart);
                if (partIndex === 0) {
                    itemPart.appendIntoPart(this);
                }
                else {
                    itemPart.insertAfterPart(itemParts[partIndex - 1]);
                }
            }
            itemPart.setValue(item);
            itemPart.commit();
            partIndex++;
        }
        if (partIndex < itemParts.length) {
            // Truncate the parts array so _value reflects the current state
            itemParts.length = partIndex;
            this.clear(itemPart && itemPart.endNode);
        }
    }
    clear(startNode = this.startNode) {
        Object(_dom_js__WEBPACK_IMPORTED_MODULE_1__["removeNodes"])(this.startNode.parentNode, startNode.nextSibling, this.endNode);
    }
}
/**
 * Implements a boolean attribute, roughly as defined in the HTML
 * specification.
 *
 * If the value is truthy, then the attribute is present with a value of
 * ''. If the value is falsey, the attribute is removed.
 */
class BooleanAttributePart {
    constructor(element, name, strings) {
        this.value = undefined;
        this.__pendingValue = undefined;
        if (strings.length !== 2 || strings[0] !== '' || strings[1] !== '') {
            throw new Error('Boolean attributes can only contain a single expression');
        }
        this.element = element;
        this.name = name;
        this.strings = strings;
    }
    setValue(value) {
        this.__pendingValue = value;
    }
    commit() {
        while (Object(_directive_js__WEBPACK_IMPORTED_MODULE_0__["isDirective"])(this.__pendingValue)) {
            const directive = this.__pendingValue;
            this.__pendingValue = _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"];
            directive(this);
        }
        if (this.__pendingValue === _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"]) {
            return;
        }
        const value = !!this.__pendingValue;
        if (this.value !== value) {
            if (value) {
                this.element.setAttribute(this.name, '');
            }
            else {
                this.element.removeAttribute(this.name);
            }
            this.value = value;
        }
        this.__pendingValue = _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"];
    }
}
/**
 * Sets attribute values for PropertyParts, so that the value is only set once
 * even if there are multiple parts for a property.
 *
 * If an expression controls the whole property value, then the value is simply
 * assigned to the property under control. If there are string literals or
 * multiple expressions, then the strings are expressions are interpolated into
 * a string first.
 */
class PropertyCommitter extends AttributeCommitter {
    constructor(element, name, strings) {
        super(element, name, strings);
        this.single =
            (strings.length === 2 && strings[0] === '' && strings[1] === '');
    }
    _createPart() {
        return new PropertyPart(this);
    }
    _getValue() {
        if (this.single) {
            return this.parts[0].value;
        }
        return super._getValue();
    }
    commit() {
        if (this.dirty) {
            this.dirty = false;
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            this.element[this.name] = this._getValue();
        }
    }
}
class PropertyPart extends AttributePart {
}
// Detect event listener options support. If the `capture` property is read
// from the options object, then options are supported. If not, then the third
// argument to add/removeEventListener is interpreted as the boolean capture
// value so we should only pass the `capture` property.
let eventOptionsSupported = false;
// Wrap into an IIFE because MS Edge <= v41 does not support having try/catch
// blocks right into the body of a module
(() => {
    try {
        const options = {
            get capture() {
                eventOptionsSupported = true;
                return false;
            }
        };
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        window.addEventListener('test', options, options);
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        window.removeEventListener('test', options, options);
    }
    catch (_e) {
        // event options not supported
    }
})();
class EventPart {
    constructor(element, eventName, eventContext) {
        this.value = undefined;
        this.__pendingValue = undefined;
        this.element = element;
        this.eventName = eventName;
        this.eventContext = eventContext;
        this.__boundHandleEvent = (e) => this.handleEvent(e);
    }
    setValue(value) {
        this.__pendingValue = value;
    }
    commit() {
        while (Object(_directive_js__WEBPACK_IMPORTED_MODULE_0__["isDirective"])(this.__pendingValue)) {
            const directive = this.__pendingValue;
            this.__pendingValue = _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"];
            directive(this);
        }
        if (this.__pendingValue === _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"]) {
            return;
        }
        const newListener = this.__pendingValue;
        const oldListener = this.value;
        const shouldRemoveListener = newListener == null ||
            oldListener != null &&
                (newListener.capture !== oldListener.capture ||
                    newListener.once !== oldListener.once ||
                    newListener.passive !== oldListener.passive);
        const shouldAddListener = newListener != null && (oldListener == null || shouldRemoveListener);
        if (shouldRemoveListener) {
            this.element.removeEventListener(this.eventName, this.__boundHandleEvent, this.__options);
        }
        if (shouldAddListener) {
            this.__options = getOptions(newListener);
            this.element.addEventListener(this.eventName, this.__boundHandleEvent, this.__options);
        }
        this.value = newListener;
        this.__pendingValue = _part_js__WEBPACK_IMPORTED_MODULE_2__["noChange"];
    }
    handleEvent(event) {
        if (typeof this.value === 'function') {
            this.value.call(this.eventContext || this.element, event);
        }
        else {
            this.value.handleEvent(event);
        }
    }
}
// We copy options because of the inconsistent behavior of browsers when reading
// the third argument of add/removeEventListener. IE11 doesn't support options
// at all. Chrome 41 only reads `capture` if the argument is an object.
const getOptions = (o) => o &&
    (eventOptionsSupported ?
        { capture: o.capture, passive: o.passive, once: o.once } :
        o.capture);
//# sourceMappingURL=parts.js.map

/***/ }),

/***/ "XZ4c":
/*!************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/index.js ***!
  \************************************************************************/
/*! exports provided: BatchRequestContent, BatchResponseContent, AuthenticationHandler, HTTPMessageHandler, RetryHandler, RedirectHandler, TelemetryHandler, MiddlewareFactory, AuthenticationHandlerOptions, RetryHandlerOptions, RedirectHandlerOptions, FeatureUsageFlag, TelemetryHandlerOptions, ChaosHandlerOptions, ChaosStrategy, ChaosHandler, LargeFileUploadTask, OneDriveLargeFileUploadTask, PageIterator, Client, CustomAuthenticationProvider, GraphError, GraphRequest, ImplicitMSALAuthenticationProvider, MSALAuthenticationProviderOptions, ResponseType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _content_BatchRequestContent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./content/BatchRequestContent */ "cXbq");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchRequestContent", function() { return _content_BatchRequestContent__WEBPACK_IMPORTED_MODULE_0__["BatchRequestContent"]; });

/* harmony import */ var _content_BatchResponseContent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./content/BatchResponseContent */ "pkRw");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchResponseContent", function() { return _content_BatchResponseContent__WEBPACK_IMPORTED_MODULE_1__["BatchResponseContent"]; });

/* harmony import */ var _middleware_AuthenticationHandler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./middleware/AuthenticationHandler */ "RsRP");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AuthenticationHandler", function() { return _middleware_AuthenticationHandler__WEBPACK_IMPORTED_MODULE_2__["AuthenticationHandler"]; });

/* harmony import */ var _middleware_HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./middleware/HTTPMessageHandler */ "nWAj");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HTTPMessageHandler", function() { return _middleware_HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_3__["HTTPMessageHandler"]; });

/* harmony import */ var _middleware_RetryHandler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./middleware/RetryHandler */ "Rtth");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RetryHandler", function() { return _middleware_RetryHandler__WEBPACK_IMPORTED_MODULE_4__["RetryHandler"]; });

/* harmony import */ var _middleware_RedirectHandler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./middleware/RedirectHandler */ "k/fM");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RedirectHandler", function() { return _middleware_RedirectHandler__WEBPACK_IMPORTED_MODULE_5__["RedirectHandler"]; });

/* harmony import */ var _middleware_TelemetryHandler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./middleware/TelemetryHandler */ "FGIY");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TelemetryHandler", function() { return _middleware_TelemetryHandler__WEBPACK_IMPORTED_MODULE_6__["TelemetryHandler"]; });

/* harmony import */ var _middleware_MiddlewareFactory__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./middleware/MiddlewareFactory */ "xCGj");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MiddlewareFactory", function() { return _middleware_MiddlewareFactory__WEBPACK_IMPORTED_MODULE_7__["MiddlewareFactory"]; });

/* harmony import */ var _middleware_options_AuthenticationHandlerOptions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./middleware/options/AuthenticationHandlerOptions */ "jMoM");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AuthenticationHandlerOptions", function() { return _middleware_options_AuthenticationHandlerOptions__WEBPACK_IMPORTED_MODULE_8__["AuthenticationHandlerOptions"]; });

/* harmony import */ var _middleware_options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./middleware/options/RetryHandlerOptions */ "q5Kr");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RetryHandlerOptions", function() { return _middleware_options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_9__["RetryHandlerOptions"]; });

/* harmony import */ var _middleware_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./middleware/options/RedirectHandlerOptions */ "FDgl");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RedirectHandlerOptions", function() { return _middleware_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_10__["RedirectHandlerOptions"]; });

/* harmony import */ var _middleware_options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./middleware/options/TelemetryHandlerOptions */ "x9B3");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FeatureUsageFlag", function() { return _middleware_options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_11__["FeatureUsageFlag"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TelemetryHandlerOptions", function() { return _middleware_options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_11__["TelemetryHandlerOptions"]; });

/* harmony import */ var _middleware_options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./middleware/options/ChaosHandlerOptions */ "DOGG");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ChaosHandlerOptions", function() { return _middleware_options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_12__["ChaosHandlerOptions"]; });

/* harmony import */ var _middleware_options_ChaosStrategy__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./middleware/options/ChaosStrategy */ "nT0M");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ChaosStrategy", function() { return _middleware_options_ChaosStrategy__WEBPACK_IMPORTED_MODULE_13__["ChaosStrategy"]; });

/* harmony import */ var _middleware_ChaosHandler__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./middleware/ChaosHandler */ "u6ad");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ChaosHandler", function() { return _middleware_ChaosHandler__WEBPACK_IMPORTED_MODULE_14__["ChaosHandler"]; });

/* harmony import */ var _tasks_LargeFileUploadTask__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./tasks/LargeFileUploadTask */ "P6yO");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LargeFileUploadTask", function() { return _tasks_LargeFileUploadTask__WEBPACK_IMPORTED_MODULE_15__["LargeFileUploadTask"]; });

/* harmony import */ var _tasks_OneDriveLargeFileUploadTask__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./tasks/OneDriveLargeFileUploadTask */ "68J5");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OneDriveLargeFileUploadTask", function() { return _tasks_OneDriveLargeFileUploadTask__WEBPACK_IMPORTED_MODULE_16__["OneDriveLargeFileUploadTask"]; });

/* harmony import */ var _tasks_PageIterator__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./tasks/PageIterator */ "LG2h");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PageIterator", function() { return _tasks_PageIterator__WEBPACK_IMPORTED_MODULE_17__["PageIterator"]; });

/* harmony import */ var _Client__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Client */ "D39h");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Client", function() { return _Client__WEBPACK_IMPORTED_MODULE_18__["Client"]; });

/* harmony import */ var _CustomAuthenticationProvider__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./CustomAuthenticationProvider */ "SdJ9");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CustomAuthenticationProvider", function() { return _CustomAuthenticationProvider__WEBPACK_IMPORTED_MODULE_19__["CustomAuthenticationProvider"]; });

/* harmony import */ var _GraphError__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./GraphError */ "FgoX");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GraphError", function() { return _GraphError__WEBPACK_IMPORTED_MODULE_20__["GraphError"]; });

/* harmony import */ var _GraphRequest__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./GraphRequest */ "tIC7");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GraphRequest", function() { return _GraphRequest__WEBPACK_IMPORTED_MODULE_21__["GraphRequest"]; });

/* harmony import */ var _ImplicitMSALAuthenticationProvider__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./ImplicitMSALAuthenticationProvider */ "dh3g");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImplicitMSALAuthenticationProvider", function() { return _ImplicitMSALAuthenticationProvider__WEBPACK_IMPORTED_MODULE_22__["ImplicitMSALAuthenticationProvider"]; });

/* harmony import */ var _MSALAuthenticationProviderOptions__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./MSALAuthenticationProviderOptions */ "TXhN");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MSALAuthenticationProviderOptions", function() { return _MSALAuthenticationProviderOptions__WEBPACK_IMPORTED_MODULE_23__["MSALAuthenticationProviderOptions"]; });

/* harmony import */ var _ResponseType__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./ResponseType */ "G+40");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResponseType", function() { return _ResponseType__WEBPACK_IMPORTED_MODULE_24__["ResponseType"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

























//# sourceMappingURL=index.js.map

/***/ }),

/***/ "Xol0":
/*!****************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/IBatch.js ***!
  \****************************************************************/
/*! exports provided: BatchResponse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchResponse", function() { return BatchResponse; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * Represents a response from a request executed in a batch
 *
 * @export
 * @class BatchResponse
 */
// tslint:disable-next-line:max-classes-per-file
class BatchResponse {
}
//# sourceMappingURL=IBatch.js.map

/***/ }),

/***/ "XyBC":
/*!********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/styles/style-helper.js ***!
  \********************************************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _theme_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./theme-css */ "iQg6");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

const fabricFont = document.createElement('style');
fabricFont.type = 'text/css';
fabricFont.appendChild(document.createTextNode(`
@font-face {
    font-family: 'FabricMDL2Icons';
    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),
    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format("woff"),
    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format("truetype");;
}
`));
document.head.appendChild(fabricFont);
const themeStyle = document.createElement('style');
themeStyle.innerHTML = _theme_css__WEBPACK_IMPORTED_MODULE_0__["styles"].toString();
document.head.appendChild(themeStyle);
//# sourceMappingURL=style-helper.js.map

/***/ }),

/***/ "Y3UZ":
/*!****************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/dist/es6/MsalProvider.js ***!
  \****************************************************************************/
/*! exports provided: MsalProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MsalProvider", function() { return MsalProvider; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var msal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! msal */ "jEu4");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


/**
 * Msal Provider using MSAL.js to aquire tokens for authentication
 *
 * @export
 * @class MsalProvider
 * @extends {IProvider}
 */
class MsalProvider extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["IProvider"] {
    constructor(config) {
        super();
        // session storage
        this.sessionStorageRequestedScopesKey = 'mgt-requested-scopes';
        this.sessionStorageDeniedScopesKey = 'mgt-denied-scopes';
        this.initProvider(config);
    }
    /**
     * Gets the user agent application instance
     *
     * @protected
     * @type {UserAgentApplication}
     * @memberof MsalProvider
     */
    get userAgentApplication() {
        return this._userAgentApplication;
    }
    /**
     * attempts to sign in user silently
     *
     * @returns
     * @memberof MsalProvider
     */
    trySilentSignIn() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                if (this._userAgentApplication.isCallback(window.location.hash)) {
                    return;
                }
                if (this._userAgentApplication.getAccount() && (yield this.getAccessToken(null))) {
                    this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedIn);
                }
                else {
                    this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
                }
            }
            catch (e) {
                this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
            }
        });
    }
    /**
     * sign in user
     *
     * @param {AuthenticationParameters} [authenticationParameters]
     * @returns {Promise<void>}
     * @memberof MsalProvider
     */
    login(authenticationParameters) {
        return __awaiter(this, void 0, void 0, function* () {
            const loginRequest = authenticationParameters || {
                loginHint: this._loginHint,
                prompt: 'select_account',
                scopes: this.scopes
            };
            if (this._loginType === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["LoginType"].Popup) {
                const response = yield this._userAgentApplication.loginPopup(loginRequest);
                this.setState(response.account ? _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedIn : _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
            }
            else {
                this._userAgentApplication.loginRedirect(loginRequest);
            }
        });
    }
    /**
     * sign out user
     *
     * @returns {Promise<void>}
     * @memberof MsalProvider
     */
    logout() {
        return __awaiter(this, void 0, void 0, function* () {
            this._userAgentApplication.logout();
            this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
        });
    }
    /**
     * returns an access token for scopes
     *
     * @param {AuthenticationProviderOptions} options
     * @returns {Promise<string>}
     * @memberof MsalProvider
     */
    getAccessToken(options) {
        return __awaiter(this, void 0, void 0, function* () {
            const scopes = options ? options.scopes || this.scopes : this.scopes;
            const accessTokenRequest = {
                loginHint: this._loginHint,
                scopes
            };
            try {
                const response = yield this._userAgentApplication.acquireTokenSilent(accessTokenRequest);
                return response.accessToken;
            }
            catch (e) {
                if (this.requiresInteraction(e)) {
                    if (this._loginType === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["LoginType"].Redirect) {
                        // check if the user denied the scope before
                        if (!this.areScopesDenied(scopes)) {
                            this.setRequestedScopes(scopes);
                            this._userAgentApplication.acquireTokenRedirect(accessTokenRequest);
                        }
                        else {
                            throw e;
                        }
                    }
                    else {
                        try {
                            const response = yield this._userAgentApplication.acquireTokenPopup(accessTokenRequest);
                            return response.accessToken;
                        }
                        catch (e) {
                            throw e;
                        }
                    }
                }
                else {
                    // if we don't know what the error is, just ask the user to sign in again
                    this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
                    throw e;
                }
            }
            throw null;
        });
    }
    /**
     * sets scopes
     *
     * @param {string[]} scopes
     * @memberof MsalProvider
     */
    updateScopes(scopes) {
        this.scopes = scopes;
    }
    /**
     * checks if error indicates a user interaction is required
     *
     * @protected
     * @param {*} error
     * @returns
     * @memberof MsalProvider
     */
    requiresInteraction(error) {
        if (!error || !error.errorCode) {
            return false;
        }
        return (error.errorCode.indexOf('consent_required') !== -1 ||
            error.errorCode.indexOf('interaction_required') !== -1 ||
            error.errorCode.indexOf('login_required') !== -1);
    }
    /**
     * setting scopes in sessionStorage
     *
     * @protected
     * @param {string[]} scopes
     * @memberof MsalProvider
     */
    setRequestedScopes(scopes) {
        if (scopes) {
            sessionStorage.setItem(this.sessionStorageRequestedScopesKey, JSON.stringify(scopes));
        }
    }
    /**
     * getting scopes from sessionStorage if they exist
     *
     * @protected
     * @returns
     * @memberof MsalProvider
     */
    getRequestedScopes() {
        const scopesStr = sessionStorage.getItem(this.sessionStorageRequestedScopesKey);
        return scopesStr ? JSON.parse(scopesStr) : null;
    }
    /**
     * clears requested scopes from sessionStorage
     *
     * @protected
     * @memberof MsalProvider
     */
    clearRequestedScopes() {
        sessionStorage.removeItem(this.sessionStorageRequestedScopesKey);
    }
    /**
     * sets Denied scopes to sessionStoage
     *
     * @protected
     * @param {string[]} scopes
     * @memberof MsalProvider
     */
    addDeniedScopes(scopes) {
        if (scopes) {
            let deniedScopes = this.getDeniedScopes() || [];
            deniedScopes = deniedScopes.concat(scopes);
            let index = deniedScopes.indexOf('openid');
            if (index !== -1) {
                deniedScopes.splice(index, 1);
            }
            index = deniedScopes.indexOf('profile');
            if (index !== -1) {
                deniedScopes.splice(index, 1);
            }
            sessionStorage.setItem(this.sessionStorageDeniedScopesKey, JSON.stringify(deniedScopes));
        }
    }
    /**
     * gets deniedScopes from sessionStorage
     *
     * @protected
     * @returns
     * @memberof MsalProvider
     */
    getDeniedScopes() {
        const scopesStr = sessionStorage.getItem(this.sessionStorageDeniedScopesKey);
        return scopesStr ? JSON.parse(scopesStr) : null;
    }
    /**
     * if scopes are denied
     *
     * @protected
     * @param {string[]} scopes
     * @returns
     * @memberof MsalProvider
     */
    areScopesDenied(scopes) {
        if (scopes) {
            const deniedScopes = this.getDeniedScopes();
            if (deniedScopes && deniedScopes.filter(s => -1 !== scopes.indexOf(s)).length > 0) {
                return true;
            }
        }
        return false;
    }
    initProvider(config) {
        this.scopes = typeof config.scopes !== 'undefined' ? config.scopes : ['user.read'];
        this._loginType = typeof config.loginType !== 'undefined' ? config.loginType : _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["LoginType"].Redirect;
        this._loginHint = config.loginHint;
        let userAgentApplication;
        let clientId;
        if ('clientId' in config) {
            if (config.clientId) {
                const msalConfig = config.options || { auth: { clientId: config.clientId } };
                msalConfig.auth.clientId = config.clientId;
                msalConfig.cache = msalConfig.cache || {};
                msalConfig.cache.cacheLocation = msalConfig.cache.cacheLocation || 'localStorage';
                if (typeof msalConfig.cache.storeAuthStateInCookie === 'undefined' ||
                    msalConfig.cache.storeAuthStateInCookie === null) {
                    msalConfig.cache.storeAuthStateInCookie = true;
                }
                if (config.authority) {
                    msalConfig.auth.authority = config.authority;
                }
                if (config.redirectUri) {
                    msalConfig.auth.redirectUri = config.redirectUri;
                }
                clientId = config.clientId;
                userAgentApplication = new msal__WEBPACK_IMPORTED_MODULE_1__["UserAgentApplication"](msalConfig);
            }
            else {
                throw new Error('clientId must be provided');
            }
        }
        else if ('userAgentApplication' in config) {
            if (config.userAgentApplication) {
                userAgentApplication = config.userAgentApplication;
                const msalConfig = userAgentApplication.getCurrentConfiguration();
                clientId = msalConfig.auth.clientId;
            }
            else {
                throw new Error('userAgentApplication must be provided');
            }
        }
        else {
            throw new Error('either clientId or userAgentApplication must be provided');
        }
        this.clientId = clientId;
        this._userAgentApplication = userAgentApplication;
        this._userAgentApplication.handleRedirectCallback(response => this.tokenReceivedCallback(response), (error, state) => this.errorReceivedCallback(error, state));
        this.graph = Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["createFromProvider"])(this);
        this.trySilentSignIn();
    }
    tokenReceivedCallback(response) {
        if (response.tokenType === 'id_token') {
            this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedIn);
        }
        this.clearRequestedScopes();
    }
    errorReceivedCallback(authError, accountState) {
        const requestedScopes = this.getRequestedScopes();
        if (requestedScopes) {
            this.addDeniedScopes(requestedScopes);
        }
        this.clearRequestedScopes();
    }
}
//# sourceMappingURL=MsalProvider.js.map

/***/ }),

/***/ "Y6V/":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/PersonCardInteraction.js ***!
  \*********************************************************************************************/
/*! exports provided: PersonCardInteraction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PersonCardInteraction", function() { return PersonCardInteraction; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * Defines how a person card is shown when a user interacts with
 * a person component
 *
 * @export
 * @enum {number}
 */
var PersonCardInteraction;
(function (PersonCardInteraction) {
    /**
     * Don't show person card
     */
    PersonCardInteraction[PersonCardInteraction["none"] = 0] = "none";
    /**
     * Show person card on hover
     */
    PersonCardInteraction[PersonCardInteraction["hover"] = 1] = "hover";
    /**
     * Show person card on click
     */
    PersonCardInteraction[PersonCardInteraction["click"] = 2] = "click";
})(PersonCardInteraction || (PersonCardInteraction = {}));
//# sourceMappingURL=PersonCardInteraction.js.map

/***/ }),

/***/ "Y7+M":
/*!****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/Configuration.js ***!
  \****************************************************************************************/
/*! exports provided: buildConfiguration */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "buildConfiguration", function() { return buildConfiguration; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Logger */ "yJyd");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/UrlUtils */ "8P3k");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * Defaults for the Configuration Options
 */
var FRAME_TIMEOUT = 6000;
var OFFSET = 300;
var NAVIGATE_FRAME_WAIT = 500;
var DEFAULT_AUTH_OPTIONS = {
    clientId: "",
    authority: null,
    validateAuthority: true,
    authorityMetadata: "",
    knownAuthorities: [],
    redirectUri: function () { return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__["UrlUtils"].getCurrentUrl(); },
    postLogoutRedirectUri: function () { return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__["UrlUtils"].getCurrentUrl(); },
    navigateToLoginRequestUrl: true
};
var DEFAULT_CACHE_OPTIONS = {
    cacheLocation: "sessionStorage",
    storeAuthStateInCookie: false
};
var DEFAULT_SYSTEM_OPTIONS = {
    logger: new _Logger__WEBPACK_IMPORTED_MODULE_1__["Logger"](null),
    loadFrameTimeout: FRAME_TIMEOUT,
    tokenRenewalOffsetSeconds: OFFSET,
    navigateFrameWait: NAVIGATE_FRAME_WAIT
};
var DEFAULT_FRAMEWORK_OPTIONS = {
    isAngular: false,
    unprotectedResources: new Array(),
    protectedResourceMap: new Map()
};
/**
 * MSAL function that sets the default options when not explicitly configured from app developer
 *
 * @param TAuthOptions
 * @param TCacheOptions
 * @param TSystemOptions
 * @param TFrameworkOptions
 * @param TAuthorityDataOptions
 *
 * @returns TConfiguration object
 */
function buildConfiguration(_a) {
    var auth = _a.auth, _b = _a.cache, cache = _b === void 0 ? {} : _b, _c = _a.system, system = _c === void 0 ? {} : _c, _d = _a.framework, framework = _d === void 0 ? {} : _d;
    var overlayedConfig = {
        auth: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_AUTH_OPTIONS, auth),
        cache: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_CACHE_OPTIONS, cache),
        system: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_SYSTEM_OPTIONS, system),
        framework: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_FRAMEWORK_OPTIONS, framework)
    };
    return overlayedConfig;
}
//# sourceMappingURL=Configuration.js.map

/***/ }),

/***/ "Ya4k":
/*!************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/Range.js ***!
  \************************************************************************************************************/
/*! exports provided: Range */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Range", function() { return Range; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module Range
 */
/**
 * @class
 * Class representing Range
 */
class Range {
    /**
     * @public
     * @constructor
     * Creates a range for given min and max values
     * @param {number} [minVal = -1] - The minimum value.
     * @param {number} [maxVal = -1] - The maximum value.
     * @returns An instance of a Range
     */
    constructor(minVal = -1, maxVal = -1) {
        this.minValue = minVal;
        this.maxValue = maxVal;
    }
}
//# sourceMappingURL=Range.js.map

/***/ }),

/***/ "YdX3":
/*!***********************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/version.js ***!
  \***********************************************************************/
/*! exports provided: PACKAGE_VERSION */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PACKAGE_VERSION", function() { return PACKAGE_VERSION; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
const PACKAGE_VERSION = '2.1.0';
//# sourceMappingURL=version.js.map

/***/ }),

/***/ "YnAP":
/*!**********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/IdToken.js ***!
  \**********************************************************************************/
/*! exports provided: IdToken */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IdToken", function() { return IdToken; });
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error/ClientAuthError */ "859E");
/* harmony import */ var _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/TokenUtils */ "8w1o");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ "Ft/c");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * @hidden
 */
var IdToken = /** @class */ (function () {
    /* tslint:disable:no-string-literal */
    function IdToken(rawIdToken) {
        if (_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(rawIdToken)) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createIdTokenNullOrEmptyError(rawIdToken);
        }
        try {
            this.rawIdToken = rawIdToken;
            this.claims = _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_1__["TokenUtils"].extractIdToken(rawIdToken);
            if (this.claims) {
                if (this.claims.hasOwnProperty("iss")) {
                    this.issuer = this.claims["iss"];
                }
                if (this.claims.hasOwnProperty("oid")) {
                    this.objectId = this.claims["oid"];
                }
                if (this.claims.hasOwnProperty("sub")) {
                    this.subject = this.claims["sub"];
                }
                if (this.claims.hasOwnProperty("tid")) {
                    this.tenantId = this.claims["tid"];
                }
                if (this.claims.hasOwnProperty("ver")) {
                    this.version = this.claims["ver"];
                }
                if (this.claims.hasOwnProperty("preferred_username")) {
                    this.preferredName = this.claims["preferred_username"];
                }
                else if (this.claims.hasOwnProperty("upn")) {
                    this.preferredName = this.claims["upn"];
                }
                if (this.claims.hasOwnProperty("name")) {
                    this.name = this.claims["name"];
                }
                if (this.claims.hasOwnProperty("nonce")) {
                    this.nonce = this.claims["nonce"];
                }
                if (this.claims.hasOwnProperty("exp")) {
                    this.expiration = this.claims["exp"];
                }
                if (this.claims.hasOwnProperty("home_oid")) {
                    this.homeObjectId = this.claims["home_oid"];
                }
                if (this.claims.hasOwnProperty("sid")) {
                    this.sid = this.claims["sid"];
                }
                if (this.claims.hasOwnProperty("cloud_instance_host_name")) {
                    this.cloudInstance = this.claims["cloud_instance_host_name"];
                }
                /* tslint:enable:no-string-literal */
            }
        }
        catch (e) {
            /*
             * TODO: This error here won't really every be thrown, since extractIdToken() returns null if the decodeJwt() fails.
             * Need to add better error handling here to account for being unable to decode jwts.
             */
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createIdTokenParsingError(e);
        }
    }
    return IdToken;
}());

//# sourceMappingURL=IdToken.js.map

/***/ }),

/***/ "Yol3":
/*!******************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-teams-provider/dist/es6/TeamsProvider.js ***!
  \******************************************************************************/
/*! exports provided: TeamsProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TeamsProvider", function() { return TeamsProvider; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _microsoft_mgt_msal_provider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/mgt-msal-provider */ "ZDPT");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Enables authentication of Single page apps inside of a Microsoft Teams tab
 *
 * @export
 * @class TeamsProvider
 * @extends {MsalProvider}
 */
class TeamsProvider extends _microsoft_mgt_msal_provider__WEBPACK_IMPORTED_MODULE_1__["MsalProvider"] {
    constructor(config) {
        super({
            clientId: config.clientId,
            loginType: _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["LoginType"].Redirect,
            options: config.msalOptions,
            scopes: config.scopes
        });
        this._msalOptions = config.msalOptions;
        this._authPopupUrl = config.authPopupUrl;
        const teams = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["TeamsHelper"].microsoftTeamsLib;
        teams.initialize();
    }
    /**
     * Gets whether the Teams provider can be used in the current context
     * (Whether the app is running in Microsoft Teams)
     *
     * @readonly
     * @static
     * @memberof TeamsProvider
     */
    static get isAvailable() {
        return _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["TeamsHelper"].isAvailable;
    }
    /**
     * Optional entry point to the teams library
     * If this value is not set, the provider will attempt to use
     * the microsoftTeams global variable.
     *
     * @static
     * @memberof TeamsProvider
     */
    static get microsoftTeamsLib() {
        return _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["TeamsHelper"].microsoftTeamsLib;
    }
    static set microsoftTeamsLib(value) {
        _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["TeamsHelper"].microsoftTeamsLib = value;
    }
    /**
     * Handle all authentication redirects in the authentication page and authenticates the user
     *
     * @static
     * @returns
     * @memberof TeamsProvider
     */
    static handleAuth() {
        return __awaiter(this, void 0, void 0, function* () {
            // we are in popup world now - authenticate and handle it
            const teams = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["TeamsHelper"].microsoftTeamsLib;
            if (!teams) {
                // tslint:disable-next-line: no-console
                console.error('Make sure you have referenced the Microsoft Teams sdk before using the TeamsProvider');
                return;
            }
            teams.initialize();
            // if we were signing out before, then we are done
            if (sessionStorage.getItem(this._sessionStorageLogoutInProgress)) {
                teams.authentication.notifySuccess();
            }
            const url = new URL(window.location.href);
            const isSignOut = url.searchParams.get('signout');
            const paramsString = localStorage.getItem(this._localStorageParametersKey);
            let authParams;
            if (paramsString) {
                authParams = JSON.parse(paramsString);
            }
            else {
                authParams = {};
            }
            if (!authParams.clientId) {
                teams.authentication.notifyFailure('no clientId provided');
                return;
            }
            const scopes = authParams.scopes ? authParams.scopes.split(',') : null;
            const options = authParams.options || { auth: { clientId: authParams.clientId } };
            options.system = options.system || {};
            options.system.loadFrameTimeout = 10000;
            const provider = new _microsoft_mgt_msal_provider__WEBPACK_IMPORTED_MODULE_1__["MsalProvider"]({
                clientId: authParams.clientId,
                options,
                scopes
            });
            if (provider.userAgentApplication.urlContainsHash(window.location.hash)) {
                // the page should redirect again
                return;
            }
            const handleProviderState = () => __awaiter(this, void 0, void 0, function* () {
                // how do we handle when user can't sign in
                // change to promise and return status
                if (provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut) {
                    if (isSignOut) {
                        teams.authentication.notifySuccess();
                        return;
                    }
                    // make sure we are calling login only once
                    if (!sessionStorage.getItem(this._sessionStorageLoginInProgress)) {
                        sessionStorage.setItem(this._sessionStorageLoginInProgress, 'true');
                        provider.login({
                            loginHint: authParams.loginHint,
                            scopes: scopes || provider.scopes
                        });
                    }
                }
                else if (provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedIn) {
                    if (isSignOut) {
                        sessionStorage.setItem(this._sessionStorageLogoutInProgress, 'true');
                        yield provider.logout();
                        return;
                    }
                    try {
                        const accessToken = yield provider.getAccessTokenForScopes(...provider.scopes);
                        teams.authentication.notifySuccess(accessToken);
                    }
                    catch (e) {
                        teams.authentication.notifyFailure(e);
                    }
                }
            });
            provider.onStateChanged(handleProviderState);
            handleProviderState();
        });
    }
    /**
     * Opens the teams authentication popup to the authentication page
     *
     * @returns {Promise<void>}
     * @memberof TeamsProvider
     */
    login() {
        return __awaiter(this, void 0, void 0, function* () {
            this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].Loading);
            const teams = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["TeamsHelper"].microsoftTeamsLib;
            return new Promise((resolve, reject) => {
                teams.getContext(context => {
                    this.teamsContext = context;
                    const authParams = {
                        clientId: this.clientId,
                        loginHint: context.loginHint,
                        options: this._msalOptions,
                        scopes: this.scopes.join(',')
                    };
                    localStorage.setItem(TeamsProvider._localStorageParametersKey, JSON.stringify(authParams));
                    const url = new URL(this._authPopupUrl, new URL(window.location.href));
                    teams.authentication.authenticate({
                        failureCallback: reason => {
                            this.setState(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
                            reject();
                        },
                        successCallback: result => {
                            this.trySilentSignIn();
                            resolve();
                        },
                        url: url.href
                    });
                });
            });
        });
    }
    /**
     * sign out user
     *
     * @returns {Promise<void>}
     * @memberof MsalProvider
     */
    logout() {
        return __awaiter(this, void 0, void 0, function* () {
            const teams = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["TeamsHelper"].microsoftTeamsLib;
            return new Promise((resolve, reject) => {
                teams.getContext(context => {
                    this.teamsContext = context;
                    const url = new URL(this._authPopupUrl, new URL(window.location.href));
                    url.searchParams.append('signout', 'true');
                    teams.authentication.authenticate({
                        failureCallback: reason => {
                            this.trySilentSignIn();
                            reject();
                        },
                        successCallback: result => {
                            this.trySilentSignIn();
                            resolve();
                        },
                        url: url.href
                    });
                });
            });
        });
    }
    /**
     * Returns an access token that can be used for making calls to the Microsoft Graph
     *
     * @param {AuthenticationProviderOptions} options
     * @returns {Promise<string>}
     * @memberof TeamsProvider
     */
    getAccessToken(options) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.teamsContext && _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["TeamsHelper"].microsoftTeamsLib) {
                const teams = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["TeamsHelper"].microsoftTeamsLib;
                teams.initialize();
                this.teamsContext = yield teams.getContext();
            }
            const scopes = options ? options.scopes || this.scopes : this.scopes;
            const accessTokenRequest = {
                scopes
            };
            if (this.teamsContext && this.teamsContext.loginHint) {
                accessTokenRequest.loginHint = this.teamsContext.loginHint;
            }
            try {
                const response = yield this.userAgentApplication.acquireTokenSilent(accessTokenRequest);
                return response.accessToken;
            }
            catch (e) {
                if (this.requiresInteraction(e)) {
                    // nothing we can do now until we can do incremental consent
                    return null;
                }
                else {
                    throw e;
                }
            }
        });
    }
}
TeamsProvider._localStorageParametersKey = 'msg-teamsprovider-auth-parameters';
TeamsProvider._sessionStorageLoginInProgress = 'msg-teamsprovider-login-in-progress';
TeamsProvider._sessionStorageLogoutInProgress = 'msg-teamsprovider-logout-in-progress';
//# sourceMappingURL=TeamsProvider.js.map

/***/ }),

/***/ "Ytee":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/RedirectHandlerOptions.js ***!
  \************************************************************************************************************************************************/
/*! exports provided: RedirectHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RedirectHandlerOptions", function() { return RedirectHandlerOptions; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * @implements MiddlewareOptions
 * A class representing RedirectHandlerOptions
 */
class RedirectHandlerOptions {
    /**
     * @public
     * @constructor
     * To create an instance of RedirectHandlerOptions
     * @param {number} [maxRedirects = RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS] - The max redirects value
     * @param {ShouldRedirect} [shouldRedirect = RedirectHandlerOptions.DEFAULT_SHOULD_RETRY] - The should redirect callback
     * @returns An instance of RedirectHandlerOptions
     */
    constructor(maxRedirects = RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS, shouldRedirect = RedirectHandlerOptions.DEFAULT_SHOULD_RETRY) {
        if (maxRedirects > RedirectHandlerOptions.MAX_MAX_REDIRECTS) {
            const error = new Error(`MaxRedirects should not be more than ${RedirectHandlerOptions.MAX_MAX_REDIRECTS}`);
            error.name = "MaxLimitExceeded";
            throw error;
        }
        if (maxRedirects < 0) {
            const error = new Error(`MaxRedirects should not be negative`);
            error.name = "MinExpectationNotMet";
            throw error;
        }
        this.maxRedirects = maxRedirects;
        this.shouldRedirect = shouldRedirect;
    }
}
/**
 * @private
 * @static
 * A member holding default max redirects value
 */
RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS = 5;
/**
 * @private
 * @static
 * A member holding maximum max redirects value
 */
RedirectHandlerOptions.MAX_MAX_REDIRECTS = 20;
/**
 * @private
 * A member holding default shouldRedirect callback
 */
RedirectHandlerOptions.DEFAULT_SHOULD_RETRY = () => true;
//# sourceMappingURL=RedirectHandlerOptions.js.map

/***/ }),

/***/ "Z2zU":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/cache/BrowserStorage.js ***!
  \***********************************************************************************************/
/*! exports provided: BrowserStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BrowserStorage", function() { return BrowserStorage; });
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "ovzL");
/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../error/AuthError */ "a+UN");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * @hidden
 */
var BrowserStorage = /** @class */ (function () {
    function BrowserStorage(cacheLocation) {
        if (!window) {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_1__["AuthError"].createNoWindowObjectError("Browser storage class could not find window object");
        }
        var storageSupported = typeof window[cacheLocation] !== "undefined" && window[cacheLocation] != null;
        if (!storageSupported) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createStorageNotSupportedError(cacheLocation);
        }
        this.cacheLocation = cacheLocation;
    }
    /**
     * add value to storage
     * @param key
     * @param value
     * @param enableCookieStorage
     */
    BrowserStorage.prototype.setItem = function (key, value, enableCookieStorage) {
        window[this.cacheLocation].setItem(key, value);
        if (enableCookieStorage) {
            this.setItemCookie(key, value);
        }
    };
    /**
     * get one item by key from storage
     * @param key
     * @param enableCookieStorage
     */
    BrowserStorage.prototype.getItem = function (key, enableCookieStorage) {
        if (enableCookieStorage && this.getItemCookie(key)) {
            return this.getItemCookie(key);
        }
        return window[this.cacheLocation].getItem(key);
    };
    /**
     * remove value from storage
     * @param key
     */
    BrowserStorage.prototype.removeItem = function (key) {
        return window[this.cacheLocation].removeItem(key);
    };
    /**
     * clear storage (remove all items from it)
     */
    BrowserStorage.prototype.clear = function () {
        return window[this.cacheLocation].clear();
    };
    /**
     * add value to cookies
     * @param cName
     * @param cValue
     * @param expires
     */
    BrowserStorage.prototype.setItemCookie = function (cName, cValue, expires) {
        var cookieStr = cName + "=" + cValue + ";path=/;";
        if (expires) {
            var expireTime = this.getCookieExpirationTime(expires);
            cookieStr += "expires=" + expireTime + ";";
        }
        document.cookie = cookieStr;
    };
    /**
     * get one item by key from cookies
     * @param cName
     */
    BrowserStorage.prototype.getItemCookie = function (cName) {
        var name = cName + "=";
        var ca = document.cookie.split(";");
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) === " ") {
                c = c.substring(1);
            }
            if (c.indexOf(name) === 0) {
                return c.substring(name.length, c.length);
            }
        }
        return "";
    };
    /**
     * Clear an item in the cookies by key
     * @param cName
     */
    BrowserStorage.prototype.clearItemCookie = function (cName) {
        this.setItemCookie(cName, "", -1);
    };
    /**
     * Get cookie expiration time
     * @param cookieLifeDays
     */
    BrowserStorage.prototype.getCookieExpirationTime = function (cookieLifeDays) {
        var today = new Date();
        var expr = new Date(today.getTime() + cookieLifeDays * 24 * 60 * 60 * 1000);
        return expr.toUTCString();
    };
    return BrowserStorage;
}());

//# sourceMappingURL=BrowserStorage.js.map

/***/ }),

/***/ "Z3M6":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/GraphErrorHandler.js ***!
  \************************************************************************************************************************/
/*! exports provided: GraphErrorHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphErrorHandler", function() { return GraphErrorHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _GraphError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GraphError */ "3gtU");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @module GraphErrorHandler
 */

/**
 * @class
 * Class for GraphErrorHandler
 */
class GraphErrorHandler {
    /**
     * @private
     * @static
     * Populates the GraphError instance with Error instance values
     * @param {Error} error - The error returned by graph service or some native error
     * @param {number} [statusCode] - The status code of the response
     * @returns The GraphError instance
     */
    static constructError(error, statusCode) {
        const gError = new _GraphError__WEBPACK_IMPORTED_MODULE_1__["GraphError"](statusCode, "", error);
        if (error.name !== undefined) {
            gError.code = error.name;
        }
        gError.body = error.toString();
        gError.date = new Date();
        return gError;
    }
    /**
     * @private
     * @static
     * @async
     * Populates the GraphError instance from the Error returned by graph service
     * @param {any} error - The error returned by graph service or some native error
     * @param {number} statusCode - The status code of the response
     * @returns A promise that resolves to GraphError instance
     *
     * Example error for https://graph.microsoft.com/v1.0/me/events?$top=3&$search=foo
     * {
     *      "error": {
     *          "code": "SearchEvents",
     *          "message": "The parameter $search is not currently supported on the Events resource.",
     *          "innerError": {
     *              "request-id": "b31c83fd-944c-4663-aa50-5d9ceb367e19",
     *              "date": "2016-11-17T18:37:45"
     *          }
     *      }
     *  }
     */
    static constructErrorFromResponse(error, statusCode) {
        error = error.error;
        const gError = new _GraphError__WEBPACK_IMPORTED_MODULE_1__["GraphError"](statusCode, error.message);
        gError.code = error.code;
        if (error.innerError !== undefined) {
            gError.requestId = error.innerError["request-id"];
            gError.date = new Date(error.innerError.date);
        }
        try {
            gError.body = JSON.stringify(error);
        }
        catch (error) {
            // tslint:disable-line: no-empty
        }
        return gError;
    }
    /**
     * @public
     * @static
     * @async
     * To get the GraphError object
     * @param {any} [error = null] - The error returned by graph service or some native error
     * @param {number} [statusCode = -1] - The status code of the response
     * @param {GraphRequestCallback} [callback] - The graph request callback function
     * @returns A promise that resolves to GraphError instance
     */
    static getError(error = null, statusCode = -1, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            let gError;
            if (error && error.error) {
                gError = GraphErrorHandler.constructErrorFromResponse(error, statusCode);
            }
            else if (typeof Error !== "undefined" && error instanceof Error) {
                gError = GraphErrorHandler.constructError(error, statusCode);
            }
            else {
                gError = new _GraphError__WEBPACK_IMPORTED_MODULE_1__["GraphError"](statusCode);
            }
            if (typeof callback === "function") {
                callback(gError, null);
            }
            else {
                return gError;
            }
        });
    }
}
//# sourceMappingURL=GraphErrorHandler.js.map

/***/ }),

/***/ "ZDPT":
/*!*********************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/dist/es6/index.js ***!
  \*********************************************************************/
/*! exports provided: MsalProvider, MgtMsalProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _MsalProvider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MsalProvider */ "Y3UZ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MsalProvider", function() { return _MsalProvider__WEBPACK_IMPORTED_MODULE_0__["MsalProvider"]; });

/* harmony import */ var _mgt_msal_provider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mgt-msal-provider */ "rHXU");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtMsalProvider", function() { return _mgt_msal_provider__WEBPACK_IMPORTED_MODULE_1__["MgtMsalProvider"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


//# sourceMappingURL=index.js.map

/***/ }),

/***/ "ZVnu":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/WindowUtils.js ***!
  \*******************************************************************************************************/
/*! exports provided: WindowUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WindowUtils", function() { return WindowUtils; });
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../error/ClientAuthError */ "L9Ey");
/* harmony import */ var _UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UrlUtils */ "6r4W");
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Constants */ "MQw9");
/* harmony import */ var _TimeUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TimeUtils */ "b7Qq");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var WindowUtils = /** @class */ (function () {
    function WindowUtils() {
    }
    /**
     * @hidden
     * Checks if the current page is running in an iframe.
     * @ignore
     */
    WindowUtils.isInIframe = function () {
        return window.parent !== window;
    };
    /**
     * @hidden
     * Check if the current page is running in a popup.
     * @ignore
     */
    WindowUtils.isInPopup = function () {
        return !!(window.opener && window.opener !== window);
    };
    /**
     * @hidden
     * @param prefix
     * @param scopes
     * @param authority
     */
    WindowUtils.generateFrameName = function (prefix, requestSignature) {
        return "" + prefix + _Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].resourceDelimiter + requestSignature;
    };
    /**
     * @hidden
     * Polls an iframe until it loads a url with a hash
     * @ignore
     */
    WindowUtils.monitorIframeForHash = function (contentWindow, timeout, urlNavigate, logger) {
        return new Promise(function (resolve, reject) {
            /*
             * Polling for iframes can be purely timing based,
             * since we don't need to account for interaction.
             */
            var nowMark = _TimeUtils__WEBPACK_IMPORTED_MODULE_3__["TimeUtils"].relativeNowMs();
            var timeoutMark = nowMark + timeout;
            logger.verbose("monitorWindowForIframe polling started");
            var intervalId = setInterval(function () {
                if (_TimeUtils__WEBPACK_IMPORTED_MODULE_3__["TimeUtils"].relativeNowMs() > timeoutMark) {
                    logger.error("monitorIframeForHash unable to find hash in url, timing out");
                    logger.errorPii("monitorIframeForHash polling timed out for url: " + urlNavigate);
                    clearInterval(intervalId);
                    reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createTokenRenewalTimeoutError());
                    return;
                }
                var href;
                try {
                    /*
                     * Will throw if cross origin,
                     * which should be caught and ignored
                     * since we need the interval to keep running while on STS UI.
                     */
                    href = contentWindow.location.href;
                }
                catch (e) { }
                if (href && _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(href)) {
                    logger.verbose("monitorIframeForHash found url in hash");
                    clearInterval(intervalId);
                    resolve(contentWindow.location.hash);
                }
            }, WindowUtils.POLLING_INTERVAL_MS);
        });
    };
    /**
     * @hidden
     * Polls a popup until it loads a url with a hash
     * @ignore
     */
    WindowUtils.monitorPopupForHash = function (contentWindow, timeout, urlNavigate, logger) {
        return new Promise(function (resolve, reject) {
            /*
             * Polling for popups needs to be tick-based,
             * since a non-trivial amount of time can be spent on interaction (which should not count against the timeout).
             */
            var maxTicks = timeout / WindowUtils.POLLING_INTERVAL_MS;
            var ticks = 0;
            logger.verbose("monitorWindowForHash polling started");
            var intervalId = setInterval(function () {
                if (contentWindow.closed) {
                    logger.error("monitorWindowForHash window closed");
                    clearInterval(intervalId);
                    reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createUserCancelledError());
                    return;
                }
                var href;
                try {
                    /*
                     * Will throw if cross origin,
                     * which should be caught and ignored
                     * since we need the interval to keep running while on STS UI.
                     */
                    href = contentWindow.location.href;
                }
                catch (e) { }
                // Don't process blank pages or cross domain
                if (!href || href === "about:blank") {
                    return;
                }
                /*
                 * Only run clock when we are on same domain for popups
                 * as popup operations can take a long time.
                 */
                ticks++;
                if (href && _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(href)) {
                    logger.verbose("monitorPopupForHash found url in hash");
                    clearInterval(intervalId);
                    resolve(contentWindow.location.hash);
                }
                else if (ticks > maxTicks) {
                    logger.error("monitorPopupForHash unable to find hash in url, timing out");
                    logger.errorPii("monitorPopupForHash polling timed out for url: " + urlNavigate);
                    clearInterval(intervalId);
                    reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createTokenRenewalTimeoutError());
                }
            }, WindowUtils.POLLING_INTERVAL_MS);
        });
    };
    /**
     * @hidden
     * Loads iframe with authorization endpoint URL
     * @ignore
     */
    WindowUtils.loadFrame = function (urlNavigate, frameName, timeoutMs, logger) {
        var _this = this;
        /*
         * This trick overcomes iframe navigation in IE
         * IE does not load the page consistently in iframe
         */
        logger.infoPii("LoadFrame: " + frameName);
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                var frameHandle = _this.loadFrameSync(urlNavigate, frameName, logger);
                if (!frameHandle) {
                    reject("Unable to load iframe with name: " + frameName);
                    return;
                }
                resolve(frameHandle);
            }, timeoutMs);
        });
    };
    /**
     * @hidden
     * Loads the iframe synchronously when the navigateTimeFrame is set to `0`
     * @param urlNavigate
     * @param frameName
     * @param logger
     */
    WindowUtils.loadFrameSync = function (urlNavigate, frameName, logger) {
        var frameHandle = WindowUtils.addHiddenIFrame(frameName, logger);
        // returning to handle null in loadFrame, also to avoid null object access errors
        if (!frameHandle) {
            return null;
        }
        else if (frameHandle.src === "" || frameHandle.src === "about:blank") {
            frameHandle.src = urlNavigate;
            logger.infoPii("Frame Name : " + frameName + " Navigated to: " + urlNavigate);
        }
        return frameHandle;
    };
    /**
     * @hidden
     * Adds the hidden iframe for silent token renewal.
     * @ignore
     */
    WindowUtils.addHiddenIFrame = function (iframeId, logger) {
        if (typeof iframeId === "undefined") {
            return null;
        }
        logger.infoPii("Add msal frame to document:" + iframeId);
        var adalFrame = document.getElementById(iframeId);
        if (!adalFrame) {
            if (document.createElement &&
                document.documentElement &&
                (window.navigator.userAgent.indexOf("MSIE 5.0") === -1)) {
                var ifr = document.createElement("iframe");
                ifr.setAttribute("id", iframeId);
                ifr.setAttribute("aria-hidden", "true");
                ifr.style.visibility = "hidden";
                ifr.style.position = "absolute";
                ifr.style.width = ifr.style.height = "0";
                ifr.style.border = "0";
                ifr.setAttribute("sandbox", "allow-scripts allow-same-origin allow-forms");
                adalFrame = document.getElementsByTagName("body")[0].appendChild(ifr);
            }
            else if (document.body && document.body.insertAdjacentHTML) {
                document.body.insertAdjacentHTML("beforeend", "<iframe name='" + iframeId + "' id='" + iframeId + "' style='display:none'></iframe>");
            }
            if (window.frames && window.frames[iframeId]) {
                adalFrame = window.frames[iframeId];
            }
        }
        return adalFrame;
    };
    /**
     * @hidden
     * Removes a hidden iframe from the page.
     * @ignore
     */
    WindowUtils.removeHiddenIframe = function (iframe) {
        if (document.body === iframe.parentNode) {
            document.body.removeChild(iframe);
        }
    };
    /**
     * @hidden
     * Find and return the iframe element with the given hash
     * @ignore
     */
    WindowUtils.getIframeWithHash = function (hash) {
        var iframes = document.getElementsByTagName("iframe");
        var iframeArray = Array.apply(null, Array(iframes.length)).map(function (iframe, index) { return iframes.item(index); }); // eslint-disable-line prefer-spread
        return iframeArray.filter(function (iframe) {
            try {
                return iframe.contentWindow.location.hash === hash;
            }
            catch (e) {
                return false;
            }
        })[0];
    };
    /**
     * @hidden
     * Returns an array of all the popups opened by MSAL
     * @ignore
     */
    WindowUtils.getPopups = function () {
        if (!window.openedWindows) {
            window.openedWindows = [];
        }
        return window.openedWindows;
    };
    /**
     * @hidden
     * Find and return the popup with the given hash
     * @ignore
     */
    WindowUtils.getPopUpWithHash = function (hash) {
        return WindowUtils.getPopups().filter(function (popup) {
            try {
                return popup.location.hash === hash;
            }
            catch (e) {
                return false;
            }
        })[0];
    };
    /**
     * @hidden
     * Add the popup to the known list of popups
     * @ignore
     */
    WindowUtils.trackPopup = function (popup) {
        WindowUtils.getPopups().push(popup);
    };
    /**
     * @hidden
     * Close all popups
     * @ignore
     */
    WindowUtils.closePopups = function () {
        WindowUtils.getPopups().forEach(function (popup) { return popup.close(); });
    };
    /**
     * @ignore
     *
     * blocks any login/acquireToken calls to reload from within a hidden iframe (generated for silent calls)
     */
    WindowUtils.blockReloadInHiddenIframes = function () {
        // return an error if called from the hidden iframe created by the msal js silent calls
        if (_UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(window.location.hash) && WindowUtils.isInIframe()) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createBlockTokenRequestsInHiddenIframeError();
        }
    };
    /**
     *
     * @param cacheStorage
     */
    WindowUtils.checkIfBackButtonIsPressed = function (cacheStorage) {
        var redirectCache = cacheStorage.getItem(_Constants__WEBPACK_IMPORTED_MODULE_2__["TemporaryCacheKeys"].REDIRECT_REQUEST);
        // if redirect request is set and there is no hash
        if (redirectCache && !_UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(window.location.hash)) {
            var splitCache = redirectCache.split(_Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].resourceDelimiter);
            splitCache.shift();
            var state = splitCache.length > 0 ? splitCache.join(_Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].resourceDelimiter) : null;
            cacheStorage.resetTempCacheItems(state);
        }
    };
    /**
     * Removes url fragment from browser url
     */
    WindowUtils.clearUrlFragment = function () {
        // Office.js sets history.replaceState to null
        if (typeof history.replaceState === "function") {
            // Full removes "#" from url
            history.replaceState(null, null, "" + window.location.pathname + window.location.search);
        }
        else {
            window.location.hash = "";
        }
    };
    /**
     * @hidden
     * Interval in milliseconds that we poll a window
     * @ignore
     */
    WindowUtils.POLLING_INTERVAL_MS = 50;
    return WindowUtils;
}());

//# sourceMappingURL=WindowUtils.js.map

/***/ }),

/***/ "ZiRd":
/*!************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/SdkVersionMiddleware.js ***!
  \************************************************************************************/
/*! exports provided: SdkVersionMiddleware */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SdkVersionMiddleware", function() { return SdkVersionMiddleware; });
/* harmony import */ var _microsoft_microsoft_graph_client_lib_es_middleware_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/microsoft-graph-client/lib/es/middleware/MiddlewareUtil */ "kM4i");
/* harmony import */ var _ComponentMiddlewareOptions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ComponentMiddlewareOptions */ "nz8i");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


/**
 * Implements Middleware for the Graph sdk to inject
 * the toolkit version in the SdkVersion header
 *
 * @class SdkVersionMiddleware
 * @implements {Middleware}
 */
class SdkVersionMiddleware {
    constructor(packageVersion) {
        this._packageVersion = packageVersion;
    }
    // tslint:disable-next-line: completed-docs
    execute(context) {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                // Header parts must follow the format: 'name/version'
                const headerParts = [];
                const componentOptions = context.middlewareControl.getMiddlewareOptions(_ComponentMiddlewareOptions__WEBPACK_IMPORTED_MODULE_1__["ComponentMiddlewareOptions"]);
                if (componentOptions) {
                    const componentVersion = `${componentOptions.componentName}/${this._packageVersion}`;
                    headerParts.push(componentVersion);
                }
                // Package version
                const packageVersion = `mgt/${this._packageVersion}`;
                headerParts.push(packageVersion);
                // Existing SdkVersion header value
                headerParts.push(Object(_microsoft_microsoft_graph_client_lib_es_middleware_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_0__["getRequestHeader"])(context.request, context.options, 'SdkVersion'));
                // Join the header parts together and update the SdkVersion request header value
                const sdkVersionHeaderValue = headerParts.join(', ');
                Object(_microsoft_microsoft_graph_client_lib_es_middleware_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_0__["setRequestHeader"])(context.request, context.options, 'SdkVersion', sdkVersionHeaderValue);
            }
            catch (error) {
                // ignore error
            }
            return yield this._nextMiddleware.execute(context);
        });
    }
    /**
     * Handles setting of next middleware
     *
     * @param {Middleware} next
     * @memberof SdkVersionMiddleware
     */
    setNext(next) {
        this._nextMiddleware = next;
    }
}
//# sourceMappingURL=SdkVersionMiddleware.js.map

/***/ }),

/***/ "ZwGo":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/telemetry/TelemetryEvent.js ***!
  \***************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryConstants */ "3gM8");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryUtils */ "yuSj");
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/CryptoUtils */ "qD3l");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var TelemetryEvent = /** @class */ (function () {
    function TelemetryEvent(eventName, correlationId, eventLabel) {
        var _a;
        this.eventId = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_3__["CryptoUtils"].createNewGuid();
        this.label = eventLabel;
        this.event = (_a = {},
            _a[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["EVENT_NAME_KEY"])] = eventName,
            _a[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["ELAPSED_TIME_KEY"])] = -1,
            _a["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].MsalCorrelationIdConstStrKey] = correlationId,
            _a);
    }
    TelemetryEvent.prototype.setElapsedTime = function (time) {
        this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["ELAPSED_TIME_KEY"])] = time;
    };
    TelemetryEvent.prototype.stop = function () {
        // Set duration of event
        this.setElapsedTime(+Date.now() - +this.startTimestamp);
        Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["endBrowserPerformanceMeasurement"])(this.displayName, this.perfStartMark, this.perfEndMark);
    };
    TelemetryEvent.prototype.start = function () {
        this.startTimestamp = Date.now();
        this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["START_TIME_KEY"])] = this.startTimestamp;
        Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["startBrowserPerformanceMeasurement"])(this.perfStartMark);
    };
    Object.defineProperty(TelemetryEvent.prototype, "telemetryCorrelationId", {
        get: function () {
            return this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].MsalCorrelationIdConstStrKey];
        },
        set: function (value) {
            this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].MsalCorrelationIdConstStrKey] = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "eventName", {
        get: function () {
            return this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["EVENT_NAME_KEY"])];
        },
        enumerable: true,
        configurable: true
    });
    TelemetryEvent.prototype.get = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.event, { eventId: this.eventId });
    };
    Object.defineProperty(TelemetryEvent.prototype, "key", {
        get: function () {
            return this.telemetryCorrelationId + "_" + this.eventId + "-" + this.eventName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "displayName", {
        get: function () {
            return "Msal-" + this.label + "-" + this.telemetryCorrelationId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "perfStartMark", {
        get: function () {
            return "start-" + this.key;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "perfEndMark", {
        get: function () {
            return "end-" + this.key;
        },
        enumerable: true,
        configurable: true
    });
    return TelemetryEvent;
}());
/* harmony default export */ __webpack_exports__["default"] = (TelemetryEvent);
//# sourceMappingURL=TelemetryEvent.js.map

/***/ }),

/***/ "a+UN":
/*!******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/error/AuthError.js ***!
  \******************************************************************************************/
/*! exports provided: AuthErrorMessage, AuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthErrorMessage", function() { return AuthErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthError", function() { return AuthError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */

var AuthErrorMessage = {
    unexpectedError: {
        code: "unexpected_error",
        desc: "Unexpected error in authentication."
    },
    noWindowObjectError: {
        code: "no_window_object",
        desc: "No window object available. Details:"
    }
};
/**
 * General error class thrown by the MSAL.js library.
 */
var AuthError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AuthError, _super);
    function AuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorMessage) || this;
        Object.setPrototypeOf(_this, AuthError.prototype);
        _this.errorCode = errorCode;
        _this.errorMessage = errorMessage;
        _this.name = "AuthError";
        return _this;
    }
    AuthError.createUnexpectedError = function (errDesc) {
        return new AuthError(AuthErrorMessage.unexpectedError.code, AuthErrorMessage.unexpectedError.desc + ": " + errDesc);
    };
    AuthError.createNoWindowObjectError = function (errDesc) {
        return new AuthError(AuthErrorMessage.noWindowObjectError.code, AuthErrorMessage.noWindowObjectError.desc + " " + errDesc);
    };
    return AuthError;
}(Error));

//# sourceMappingURL=AuthError.js.map

/***/ }),

/***/ "a7t/":
/*!*************************************************!*\
  !*** ./node_modules/lit-element/lib/css-tag.js ***!
  \*************************************************/
/*! exports provided: supportsAdoptingStyleSheets, CSSResult, unsafeCSS, css */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "supportsAdoptingStyleSheets", function() { return supportsAdoptingStyleSheets; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CSSResult", function() { return CSSResult; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "unsafeCSS", function() { return unsafeCSS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "css", function() { return css; });
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
/**
 * Whether the current browser supports `adoptedStyleSheets`.
 */
const supportsAdoptingStyleSheets = (window.ShadowRoot) &&
    (window.ShadyCSS === undefined || window.ShadyCSS.nativeShadow) &&
    ('adoptedStyleSheets' in Document.prototype) &&
    ('replace' in CSSStyleSheet.prototype);
const constructionToken = Symbol();
class CSSResult {
    constructor(cssText, safeToken) {
        if (safeToken !== constructionToken) {
            throw new Error('CSSResult is not constructable. Use `unsafeCSS` or `css` instead.');
        }
        this.cssText = cssText;
    }
    // Note, this is a getter so that it's lazy. In practice, this means
    // stylesheets are not created until the first element instance is made.
    get styleSheet() {
        if (this._styleSheet === undefined) {
            // Note, if `supportsAdoptingStyleSheets` is true then we assume
            // CSSStyleSheet is constructable.
            if (supportsAdoptingStyleSheets) {
                this._styleSheet = new CSSStyleSheet();
                this._styleSheet.replaceSync(this.cssText);
            }
            else {
                this._styleSheet = null;
            }
        }
        return this._styleSheet;
    }
    toString() {
        return this.cssText;
    }
}
/**
 * Wrap a value for interpolation in a [[`css`]] tagged template literal.
 *
 * This is unsafe because untrusted CSS text can be used to phone home
 * or exfiltrate data to an attacker controlled site. Take care to only use
 * this with trusted input.
 */
const unsafeCSS = (value) => {
    return new CSSResult(String(value), constructionToken);
};
const textFromCSSResult = (value) => {
    if (value instanceof CSSResult) {
        return value.cssText;
    }
    else if (typeof value === 'number') {
        return value;
    }
    else {
        throw new Error(`Value passed to 'css' function must be a 'css' function result: ${value}. Use 'unsafeCSS' to pass non-literal values, but
            take care to ensure page security.`);
    }
};
/**
 * Template tag which which can be used with LitElement's [[LitElement.styles |
 * `styles`]] property to set element styles. For security reasons, only literal
 * string values may be used. To incorporate non-literal values [[`unsafeCSS`]]
 * may be used inside a template string part.
 */
const css = (strings, ...values) => {
    const cssText = values.reduce((acc, v, idx) => acc + textFromCSSResult(v) + strings[idx + 1], strings[0]);
    return new CSSResult(cssText, constructionToken);
};
//# sourceMappingURL=css-tag.js.map

/***/ }),

/***/ "aAxo":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/mgt-person-card.graph.js ***!
  \*************************************************************************************************************/
/*! exports provided: getPersonCardGraphData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPersonCardGraphData", function() { return getPersonCardGraphData; });
/* harmony import */ var _graph_graph_people__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../graph/graph.people */ "r/Dn");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

// tslint:disable-next-line:completed-docs
const userProperties = 'businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id';
// tslint:disable-next-line:completed-docs
const batchKeys = {
    directReports: 'directReports',
    files: 'files',
    messages: 'messages',
    people: 'people',
    person: 'person'
};
/**
 * Get data to populate the person card
 *
 * @export
 * @param {IGraph} graph
 * @param {IDynamicPerson} personDetails
 * @param {boolean} isMe
 * @param {MgtPersonCardConfig} config
 * @return {*}  {Promise<MgtPersonCardState>}
 */
function getPersonCardGraphData(graph, personDetails, isMe, config) {
    return __awaiter(this, void 0, void 0, function* () {
        const userId = personDetails.id;
        const email = Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_0__["getEmailFromGraphEntity"])(personDetails);
        const isContactOrGroup = 'classification' in personDetails ||
            ('personType' in personDetails &&
                (personDetails.personType.subclass === 'PersonalContact' || personDetails.personType.class === 'Group'));
        const batch = graph.createBatch();
        if (!isContactOrGroup) {
            if (config.sections.organization) {
                buildOrgStructureRequest(batch, userId);
                if (typeof config.sections.organization !== 'boolean' && config.sections.organization.showWorksWith) {
                    buildWorksWithRequest(batch, userId);
                }
            }
        }
        if (config.sections.mailMessages && email) {
            buildMessagesWithUserRequest(batch, email);
        }
        if (config.sections.files) {
            buildFilesRequest(batch, isMe ? null : email);
        }
        let response;
        const data = {}; // TODO
        try {
            response = yield batch.executeAll();
        }
        catch (_a) {
            // nop
        }
        if (response) {
            for (const [key, value] of response) {
                data[key] = value.content.value || value.content;
            }
        }
        if (!isContactOrGroup && config.sections.profile) {
            try {
                const profile = yield getProfile(graph, userId);
                if (profile) {
                    data.profile = profile;
                }
            }
            catch (_b) {
                // nop
            }
        }
        return data;
    });
}
// tslint:disable-next-line:completed-docs
function buildOrgStructureRequest(batch, userId) {
    const expandManagers = `manager($levels=max;$select=${userProperties})`;
    batch.get(batchKeys.person, `users/${userId}?$expand=${expandManagers}&$select=${userProperties}&$count=true`, ['user.read.all'], {
        ConsistencyLevel: 'eventual'
    });
    batch.get(batchKeys.directReports, `users/${userId}/directReports?$select=${userProperties}`);
}
// tslint:disable-next-line:completed-docs
function buildWorksWithRequest(batch, userId) {
    batch.get(batchKeys.people, `users/${userId}/people?$filter=personType/class eq 'Person'`, ['People.Read.All']);
}
// tslint:disable-next-line:completed-docs
function buildMessagesWithUserRequest(batch, emailAddress) {
    batch.get(batchKeys.messages, `me/messages?$search="from:${emailAddress}"`, ['Mail.ReadBasic']);
}
// tslint:disable-next-line:completed-docs
function buildFilesRequest(batch, emailAddress) {
    let request;
    if (emailAddress) {
        request = `me/insights/shared?$filter=lastshared/sharedby/address eq '${emailAddress}'`;
    }
    else {
        request = 'me/insights/used';
    }
    batch.get(batchKeys.files, request, ['Sites.Read.All']);
}
/**
 * Get the profile for a user
 *
 * @param {IGraph} graph
 * @param {string} userId
 * @return {*}  {Promise<Profile>}
 */
function getProfile(graph, userId) {
    return __awaiter(this, void 0, void 0, function* () {
        const profile = yield graph
            .api(`/users/${userId}/profile`)
            .version('beta')
            .get();
        return profile;
    });
}
//# sourceMappingURL=mgt-person-card.graph.js.map

/***/ }),

/***/ "aX9C":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/ScopeSet.js ***!
  \*****************************************************************************************/
/*! exports provided: ScopeSet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScopeSet", function() { return ScopeSet; });
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error/ClientConfigurationError */ "SRUK");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ "/pXG");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var ScopeSet = /** @class */ (function () {
    function ScopeSet() {
    }
    /**
     * Check if there are dup scopes in a given request
     *
     * @param cachedScopes
     * @param scopes
     */
    // TODO: Rename this, intersecting scopes isn't a great name for duplicate checker
    ScopeSet.isIntersectingScopes = function (cachedScopes, scopes) {
        var convertedCachedScopes = this.trimAndConvertArrayToLowerCase(cachedScopes.slice());
        var requestScopes = this.trimAndConvertArrayToLowerCase(scopes.slice());
        for (var i = 0; i < requestScopes.length; i++) {
            if (convertedCachedScopes.indexOf(requestScopes[i].toLowerCase()) > -1) {
                return true;
            }
        }
        return false;
    };
    /**
     * Check if a given scope is present in the request
     *
     * @param cachedScopes
     * @param scopes
     */
    ScopeSet.containsScope = function (cachedScopes, scopes) {
        var convertedCachedScopes = this.trimAndConvertArrayToLowerCase(cachedScopes.slice());
        var requestScopes = this.trimAndConvertArrayToLowerCase(scopes.slice());
        return requestScopes.every(function (value) { return convertedCachedScopes.indexOf(value.toString().toLowerCase()) >= 0; });
    };
    /**
     *  Trims and converts string to lower case
     *
     * @param scopes
     */
    // TODO: Rename this, too generic name for a function that only deals with scopes
    ScopeSet.trimAndConvertToLowerCase = function (scope) {
        return scope.trim().toLowerCase();
    };
    /**
     * Performs trimAndConvertToLowerCase on string array
     * @param scopes
     */
    ScopeSet.trimAndConvertArrayToLowerCase = function (scopes) {
        var _this = this;
        return scopes.map(function (scope) { return _this.trimAndConvertToLowerCase(scope); });
    };
    /**
     * Trims each scope in scopes array
     * @param scopes
     */
    ScopeSet.trimScopes = function (scopes) {
        return scopes.map(function (scope) { return scope.trim(); });
    };
    /**
     * Remove one element from a scope array
     *
     * @param scopes
     * @param scope
     */
    // TODO: Rename this, too generic name for a function that only deals with scopes
    ScopeSet.removeElement = function (scopes, scope) {
        var scopeVal = this.trimAndConvertToLowerCase(scope);
        return scopes.filter(function (value) { return value !== scopeVal; });
    };
    /**
     * Parse the scopes into a formatted scopeList
     * @param scopes
     */
    ScopeSet.parseScope = function (scopes) {
        var scopeList = "";
        if (scopes) {
            for (var i = 0; i < scopes.length; ++i) {
                scopeList += (i !== scopes.length - 1) ? scopes[i] + " " : scopes[i];
            }
        }
        return scopeList;
    };
    /**
     * @hidden
     *
     * Used to validate the scopes input parameter requested  by the developer.
     * @param {Array<string>} scopes - Developer requested permissions. Not all scopes are guaranteed to be included in the access token returned.
     * @param {boolean} scopesRequired - Boolean indicating whether the scopes array is required or not
     * @ignore
     */
    ScopeSet.validateInputScope = function (scopes, scopesRequired) {
        if (!scopes) {
            if (scopesRequired) {
                throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createScopesRequiredError(scopes);
            }
            else {
                return;
            }
        }
        // Check that scopes is an array object (also throws error if scopes == null)
        if (!Array.isArray(scopes)) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createScopesNonArrayError(scopes);
        }
        // Check that scopes is not an empty array
        if (scopes.length < 1 && scopesRequired) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createEmptyScopesArrayError(scopes.toString());
        }
    };
    /**
     * @hidden
     *
     * Extracts scope value from the state sent with the authentication request.
     * @param {string} state
     * @returns {string} scope.
     * @ignore
     */
    ScopeSet.getScopeFromState = function (state) {
        if (state) {
            var splitIndex = state.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter);
            if (splitIndex > -1 && splitIndex + 1 < state.length) {
                return state.substring(splitIndex + 1);
            }
        }
        return "";
    };
    /**
     * @ignore
     * Appends extraScopesToConsent if passed
     * @param {@link AuthenticationParameters}
     */
    ScopeSet.appendScopes = function (reqScopes, reqExtraScopesToConsent) {
        if (reqScopes) {
            var convertedExtraScopes = reqExtraScopesToConsent ? this.trimAndConvertArrayToLowerCase(reqExtraScopesToConsent.slice()) : null;
            var convertedReqScopes = this.trimAndConvertArrayToLowerCase(reqScopes.slice());
            return convertedExtraScopes ? convertedReqScopes.concat(convertedExtraScopes) : convertedReqScopes;
        }
        return null;
    };
    // #endregion
    /**
     * @ignore
     * Returns true if the scopes array only contains openid and/or profile
     */
    ScopeSet.onlyContainsOidcScopes = function (scopes) {
        var scopesCount = scopes.length;
        var oidcScopesFound = 0;
        if (scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope) > -1) {
            oidcScopesFound += 1;
        }
        if (scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope) > -1) {
            oidcScopesFound += 1;
        }
        return (scopesCount > 0 && scopesCount === oidcScopesFound);
    };
    /**
     * @ignore
     * Returns true if the scopes array only contains openid and/or profile
     */
    ScopeSet.containsAnyOidcScopes = function (scopes) {
        var containsOpenIdScope = scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope) > -1;
        var containsProfileScope = scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope) > -1;
        return (containsOpenIdScope || containsProfileScope);
    };
    /**
     * @ignore
     * Returns true if the clientId is the only scope in the array
     */
    ScopeSet.onlyContainsClientId = function (scopes, clientId) {
        // Double negation to force false value returned in case scopes is null
        return !!scopes && (scopes.indexOf(clientId) > -1 && scopes.length === 1);
    };
    /**
     * @ignore
     * Adds missing OIDC scopes to scopes array without duplication. Since STS requires OIDC scopes for
     * all implicit flow requests, 'openid' and 'profile' should always be included in the final request
     */
    ScopeSet.appendDefaultScopes = function (scopes) {
        var extendedScopes = scopes;
        if (extendedScopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope) === -1) {
            extendedScopes.push(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope);
        }
        if (extendedScopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope) === -1) {
            extendedScopes.push(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope);
        }
        return extendedScopes;
    };
    /**
     * @ignore
     * Removes present OIDC scopes from scopes array.
     */
    ScopeSet.removeDefaultScopes = function (scopes) {
        return scopes.filter(function (scope) {
            return (scope !== _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope && scope !== _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope);
        });
    };
    /**
     * @ignore
     * Removes clientId from scopes array if included as only scope. If it's not the only scope, it is treated as a resource scope.
     * @param scopes Array<string>: Pre-normalized scopes array
     * @param clientId string: The application's clientId that is searched for in the scopes array
     */
    ScopeSet.translateClientIdIfSingleScope = function (scopes, clientId) {
        return this.onlyContainsClientId(scopes, clientId) ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].oidcScopes : scopes;
    };
    return ScopeSet;
}());

//# sourceMappingURL=ScopeSet.js.map

/***/ }),

/***/ "aZXi":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/telemetry/TelemetryManager.js ***!
  \*****************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _DefaultEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultEvent */ "z4C7");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/Constants */ "vFME");
/* harmony import */ var _ApiEvent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ApiEvent */ "Brgr");
/* harmony import */ var _HttpEvent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./HttpEvent */ "G4FT");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */





var TelemetryManager = /** @class */ (function () {
    function TelemetryManager(config, telemetryEmitter, logger) {
        // correlation Id to list of events
        this.completedEvents = {};
        // event key to event
        this.inProgressEvents = {};
        // correlation id to map of eventname to count
        this.eventCountByCorrelationId = {};
        // Implement after API EVENT
        this.onlySendFailureTelemetry = false;
        // TODO THROW if bad options
        this.telemetryPlatform = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ sdk: _utils_Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].libraryName, sdkVersion: Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_2__["libraryVersion"])(), networkInformation: {
                // @ts-ignore
                connectionSpeed: typeof navigator !== "undefined" && navigator.connection && navigator.connection.effectiveType
            } }, config.platform);
        this.clientId = config.clientId;
        this.onlySendFailureTelemetry = config.onlySendFailureTelemetry;
        /*
         * TODO, when i get to wiring this through, think about what it means if
         * a developer does not implement telem at all, we still instrument, but telemetryEmitter can be
         * optional?
         */
        this.telemetryEmitter = telemetryEmitter;
        this.logger = logger;
    }
    TelemetryManager.getTelemetrymanagerStub = function (clientId, logger) {
        var applicationName = "UnSetStub";
        var applicationVersion = "0.0";
        var telemetryEmitter = function () { };
        var telemetryPlatform = {
            applicationName: applicationName,
            applicationVersion: applicationVersion
        };
        var telemetryManagerConfig = {
            platform: telemetryPlatform,
            clientId: clientId
        };
        return new this(telemetryManagerConfig, telemetryEmitter, logger);
    };
    TelemetryManager.prototype.startEvent = function (event) {
        this.logger.verbose("Telemetry Event started: " + event.key);
        if (!this.telemetryEmitter) {
            return;
        }
        event.start();
        this.inProgressEvents[event.key] = event;
    };
    TelemetryManager.prototype.stopEvent = function (event) {
        this.logger.verbose("Telemetry Event stopped: " + event.key);
        if (!this.telemetryEmitter || !this.inProgressEvents[event.key]) {
            return;
        }
        event.stop();
        this.incrementEventCount(event);
        var completedEvents = this.completedEvents[event.telemetryCorrelationId];
        this.completedEvents[event.telemetryCorrelationId] = (completedEvents || []).concat([event]);
        delete this.inProgressEvents[event.key];
    };
    TelemetryManager.prototype.flush = function (correlationId) {
        var _this = this;
        this.logger.verbose("Flushing telemetry events: " + correlationId);
        // If there is only unfinished events should this still return them?
        if (!this.telemetryEmitter || !this.completedEvents[correlationId]) {
            return;
        }
        var orphanedEvents = this.getOrphanedEvents(correlationId);
        orphanedEvents.forEach(function (event) { return _this.incrementEventCount(event); });
        var eventsToFlush = this.completedEvents[correlationId].concat(orphanedEvents);
        delete this.completedEvents[correlationId];
        var eventCountsToFlush = this.eventCountByCorrelationId[correlationId];
        delete this.eventCountByCorrelationId[correlationId];
        // TODO add funcitonality for onlyFlushFailures after implementing api event? ??
        if (!eventsToFlush || !eventsToFlush.length) {
            return;
        }
        var defaultEvent = new _DefaultEvent__WEBPACK_IMPORTED_MODULE_1__["default"](this.telemetryPlatform, correlationId, this.clientId, eventCountsToFlush);
        var eventsWithDefaultEvent = eventsToFlush.concat([defaultEvent]);
        this.telemetryEmitter(eventsWithDefaultEvent.map(function (e) { return e.get(); }));
    };
    TelemetryManager.prototype.createAndStartApiEvent = function (correlationId, apiEventIdentifier) {
        var apiEvent = new _ApiEvent__WEBPACK_IMPORTED_MODULE_3__["default"](correlationId, this.logger.isPiiLoggingEnabled(), apiEventIdentifier);
        this.startEvent(apiEvent);
        return apiEvent;
    };
    TelemetryManager.prototype.stopAndFlushApiEvent = function (correlationId, apiEvent, wasSuccessful, errorCode) {
        apiEvent.wasSuccessful = wasSuccessful;
        if (errorCode) {
            apiEvent.apiErrorCode = errorCode;
        }
        this.stopEvent(apiEvent);
        this.flush(correlationId);
    };
    TelemetryManager.prototype.createAndStartHttpEvent = function (correlation, httpMethod, url, eventLabel) {
        var httpEvent = new _HttpEvent__WEBPACK_IMPORTED_MODULE_4__["default"](correlation, eventLabel);
        httpEvent.url = url;
        httpEvent.httpMethod = httpMethod;
        this.startEvent(httpEvent);
        return httpEvent;
    };
    TelemetryManager.prototype.incrementEventCount = function (event) {
        var _a;
        /*
         * TODO, name cache event different?
         * if type is cache event, change name
         */
        var eventName = event.eventName;
        var eventCount = this.eventCountByCorrelationId[event.telemetryCorrelationId];
        if (!eventCount) {
            this.eventCountByCorrelationId[event.telemetryCorrelationId] = (_a = {},
                _a[eventName] = 1,
                _a);
        }
        else {
            eventCount[eventName] = eventCount[eventName] ? eventCount[eventName] + 1 : 1;
        }
    };
    TelemetryManager.prototype.getOrphanedEvents = function (correlationId) {
        var _this = this;
        return Object.keys(this.inProgressEvents)
            .reduce(function (memo, eventKey) {
            if (eventKey.indexOf(correlationId) !== -1) {
                var event_1 = _this.inProgressEvents[eventKey];
                delete _this.inProgressEvents[eventKey];
                return memo.concat([event_1]);
            }
            return memo;
        }, []);
    };
    return TelemetryManager;
}());
/* harmony default export */ __webpack_exports__["default"] = (TelemetryManager);
//# sourceMappingURL=TelemetryManager.js.map

/***/ }),

/***/ "aklA":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/telemetry/TelemetryEvent.js ***!
  \**************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryConstants */ "7xDs");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryUtils */ "E5LX");
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/CryptoUtils */ "oish");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var TelemetryEvent = /** @class */ (function () {
    function TelemetryEvent(eventName, correlationId, eventLabel) {
        var _a;
        this.eventId = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_3__["CryptoUtils"].createNewGuid();
        this.label = eventLabel;
        this.event = (_a = {},
            _a[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["EVENT_NAME_KEY"])] = eventName,
            _a[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["ELAPSED_TIME_KEY"])] = -1,
            _a["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].MsalCorrelationIdConstStrKey] = correlationId,
            _a);
    }
    TelemetryEvent.prototype.setElapsedTime = function (time) {
        this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["ELAPSED_TIME_KEY"])] = time;
    };
    TelemetryEvent.prototype.stop = function () {
        // Set duration of event
        this.setElapsedTime(+Date.now() - +this.startTimestamp);
        Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["endBrowserPerformanceMeasurement"])(this.displayName, this.perfStartMark, this.perfEndMark);
    };
    TelemetryEvent.prototype.start = function () {
        this.startTimestamp = Date.now();
        this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["START_TIME_KEY"])] = this.startTimestamp;
        Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["startBrowserPerformanceMeasurement"])(this.perfStartMark);
    };
    Object.defineProperty(TelemetryEvent.prototype, "telemetryCorrelationId", {
        get: function () {
            return this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].MsalCorrelationIdConstStrKey];
        },
        set: function (value) {
            this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].MsalCorrelationIdConstStrKey] = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "eventName", {
        get: function () {
            return this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_2__["prependEventNamePrefix"])(_TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["EVENT_NAME_KEY"])];
        },
        enumerable: true,
        configurable: true
    });
    TelemetryEvent.prototype.get = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.event, { eventId: this.eventId });
    };
    Object.defineProperty(TelemetryEvent.prototype, "key", {
        get: function () {
            return this.telemetryCorrelationId + "_" + this.eventId + "-" + this.eventName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "displayName", {
        get: function () {
            return "Msal-" + this.label + "-" + this.telemetryCorrelationId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "perfStartMark", {
        get: function () {
            return "start-" + this.key;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TelemetryEvent.prototype, "perfEndMark", {
        get: function () {
            return "end-" + this.key;
        },
        enumerable: true,
        configurable: true
    });
    return TelemetryEvent;
}());
/* harmony default export */ __webpack_exports__["default"] = (TelemetryEvent);
//# sourceMappingURL=TelemetryEvent.js.map

/***/ }),

/***/ "aos8":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/UserAgentApplication.js ***!
  \***********************************************************************************************/
/*! exports provided: UserAgentApplication */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserAgentApplication", function() { return UserAgentApplication; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _cache_AccessTokenKey__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cache/AccessTokenKey */ "4N0K");
/* harmony import */ var _cache_AccessTokenValue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./cache/AccessTokenValue */ "e8Xr");
/* harmony import */ var _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ServerRequestParameters */ "KbZT");
/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./authority/Authority */ "43Tr");
/* harmony import */ var _ClientInfo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ClientInfo */ "KdcN");
/* harmony import */ var _IdToken__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./IdToken */ "YnAP");
/* harmony import */ var _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./cache/AuthCache */ "mx/S");
/* harmony import */ var _Account__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Account */ "mWN4");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ScopeSet */ "mb9z");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./utils/StringUtils */ "Ft/c");
/* harmony import */ var _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./utils/WindowUtils */ "rPdB");
/* harmony import */ var _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./utils/TokenUtils */ "8w1o");
/* harmony import */ var _utils_TimeUtils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./utils/TimeUtils */ "h916");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./utils/UrlUtils */ "8P3k");
/* harmony import */ var _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./utils/RequestUtils */ "tjEs");
/* harmony import */ var _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./utils/ResponseUtils */ "4hjE");
/* harmony import */ var _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./authority/AuthorityFactory */ "IURE");
/* harmony import */ var _Configuration__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Configuration */ "Y7+M");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./error/ClientConfigurationError */ "ovzL");
/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./error/AuthError */ "a+UN");
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./error/ClientAuthError */ "859E");
/* harmony import */ var _error_ServerError__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./error/ServerError */ "53Y/");
/* harmony import */ var _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./error/InteractionRequiredAuthError */ "v0vZ");
/* harmony import */ var _AuthResponse__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./AuthResponse */ "IW+q");
/* harmony import */ var _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./telemetry/TelemetryManager */ "aZXi");
/* harmony import */ var _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./telemetry/ApiEvent */ "Brgr");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./utils/Constants */ "vFME");
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./utils/CryptoUtils */ "qD3l");
/* harmony import */ var _authority_TrustedAuthority__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./authority/TrustedAuthority */ "FFC9");
/* harmony import */ var _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./utils/AuthCacheUtils */ "cYvR");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */































// default authority
var DEFAULT_AUTHORITY = "https://login.microsoftonline.com/common";
/**
 * UserAgentApplication class
 *
 * Object Instance that the developer can use to make loginXX OR acquireTokenXX functions
 */
var UserAgentApplication = /** @class */ (function () {
    /**
     * @constructor
     * Constructor for the UserAgentApplication used to instantiate the UserAgentApplication object
     *
     * Important attributes in the Configuration object for auth are:
     * - clientID: the application ID of your application.
     * You can obtain one by registering your application with our Application registration portal : https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredAppsPreview
     * - authority: the authority URL for your application.
     *
     * In Azure AD, authority is a URL indicating the Azure active directory that MSAL uses to obtain tokens.
     * It is of the form https://login.microsoftonline.com/&lt;Enter_the_Tenant_Info_Here&gt;.
     * If your application supports Accounts in one organizational directory, replace "Enter_the_Tenant_Info_Here" value with the Tenant Id or Tenant name (for example, contoso.microsoft.com).
     * If your application supports Accounts in any organizational directory, replace "Enter_the_Tenant_Info_Here" value with organizations.
     * If your application supports Accounts in any organizational directory and personal Microsoft accounts, replace "Enter_the_Tenant_Info_Here" value with common.
     * To restrict support to Personal Microsoft accounts only, replace "Enter_the_Tenant_Info_Here" value with consumers.
     *
     *
     * In Azure B2C, authority is of the form https://&lt;instance&gt;/tfp/&lt;tenant&gt;/&lt;policyName&gt;/
     *
     * @param {@link (Configuration:type)} configuration object for the MSAL UserAgentApplication instance
     */
    function UserAgentApplication(configuration) {
        // callbacks for token/error
        this.authResponseCallback = null;
        this.tokenReceivedCallback = null;
        this.errorReceivedCallback = null;
        // Set the Configuration
        this.config = Object(_Configuration__WEBPACK_IMPORTED_MODULE_18__["buildConfiguration"])(configuration);
        this.logger = this.config.system.logger;
        this.clientId = this.config.auth.clientId;
        this.inCookie = this.config.cache.storeAuthStateInCookie;
        this.telemetryManager = this.getTelemetryManagerFromConfig(this.config.system.telemetry, this.clientId);
        _authority_TrustedAuthority__WEBPACK_IMPORTED_MODULE_29__["TrustedAuthority"].setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority, this.config.auth.knownAuthorities);
        _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromConfig(this.config.auth.authority, this.config.auth.authorityMetadata);
        // if no authority is passed, set the default: "https://login.microsoftonline.com/common"
        this.authority = this.config.auth.authority || DEFAULT_AUTHORITY;
        // cache keys msal - typescript throws an error if any value other than "localStorage" or "sessionStorage" is passed
        this.cacheStorage = new _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"](this.clientId, this.config.cache.cacheLocation, this.inCookie);
        // Initialize window handling code
        window.activeRenewals = {};
        window.renewStates = [];
        window.callbackMappedToRenewStates = {};
        window.promiseMappedToRenewStates = {};
        window.msal = this;
        var urlHash = window.location.hash;
        var urlContainsHash = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlContainsHash(urlHash);
        // check if back button is pressed
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].checkIfBackButtonIsPressed(this.cacheStorage);
        // On the server 302 - Redirect, handle this
        if (urlContainsHash) {
            var stateInfo = this.getResponseState(urlHash);
            if (stateInfo.method === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
                this.handleRedirectAuthenticationResponse(urlHash);
            }
        }
    }
    Object.defineProperty(UserAgentApplication.prototype, "authority", {
        /**
         * Method to manage the authority URL.
         *
         * @returns {string} authority
         */
        get: function () {
            return this.authorityInstance.CanonicalAuthority;
        },
        /**
         * setter for the authority URL
         * @param {string} authority
         */
        // If the developer passes an authority, create an instance
        set: function (val) {
            this.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(val, this.config.auth.validateAuthority);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Get the current authority instance from the MSAL configuration object
     *
     * @returns {@link Authority} authority instance
     */
    UserAgentApplication.prototype.getAuthorityInstance = function () {
        return this.authorityInstance;
    };
    UserAgentApplication.prototype.handleRedirectCallback = function (authOrTokenCallback, errorReceivedCallback) {
        if (!authOrTokenCallback) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createInvalidCallbackObjectError(authOrTokenCallback);
        }
        // Set callbacks
        if (errorReceivedCallback) {
            this.tokenReceivedCallback = authOrTokenCallback;
            this.errorReceivedCallback = errorReceivedCallback;
            this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).");
        }
        else {
            this.authResponseCallback = authOrTokenCallback;
        }
        if (this.redirectError) {
            this.authErrorHandler(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, this.redirectError, this.redirectResponse);
        }
        else if (this.redirectResponse) {
            this.authResponseHandler(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, this.redirectResponse);
        }
    };
    /**
     * Public API to verify if the URL contains the hash with known properties
     * @param hash
     */
    UserAgentApplication.prototype.urlContainsHash = function (hash) {
        this.logger.verbose("UrlContainsHash has been called");
        return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlContainsHash(hash);
    };
    UserAgentApplication.prototype.authResponseHandler = function (interactionType, response, resolve) {
        this.logger.verbose("AuthResponseHandler has been called");
        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
            this.logger.verbose("Interaction type is redirect");
            if (this.errorReceivedCallback) {
                this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response");
                this.tokenReceivedCallback(response);
            }
            else if (this.authResponseCallback) {
                this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response");
                this.authResponseCallback(null, response);
            }
        }
        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup) {
            this.logger.verbose("Interaction type is popup, resolving");
            resolve(response);
        }
        else {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidInteractionTypeError();
        }
    };
    UserAgentApplication.prototype.authErrorHandler = function (interactionType, authErr, response, reject) {
        this.logger.verbose("AuthErrorHandler has been called");
        // set interaction_status to complete
        this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
            this.logger.verbose("Interaction type is redirect");
            if (this.errorReceivedCallback) {
                this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback");
                this.errorReceivedCallback(authErr, response.accountState);
            }
            else if (this.authResponseCallback) {
                this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error");
                this.authResponseCallback(authErr, response);
            }
            else {
                this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error");
                throw authErr;
            }
        }
        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup) {
            this.logger.verbose("Interaction type is popup, rejecting");
            reject(authErr);
        }
        else {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidInteractionTypeError();
        }
    };
    // #endregion
    /**
     * Use when initiating the login process by redirecting the user's browser to the authorization endpoint.
     * @param {@link (AuthenticationParameters:type)}
     */
    UserAgentApplication.prototype.loginRedirect = function (userRequest) {
        this.logger.verbose("LoginRedirect has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, true, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect);
        this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, true, request, null, null);
    };
    /**
     * Use when you want to obtain an access_token for your API by redirecting the user's browser window to the authorization endpoint.
     * @param {@link (AuthenticationParameters:type)}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     */
    UserAgentApplication.prototype.acquireTokenRedirect = function (userRequest) {
        this.logger.verbose("AcquireTokenRedirect has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect);
        this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, false, request, null, null);
    };
    /**
     * Use when initiating the login process via opening a popup window in the user's browser
     *
     * @param {@link (AuthenticationParameters:type)}
     *
     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object
     */
    UserAgentApplication.prototype.loginPopup = function (userRequest) {
        var _this = this;
        this.logger.verbose("LoginPopup has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, true, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup);
        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].LoginPopup);
        return new Promise(function (resolve, reject) {
            _this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup, true, request, resolve, reject);
        })
            .then(function (resp) {
            _this.logger.verbose("Successfully logged in");
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);
            return resp;
        })
            .catch(function (error) {
            _this.cacheStorage.resetTempCacheItems(request.state);
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);
            throw error;
        });
    };
    /**
     * Use when you want to obtain an access_token for your API via opening a popup window in the user's browser
     * @param {@link AuthenticationParameters}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object
     */
    UserAgentApplication.prototype.acquireTokenPopup = function (userRequest) {
        var _this = this;
        this.logger.verbose("AcquireTokenPopup has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup);
        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].AcquireTokenPopup);
        return new Promise(function (resolve, reject) {
            _this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup, false, request, resolve, reject);
        })
            .then(function (resp) {
            _this.logger.verbose("Successfully acquired token");
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);
            return resp;
        })
            .catch(function (error) {
            _this.cacheStorage.resetTempCacheItems(request.state);
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);
            throw error;
        });
    };
    // #region Acquire Token
    /**
     * Use when initiating the login process or when you want to obtain an access_token for your API,
     * either by redirecting the user's browser window to the authorization endpoint or via opening a popup window in the user's browser.
     * @param {@link (AuthenticationParameters:type)}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     */
    UserAgentApplication.prototype.acquireTokenInteractive = function (interactionType, isLoginCall, request, resolve, reject) {
        var _this = this;
        this.logger.verbose("AcquireTokenInteractive has been called");
        // block the request if made from the hidden iframe
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].blockReloadInHiddenIframes();
        var interactionProgress = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].REDIRECT_REQUEST, "" + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].resourceDelimiter + request.state);
        }
        // If already in progress, do not proceed
        if (interactionProgress === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress) {
            var thrownError = isLoginCall ? _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createLoginInProgressError() : _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createAcquireTokenInProgressError();
            var stateOnlyResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(this.getAccountState(request.state));
            this.cacheStorage.resetTempCacheItems(request.state);
            this.authErrorHandler(interactionType, thrownError, stateOnlyResponse, reject);
            return;
        }
        // Get the account object if a session exists
        var account;
        if (request && request.account && !isLoginCall) {
            account = request.account;
            this.logger.verbose("Account set from request");
        }
        else {
            account = this.getAccount();
            this.logger.verbose("Account set from MSAL Cache");
        }
        // If no session exists, prompt the user to login.
        if (!account && !_ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].isSSOParam(request)) {
            if (isLoginCall) {
                // extract ADAL id_token if exists
                var adalIdToken = this.extractADALIdToken();
                // silent login if ADAL id_token is retrieved successfully - SSO
                if (adalIdToken && !request.scopes) {
                    this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");
                    var tokenRequest = this.buildIDTokenRequest(request);
                    this.silentLogin = true;
                    this.acquireTokenSilent(tokenRequest).then(function (response) {
                        _this.silentLogin = false;
                        _this.logger.info("Unified cache call is successful");
                        _this.authResponseHandler(interactionType, response, resolve);
                        return;
                    }, function (error) {
                        _this.silentLogin = false;
                        _this.logger.error("Error occurred during unified cache ATS: " + error);
                        // proceed to login since ATS failed
                        _this.acquireTokenHelper(null, interactionType, isLoginCall, request, resolve, reject);
                    });
                }
                // No ADAL token found, proceed to login
                else {
                    this.logger.verbose("Login call but no token found, proceed to login");
                    this.acquireTokenHelper(null, interactionType, isLoginCall, request, resolve, reject);
                }
            }
            // AcquireToken call, but no account or context given, so throw error
            else {
                this.logger.verbose("AcquireToken call, no context or account given");
                this.logger.info("User login is required");
                var stateOnlyResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(this.getAccountState(request.state));
                this.cacheStorage.resetTempCacheItems(request.state);
                this.authErrorHandler(interactionType, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createUserLoginRequiredError(), stateOnlyResponse, reject);
                return;
            }
        }
        // User session exists
        else {
            this.logger.verbose("User session exists, login not required");
            this.acquireTokenHelper(account, interactionType, isLoginCall, request, resolve, reject);
        }
    };
    /**
     * @hidden
     * @ignore
     * Helper function to acquireToken
     *
     */
    UserAgentApplication.prototype.acquireTokenHelper = function (account, interactionType, isLoginCall, request, resolve, reject) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var requestSignature, serverAuthenticationRequest, acquireTokenAuthority, popUpWindow, responseType, loginStartPage, urlNavigate, hash, error_1, navigate, err_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.logger.verbose("AcquireTokenHelper has been called");
                        this.logger.verbose("Interaction type: " + interactionType + ". isLoginCall: " + isLoginCall);
                        // Track the acquireToken progress
                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress);
                        requestSignature = request.scopes ? request.scopes.join(" ").toLowerCase() : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes.join(" ");
                        this.logger.verbosePii("Request signature: " + requestSignature);
                        acquireTokenAuthority = (request && request.authority) ? _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata) : this.authorityInstance;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 11, , 12]);
                        if (!!acquireTokenAuthority.hasCachedMetadata()) return [3 /*break*/, 3];
                        this.logger.verbose("No cached metadata for authority");
                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromNetwork(acquireTokenAuthority, this.telemetryManager, request.correlationId)];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.logger.verbose("Cached metadata found for authority");
                        _a.label = 4;
                    case 4:
                        responseType = isLoginCall ? _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ResponseTypes"].id_token : this.getTokenType(account, request.scopes);
                        loginStartPage = request.redirectStartPage || window.location.href;
                        serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"](acquireTokenAuthority, this.clientId, responseType, this.getRedirectUri(request && request.redirectUri), request.scopes, request.state, request.correlationId);
                        this.logger.verbose("Finished building server authentication request");
                        this.updateCacheEntries(serverAuthenticationRequest, account, isLoginCall, loginStartPage);
                        this.logger.verbose("Updating cache entries");
                        // populate QueryParameters (sid/login_hint) and any other extraQueryParameters set by the developer
                        serverAuthenticationRequest.populateQueryParams(account, request);
                        this.logger.verbose("Query parameters populated from account");
                        urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].createNavigateUrl(serverAuthenticationRequest) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].response_mode_fragment;
                        // set state in cache
                        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
                            if (!isLoginCall) {
                                this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_ACQ_TOKEN, request.state), serverAuthenticationRequest.state, this.inCookie);
                                this.logger.verbose("State cached for redirect");
                                this.logger.verbosePii("State cached: " + serverAuthenticationRequest.state);
                            }
                            else {
                                this.logger.verbose("Interaction type redirect but login call is true. State not cached");
                            }
                        }
                        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup) {
                            window.renewStates.push(serverAuthenticationRequest.state);
                            window.requestType = isLoginCall ? _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
                            this.logger.verbose("State saved to window");
                            this.logger.verbosePii("State saved: " + serverAuthenticationRequest.state);
                            // Register callback to capture results from server
                            this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);
                        }
                        else {
                            this.logger.verbose("Invalid interaction error. State not cached");
                            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidInteractionTypeError();
                        }
                        if (!(interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup)) return [3 /*break*/, 9];
                        this.logger.verbose("Interaction type is popup. Generating popup window");
                        // Generate a popup window
                        try {
                            popUpWindow = this.openPopup(urlNavigate, "msal", _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].popUpWidth, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].popUpHeight);
                            // Push popup window handle onto stack for tracking
                            _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].trackPopup(popUpWindow);
                        }
                        catch (e) {
                            this.logger.info(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.code + ":" + _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.desc);
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.code);
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.desc);
                            if (reject) {
                                reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createPopupWindowError());
                                return [2 /*return*/];
                            }
                        }
                        if (!popUpWindow) return [3 /*break*/, 8];
                        _a.label = 5;
                    case 5:
                        _a.trys.push([5, 7, , 8]);
                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].monitorPopupForHash(popUpWindow, this.config.system.loadFrameTimeout, urlNavigate, this.logger)];
                    case 6:
                        hash = _a.sent();
                        this.handleAuthenticationResponse(hash);
                        // Request completed successfully, set to completed
                        this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
                        this.logger.info("Closing popup window");
                        // TODO: Check how this can be extracted for any framework specific code?
                        if (this.config.framework.isAngular) {
                            this.broadcast("msal:popUpHashChanged", hash);
                        }
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].closePopups();
                        return [3 /*break*/, 8];
                    case 7:
                        error_1 = _a.sent();
                        if (reject) {
                            reject(error_1);
                        }
                        if (this.config.framework.isAngular) {
                            this.broadcast("msal:popUpClosed", error_1.errorCode + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].resourceDelimiter + error_1.errorMessage);
                        }
                        else {
                            // Request failed, set to canceled
                            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
                            popUpWindow.close();
                        }
                        return [3 /*break*/, 8];
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        // If onRedirectNavigate is implemented, invoke it and provide urlNavigate
                        if (request.onRedirectNavigate) {
                            this.logger.verbose("Invoking onRedirectNavigate callback");
                            navigate = request.onRedirectNavigate(urlNavigate);
                            // Returning false from onRedirectNavigate will stop navigation
                            if (navigate !== false) {
                                this.logger.verbose("onRedirectNavigate did not return false, navigating");
                                this.navigateWindow(urlNavigate);
                            }
                            else {
                                this.logger.verbose("onRedirectNavigate returned false, stopping navigation");
                            }
                        }
                        else {
                            // Otherwise, perform navigation
                            this.logger.verbose("Navigating window to urlNavigate");
                            this.navigateWindow(urlNavigate);
                        }
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        err_1 = _a.sent();
                        this.logger.error(err_1);
                        this.cacheStorage.resetTempCacheItems(request.state);
                        this.authErrorHandler(interactionType, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createEndpointResolutionError(err_1.toString), Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(request.state), reject);
                        if (popUpWindow) {
                            popUpWindow.close();
                        }
                        return [3 /*break*/, 12];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * API interfacing idToken request when applications already have a session/hint acquired by authorization client applications
     * @param request
     */
    UserAgentApplication.prototype.ssoSilent = function (request) {
        this.logger.verbose("ssoSilent has been called");
        // throw an error on an empty request
        if (!request) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createEmptyRequestError();
        }
        // throw an error on no hints passed
        if (!request.sid && !request.loginHint) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createSsoSilentError();
        }
        return this.acquireTokenSilent(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, request, { scopes: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes }));
    };
    /**
     * Use this function to obtain a token before every call to the API / resource provider
     *
     * MSAL return's a cached token when available
     * Or it send's a request to the STS to obtain a new token using a hidden iframe.
     *
     * @param {@link AuthenticationParameters}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object
     *
     */
    UserAgentApplication.prototype.acquireTokenSilent = function (userRequest) {
        var _this = this;
        this.logger.verbose("AcquireTokenSilent has been called");
        // validate the request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeSilent);
        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].AcquireTokenSilent);
        var requestSignature = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].createRequestSignature(request);
        return new Promise(function (resolve, reject) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
            var scope, account, adalIdToken, responseType, serverAuthenticationRequest, adalIdTokenObject, userContainedClaims, authErr, cacheResultResponse, logMessage, err_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        // block the request if made from the hidden iframe
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].blockReloadInHiddenIframes();
                        scope = request.scopes.join(" ").toLowerCase();
                        this.logger.verbosePii("Serialized scopes: " + scope);
                        if (request.account) {
                            account = request.account;
                            this.logger.verbose("Account set from request");
                        }
                        else {
                            account = this.getAccount();
                            this.logger.verbose("Account set from MSAL Cache");
                        }
                        adalIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].adalIdToken);
                        // In the event of no account being passed in the config, no session id, and no pre-existing adalIdToken, user will need to log in
                        if (!account && !(request.sid || request.loginHint) && _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(adalIdToken)) {
                            this.logger.info("User login is required");
                            // The promise rejects with a UserLoginRequiredError, which should be caught and user should be prompted to log in interactively
                            return [2 /*return*/, reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createUserLoginRequiredError())];
                        }
                        responseType = this.getTokenType(account, request.scopes);
                        this.logger.verbose("Response type: " + responseType);
                        serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"](_authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata), this.clientId, responseType, this.getRedirectUri(request.redirectUri), request.scopes, request.state, request.correlationId);
                        this.logger.verbose("Finished building server authentication request");
                        // populate QueryParameters (sid/login_hint) and any other extraQueryParameters set by the developer
                        if (_ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].isSSOParam(request) || account) {
                            serverAuthenticationRequest.populateQueryParams(account, request, null, true);
                            this.logger.verbose("Query parameters populated from existing SSO or account");
                        }
                        // if user didn't pass login_hint/sid and adal's idtoken is present, extract the login_hint from the adalIdToken
                        else if (!account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(adalIdToken)) {
                            adalIdTokenObject = _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__["TokenUtils"].extractIdToken(adalIdToken);
                            this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters");
                            serverAuthenticationRequest.populateQueryParams(account, null, adalIdTokenObject, true);
                        }
                        else {
                            this.logger.verbose("No additional query parameters added");
                        }
                        userContainedClaims = request.claimsRequest || serverAuthenticationRequest.claimsValue;
                        // If request.forceRefresh is set to true, force a request for a new token instead of getting it from the cache
                        if (!userContainedClaims && !request.forceRefresh) {
                            try {
                                cacheResultResponse = this.getCachedToken(serverAuthenticationRequest, account);
                            }
                            catch (e) {
                                authErr = e;
                            }
                        }
                        if (!cacheResultResponse) return [3 /*break*/, 1];
                        this.logger.verbose("Token found in cache lookup");
                        this.logger.verbosePii("Scopes found: " + JSON.stringify(cacheResultResponse.scopes));
                        resolve(cacheResultResponse);
                        return [2 /*return*/, null];
                    case 1:
                        if (!authErr) return [3 /*break*/, 2];
                        this.logger.infoPii(authErr.errorCode + ":" + authErr.errorMessage);
                        reject(authErr);
                        return [2 /*return*/, null];
                    case 2:
                        logMessage = void 0;
                        if (userContainedClaims) {
                            logMessage = "Skipped cache lookup since claims were given";
                        }
                        else if (request.forceRefresh) {
                            logMessage = "Skipped cache lookup since request.forceRefresh option was set to true";
                        }
                        else {
                            logMessage = "No valid token found in cache lookup";
                        }
                        this.logger.verbose(logMessage);
                        // Cache result can return null if cache is empty. In that case, set authority to default value if no authority is passed to the API.
                        if (!serverAuthenticationRequest.authorityInstance) {
                            serverAuthenticationRequest.authorityInstance = request.authority ?
                                _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata)
                                : this.authorityInstance;
                        }
                        this.logger.verbosePii("Authority instance: " + serverAuthenticationRequest.authority);
                        _a.label = 3;
                    case 3:
                        _a.trys.push([3, 7, , 8]);
                        if (!!serverAuthenticationRequest.authorityInstance.hasCachedMetadata()) return [3 /*break*/, 5];
                        this.logger.verbose("No cached metadata for authority");
                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromNetwork(serverAuthenticationRequest.authorityInstance, this.telemetryManager, request.correlationId)];
                    case 4:
                        _a.sent();
                        this.logger.verbose("Authority has been updated with endpoint discovery response");
                        return [3 /*break*/, 6];
                    case 5:
                        this.logger.verbose("Cached metadata found for authority");
                        _a.label = 6;
                    case 6:
                        /*
                         * refresh attempt with iframe
                         * Already renewing for this scope, callback when we get the token.
                         */
                        if (window.activeRenewals[requestSignature]) {
                            this.logger.verbose("Renewing token in progress. Registering callback");
                            // Active renewals contains the state for each renewal.
                            this.registerCallback(window.activeRenewals[requestSignature], requestSignature, resolve, reject);
                        }
                        else {
                            if (request.scopes && _ScopeSet__WEBPACK_IMPORTED_MODULE_9__["ScopeSet"].onlyContainsOidcScopes(request.scopes)) {
                                /*
                                 * App uses idToken to send to api endpoints
                                 * Default scope is tracked as OIDC scopes to store this token
                                 */
                                this.logger.verbose("OpenID Connect scopes only, renewing idToken");
                                this.silentLogin = true;
                                this.renewIdToken(requestSignature, resolve, reject, account, serverAuthenticationRequest);
                            }
                            else {
                                // renew access token
                                this.logger.verbose("Renewing access token");
                                this.renewToken(requestSignature, resolve, reject, account, serverAuthenticationRequest);
                            }
                        }
                        return [3 /*break*/, 8];
                    case 7:
                        err_2 = _a.sent();
                        this.logger.error(err_2);
                        reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createEndpointResolutionError(err_2.toString()));
                        return [2 /*return*/, null];
                    case 8: return [2 /*return*/];
                }
            });
        }); })
            .then(function (res) {
            _this.logger.verbose("Successfully acquired token");
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);
            return res;
        })
            .catch(function (error) {
            _this.cacheStorage.resetTempCacheItems(request.state);
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);
            throw error;
        });
    };
    // #endregion
    // #region Popup Window Creation
    /**
     * @hidden
     *
     * Configures popup window for login.
     *
     * @param urlNavigate
     * @param title
     * @param popUpWidth
     * @param popUpHeight
     * @ignore
     * @hidden
     */
    UserAgentApplication.prototype.openPopup = function (urlNavigate, title, popUpWidth, popUpHeight) {
        this.logger.verbose("OpenPopup has been called");
        try {
            /**
             * adding winLeft and winTop to account for dual monitor
             * using screenLeft and screenTop for IE8 and earlier
             */
            var winLeft = window.screenLeft ? window.screenLeft : window.screenX;
            var winTop = window.screenTop ? window.screenTop : window.screenY;
            /**
             * window.innerWidth displays browser window"s height and width excluding toolbars
             * using document.documentElement.clientWidth for IE8 and earlier
             */
            var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            var height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
            var left = ((width / 2) - (popUpWidth / 2)) + winLeft;
            var top_1 = ((height / 2) - (popUpHeight / 2)) + winTop;
            // open the window
            var popupWindow = window.open(urlNavigate, title, "width=" + popUpWidth + ", height=" + popUpHeight + ", top=" + top_1 + ", left=" + left + ", scrollbars=yes");
            if (!popupWindow) {
                throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createPopupWindowError();
            }
            if (popupWindow.focus) {
                popupWindow.focus();
            }
            return popupWindow;
        }
        catch (e) {
            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createPopupWindowError(e.toString());
        }
    };
    // #endregion
    // #region Iframe Management
    /**
     * @hidden
     * Calling _loadFrame but with a timeout to signal failure in loadframeStatus. Callbacks are left.
     * registered when network errors occur and subsequent token requests for same resource are registered to the pending request.
     * @ignore
     */
    UserAgentApplication.prototype.loadIframeTimeout = function (urlNavigate, frameName, requestSignature) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var expectedState, iframe, _a, hash, error_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        expectedState = window.activeRenewals[requestSignature];
                        this.logger.verbosePii("Set loading state to pending for: " + requestSignature + ":" + expectedState);
                        this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, expectedState), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress);
                        if (!this.config.system.navigateFrameWait) return [3 /*break*/, 2];
                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].loadFrame(urlNavigate, frameName, this.config.system.navigateFrameWait, this.logger)];
                    case 1:
                        _a = _b.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        _a = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].loadFrameSync(urlNavigate, frameName, this.logger);
                        _b.label = 3;
                    case 3:
                        iframe = _a;
                        _b.label = 4;
                    case 4:
                        _b.trys.push([4, 6, , 7]);
                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].monitorIframeForHash(iframe.contentWindow, this.config.system.loadFrameTimeout, urlNavigate, this.logger)];
                    case 5:
                        hash = _b.sent();
                        if (hash) {
                            this.handleAuthenticationResponse(hash);
                        }
                        return [3 /*break*/, 7];
                    case 6:
                        error_2 = _b.sent();
                        if (this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, expectedState)) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress) {
                            // fail the iframe session if it's in pending state
                            this.logger.verbose("Loading frame has timed out after: " + (this.config.system.loadFrameTimeout / 1000) + " seconds for scope/authority " + requestSignature + ":" + expectedState);
                            // Error after timeout
                            if (expectedState && window.callbackMappedToRenewStates[expectedState]) {
                                window.callbackMappedToRenewStates[expectedState](null, error_2);
                            }
                            this.cacheStorage.removeItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, expectedState));
                        }
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].removeHiddenIframe(iframe);
                        throw error_2;
                    case 7:
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].removeHiddenIframe(iframe);
                        return [2 /*return*/];
                }
            });
        });
    };
    // #endregion
    // #region General Helpers
    /**
     * @hidden
     * Used to redirect the browser to the STS authorization endpoint
     * @param {string} urlNavigate - URL of the authorization endpoint
     */
    UserAgentApplication.prototype.navigateWindow = function (urlNavigate, popupWindow) {
        // Navigate if valid URL
        if (urlNavigate && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(urlNavigate)) {
            var navigateWindow = popupWindow ? popupWindow : window;
            var logMessage = popupWindow ? "Navigated Popup window to:" + urlNavigate : "Navigate to:" + urlNavigate;
            this.logger.infoPii(logMessage);
            navigateWindow.location.assign(urlNavigate);
        }
        else {
            this.logger.info("Navigate url is empty");
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Navigate url is empty");
        }
    };
    /**
     * @hidden
     * Used to add the developer requested callback to the array of callbacks for the specified scopes. The updated array is stored on the window object
     * @param {string} expectedState - Unique state identifier (guid).
     * @param {string} scope - Developer requested permissions. Not all scopes are guaranteed to be included in the access token returned.
     * @param {Function} resolve - The resolve function of the promise object.
     * @param {Function} reject - The reject function of the promise object.
     * @ignore
     */
    UserAgentApplication.prototype.registerCallback = function (expectedState, requestSignature, resolve, reject) {
        var _this = this;
        // track active renewals
        window.activeRenewals[requestSignature] = expectedState;
        // initialize callbacks mapped array
        if (!window.promiseMappedToRenewStates[expectedState]) {
            window.promiseMappedToRenewStates[expectedState] = [];
        }
        // indexing on the current state, push the callback params to callbacks mapped
        window.promiseMappedToRenewStates[expectedState].push({ resolve: resolve, reject: reject });
        // Store the server response in the current window??
        if (!window.callbackMappedToRenewStates[expectedState]) {
            window.callbackMappedToRenewStates[expectedState] = function (response, error) {
                // reset active renewals
                window.activeRenewals[requestSignature] = null;
                // for all promiseMappedtoRenewStates for a given 'state' - call the reject/resolve with error/token respectively
                for (var i = 0; i < window.promiseMappedToRenewStates[expectedState].length; ++i) {
                    try {
                        if (error) {
                            window.promiseMappedToRenewStates[expectedState][i].reject(error);
                        }
                        else if (response) {
                            window.promiseMappedToRenewStates[expectedState][i].resolve(response);
                        }
                        else {
                            _this.cacheStorage.resetTempCacheItems(expectedState);
                            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Error and response are both null");
                        }
                    }
                    catch (e) {
                        _this.logger.warning(e);
                    }
                }
                // reset
                window.promiseMappedToRenewStates[expectedState] = null;
                window.callbackMappedToRenewStates[expectedState] = null;
            };
        }
    };
    // #endregion
    // #region Logout
    /**
     * Use to log out the current user, and redirect the user to the postLogoutRedirectUri.
     * Default behaviour is to redirect the user to `window.location.href`.
     */
    UserAgentApplication.prototype.logout = function (correlationId) {
        this.logger.verbose("Logout has been called");
        this.logoutAsync(correlationId);
    };
    /**
     * Async version of logout(). Use to log out the current user.
     * @param correlationId Request correlationId
     */
    UserAgentApplication.prototype.logoutAsync = function (correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var requestCorrelationId, apiEvent, correlationIdParam, postLogoutQueryParam, urlNavigate, error_3;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        requestCorrelationId = correlationId || _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_28__["CryptoUtils"].createNewGuid();
                        apiEvent = this.telemetryManager.createAndStartApiEvent(requestCorrelationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].Logout);
                        this.clearCache();
                        this.account = null;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 5, , 6]);
                        if (!!this.authorityInstance.hasCachedMetadata()) return [3 /*break*/, 3];
                        this.logger.verbose("No cached metadata for authority");
                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromNetwork(this.authorityInstance, this.telemetryManager, correlationId)];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.logger.verbose("Cached metadata found for authority");
                        _a.label = 4;
                    case 4:
                        correlationIdParam = "client-request-id=" + requestCorrelationId;
                        postLogoutQueryParam = void 0;
                        if (this.getPostLogoutRedirectUri()) {
                            postLogoutQueryParam = "&post_logout_redirect_uri=" + encodeURIComponent(this.getPostLogoutRedirectUri());
                            this.logger.verbose("redirectUri found and set");
                        }
                        else {
                            postLogoutQueryParam = "";
                            this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty");
                        }
                        urlNavigate = void 0;
                        if (this.authorityInstance.EndSessionEndpoint) {
                            urlNavigate = this.authorityInstance.EndSessionEndpoint + "?" + correlationIdParam + postLogoutQueryParam;
                            this.logger.verbose("EndSessionEndpoint found and urlNavigate set");
                            this.logger.verbosePii("urlNavigate set to: " + this.authorityInstance.EndSessionEndpoint);
                        }
                        else {
                            urlNavigate = this.authority + "oauth2/v2.0/logout?" + correlationIdParam + postLogoutQueryParam;
                            this.logger.verbose("No endpoint, urlNavigate set to default");
                        }
                        this.telemetryManager.stopAndFlushApiEvent(requestCorrelationId, apiEvent, true);
                        this.logger.verbose("Navigating window to urlNavigate");
                        this.navigateWindow(urlNavigate);
                        return [3 /*break*/, 6];
                    case 5:
                        error_3 = _a.sent();
                        this.telemetryManager.stopAndFlushApiEvent(requestCorrelationId, apiEvent, false, error_3.errorCode);
                        return [3 /*break*/, 6];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * @hidden
     * Clear all access tokens and ID tokens in the cache.
     * @ignore
     */
    UserAgentApplication.prototype.clearCache = function () {
        this.logger.verbose("Clearing cache");
        window.renewStates = [];
        var tokenCacheItems = this.cacheStorage.getAllTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].homeAccountIdentifier);
        for (var i = 0; i < tokenCacheItems.length; i++) {
            this.cacheStorage.removeItem(JSON.stringify(tokenCacheItems[i].key));
        }
        this.cacheStorage.resetCacheItems();
        this.cacheStorage.clearMsalCookie();
        this.logger.verbose("Cache cleared");
    };
    /**
     * @hidden
     * Clear a given access token from the cache.
     *
     * @param accessToken
     */
    UserAgentApplication.prototype.clearCacheForScope = function (accessToken) {
        this.logger.verbose("Clearing access token from cache");
        var accessTokenItems = this.cacheStorage.getAllAccessTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].homeAccountIdentifier);
        for (var i = 0; i < accessTokenItems.length; i++) {
            var token = accessTokenItems[i];
            if (token.value.accessToken === accessToken) {
                this.cacheStorage.removeItem(JSON.stringify(token.key));
                this.logger.verbosePii("Access token removed: " + token.key);
            }
        }
    };
    // #endregion
    // #region Response
    /**
     * @hidden
     * @ignore
     * Checks if the redirect response is received from the STS. In case of redirect, the url fragment has either id_token, access_token or error.
     * @param {string} hash - Hash passed from redirect page.
     * @returns {Boolean} - true if response contains id_token, access_token or error, false otherwise.
     */
    UserAgentApplication.prototype.isCallback = function (hash) {
        this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0.");
        this.logger.verbose("isCallback has been called");
        return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlContainsHash(hash);
    };
    /**
     * @hidden
     * Used to call the constructor callback with the token/error
     * @param {string} [hash=window.location.hash] - Hash fragment of Url.
     */
    UserAgentApplication.prototype.processCallBack = function (hash, stateInfo, parentCallback) {
        this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");
        // get the state info from the hash
        if (!stateInfo) {
            this.logger.verbose("StateInfo is null, getting stateInfo from hash");
            stateInfo = this.getResponseState(hash);
        }
        var response;
        var authErr;
        // Save the token info from the hash
        try {
            response = this.saveTokenFromHash(hash, stateInfo);
        }
        catch (err) {
            authErr = err;
        }
        try {
            // Clear the cookie in the hash
            this.cacheStorage.clearMsalCookie(stateInfo.state);
            var accountState = this.getAccountState(stateInfo.state);
            if (response) {
                if ((stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken) || response.accessToken) {
                    if (window.parent !== window) {
                        this.logger.verbose("Window is in iframe, acquiring token silently");
                    }
                    else {
                        this.logger.verbose("Acquiring token interactive in progress");
                    }
                    this.logger.verbose("Response tokenType set to " + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN);
                    response.tokenType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN;
                }
                else if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login) {
                    this.logger.verbose("Response tokenType set to " + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN);
                    response.tokenType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN;
                }
                if (!parentCallback) {
                    this.logger.verbose("Setting redirectResponse");
                    this.redirectResponse = response;
                    return;
                }
            }
            else if (!parentCallback) {
                this.logger.verbose("Response is null, setting redirectResponse with state");
                this.redirectResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(accountState);
                this.redirectError = authErr;
                this.cacheStorage.resetTempCacheItems(stateInfo.state);
                return;
            }
            this.logger.verbose("Calling callback provided to processCallback");
            parentCallback(response, authErr);
        }
        catch (err) {
            this.logger.error("Error occurred in token received callback function: " + err);
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createErrorInCallbackFunction(err.toString());
        }
    };
    /**
     * @hidden
     * This method must be called for processing the response received from the STS if using popups or iframes. It extracts the hash, processes the token or error
     * information and saves it in the cache. It then resolves the promises with the result.
     * @param {string} [hash=window.location.hash] - Hash fragment of Url.
     */
    UserAgentApplication.prototype.handleAuthenticationResponse = function (hash) {
        this.logger.verbose("HandleAuthenticationResponse has been called");
        // retrieve the hash
        var locationHash = hash || window.location.hash;
        // if (window.parent !== window), by using self, window.parent becomes equal to window in getResponseState method specifically
        var stateInfo = this.getResponseState(locationHash);
        this.logger.verbose("Obtained state from response");
        var tokenResponseCallback = window.callbackMappedToRenewStates[stateInfo.state];
        this.processCallBack(locationHash, stateInfo, tokenResponseCallback);
    };
    /**
     * @hidden
     * This method must be called for processing the response received from the STS when using redirect flows. It extracts the hash, processes the token or error
     * information and saves it in the cache. The result can then be accessed by user registered callbacks.
     * @param {string} [hash=window.location.hash] - Hash fragment of Url.
     */
    UserAgentApplication.prototype.handleRedirectAuthenticationResponse = function (hash) {
        this.logger.info("Returned from redirect url");
        this.logger.verbose("HandleRedirectAuthenticationResponse has been called");
        // clear hash from window
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].clearUrlFragment();
        this.logger.verbose("Window.location.hash cleared");
        // if (window.parent !== window), by using self, window.parent becomes equal to window in getResponseState method specifically
        var stateInfo = this.getResponseState(hash);
        // if set to navigate to loginRequest page post login
        if (this.config.auth.navigateToLoginRequestUrl && window.parent === window) {
            this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");
            var loginRequestUrl = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].LOGIN_REQUEST, stateInfo.state), this.inCookie);
            // Redirect to home page if login request url is null (real null or the string null)
            if (!loginRequestUrl || loginRequestUrl === "null") {
                this.logger.error("Unable to get valid login request url from cache, redirecting to home page");
                window.location.assign("/");
                return;
            }
            else {
                this.logger.verbose("Valid login request url obtained from cache");
                var currentUrl = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].removeHashFromUrl(window.location.href);
                var finalRedirectUrl = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].removeHashFromUrl(loginRequestUrl);
                if (currentUrl !== finalRedirectUrl) {
                    this.logger.verbose("Current url is not login request url, navigating");
                    this.logger.verbosePii("CurrentUrl: " + currentUrl + ", finalRedirectUrl: " + finalRedirectUrl);
                    window.location.assign("" + finalRedirectUrl + hash);
                    return;
                }
                else {
                    this.logger.verbose("Current url matches login request url");
                    var loginRequestUrlComponents = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].GetUrlComponents(loginRequestUrl);
                    if (loginRequestUrlComponents.Hash) {
                        this.logger.verbose("Login request url contains hash, resetting non-msal hash");
                        window.location.hash = loginRequestUrlComponents.Hash;
                    }
                }
            }
        }
        else if (!this.config.auth.navigateToLoginRequestUrl) {
            this.logger.verbose("Default navigation to start page after login turned off");
        }
        this.processCallBack(hash, stateInfo, null);
    };
    /**
     * @hidden
     * Creates a stateInfo object from the URL fragment and returns it.
     * @param {string} hash  -  Hash passed from redirect page
     * @returns {TokenResponse} an object created from the redirect response from AAD comprising of the keys - parameters, requestType, stateMatch, stateResponse and valid.
     * @ignore
     */
    UserAgentApplication.prototype.getResponseState = function (hash) {
        this.logger.verbose("GetResponseState has been called");
        var parameters = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].deserializeHash(hash);
        var stateResponse;
        if (!parameters) {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Hash was not parsed correctly.");
        }
        if (parameters.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].STATE)) {
            this.logger.verbose("Hash contains state. Creating stateInfo object");
            var parsedState = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].parseLibraryState(parameters.state);
            stateResponse = {
                requestType: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].unknown,
                state: parameters.state,
                timestamp: parsedState.ts,
                method: parsedState.method,
                stateMatch: false
            };
        }
        else {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Hash does not contain state.");
        }
        /*
         * async calls can fire iframe and login request at the same time if developer does not use the API as expected
         * incoming callback needs to be looked up to find the request type
         */
        // loginRedirect
        if (stateResponse.state === this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_LOGIN, stateResponse.state), this.inCookie) || stateResponse.state === this.silentAuthenticationState) {
            this.logger.verbose("State matches cached state, setting requestType to login");
            stateResponse.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login;
            stateResponse.stateMatch = true;
            return stateResponse;
        }
        // acquireTokenRedirect
        else if (stateResponse.state === this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_ACQ_TOKEN, stateResponse.state), this.inCookie)) {
            this.logger.verbose("State matches cached state, setting requestType to renewToken");
            stateResponse.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
            stateResponse.stateMatch = true;
            return stateResponse;
        }
        // external api requests may have many renewtoken requests for different resource
        if (!stateResponse.stateMatch) {
            this.logger.verbose("State does not match cached state, setting requestType to type from window");
            stateResponse.requestType = window.requestType;
            var statesInParentContext = window.renewStates;
            for (var i = 0; i < statesInParentContext.length; i++) {
                if (statesInParentContext[i] === stateResponse.state) {
                    this.logger.verbose("Matching state found for request");
                    stateResponse.stateMatch = true;
                    break;
                }
            }
            if (!stateResponse.stateMatch) {
                this.logger.verbose("Matching state not found for request");
            }
        }
        return stateResponse;
    };
    // #endregion
    // #region Token Processing (Extract to TokenProcessing.ts)
    /**
     * @hidden
     * Used to get token for the specified set of scopes from the cache
     * @param {@link ServerRequestParameters} - Request sent to the STS to obtain an id_token/access_token
     * @param {Account} account - Account for which the scopes were requested
     */
    UserAgentApplication.prototype.getCachedToken = function (serverAuthenticationRequest, account) {
        this.logger.verbose("GetCachedToken has been called");
        var scopes = serverAuthenticationRequest.scopes;
        /**
         * Id Token should be returned in every acquireTokenSilent call. The only exception is a response_type = token
         * request when a valid ID Token is not present in the cache.
         */
        var idToken = this.getCachedIdToken(serverAuthenticationRequest, account);
        var authResponse = this.getCachedAccessToken(serverAuthenticationRequest, account, scopes);
        var accountState = this.getAccountState(serverAuthenticationRequest.state);
        return _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__["ResponseUtils"].buildAuthResponse(idToken, authResponse, serverAuthenticationRequest, account, scopes, accountState);
    };
    /**
     * @hidden
     *
     * Uses passed in authority to further filter an array of tokenCacheItems until only the token being searched for remains, then returns that tokenCacheItem.
     * This method will throw if authority filtering still yields multiple matching tokens and will return null if not tokens match the authority passed in.
     *
     * @param authority
     * @param tokenCacheItems
     * @param request
     * @param requestScopes
     * @param tokenType
     */
    UserAgentApplication.prototype.getTokenCacheItemByAuthority = function (authority, tokenCacheItems, requestScopes, tokenType) {
        var _this = this;
        var filteredAuthorityItems;
        if (_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].isCommonAuthority(authority) || _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].isOrganizationsAuthority(authority)) {
            filteredAuthorityItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__["AuthCacheUtils"].filterTokenCacheItemsByDomain(tokenCacheItems, _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].GetUrlComponents(authority).HostNameAndPort);
        }
        else {
            filteredAuthorityItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__["AuthCacheUtils"].filterTokenCacheItemsByAuthority(tokenCacheItems, authority);
        }
        if (filteredAuthorityItems.length === 1) {
            return filteredAuthorityItems[0];
        }
        else if (filteredAuthorityItems.length > 1) {
            this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token.");
            filteredAuthorityItems.forEach(function (accessTokenCacheItem) {
                _this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
            });
            return null;
        }
        else {
            this.logger.verbose("No matching tokens of type " + tokenType + " found");
            return null;
        }
    };
    /**
     *
     * @hidden
     *
     * Searches the token cache for an ID Token that matches the request parameter and returns it as an IdToken object.
     *
     * @param serverAuthenticationRequest
     * @param account
     */
    UserAgentApplication.prototype.getCachedIdToken = function (serverAuthenticationRequest, account) {
        this.logger.verbose("Getting all cached tokens of type ID Token");
        var idTokenCacheItems = this.cacheStorage.getAllIdTokens(this.clientId, account ? account.homeAccountIdentifier : null);
        var matchAuthority = serverAuthenticationRequest.authority || this.authority;
        var idTokenCacheItem = this.getTokenCacheItemByAuthority(matchAuthority, idTokenCacheItems, null, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN);
        if (idTokenCacheItem) {
            this.logger.verbose("Evaluating ID token found");
            var idTokenIsStillValid = this.evaluateTokenExpiration(idTokenCacheItem);
            if (idTokenIsStillValid) {
                this.logger.verbose("ID token expiration is within offset, using ID token found in cache");
                var idTokenValue = idTokenCacheItem.value;
                if (idTokenValue) {
                    this.logger.verbose("ID Token found in cache is valid and unexpired");
                }
                else {
                    this.logger.verbose("ID Token found in cache is invalid");
                }
                return (idTokenValue) ? new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](idTokenValue.idToken) : null;
            }
            else {
                this.logger.verbose("Cached ID token is expired, removing from cache");
                this.cacheStorage.removeItem(JSON.stringify(idTokenCacheItem.key));
                return null;
            }
        }
        else {
            this.logger.verbose("No tokens found");
            return null;
        }
    };
    /**
     *
     * @hidden
     *
     * Searches the token cache for an access token that matches the request parameters and returns it as an AuthResponse.
     *
     * @param serverAuthenticationRequest
     * @param account
     * @param scopes
     */
    UserAgentApplication.prototype.getCachedAccessToken = function (serverAuthenticationRequest, account, scopes) {
        this.logger.verbose("Getting all cached tokens of type Access Token");
        var tokenCacheItems = this.cacheStorage.getAllAccessTokens(this.clientId, account ? account.homeAccountIdentifier : null);
        var scopeFilteredTokenCacheItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__["AuthCacheUtils"].filterTokenCacheItemsByScope(tokenCacheItems, scopes);
        var matchAuthority = serverAuthenticationRequest.authority || this.authority;
        // serverAuthenticationRequest.authority can only be common or organizations if not null
        var accessTokenCacheItem = this.getTokenCacheItemByAuthority(matchAuthority, scopeFilteredTokenCacheItems, scopes, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN);
        if (!accessTokenCacheItem) {
            this.logger.verbose("No matching token found when filtering by scope and authority");
            var authorityList = this.getUniqueAuthority(tokenCacheItems, "authority");
            if (authorityList.length > 1) {
                throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createMultipleAuthoritiesInCacheError(scopes.toString());
            }
            this.logger.verbose("Single authority used, setting authorityInstance");
            serverAuthenticationRequest.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(authorityList[0], this.config.auth.validateAuthority);
            return null;
        }
        else {
            serverAuthenticationRequest.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(accessTokenCacheItem.key.authority, this.config.auth.validateAuthority);
            this.logger.verbose("Evaluating access token found");
            var tokenIsStillValid = this.evaluateTokenExpiration(accessTokenCacheItem);
            // The response value will stay null if token retrieved from the cache is expired, otherwise it will be populated with said token's data
            if (tokenIsStillValid) {
                this.logger.verbose("Access token expiration is within offset, using access token found in cache");
                if (!account) {
                    account = this.getAccount();
                    if (!account) {
                        throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Account should not be null here.");
                    }
                }
                var aState = this.getAccountState(serverAuthenticationRequest.state);
                var response = {
                    uniqueId: "",
                    tenantId: "",
                    tokenType: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN,
                    idToken: null,
                    idTokenClaims: null,
                    accessToken: accessTokenCacheItem.value.accessToken,
                    scopes: accessTokenCacheItem.key.scopes.split(" "),
                    expiresOn: new Date(Number(accessTokenCacheItem.value.expiresIn) * 1000),
                    account: account,
                    accountState: aState,
                    fromCache: true
                };
                return response;
            }
            else {
                this.logger.verbose("Access token expired, removing from cache");
                this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
                return null;
            }
        }
    };
    /**
     * Returns true if the token passed in is within the acceptable expiration time offset, false if it is expired.
     * @param tokenCacheItem
     * @param serverAuthenticationRequest
     */
    UserAgentApplication.prototype.evaluateTokenExpiration = function (tokenCacheItem) {
        var expiration = Number(tokenCacheItem.value.expiresIn);
        return _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__["TokenUtils"].validateExpirationIsWithinOffset(expiration, this.config.system.tokenRenewalOffsetSeconds);
    };
    /**
     * @hidden
     * Used to get a unique list of authorities from the cache
     * @param {Array<AccessTokenCacheItem>}  accessTokenCacheItems - accessTokenCacheItems saved in the cache
     * @ignore
     */
    UserAgentApplication.prototype.getUniqueAuthority = function (accessTokenCacheItems, property) {
        this.logger.verbose("GetUniqueAuthority has been called");
        var authorityList = [];
        var flags = [];
        accessTokenCacheItems.forEach(function (element) {
            if (element.key.hasOwnProperty(property) && (flags.indexOf(element.key[property]) === -1)) {
                flags.push(element.key[property]);
                authorityList.push(element.key[property]);
            }
        });
        return authorityList;
    };
    /**
     * @hidden
     * Check if ADAL id_token exists and return if exists.
     *
     */
    UserAgentApplication.prototype.extractADALIdToken = function () {
        this.logger.verbose("ExtractADALIdToken has been called");
        var adalIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].adalIdToken);
        return (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(adalIdToken)) ? _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__["TokenUtils"].extractIdToken(adalIdToken) : null;
    };
    /**
     * @hidden
     * Acquires access token using a hidden iframe.
     * @ignore
     */
    UserAgentApplication.prototype.renewToken = function (requestSignature, resolve, reject, account, serverAuthenticationRequest) {
        this.logger.verbose("RenewToken has been called");
        this.logger.verbosePii("RenewToken scope and authority: " + requestSignature);
        var frameName = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].generateFrameName(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["FramePrefix"].TOKEN_FRAME, requestSignature);
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].addHiddenIFrame(frameName, this.logger);
        this.updateCacheEntries(serverAuthenticationRequest, account, false);
        this.logger.verbosePii("RenewToken expected state: " + serverAuthenticationRequest.state);
        // Build urlNavigate with "prompt=none" and navigate to URL in hidden iFrame
        var urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlRemoveQueryStringParameter(_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].createNavigateUrl(serverAuthenticationRequest), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt_none + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].response_mode_fragment;
        window.renewStates.push(serverAuthenticationRequest.state);
        window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
        this.logger.verbose("Set window.renewState and requestType");
        this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);
        this.logger.infoPii("Navigate to: " + urlNavigate);
        this.loadIframeTimeout(urlNavigate, frameName, requestSignature).catch(function (error) { return reject(error); });
    };
    /**
     * @hidden
     * Renews idtoken for app's own backend when clientId is passed as a single scope in the scopes array.
     * @ignore
     */
    UserAgentApplication.prototype.renewIdToken = function (requestSignature, resolve, reject, account, serverAuthenticationRequest) {
        this.logger.info("RenewIdToken has been called");
        var frameName = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].generateFrameName(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["FramePrefix"].ID_TOKEN_FRAME, requestSignature);
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].addHiddenIFrame(frameName, this.logger);
        this.updateCacheEntries(serverAuthenticationRequest, account, false);
        this.logger.verbose("RenewIdToken expected state: " + serverAuthenticationRequest.state);
        // Build urlNavigate with "prompt=none" and navigate to URL in hidden iFrame
        var urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlRemoveQueryStringParameter(_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].createNavigateUrl(serverAuthenticationRequest), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt_none + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].response_mode_fragment;
        if (this.silentLogin) {
            this.logger.verbose("Silent login is true, set silentAuthenticationState");
            window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login;
            this.silentAuthenticationState = serverAuthenticationRequest.state;
        }
        else {
            this.logger.verbose("Not silent login, set window.renewState and requestType");
            window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
            window.renewStates.push(serverAuthenticationRequest.state);
        }
        // note: scope here is clientId
        this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);
        this.logger.infoPii("Navigate to:\" " + urlNavigate);
        this.loadIframeTimeout(urlNavigate, frameName, requestSignature).catch(function (error) { return reject(error); });
    };
    /**
     * @hidden
     *
     * This method builds an Access Token Cache item and saves it to the cache, returning the original
     * AuthResponse augmented with a parsed expiresOn attribute.
     *
     * @param response The AuthResponse object that contains the token to be saved
     * @param authority The authority under which the ID token will be cached
     * @param scopes The scopes to be added to the cache item key (undefined for ID token cache items)
     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier
     * @param expiration Token expiration timestamp
     */
    UserAgentApplication.prototype.saveToken = function (response, authority, scopes, clientInfo, expiration) {
        var accessTokenKey = new _cache_AccessTokenKey__WEBPACK_IMPORTED_MODULE_1__["AccessTokenKey"](authority, this.clientId, scopes, clientInfo.uid, clientInfo.utid);
        var accessTokenValue = new _cache_AccessTokenValue__WEBPACK_IMPORTED_MODULE_2__["AccessTokenValue"](response.accessToken, response.idToken.rawIdToken, expiration.toString(), clientInfo.encodeClientInfo());
        this.cacheStorage.setItem(JSON.stringify(accessTokenKey), JSON.stringify(accessTokenValue));
        if (expiration) {
            this.logger.verbose("New expiration set for token");
            response.expiresOn = new Date(expiration * 1000);
        }
        else {
            this.logger.error("Could not parse expiresIn parameter for access token");
        }
        return response;
    };
    /**
     * @hidden
     *
     * This method sets up the elements of an ID Token cache item and calls saveToken to save it in
     * Access Token Cache item format for the client application to use.
     *
     * @param response The AuthResponse object that will be used to build the cache item
     * @param authority The authority under which the ID token will be cached
     * @param parameters The response's Hash Params, which contain the ID token returned from the server
     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier
     * @param idTokenObj ID Token object from which the ID token's expiration is extracted
     */
    /* tslint:disable:no-string-literal */
    UserAgentApplication.prototype.saveIdToken = function (response, authority, parameters, clientInfo, idTokenObj) {
        this.logger.verbose("SaveIdToken has been called");
        var idTokenResponse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, response);
        // Scopes are undefined so they don't show up in ID token cache key
        var scopes;
        idTokenResponse.scopes = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes;
        idTokenResponse.accessToken = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN];
        var expiration = Number(idTokenObj.expiration);
        // Set ID Token item in cache
        this.logger.verbose("Saving ID token to cache");
        return this.saveToken(idTokenResponse, authority, scopes, clientInfo, expiration);
    };
    /**
     * @hidden
     *
     * This method sets up the elements of an Access Token cache item and calls saveToken to save it to the cache
     *
     * @param response The AuthResponse object that will be used to build the cache item
     * @param authority The authority under which the access token will be cached
     * @param parameters The response's Hash Params, which contain the access token returned from the server
     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier
     */
    /* tslint:disable:no-string-literal */
    UserAgentApplication.prototype.saveAccessToken = function (response, authority, parameters, clientInfo) {
        this.logger.verbose("SaveAccessToken has been called");
        var accessTokenResponse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, response);
        // read the scopes
        var scope = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SCOPE];
        var consentedScopes = scope.split(" ");
        // retrieve all access tokens from the cache, remove the dup scopes
        var accessTokenCacheItems = this.cacheStorage.getAllAccessTokens(this.clientId, authority);
        this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");
        for (var i = 0; i < accessTokenCacheItems.length; i++) {
            var accessTokenCacheItem = accessTokenCacheItems[i];
            if (accessTokenCacheItem.key.homeAccountIdentifier === response.account.homeAccountIdentifier) {
                var cachedScopes = accessTokenCacheItem.key.scopes.split(" ");
                if (_ScopeSet__WEBPACK_IMPORTED_MODULE_9__["ScopeSet"].isIntersectingScopes(cachedScopes, consentedScopes)) {
                    this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
                }
            }
        }
        accessTokenResponse.accessToken = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN];
        accessTokenResponse.scopes = consentedScopes;
        var expiresIn = _utils_TimeUtils__WEBPACK_IMPORTED_MODULE_13__["TimeUtils"].parseExpiresIn(parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].EXPIRES_IN]);
        var parsedState = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].parseLibraryState(parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].STATE]);
        var expiration = parsedState.ts + expiresIn;
        this.logger.verbose("Saving access token to cache");
        return this.saveToken(accessTokenResponse, authority, scope, clientInfo, expiration);
    };
    /**
     * @hidden
     * Saves token or error received in the response from AAD in the cache. In case of id_token, it also creates the account object.
     * @ignore
     */
    UserAgentApplication.prototype.saveTokenFromHash = function (hash, stateInfo) {
        this.logger.verbose("SaveTokenFromHash has been called");
        this.logger.info("State status: " + stateInfo.stateMatch + "; Request type: " + stateInfo.requestType);
        var response = {
            uniqueId: "",
            tenantId: "",
            tokenType: "",
            idToken: null,
            idTokenClaims: null,
            accessToken: null,
            scopes: [],
            expiresOn: null,
            account: null,
            accountState: "",
            fromCache: false
        };
        var error;
        var hashParams = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].deserializeHash(hash);
        var authorityKey = "";
        var acquireTokenAccountKey = "";
        var idTokenObj = null;
        // If server returns an error
        if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION) || hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR)) {
            this.logger.verbose("Server returned an error");
            this.logger.infoPii("Error : " + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR] + "; Error description: " + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR]);
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            // login
            if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login) {
                this.logger.verbose("RequestType is login, caching login error, generating authorityKey");
                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].LOGIN_ERROR, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION] + ":" + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR]);
                authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(stateInfo.state);
            }
            // acquireToken
            if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken) {
                this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey");
                authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(stateInfo.state);
                var account = this.getAccount();
                var accountId = void 0;
                if (account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(account.homeAccountIdentifier)) {
                    accountId = account.homeAccountIdentifier;
                    this.logger.verbose("AccountId is set");
                }
                else {
                    accountId = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
                    this.logger.verbose("AccountId is set as no_account");
                }
                acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(accountId, stateInfo.state);
            }
            var _a = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR, hashErr = hashParams[_a], _b = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION, hashErrDesc = hashParams[_b];
            if (_error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__["InteractionRequiredAuthError"].isInteractionRequiredError(hashErr) ||
                _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__["InteractionRequiredAuthError"].isInteractionRequiredError(hashErrDesc)) {
                error = new _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__["InteractionRequiredAuthError"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR], hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            }
            else {
                error = new _error_ServerError__WEBPACK_IMPORTED_MODULE_22__["ServerError"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR], hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            }
        }
        // If the server returns "Success"
        else {
            this.logger.verbose("Server returns success");
            // Verify the state from redirect and record tokens to storage if exists
            if (stateInfo.stateMatch) {
                this.logger.info("State is right");
                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SESSION_STATE)) {
                    this.logger.verbose("Fragment has session state, caching");
                    this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].SESSION_STATE, stateInfo.state), hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SESSION_STATE]);
                }
                response.accountState = this.getAccountState(stateInfo.state);
                var clientInfo = void 0;
                // Process access_token
                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN)) {
                    this.logger.info("Fragment has access token");
                    response.accessToken = hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN];
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SCOPE)) {
                        response.scopes = hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SCOPE].split(" ");
                    }
                    // retrieve the id_token from response if present
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN)) {
                        this.logger.verbose("Fragment has id_token");
                        idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN]);
                    }
                    else {
                        this.logger.verbose("No idToken on fragment, getting idToken from cache");
                        idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].IDTOKEN));
                    }
                    response = _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__["ResponseUtils"].setResponseIdToken(response, idTokenObj);
                    // set authority
                    var authority = this.populateAuthority(stateInfo.state, this.inCookie, this.cacheStorage, idTokenObj);
                    this.logger.verbose("Got authority from cache");
                    // retrieve client_info - if it is not found, generate the uid and utid from idToken
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO)) {
                        this.logger.verbose("Fragment has clientInfo");
                        clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO], authority);
                    }
                    else if (this.authorityInstance.AuthorityType === _authority_Authority__WEBPACK_IMPORTED_MODULE_4__["AuthorityType"].Adfs) {
                        clientInfo = _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"].createClientInfoFromIdToken(idTokenObj, authority);
                    }
                    else {
                        this.logger.warning("ClientInfo not received in the response from AAD");
                    }
                    response.account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idTokenObj, clientInfo);
                    this.logger.verbose("Account object created from response");
                    var accountKey = void 0;
                    if (response.account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(response.account.homeAccountIdentifier)) {
                        this.logger.verbose("AccountKey set");
                        accountKey = response.account.homeAccountIdentifier;
                    }
                    else {
                        this.logger.verbose("AccountKey set as no_account");
                        accountKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
                    }
                    acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(accountKey, stateInfo.state);
                    var acquireTokenAccountKey_noaccount = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account, stateInfo.state);
                    this.logger.verbose("AcquireTokenAccountKey generated");
                    var cachedAccount = this.cacheStorage.getItem(acquireTokenAccountKey);
                    var acquireTokenAccount = void 0;
                    // Check with the account in the Cache
                    if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(cachedAccount)) {
                        acquireTokenAccount = JSON.parse(cachedAccount);
                        this.logger.verbose("AcquireToken request account retrieved from cache");
                        if (response.account && acquireTokenAccount && _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].compareAccounts(response.account, acquireTokenAccount)) {
                            response = this.saveAccessToken(response, authority, hashParams, clientInfo);
                            this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request");
                        }
                        else {
                            this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request");
                        }
                    }
                    else if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(this.cacheStorage.getItem(acquireTokenAccountKey_noaccount))) {
                        this.logger.verbose("No acquireToken account retrieved from cache");
                        response = this.saveAccessToken(response, authority, hashParams, clientInfo);
                    }
                }
                // Process id_token
                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN)) {
                    this.logger.info("Fragment has idToken");
                    // set the idToken
                    idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN]);
                    // set authority
                    var authority = this.populateAuthority(stateInfo.state, this.inCookie, this.cacheStorage, idTokenObj);
                    response = _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__["ResponseUtils"].setResponseIdToken(response, idTokenObj);
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO)) {
                        this.logger.verbose("Fragment has clientInfo");
                        clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO], authority);
                    }
                    else if (this.authorityInstance.AuthorityType === _authority_Authority__WEBPACK_IMPORTED_MODULE_4__["AuthorityType"].Adfs) {
                        clientInfo = _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"].createClientInfoFromIdToken(idTokenObj, authority);
                    }
                    else {
                        this.logger.warning("ClientInfo not received in the response from AAD");
                    }
                    this.account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idTokenObj, clientInfo);
                    response.account = this.account;
                    this.logger.verbose("Account object created from response");
                    if (idTokenObj && idTokenObj.nonce) {
                        this.logger.verbose("IdToken has nonce");
                        // check nonce integrity if idToken has nonce - throw an error if not matched
                        var cachedNonce = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].NONCE_IDTOKEN, stateInfo.state), this.inCookie);
                        if (idTokenObj.nonce !== cachedNonce) {
                            this.account = null;
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].LOGIN_ERROR, "Nonce Mismatch. Expected Nonce: " + cachedNonce + "," + "Actual Nonce: " + idTokenObj.nonce);
                            this.logger.error("Nonce Mismatch. Expected Nonce: " + cachedNonce + ", Actual Nonce: " + idTokenObj.nonce);
                            error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createNonceMismatchError(cachedNonce, idTokenObj.nonce);
                        }
                        // Save the token
                        else {
                            this.logger.verbose("Nonce matches, saving idToken to cache");
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].IDTOKEN, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN], this.inCookie);
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].CLIENT_INFO, clientInfo.encodeClientInfo(), this.inCookie);
                            // Save idToken as access token item for app itself
                            this.saveIdToken(response, authority, hashParams, clientInfo, idTokenObj);
                        }
                    }
                    else {
                        this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state");
                        authorityKey = stateInfo.state;
                        acquireTokenAccountKey = stateInfo.state;
                        this.logger.error("Invalid id_token received in the response");
                        error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidIdTokenError(idTokenObj);
                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, error.errorCode);
                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, error.errorMessage);
                    }
                }
            }
            // State mismatch - unexpected/invalid state
            else {
                this.logger.verbose("State mismatch");
                authorityKey = stateInfo.state;
                acquireTokenAccountKey = stateInfo.state;
                var expectedState = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_LOGIN, stateInfo.state), this.inCookie);
                this.logger.error("State Mismatch. Expected State: " + expectedState + ", Actual State: " + stateInfo.state);
                error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidStateError(stateInfo.state, expectedState);
                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, error.errorCode);
                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, error.errorMessage);
            }
        }
        // Set status to completed
        this.cacheStorage.removeItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, stateInfo.state));
        this.cacheStorage.resetTempCacheItems(stateInfo.state);
        this.logger.verbose("Status set to complete, temporary cache cleared");
        // this is required if navigateToLoginRequestUrl=false
        if (this.inCookie) {
            this.logger.verbose("InCookie is true, setting authorityKey in cookie");
            this.cacheStorage.setItemCookie(authorityKey, "", -1);
            this.cacheStorage.clearMsalCookie(stateInfo.state);
        }
        if (error) {
            // Error case, set status to cancelled
            throw error;
        }
        if (!response) {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Response is null");
        }
        return response;
    };
    /**
     * Set Authority when saving Token from the hash
     * @param state
     * @param inCookie
     * @param cacheStorage
     * @param idTokenObj
     * @param response
     */
    UserAgentApplication.prototype.populateAuthority = function (state, inCookie, cacheStorage, idTokenObj) {
        this.logger.verbose("PopulateAuthority has been called");
        var authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(state);
        var cachedAuthority = cacheStorage.getItem(authorityKey, inCookie);
        // retrieve the authority from cache and replace with tenantID
        return _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(cachedAuthority) ? cachedAuthority : _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].replaceTenantPath(cachedAuthority, idTokenObj.tenantId);
    };
    /* tslint:enable:no-string-literal */
    // #endregion
    // #region Account
    /**
     * Returns the signed in account
     * (the account object is created at the time of successful login)
     * or null when no state is found
     * @returns {@link Account} - the account object stored in MSAL
     */
    UserAgentApplication.prototype.getAccount = function () {
        // if a session already exists, get the account from the session
        if (this.account) {
            return this.account;
        }
        // frame is used to get idToken and populate the account for the given session
        var rawIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].IDTOKEN, this.inCookie);
        var rawClientInfo = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].CLIENT_INFO, this.inCookie);
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(rawIdToken) && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(rawClientInfo)) {
            var idToken = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](rawIdToken);
            var clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](rawClientInfo, "");
            this.account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idToken, clientInfo);
            return this.account;
        }
        // if login not yet done, return null
        return null;
    };
    /**
     * @hidden
     *
     * Extracts state value from the accountState sent with the authentication request.
     * @returns {string} scope.
     * @ignore
     */
    UserAgentApplication.prototype.getAccountState = function (state) {
        if (state) {
            var splitIndex = state.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].resourceDelimiter);
            if (splitIndex > -1 && splitIndex + 1 < state.length) {
                return state.substring(splitIndex + 1);
            }
        }
        return state;
    };
    /**
     * Use to get a list of unique accounts in MSAL cache based on homeAccountIdentifier.
     *
     * @param {@link Array<Account>} Account - all unique accounts in MSAL cache.
     */
    UserAgentApplication.prototype.getAllAccounts = function () {
        var accounts = [];
        var accessTokenCacheItems = this.cacheStorage.getAllAccessTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].homeAccountIdentifier);
        for (var i = 0; i < accessTokenCacheItems.length; i++) {
            var idToken = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](accessTokenCacheItems[i].value.idToken);
            var clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](accessTokenCacheItems[i].value.homeAccountIdentifier, "");
            var account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idToken, clientInfo);
            accounts.push(account);
        }
        return this.getUniqueAccounts(accounts);
    };
    /**
     * @hidden
     *
     * Used to filter accounts based on homeAccountIdentifier
     * @param {Array<Account>}  Accounts - accounts saved in the cache
     * @ignore
     */
    UserAgentApplication.prototype.getUniqueAccounts = function (accounts) {
        if (!accounts || accounts.length <= 1) {
            return accounts;
        }
        var flags = [];
        var uniqueAccounts = [];
        for (var index = 0; index < accounts.length; ++index) {
            if (accounts[index].homeAccountIdentifier && flags.indexOf(accounts[index].homeAccountIdentifier) === -1) {
                flags.push(accounts[index].homeAccountIdentifier);
                uniqueAccounts.push(accounts[index]);
            }
        }
        return uniqueAccounts;
    };
    // #endregion
    // #region Angular
    /**
     * @hidden
     *
     * Broadcast messages - Used only for Angular?  *
     * @param eventName
     * @param data
     */
    UserAgentApplication.prototype.broadcast = function (eventName, data) {
        var evt = new CustomEvent(eventName, { detail: data });
        window.dispatchEvent(evt);
    };
    /**
     * @hidden
     *
     * Helper function to retrieve the cached token
     *
     * @param scopes
     * @param {@link Account} account
     * @param state
     * @return {@link AuthResponse} AuthResponse
     */
    UserAgentApplication.prototype.getCachedTokenInternal = function (scopes, account, state, correlationId) {
        // Get the current session's account object
        var accountObject = account || this.getAccount();
        if (!accountObject) {
            return null;
        }
        // Construct AuthenticationRequest based on response type; set "redirectUri" from the "request" which makes this call from Angular - for this.getRedirectUri()
        var newAuthority = this.authorityInstance ? this.authorityInstance : _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(this.authority, this.config.auth.validateAuthority);
        var responseType = this.getTokenType(accountObject, scopes);
        var serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"](newAuthority, this.clientId, responseType, this.getRedirectUri(), scopes, state, correlationId);
        // get cached token
        return this.getCachedToken(serverAuthenticationRequest, account);
    };
    /**
     * @hidden
     *
     * Get scopes for the Endpoint - Used in Angular to track protected and unprotected resources without interaction from the developer app
     * Note: Please check if we need to set the "redirectUri" from the "request" which makes this call from Angular - for this.getRedirectUri()
     *
     * @param endpoint
     */
    UserAgentApplication.prototype.getScopesForEndpoint = function (endpoint) {
        // if user specified list of unprotectedResources, no need to send token to these endpoints, return null.
        if (this.config.framework.unprotectedResources.length > 0) {
            for (var i = 0; i < this.config.framework.unprotectedResources.length; i++) {
                if (endpoint.indexOf(this.config.framework.unprotectedResources[i]) > -1) {
                    return null;
                }
            }
        }
        // process all protected resources and send the matched one
        if (this.config.framework.protectedResourceMap.size > 0) {
            for (var _i = 0, _a = Array.from(this.config.framework.protectedResourceMap.keys()); _i < _a.length; _i++) {
                var key = _a[_i];
                // configEndpoint is like /api/Todo requested endpoint can be /api/Todo/1
                if (endpoint.indexOf(key) > -1) {
                    return this.config.framework.protectedResourceMap.get(key);
                }
            }
        }
        /*
         * default resource will be clientid if nothing specified
         * App will use idtoken for calls to itself
         * check if it's staring from http or https, needs to match with app host
         */
        if (endpoint.indexOf("http://") > -1 || endpoint.indexOf("https://") > -1) {
            if (_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].getHostFromUri(endpoint) === _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].getHostFromUri(this.getRedirectUri())) {
                return new Array(this.clientId);
            }
        }
        else {
            /*
             * in angular level, the url for $http interceptor call could be relative url,
             * if it's relative call, we'll treat it as app backend call.
             */
            return new Array(this.clientId);
        }
        // if not the app's own backend or not a domain listed in the endpoints structure
        return null;
    };
    /**
     * Return boolean flag to developer to help inform if login is in progress
     * @returns {boolean} true/false
     */
    UserAgentApplication.prototype.getLoginInProgress = function () {
        return this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress;
    };
    /**
     * @hidden
     * @ignore
     *
     * @param loginInProgress
     */
    UserAgentApplication.prototype.setInteractionInProgress = function (inProgress) {
        if (inProgress) {
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress);
        }
        else {
            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
        }
    };
    /**
     * @hidden
     * @ignore
     *
     * @param loginInProgress
     */
    UserAgentApplication.prototype.setloginInProgress = function (loginInProgress) {
        this.setInteractionInProgress(loginInProgress);
    };
    /**
     * @hidden
     * @ignore
     *
     * returns the status of acquireTokenInProgress
     */
    UserAgentApplication.prototype.getAcquireTokenInProgress = function () {
        return this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress;
    };
    /**
     * @hidden
     * @ignore
     *
     * @param acquireTokenInProgress
     */
    UserAgentApplication.prototype.setAcquireTokenInProgress = function (acquireTokenInProgress) {
        this.setInteractionInProgress(acquireTokenInProgress);
    };
    /**
     * @hidden
     * @ignore
     *
     * returns the logger handle
     */
    UserAgentApplication.prototype.getLogger = function () {
        return this.logger;
    };
    /**
     * Sets the logger callback.
     * @param logger Logger callback
     */
    UserAgentApplication.prototype.setLogger = function (logger) {
        this.logger = logger;
    };
    // #endregion
    // #region Getters and Setters
    /**
     * Use to get the redirect uri configured in MSAL or null.
     * Evaluates redirectUri if its a function, otherwise simply returns its value.
     *
     * @returns {string} redirect URL
     */
    UserAgentApplication.prototype.getRedirectUri = function (reqRedirectUri) {
        if (reqRedirectUri) {
            return reqRedirectUri;
        }
        else if (typeof this.config.auth.redirectUri === "function") {
            return this.config.auth.redirectUri();
        }
        return this.config.auth.redirectUri;
    };
    /**
     * Use to get the post logout redirect uri configured in MSAL or null.
     * Evaluates postLogoutredirectUri if its a function, otherwise simply returns its value.
     *
     * @returns {string} post logout redirect URL
     */
    UserAgentApplication.prototype.getPostLogoutRedirectUri = function () {
        if (typeof this.config.auth.postLogoutRedirectUri === "function") {
            return this.config.auth.postLogoutRedirectUri();
        }
        return this.config.auth.postLogoutRedirectUri;
    };
    /**
     * Use to get the current {@link Configuration} object in MSAL
     *
     * @returns {@link Configuration}
     */
    UserAgentApplication.prototype.getCurrentConfiguration = function () {
        if (!this.config) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createNoSetConfigurationError();
        }
        return this.config;
    };
    /**
     * @ignore
     *
     * Utils function to create the Authentication
     * @param {@link account} account object
     * @param scopes
     *
     * @returns {string} token type: token, id_token or id_token token
     *
     */
    UserAgentApplication.prototype.getTokenType = function (accountObject, scopes) {
        var accountsMatch = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].compareAccounts(accountObject, this.getAccount());
        return _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].determineResponseType(accountsMatch, scopes);
    };
    /**
     * @hidden
     * @ignore
     *
     * Sets the cachekeys for and stores the account information in cache
     * @param account
     * @param state
     * @hidden
     */
    UserAgentApplication.prototype.setAccountCache = function (account, state) {
        // Cache acquireTokenAccountKey
        var accountId = account ? this.getAccountId(account) : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
        var acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(accountId, state);
        this.cacheStorage.setItem(acquireTokenAccountKey, JSON.stringify(account));
    };
    /**
     * @hidden
     * @ignore
     *
     * Sets the cacheKey for and stores the authority information in cache
     * @param state
     * @param authority
     * @hidden
     */
    UserAgentApplication.prototype.setAuthorityCache = function (state, authority) {
        // Cache authorityKey
        var authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(state);
        this.cacheStorage.setItem(authorityKey, _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].CanonicalizeUri(authority), this.inCookie);
    };
    /**
     * Updates account, authority, and nonce in cache
     * @param serverAuthenticationRequest
     * @param account
     * @hidden
     * @ignore
     */
    UserAgentApplication.prototype.updateCacheEntries = function (serverAuthenticationRequest, account, isLoginCall, loginStartPage) {
        // Cache Request Originator Page
        if (loginStartPage) {
            this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].LOGIN_REQUEST, serverAuthenticationRequest.state), loginStartPage, this.inCookie);
        }
        // Cache account and authority
        if (isLoginCall) {
            // Cache the state
            this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_LOGIN, serverAuthenticationRequest.state), serverAuthenticationRequest.state, this.inCookie);
        }
        else {
            this.setAccountCache(account, serverAuthenticationRequest.state);
        }
        // Cache authorityKey
        this.setAuthorityCache(serverAuthenticationRequest.state, serverAuthenticationRequest.authority);
        // Cache nonce
        this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].NONCE_IDTOKEN, serverAuthenticationRequest.state), serverAuthenticationRequest.nonce, this.inCookie);
    };
    /**
     * Returns the unique identifier for the logged in account
     * @param account
     * @hidden
     * @ignore
     */
    UserAgentApplication.prototype.getAccountId = function (account) {
        // return `${account.accountIdentifier}` + Constants.resourceDelimiter + `${account.homeAccountIdentifier}`;
        var accountId;
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(account.homeAccountIdentifier)) {
            accountId = account.homeAccountIdentifier;
        }
        else {
            accountId = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
        }
        return accountId;
    };
    /**
     * @ignore
     * @param extraQueryParameters
     *
     * Construct 'tokenRequest' from the available data in adalIdToken
     */
    UserAgentApplication.prototype.buildIDTokenRequest = function (request) {
        var tokenRequest = {
            scopes: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes,
            authority: this.authority,
            account: this.getAccount(),
            extraQueryParameters: request.extraQueryParameters,
            correlationId: request.correlationId
        };
        return tokenRequest;
    };
    /**
     * @ignore
     * @param config
     * @param clientId
     *
     * Construct TelemetryManager from Configuration
     */
    UserAgentApplication.prototype.getTelemetryManagerFromConfig = function (config, clientId) {
        if (!config) { // if unset
            return _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__["default"].getTelemetrymanagerStub(clientId, this.logger);
        }
        // if set then validate
        var applicationName = config.applicationName, applicationVersion = config.applicationVersion, telemetryEmitter = config.telemetryEmitter;
        if (!applicationName || !applicationVersion || !telemetryEmitter) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createTelemetryConfigError(config);
        }
        // if valid then construct
        var telemetryPlatform = {
            applicationName: applicationName,
            applicationVersion: applicationVersion
        };
        var telemetryManagerConfig = {
            platform: telemetryPlatform,
            clientId: clientId
        };
        return new _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__["default"](telemetryManagerConfig, telemetryEmitter, this.logger);
    };
    return UserAgentApplication;
}());

//# sourceMappingURL=UserAgentApplication.js.map

/***/ }),

/***/ "b+AD":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/Configuration.js ***!
  \**********************************************************************************************/
/*! exports provided: buildConfiguration */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "buildConfiguration", function() { return buildConfiguration; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Logger */ "B52y");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/UrlUtils */ "j0B3");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * Defaults for the Configuration Options
 */
var FRAME_TIMEOUT = 6000;
var OFFSET = 300;
var NAVIGATE_FRAME_WAIT = 500;
var DEFAULT_AUTH_OPTIONS = {
    clientId: "",
    authority: null,
    validateAuthority: true,
    authorityMetadata: "",
    knownAuthorities: [],
    redirectUri: function () { return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__["UrlUtils"].getCurrentUrl(); },
    postLogoutRedirectUri: function () { return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__["UrlUtils"].getCurrentUrl(); },
    navigateToLoginRequestUrl: true
};
var DEFAULT_CACHE_OPTIONS = {
    cacheLocation: "sessionStorage",
    storeAuthStateInCookie: false
};
var DEFAULT_SYSTEM_OPTIONS = {
    logger: new _Logger__WEBPACK_IMPORTED_MODULE_1__["Logger"](null),
    loadFrameTimeout: FRAME_TIMEOUT,
    tokenRenewalOffsetSeconds: OFFSET,
    navigateFrameWait: NAVIGATE_FRAME_WAIT
};
var DEFAULT_FRAMEWORK_OPTIONS = {
    isAngular: false,
    unprotectedResources: new Array(),
    protectedResourceMap: new Map()
};
/**
 * MSAL function that sets the default options when not explicitly configured from app developer
 *
 * @param TAuthOptions
 * @param TCacheOptions
 * @param TSystemOptions
 * @param TFrameworkOptions
 * @param TAuthorityDataOptions
 *
 * @returns TConfiguration object
 */
function buildConfiguration(_a) {
    var auth = _a.auth, _b = _a.cache, cache = _b === void 0 ? {} : _b, _c = _a.system, system = _c === void 0 ? {} : _c, _d = _a.framework, framework = _d === void 0 ? {} : _d;
    var overlayedConfig = {
        auth: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_AUTH_OPTIONS, auth),
        cache: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_CACHE_OPTIONS, cache),
        system: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_SYSTEM_OPTIONS, system),
        framework: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_FRAMEWORK_OPTIONS, framework)
    };
    return overlayedConfig;
}
//# sourceMappingURL=Configuration.js.map

/***/ }),

/***/ "b+K5":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/telemetry/TelemetryManager.js ***!
  \****************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _DefaultEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultEvent */ "EnkG");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/Constants */ "MQw9");
/* harmony import */ var _ApiEvent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ApiEvent */ "BoDS");
/* harmony import */ var _HttpEvent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./HttpEvent */ "PQPV");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */





var TelemetryManager = /** @class */ (function () {
    function TelemetryManager(config, telemetryEmitter, logger) {
        // correlation Id to list of events
        this.completedEvents = {};
        // event key to event
        this.inProgressEvents = {};
        // correlation id to map of eventname to count
        this.eventCountByCorrelationId = {};
        // Implement after API EVENT
        this.onlySendFailureTelemetry = false;
        // TODO THROW if bad options
        this.telemetryPlatform = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ sdk: _utils_Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].libraryName, sdkVersion: Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_2__["libraryVersion"])(), networkInformation: {
                // @ts-ignore
                connectionSpeed: typeof navigator !== "undefined" && navigator.connection && navigator.connection.effectiveType
            } }, config.platform);
        this.clientId = config.clientId;
        this.onlySendFailureTelemetry = config.onlySendFailureTelemetry;
        /*
         * TODO, when i get to wiring this through, think about what it means if
         * a developer does not implement telem at all, we still instrument, but telemetryEmitter can be
         * optional?
         */
        this.telemetryEmitter = telemetryEmitter;
        this.logger = logger;
    }
    TelemetryManager.getTelemetrymanagerStub = function (clientId, logger) {
        var applicationName = "UnSetStub";
        var applicationVersion = "0.0";
        var telemetryEmitter = function () { };
        var telemetryPlatform = {
            applicationName: applicationName,
            applicationVersion: applicationVersion
        };
        var telemetryManagerConfig = {
            platform: telemetryPlatform,
            clientId: clientId
        };
        return new this(telemetryManagerConfig, telemetryEmitter, logger);
    };
    TelemetryManager.prototype.startEvent = function (event) {
        this.logger.verbose("Telemetry Event started: " + event.key);
        if (!this.telemetryEmitter) {
            return;
        }
        event.start();
        this.inProgressEvents[event.key] = event;
    };
    TelemetryManager.prototype.stopEvent = function (event) {
        this.logger.verbose("Telemetry Event stopped: " + event.key);
        if (!this.telemetryEmitter || !this.inProgressEvents[event.key]) {
            return;
        }
        event.stop();
        this.incrementEventCount(event);
        var completedEvents = this.completedEvents[event.telemetryCorrelationId];
        this.completedEvents[event.telemetryCorrelationId] = (completedEvents || []).concat([event]);
        delete this.inProgressEvents[event.key];
    };
    TelemetryManager.prototype.flush = function (correlationId) {
        var _this = this;
        this.logger.verbose("Flushing telemetry events: " + correlationId);
        // If there is only unfinished events should this still return them?
        if (!this.telemetryEmitter || !this.completedEvents[correlationId]) {
            return;
        }
        var orphanedEvents = this.getOrphanedEvents(correlationId);
        orphanedEvents.forEach(function (event) { return _this.incrementEventCount(event); });
        var eventsToFlush = this.completedEvents[correlationId].concat(orphanedEvents);
        delete this.completedEvents[correlationId];
        var eventCountsToFlush = this.eventCountByCorrelationId[correlationId];
        delete this.eventCountByCorrelationId[correlationId];
        // TODO add funcitonality for onlyFlushFailures after implementing api event? ??
        if (!eventsToFlush || !eventsToFlush.length) {
            return;
        }
        var defaultEvent = new _DefaultEvent__WEBPACK_IMPORTED_MODULE_1__["default"](this.telemetryPlatform, correlationId, this.clientId, eventCountsToFlush);
        var eventsWithDefaultEvent = eventsToFlush.concat([defaultEvent]);
        this.telemetryEmitter(eventsWithDefaultEvent.map(function (e) { return e.get(); }));
    };
    TelemetryManager.prototype.createAndStartApiEvent = function (correlationId, apiEventIdentifier) {
        var apiEvent = new _ApiEvent__WEBPACK_IMPORTED_MODULE_3__["default"](correlationId, this.logger.isPiiLoggingEnabled(), apiEventIdentifier);
        this.startEvent(apiEvent);
        return apiEvent;
    };
    TelemetryManager.prototype.stopAndFlushApiEvent = function (correlationId, apiEvent, wasSuccessful, errorCode) {
        apiEvent.wasSuccessful = wasSuccessful;
        if (errorCode) {
            apiEvent.apiErrorCode = errorCode;
        }
        this.stopEvent(apiEvent);
        this.flush(correlationId);
    };
    TelemetryManager.prototype.createAndStartHttpEvent = function (correlation, httpMethod, url, eventLabel) {
        var httpEvent = new _HttpEvent__WEBPACK_IMPORTED_MODULE_4__["default"](correlation, eventLabel);
        httpEvent.url = url;
        httpEvent.httpMethod = httpMethod;
        this.startEvent(httpEvent);
        return httpEvent;
    };
    TelemetryManager.prototype.incrementEventCount = function (event) {
        var _a;
        /*
         * TODO, name cache event different?
         * if type is cache event, change name
         */
        var eventName = event.eventName;
        var eventCount = this.eventCountByCorrelationId[event.telemetryCorrelationId];
        if (!eventCount) {
            this.eventCountByCorrelationId[event.telemetryCorrelationId] = (_a = {},
                _a[eventName] = 1,
                _a);
        }
        else {
            eventCount[eventName] = eventCount[eventName] ? eventCount[eventName] + 1 : 1;
        }
    };
    TelemetryManager.prototype.getOrphanedEvents = function (correlationId) {
        var _this = this;
        return Object.keys(this.inProgressEvents)
            .reduce(function (memo, eventKey) {
            if (eventKey.indexOf(correlationId) !== -1) {
                var event_1 = _this.inProgressEvents[eventKey];
                delete _this.inProgressEvents[eventKey];
                return memo.concat([event_1]);
            }
            return memo;
        }, []);
    };
    return TelemetryManager;
}());
/* harmony default export */ __webpack_exports__["default"] = (TelemetryManager);
//# sourceMappingURL=TelemetryManager.js.map

/***/ }),

/***/ "b7Qq":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/TimeUtils.js ***!
  \*****************************************************************************************************/
/*! exports provided: TimeUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TimeUtils", function() { return TimeUtils; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var TimeUtils = /** @class */ (function () {
    function TimeUtils() {
    }
    /**
     * Returns time in seconds for expiration based on string value passed in.
     *
     * @param expiresIn
     */
    TimeUtils.parseExpiresIn = function (expiresIn) {
        // if AAD did not send "expires_in" property, use default expiration of 3599 seconds, for some reason AAD sends 3599 as "expires_in" value instead of 3600
        if (!expiresIn) {
            expiresIn = "3599";
        }
        return parseInt(expiresIn, 10);
    };
    /**
     * Return the current time in Unix time (seconds). Date.getTime() returns in milliseconds.
     */
    TimeUtils.now = function () {
        return Math.round(new Date().getTime() / 1000.0);
    };
    /**
     * Returns the amount of time in milliseconds since the page loaded.
     */
    TimeUtils.relativeNowMs = function () {
        return window.performance.now();
    };
    return TimeUtils;
}());

//# sourceMappingURL=TimeUtils.js.map

/***/ }),

/***/ "b91I":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/ServerRequestParameters.js ***!
  \********************************************************************************************************/
/*! exports provided: ServerRequestParameters */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerRequestParameters", function() { return ServerRequestParameters; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ "RDZQ");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ "/pXG");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ "k+Uk");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ScopeSet */ "aX9C");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




/**
 * Nonce: OIDC Nonce definition: https://openid.net/specs/openid-connect-core-1_0.html#IDToken
 * State: OAuth Spec: https://tools.ietf.org/html/rfc6749#section-10.12
 * @hidden
 */
var ServerRequestParameters = /** @class */ (function () {
    /**
     * Constructor
     * @param authority
     * @param clientId
     * @param scope
     * @param responseType
     * @param redirectUri
     * @param state
     */
    function ServerRequestParameters(authority, clientId, responseType, redirectUri, scopes, state, correlationId) {
        this.authorityInstance = authority;
        this.clientId = clientId;
        this.nonce = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].createNewGuid();
        // set scope to clientId if null
        this.scopes = scopes ? scopes.slice() : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].oidcScopes;
        this.scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].trimScopes(this.scopes);
        // set state (already set at top level)
        this.state = state;
        // set correlationId
        this.correlationId = correlationId;
        // telemetry information
        this.xClientSku = "MSAL.JS";
        this.xClientVer = Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["libraryVersion"])();
        this.responseType = responseType;
        this.redirectUri = redirectUri;
    }
    Object.defineProperty(ServerRequestParameters.prototype, "authority", {
        get: function () {
            return this.authorityInstance ? this.authorityInstance.CanonicalAuthority : null;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @hidden
     * @ignore
     *
     * Utility to populate QueryParameters and ExtraQueryParameters to ServerRequestParamerers
     * @param request
     * @param serverAuthenticationRequest
     */
    ServerRequestParameters.prototype.populateQueryParams = function (account, request, adalIdTokenObject, silentCall) {
        var queryParameters = {};
        if (request) {
            // add the prompt parameter to serverRequestParameters if passed
            if (request.prompt) {
                this.promptValue = request.prompt;
            }
            // Add claims challenge to serverRequestParameters if passed
            if (request.claimsRequest) {
                this.claimsValue = request.claimsRequest;
            }
            // if the developer provides one of these, give preference to developer choice
            if (ServerRequestParameters.isSSOParam(request)) {
                queryParameters = this.constructUnifiedCacheQueryParameter(request, null);
            }
        }
        if (adalIdTokenObject) {
            queryParameters = this.constructUnifiedCacheQueryParameter(null, adalIdTokenObject);
        }
        /*
         * adds sid/login_hint if not populated
         * this.logger.verbose("Calling addHint parameters");
         */
        queryParameters = this.addHintParameters(account, queryParameters);
        // sanity check for developer passed extraQueryParameters
        var eQParams = request ? request.extraQueryParameters : null;
        // Populate the extraQueryParameters to be sent to the server
        this.queryParameters = ServerRequestParameters.generateQueryParametersString(queryParameters);
        this.extraQueryParameters = ServerRequestParameters.generateQueryParametersString(eQParams, silentCall);
    };
    // #region QueryParam helpers
    /**
     * Constructs extraQueryParameters to be sent to the server for the AuthenticationParameters set by the developer
     * in any login() or acquireToken() calls
     * @param idTokenObject
     * @param extraQueryParameters
     * @param sid
     * @param loginHint
     */
    // TODO: check how this behaves when domain_hint only is sent in extraparameters and idToken has no upn.
    ServerRequestParameters.prototype.constructUnifiedCacheQueryParameter = function (request, idTokenObject) {
        // preference order: account > sid > login_hint
        var ssoType;
        var ssoData;
        var serverReqParam = {};
        // if account info is passed, account.sid > account.login_hint
        if (request) {
            if (request.account) {
                var account = request.account;
                if (account.sid) {
                    ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID;
                    ssoData = account.sid;
                }
                else if (account.userName) {
                    ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT;
                    ssoData = account.userName;
                }
            }
            // sid from request
            else if (request.sid) {
                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID;
                ssoData = request.sid;
            }
            // loginHint from request
            else if (request.loginHint) {
                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT;
                ssoData = request.loginHint;
            }
        }
        // adalIdToken retrieved from cache
        else if (idTokenObject) {
            if (idTokenObject.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].upn)) {
                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].ID_TOKEN;
                ssoData = idTokenObject.upn;
            }
        }
        serverReqParam = this.addSSOParameter(ssoType, ssoData);
        return serverReqParam;
    };
    /**
     * @hidden
     *
     * Adds login_hint to authorization URL which is used to pre-fill the username field of sign in page for the user if known ahead of time
     * domain_hint if added skips the email based discovery process of the user - only supported for interactive calls in implicit_flow
     * domain_req utid received as part of the clientInfo
     * login_req uid received as part of clientInfo
     * Also does a sanity check for extraQueryParameters passed by the user to ensure no repeat queryParameters
     *
     * @param {@link Account} account - Account for which the token is requested
     * @param queryparams
     * @param {@link ServerRequestParameters}
     * @ignore
     */
    ServerRequestParameters.prototype.addHintParameters = function (account, qParams) {
        /*
         * This is a final check for all queryParams added so far; preference order: sid > login_hint
         * sid cannot be passed along with login_hint or domain_hint, hence we check both are not populated yet in queryParameters
         */
        if (account && !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID]) {
            // sid - populate only if login_hint is not already populated and the account has sid
            var populateSID = !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] && account.sid && this.promptValue === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].NONE;
            if (populateSID) {
                qParams = this.addSSOParameter(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID, account.sid, qParams);
            }
            // login_hint - account.userName
            else {
                var populateLoginHint = !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] && account.userName && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(account.userName);
                if (populateLoginHint) {
                    qParams = this.addSSOParameter(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT, account.userName, qParams);
                }
            }
        }
        return qParams;
    };
    /**
     * Add SID to extraQueryParameters
     * @param sid
     */
    ServerRequestParameters.prototype.addSSOParameter = function (ssoType, ssoData, ssoParam) {
        if (!ssoParam) {
            ssoParam = {};
        }
        if (!ssoData) {
            return ssoParam;
        }
        switch (ssoType) {
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID: {
                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID] = ssoData;
                break;
            }
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].ID_TOKEN: {
                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] = ssoData;
                break;
            }
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT: {
                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].LOGIN_HINT] = ssoData;
                break;
            }
        }
        return ssoParam;
    };
    /**
     * Utility to generate a QueryParameterString from a Key-Value mapping of extraQueryParameters passed
     * @param extraQueryParameters
     */
    ServerRequestParameters.generateQueryParametersString = function (queryParameters, silentCall) {
        var paramsString = null;
        if (queryParameters) {
            Object.keys(queryParameters).forEach(function (key) {
                // sid cannot be passed along with login_hint or domain_hint
                if (key === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].domain_hint && (silentCall || queryParameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["SSOTypes"].SID])) {
                    return;
                }
                if (paramsString == null) {
                    paramsString = key + "=" + encodeURIComponent(queryParameters[key]);
                }
                else {
                    paramsString += "&" + key + "=" + encodeURIComponent(queryParameters[key]);
                }
            });
        }
        return paramsString;
    };
    // #endregion
    /**
     * Check to see if there are SSO params set in the Request
     * @param request
     */
    ServerRequestParameters.isSSOParam = function (request) {
        return request && (request.account || request.sid || request.loginHint);
    };
    /**
     * Returns the correct response_type string attribute for an acquireToken request configuration
     * @param accountsMatch boolean: Determines whether the account in the request matches the cached account
     * @param scopes Array<string>: AuthenticationRequest scopes configuration
     * @param loginScopesOnly boolean: True if the scopes array ONLY contains the clientId or any combination of OIDC scopes, without resource scopes
     */
    ServerRequestParameters.determineResponseType = function (accountsMatch, scopes) {
        // Supports getting an id_token by sending in clientId as only scope or OIDC scopes as only scopes
        if (_ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].onlyContainsOidcScopes(scopes)) {
            return _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token;
        }
        // If accounts match, check if OIDC scopes are included, otherwise return id_token_token
        return (accountsMatch) ? this.responseTypeForMatchingAccounts(scopes) : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token_token;
    };
    /**
     * Returns the correct response_type string attribute for an acquireToken request configuration that contains an
     * account that matches the account in the MSAL cache.
     * @param scopes Array<string>: AuthenticationRequest scopes configuration
     */
    ServerRequestParameters.responseTypeForMatchingAccounts = function (scopes) {
        // Opt-into also requesting an ID token by sending in 'openid', 'profile' or both along with resource scopes when login is not necessary.
        return (_ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].containsAnyOidcScopes(scopes)) ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].id_token_token : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ResponseTypes"].token;
    };
    return ServerRequestParameters;
}());

//# sourceMappingURL=ServerRequestParameters.js.map

/***/ }),

/***/ "bKjy":
/*!************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/Range.js ***!
  \************************************************************************/
/*! exports provided: Range */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Range", function() { return Range; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module Range
 */
/**
 * @class
 * Class representing Range
 */
class Range {
    /**
     * @public
     * @constructor
     * Creates a range for given min and max values
     * @param {number} [minVal = -1] - The minimum value.
     * @param {number} [maxVal = -1] - The maximum value.
     * @returns An instance of a Range
     */
    constructor(minVal = -1, maxVal = -1) {
        this.minValue = minVal;
        this.maxValue = maxVal;
    }
}
//# sourceMappingURL=Range.js.map

/***/ }),

/***/ "bYYR":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/authority/TrustedAuthority.js ***!
  \****************************************************************************************************************/
/*! exports provided: TrustedAuthority */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TrustedAuthority", function() { return TrustedAuthority; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _XHRClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../XHRClient */ "NzbG");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/Constants */ "MQw9");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/UrlUtils */ "6r4W");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var TrustedAuthority = /** @class */ (function () {
    function TrustedAuthority() {
    }
    /**
     *
     * @param validateAuthority
     * @param knownAuthorities
     */
    TrustedAuthority.setTrustedAuthoritiesFromConfig = function (validateAuthority, knownAuthorities) {
        if (validateAuthority && !this.getTrustedHostList().length) {
            knownAuthorities.forEach(function (authority) {
                TrustedAuthority.TrustedHostList.push(authority.toLowerCase());
            });
        }
    };
    /**
     *
     * @param telemetryManager
     * @param correlationId
     */
    TrustedAuthority.getAliases = function (authorityToVerify, telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, httpMethod, instanceDiscoveryEndpoint, httpEvent;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                client = new _XHRClient__WEBPACK_IMPORTED_MODULE_1__["XhrClient"]();
                httpMethod = _utils_Constants__WEBPACK_IMPORTED_MODULE_2__["NetworkRequestType"].GET;
                instanceDiscoveryEndpoint = "" + _utils_Constants__WEBPACK_IMPORTED_MODULE_2__["AAD_INSTANCE_DISCOVERY_ENDPOINT"] + authorityToVerify + "oauth2/v2.0/authorize";
                httpEvent = telemetryManager.createAndStartHttpEvent(correlationId, httpMethod, instanceDiscoveryEndpoint, "getAliases");
                return [2 /*return*/, client.sendRequestAsync(instanceDiscoveryEndpoint, httpMethod, true)
                        .then(function (response) {
                        httpEvent.httpResponseStatus = response.statusCode;
                        telemetryManager.stopEvent(httpEvent);
                        return response.body.metadata;
                    })
                        .catch(function (err) {
                        httpEvent.serverErrorCode = err;
                        telemetryManager.stopEvent(httpEvent);
                        throw err;
                    })];
            });
        });
    };
    /**
     *
     * @param telemetryManager
     * @param correlationId
     */
    TrustedAuthority.setTrustedAuthoritiesFromNetwork = function (authorityToVerify, telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var metadata, host;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.getAliases(authorityToVerify, telemetryManager, correlationId)];
                    case 1:
                        metadata = _a.sent();
                        metadata.forEach(function (entry) {
                            var authorities = entry.aliases;
                            authorities.forEach(function (authority) {
                                TrustedAuthority.TrustedHostList.push(authority.toLowerCase());
                            });
                        });
                        host = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__["UrlUtils"].GetUrlComponents(authorityToVerify).HostNameAndPort;
                        if (TrustedAuthority.getTrustedHostList().length && !TrustedAuthority.IsInTrustedHostList(host)) {
                            // Custom Domain scenario, host is trusted because Instance Discovery call succeeded
                            TrustedAuthority.TrustedHostList.push(host.toLowerCase());
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    TrustedAuthority.getTrustedHostList = function () {
        return this.TrustedHostList;
    };
    /**
     * Checks to see if the host is in a list of trusted hosts
     * @param host
     */
    TrustedAuthority.IsInTrustedHostList = function (host) {
        return this.TrustedHostList.indexOf(host.toLowerCase()) > -1;
    };
    TrustedAuthority.TrustedHostList = [];
    return TrustedAuthority;
}());

//# sourceMappingURL=TrustedAuthority.js.map

/***/ }),

/***/ "br4S":
/*!*********************************************!*\
  !*** external "@microsoft/sp-webpart-base" ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_br4S__;

/***/ }),

/***/ "cGuR":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/authority/AuthorityFactory.js ***!
  \****************************************************************************************************************/
/*! exports provided: AuthorityFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthorityFactory", function() { return AuthorityFactory; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Authority__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Authority */ "UYCr");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StringUtils */ "UjIo");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "UBea");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */

/**
 * @hidden
 */



var AuthorityFactory = /** @class */ (function () {
    function AuthorityFactory() {
    }
    AuthorityFactory.saveMetadataFromNetwork = function (authorityInstance, telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var metadata;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, authorityInstance.resolveEndpointsAsync(telemetryManager, correlationId)];
                    case 1:
                        metadata = _a.sent();
                        this.metadataMap.set(authorityInstance.CanonicalAuthority, metadata);
                        return [2 /*return*/, metadata];
                }
            });
        });
    };
    AuthorityFactory.getMetadata = function (authorityUrl) {
        return this.metadataMap.get(authorityUrl);
    };
    AuthorityFactory.saveMetadataFromConfig = function (authorityUrl, authorityMetadataJson) {
        try {
            if (authorityMetadataJson) {
                var parsedMetadata = JSON.parse(authorityMetadataJson);
                if (!parsedMetadata.authorization_endpoint || !parsedMetadata.end_session_endpoint || !parsedMetadata.issuer) {
                    throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__["ClientConfigurationError"].createInvalidAuthorityMetadataError();
                }
                this.metadataMap.set(authorityUrl, {
                    AuthorizationEndpoint: parsedMetadata.authorization_endpoint,
                    EndSessionEndpoint: parsedMetadata.end_session_endpoint,
                    Issuer: parsedMetadata.issuer
                });
            }
        }
        catch (e) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__["ClientConfigurationError"].createInvalidAuthorityMetadataError();
        }
    };
    /**
     * Create an authority object of the correct type based on the url
     * Performs basic authority validation - checks to see if the authority is of a valid type (eg aad, b2c)
     */
    AuthorityFactory.CreateInstance = function (authorityUrl, validateAuthority, authorityMetadata) {
        if (_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(authorityUrl)) {
            return null;
        }
        if (authorityMetadata) {
            // todo: log statements
            this.saveMetadataFromConfig(authorityUrl, authorityMetadata);
        }
        return new _Authority__WEBPACK_IMPORTED_MODULE_1__["Authority"](authorityUrl, validateAuthority, this.metadataMap.get(authorityUrl));
    };
    AuthorityFactory.metadataMap = new Map();
    return AuthorityFactory;
}());

//# sourceMappingURL=AuthorityFactory.js.map

/***/ }),

/***/ "cTj7":
/*!***************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-proxy-provider/dist/es6/CustomHeaderMiddleware.js ***!
  \***************************************************************************************/
/*! exports provided: CustomHeaderMiddleware */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomHeaderMiddleware", function() { return CustomHeaderMiddleware; });
/* harmony import */ var _microsoft_microsoft_graph_client_lib_es_middleware_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/microsoft-graph-client/lib/es/middleware/MiddlewareUtil */ "z+g4");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

/**
 * Custom Middleware to add custom headers when making calls
 * through the proxy provider
 *
 * @class CustomHeaderMiddleware
 * @implements {Middleware}
 */
// tslint:disable-next-line: max-classes-per-file
class CustomHeaderMiddleware {
    constructor(getCustomHeaders) {
        this._getCustomHeaders = getCustomHeaders;
    }
    /**
     * Execute the current middleware
     *
     * @param {Context} context
     * @returns {Promise<void>}
     * @memberof CustomHeaderMiddleware
     */
    execute(context) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this._getCustomHeaders) {
                const headers = yield this._getCustomHeaders();
                for (const key in headers) {
                    if (headers.hasOwnProperty(key)) {
                        Object(_microsoft_microsoft_graph_client_lib_es_middleware_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_0__["setRequestHeader"])(context.request, context.options, key, headers[key]);
                    }
                }
            }
            return yield this.nextMiddleware.execute(context);
        });
    }
    /**
     * Handles setting of next middleware
     *
     * @param {Middleware} next
     * @memberof SdkVersionMiddleware
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
//# sourceMappingURL=CustomHeaderMiddleware.js.map

/***/ }),

/***/ "cXbq":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/content/BatchRequestContent.js ***!
  \**********************************************************************************************/
/*! exports provided: BatchRequestContent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRequestContent", function() { return BatchRequestContent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _RequestMethod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../RequestMethod */ "wmib");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @module BatchRequestContent
 */

/**
 * @class
 * Class for handling BatchRequestContent
 */
class BatchRequestContent {
    /**
     * @public
     * @constructor
     * Constructs a BatchRequestContent instance
     * @param {BatchRequestStep[]} [requests] - Array of requests value
     * @returns An instance of a BatchRequestContent
     */
    constructor(requests) {
        this.requests = new Map();
        if (typeof requests !== "undefined") {
            const limit = BatchRequestContent.requestLimit;
            if (requests.length > limit) {
                const error = new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${limit}`);
                error.name = "Limit Exceeded Error";
                throw error;
            }
            for (const req of requests) {
                this.addRequest(req);
            }
        }
    }
    /**
     * @private
     * @static
     * Validates the dependency chain of the requests
     *
     * Note:
     * Individual requests can depend on other individual requests. Currently, requests can only depend on a single other request, and must follow one of these three patterns:
     * 1. Parallel - no individual request states a dependency in the dependsOn property.
     * 2. Serial - all individual requests depend on the previous individual request.
     * 3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.
     * As JSON batching matures, these limitations will be removed.
     * @see {@link https://developer.microsoft.com/en-us/graph/docs/concepts/known_issues#json-batching}
     *
     * @param {Map<string, BatchRequestStep>} requests - The map of requests.
     * @returns The boolean indicating the validation status
     */
    static validateDependencies(requests) {
        const isParallel = (reqs) => {
            const iterator = reqs.entries();
            let cur = iterator.next();
            while (!cur.done) {
                const curReq = cur.value[1];
                if (curReq.dependsOn !== undefined && curReq.dependsOn.length > 0) {
                    return false;
                }
                cur = iterator.next();
            }
            return true;
        };
        const isSerial = (reqs) => {
            const iterator = reqs.entries();
            let cur = iterator.next();
            const firstRequest = cur.value[1];
            if (firstRequest.dependsOn !== undefined && firstRequest.dependsOn.length > 0) {
                return false;
            }
            let prev = cur;
            cur = iterator.next();
            while (!cur.done) {
                const curReq = cur.value[1];
                if (curReq.dependsOn === undefined || curReq.dependsOn.length !== 1 || curReq.dependsOn[0] !== prev.value[1].id) {
                    return false;
                }
                prev = cur;
                cur = iterator.next();
            }
            return true;
        };
        const isSame = (reqs) => {
            const iterator = reqs.entries();
            let cur = iterator.next();
            const firstRequest = cur.value[1];
            let dependencyId;
            if (firstRequest.dependsOn === undefined || firstRequest.dependsOn.length === 0) {
                dependencyId = firstRequest.id;
            }
            else {
                if (firstRequest.dependsOn.length === 1) {
                    const fDependencyId = firstRequest.dependsOn[0];
                    if (fDependencyId !== firstRequest.id && reqs.has(fDependencyId)) {
                        dependencyId = fDependencyId;
                    }
                    else {
                        return false;
                    }
                }
                else {
                    return false;
                }
            }
            cur = iterator.next();
            while (!cur.done) {
                const curReq = cur.value[1];
                if ((curReq.dependsOn === undefined || curReq.dependsOn.length === 0) && dependencyId !== curReq.id) {
                    return false;
                }
                if (curReq.dependsOn !== undefined && curReq.dependsOn.length !== 0) {
                    if (curReq.dependsOn.length === 1 && (curReq.id === dependencyId || curReq.dependsOn[0] !== dependencyId)) {
                        return false;
                    }
                    if (curReq.dependsOn.length > 1) {
                        return false;
                    }
                }
                cur = iterator.next();
            }
            return true;
        };
        if (requests.size === 0) {
            const error = new Error("Empty requests map, Please provide at least one request.");
            error.name = "Empty Requests Error";
            throw error;
        }
        return isParallel(requests) || isSerial(requests) || isSame(requests);
    }
    /**
     * @private
     * @static
     * @async
     * Converts Request Object instance to a JSON
     * @param {IsomorphicRequest} request - The IsomorphicRequest Object instance
     * @returns A promise that resolves to JSON representation of a request
     */
    static getRequestData(request) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const requestData = {
                url: "",
            };
            const hasHttpRegex = new RegExp("^https?://");
            // Stripping off hostname, port and url scheme
            requestData.url = hasHttpRegex.test(request.url) ? "/" + request.url.split(/.*?\/\/.*?\//)[1] : request.url;
            requestData.method = request.method;
            const headers = {};
            request.headers.forEach((value, key) => {
                headers[key] = value;
            });
            if (Object.keys(headers).length) {
                requestData.headers = headers;
            }
            if (request.method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].PATCH || request.method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].POST || request.method === _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].PUT) {
                requestData.body = yield BatchRequestContent.getRequestBody(request);
            }
            /**
             * TODO: Check any other property needs to be used from the Request object and add them
             */
            return requestData;
        });
    }
    /**
     * @private
     * @static
     * @async
     * Gets the body of a Request object instance
     * @param {IsomorphicRequest} request - The IsomorphicRequest object instance
     * @returns The Promise that resolves to a body value of a Request
     */
    static getRequestBody(request) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            let bodyParsed = false;
            let body;
            try {
                const cloneReq = request.clone();
                body = yield cloneReq.json();
                bodyParsed = true;
            }
            catch (e) {
                // tslint:disable-line: no-empty
            }
            if (!bodyParsed) {
                try {
                    if (typeof Blob !== "undefined") {
                        const blob = yield request.blob();
                        const reader = new FileReader();
                        body = yield new Promise((resolve) => {
                            reader.addEventListener("load", () => {
                                const dataURL = reader.result;
                                /**
                                 * Some valid dataURL schemes:
                                 *  1. data:text/vnd-example+xyz;foo=bar;base64,R0lGODdh
                                 *  2. data:text/plain;charset=UTF-8;page=21,the%20data:1234,5678
                                 *  3. data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==
                                 *  4. data:image/png,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==
                                 *  5. data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==
                                 * @see Syntax {@link https://en.wikipedia.org/wiki/Data_URI_scheme} for more
                                 */
                                const regex = new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$");
                                const segments = regex.exec(dataURL);
                                resolve(segments[4]);
                            }, false);
                            reader.readAsDataURL(blob);
                        });
                    }
                    else if (typeof Buffer !== "undefined") {
                        const buffer = yield request.buffer();
                        body = buffer.toString("base64");
                    }
                    bodyParsed = true;
                }
                catch (e) {
                    // tslint:disable-line: no-empty
                }
            }
            return body;
        });
    }
    /**
     * @public
     * Adds a request to the batch request content
     * @param {BatchRequestStep} request - The request value
     * @returns The id of the added request
     */
    addRequest(request) {
        const limit = BatchRequestContent.requestLimit;
        if (request.id === "") {
            const error = new Error(`Id for a request is empty, Please provide an unique id`);
            error.name = "Empty Id For Request";
            throw error;
        }
        if (this.requests.size === limit) {
            const error = new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${limit}`);
            error.name = "Limit Exceeded Error";
            throw error;
        }
        if (this.requests.has(request.id)) {
            const error = new Error(`Adding request with duplicate id ${request.id}, Make the id of the requests unique`);
            error.name = "Duplicate RequestId Error";
            throw error;
        }
        this.requests.set(request.id, request);
        return request.id;
    }
    /**
     * @public
     * Removes request from the batch payload and its dependencies from all dependents
     * @param {string} requestId - The id of a request that needs to be removed
     * @returns The boolean indicating removed status
     */
    removeRequest(requestId) {
        const deleteStatus = this.requests.delete(requestId);
        const iterator = this.requests.entries();
        let cur = iterator.next();
        /**
         * Removing dependencies where this request is present as a dependency
         */
        while (!cur.done) {
            const dependencies = cur.value[1].dependsOn;
            if (typeof dependencies !== "undefined") {
                const index = dependencies.indexOf(requestId);
                if (index !== -1) {
                    dependencies.splice(index, 1);
                }
                if (dependencies.length === 0) {
                    delete cur.value[1].dependsOn;
                }
            }
            cur = iterator.next();
        }
        return deleteStatus;
    }
    /**
     * @public
     * @async
     * Serialize content from BatchRequestContent instance
     * @returns The body content to make batch request
     */
    getContent() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const requests = [];
            const requestBody = {
                requests,
            };
            const iterator = this.requests.entries();
            let cur = iterator.next();
            if (cur.done) {
                const error = new Error("No requests added yet, Please add at least one request.");
                error.name = "Empty Payload";
                throw error;
            }
            if (!BatchRequestContent.validateDependencies(this.requests)) {
                const error = new Error(`Invalid dependency found, Dependency should be:
1. Parallel - no individual request states a dependency in the dependsOn property.
2. Serial - all individual requests depend on the previous individual request.
3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.`);
                error.name = "Invalid Dependency";
                throw error;
            }
            while (!cur.done) {
                const requestStep = cur.value[1];
                const batchRequestData = (yield BatchRequestContent.getRequestData(requestStep.request));
                /**
                 * @see {@link https://developer.microsoft.com/en-us/graph/docs/concepts/json_batching#request-format}
                 */
                if (batchRequestData.body !== undefined && (batchRequestData.headers === undefined || batchRequestData.headers["content-type"] === undefined)) {
                    const error = new Error(`Content-type header is not mentioned for request #${requestStep.id}, For request having body, Content-type header should be mentioned`);
                    error.name = "Invalid Content-type header";
                    throw error;
                }
                batchRequestData.id = requestStep.id;
                if (requestStep.dependsOn !== undefined && requestStep.dependsOn.length > 0) {
                    batchRequestData.dependsOn = requestStep.dependsOn;
                }
                requests.push(batchRequestData);
                cur = iterator.next();
            }
            requestBody.requests = requests;
            return requestBody;
        });
    }
    /**
     * @public
     * Adds a dependency for a given dependent request
     * @param {string} dependentId - The id of the dependent request
     * @param {string} [dependencyId] - The id of the dependency request, if not specified the preceding request will be considered as a dependency
     * @returns Nothing
     */
    addDependency(dependentId, dependencyId) {
        if (!this.requests.has(dependentId)) {
            const error = new Error(`Dependent ${dependentId} does not exists, Please check the id`);
            error.name = "Invalid Dependent";
            throw error;
        }
        if (typeof dependencyId !== "undefined" && !this.requests.has(dependencyId)) {
            const error = new Error(`Dependency ${dependencyId} does not exists, Please check the id`);
            error.name = "Invalid Dependency";
            throw error;
        }
        if (typeof dependencyId !== "undefined") {
            const dependent = this.requests.get(dependentId);
            if (dependent.dependsOn === undefined) {
                dependent.dependsOn = [];
            }
            if (dependent.dependsOn.indexOf(dependencyId) !== -1) {
                const error = new Error(`Dependency ${dependencyId} is already added for the request ${dependentId}`);
                error.name = "Duplicate Dependency";
                throw error;
            }
            dependent.dependsOn.push(dependencyId);
        }
        else {
            const iterator = this.requests.entries();
            let prev;
            let cur = iterator.next();
            while (!cur.done && cur.value[1].id !== dependentId) {
                prev = cur;
                cur = iterator.next();
            }
            if (typeof prev !== "undefined") {
                const dId = prev.value[0];
                if (cur.value[1].dependsOn === undefined) {
                    cur.value[1].dependsOn = [];
                }
                if (cur.value[1].dependsOn.indexOf(dId) !== -1) {
                    const error = new Error(`Dependency ${dId} is already added for the request ${dependentId}`);
                    error.name = "Duplicate Dependency";
                    throw error;
                }
                cur.value[1].dependsOn.push(dId);
            }
            else {
                const error = new Error(`Can't add dependency ${dependencyId}, There is only a dependent request in the batch`);
                error.name = "Invalid Dependency Addition";
                throw error;
            }
        }
    }
    /**
     * @public
     * Removes a dependency for a given dependent request id
     * @param {string} dependentId - The id of the dependent request
     * @param {string} [dependencyId] - The id of the dependency request, if not specified will remove all the dependencies of that request
     * @returns The boolean indicating removed status
     */
    removeDependency(dependentId, dependencyId) {
        const request = this.requests.get(dependentId);
        if (typeof request === "undefined" || request.dependsOn === undefined || request.dependsOn.length === 0) {
            return false;
        }
        if (typeof dependencyId !== "undefined") {
            const index = request.dependsOn.indexOf(dependencyId);
            if (index === -1) {
                return false;
            }
            request.dependsOn.splice(index, 1);
            return true;
        }
        else {
            delete request.dependsOn;
            return true;
        }
    }
}
/**
 * @private
 * @static
 * Limit for number of requests {@link - https://developer.microsoft.com/en-us/graph/docs/concepts/known_issues#json-batching}
 */
BatchRequestContent.requestLimit = 20;
//# sourceMappingURL=BatchRequestContent.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../buffer/index.js */ "tjlA").Buffer))

/***/ }),

/***/ "cY1T":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/Account.js ***!
  \*********************************************************************************************/
/*! exports provided: Account */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Account", function() { return Account; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ "oish");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/StringUtils */ "UjIo");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * accountIdentifier       combination of idToken.uid and idToken.utid
 * homeAccountIdentifier   combination of clientInfo.uid and clientInfo.utid
 * userName                idToken.preferred_username
 * name                    idToken.name
 * idToken                 idToken
 * sid                     idToken.sid - session identifier
 * environment             idtoken.issuer (the authority that issues the token)
 */
var Account = /** @class */ (function () {
    /**
     * Creates an Account Object
     * @praram accountIdentifier
     * @param homeAccountIdentifier
     * @param userName
     * @param name
     * @param idToken
     * @param sid
     * @param environment
     */
    function Account(accountIdentifier, homeAccountIdentifier, userName, name, idTokenClaims, sid, environment) {
        this.accountIdentifier = accountIdentifier;
        this.homeAccountIdentifier = homeAccountIdentifier;
        this.userName = userName;
        this.name = name;
        // will be deprecated soon
        this.idToken = idTokenClaims;
        this.idTokenClaims = idTokenClaims;
        this.sid = sid;
        this.environment = environment;
    }
    /**
     * @hidden
     * @param idToken
     * @param clientInfo
     */
    Account.createAccount = function (idToken, clientInfo) {
        // create accountIdentifier
        var accountIdentifier = idToken.objectId || idToken.subject;
        // create homeAccountIdentifier
        var uid = clientInfo ? clientInfo.uid : "";
        var utid = clientInfo ? clientInfo.utid : "";
        var homeAccountIdentifier;
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_1__["StringUtils"].isEmpty(uid)) {
            homeAccountIdentifier = _utils_StringUtils__WEBPACK_IMPORTED_MODULE_1__["StringUtils"].isEmpty(utid) ? _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(uid) : _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(uid) + "." + _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(utid);
        }
        return new Account(accountIdentifier, homeAccountIdentifier, idToken.preferredName, idToken.name, idToken.claims, idToken.sid, idToken.issuer);
    };
    /**
     * Utils function to compare two Account objects - used to check if the same user account is logged in
     *
     * @param a1: Account object
     * @param a2: Account object
     */
    Account.compareAccounts = function (a1, a2) {
        if (!a1 || !a2) {
            return false;
        }
        if (a1.homeAccountIdentifier && a2.homeAccountIdentifier) {
            if (a1.homeAccountIdentifier === a2.homeAccountIdentifier) {
                return true;
            }
        }
        return false;
    };
    return Account;
}());

//# sourceMappingURL=Account.js.map

/***/ }),

/***/ "cYvR":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/AuthCacheUtils.js ***!
  \***********************************************************************************************/
/*! exports provided: AuthCacheUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthCacheUtils", function() { return AuthCacheUtils; });
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ScopeSet */ "mb9z");
/* harmony import */ var _UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UrlUtils */ "8P3k");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * @hidden
 */
var AuthCacheUtils = /** @class */ (function () {
    function AuthCacheUtils() {
    }
    AuthCacheUtils.filterTokenCacheItemsByScope = function (tokenCacheItems, requestScopes) {
        return tokenCacheItems.filter(function (cacheItem) {
            var cachedScopes = cacheItem.key.scopes.split(" ");
            var searchScopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_0__["ScopeSet"].removeDefaultScopes(requestScopes);
            // If requestScopes contain only default scopes search for default scopes otherwise search for everything but default scopes
            return searchScopes.length === 0 ? _ScopeSet__WEBPACK_IMPORTED_MODULE_0__["ScopeSet"].containsScope(cachedScopes, requestScopes) : _ScopeSet__WEBPACK_IMPORTED_MODULE_0__["ScopeSet"].containsScope(cachedScopes, searchScopes);
        });
    };
    AuthCacheUtils.filterTokenCacheItemsByAuthority = function (tokenCacheItems, authority) {
        return tokenCacheItems.filter(function (cacheItem) { return _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].CanonicalizeUri(cacheItem.key.authority) === authority; });
    };
    AuthCacheUtils.filterTokenCacheItemsByDomain = function (tokenCacheItems, requestDomain) {
        return tokenCacheItems.filter(function (cacheItem) {
            var cacheItemDomain = _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].GetUrlComponents(cacheItem.key.authority).HostNameAndPort;
            return cacheItemDomain === requestDomain;
        });
    };
    return AuthCacheUtils;
}());

//# sourceMappingURL=AuthCacheUtils.js.map

/***/ }),

/***/ "cck5":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/cache/AccessTokenCacheItem.js ***!
  \***********************************************************************************************************/
/*! exports provided: AccessTokenCacheItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccessTokenCacheItem", function() { return AccessTokenCacheItem; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var AccessTokenCacheItem = /** @class */ (function () {
    function AccessTokenCacheItem(key, value) {
        this.key = key;
        this.value = value;
    }
    return AccessTokenCacheItem;
}());

//# sourceMappingURL=AccessTokenCacheItem.js.map

/***/ }),

/***/ "cjdc":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/mgt-person-card.types.js ***!
  \*************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
//# sourceMappingURL=mgt-person-card.types.js.map

/***/ }),

/***/ "crAU":
/*!****************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/IGraph.js ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
//# sourceMappingURL=IGraph.js.map

/***/ }),

/***/ "dUYm":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-people/mgt-people-css.js ***!
  \*************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family);color:var(--color,#000);font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}
`
];
//# sourceMappingURL=mgt-people-css.js.map

/***/ }),

/***/ "dYzh":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/AuthResponse.js ***!
  \*********************************************************************************************/
/*! exports provided: buildResponseStateOnly */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "buildResponseStateOnly", function() { return buildResponseStateOnly; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
function buildResponseStateOnly(state) {
    return {
        uniqueId: "",
        tenantId: "",
        tokenType: "",
        idToken: null,
        idTokenClaims: null,
        accessToken: "",
        scopes: null,
        expiresOn: null,
        account: null,
        accountState: state,
        fromCache: false
    };
}
//# sourceMappingURL=AuthResponse.js.map

/***/ }),

/***/ "dh3g":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/ImplicitMSALAuthenticationProvider.js ***!
  \*****************************************************************************************************/
/*! exports provided: ImplicitMSALAuthenticationProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImplicitMSALAuthenticationProvider", function() { return ImplicitMSALAuthenticationProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var msal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! msal */ "O34b");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @module ImplicitMSALAuthenticationProvider
 */

/**
 * @class
 * Class representing ImplicitMSALAuthenticationProvider
 * @extends AuthenticationProvider
 */
class ImplicitMSALAuthenticationProvider {
    /**
     * @public
     * @constructor
     * Creates an instance of ImplicitMSALAuthenticationProvider
     * @param {UserAgentApplication} msalApplication - An instance of MSAL UserAgentApplication
     * @param {MSALAuthenticationProviderOptions} options - An instance of MSALAuthenticationProviderOptions
     * @returns An instance of ImplicitMSALAuthenticationProvider
     */
    constructor(msalApplication, options) {
        this.options = options;
        this.msalApplication = msalApplication;
    }
    /**
     * @public
     * @async
     * To get the access token
     * @param {AuthenticationProviderOptions} authenticationProviderOptions - The authentication provider options object
     * @returns The promise that resolves to an access token
     */
    getAccessToken(authenticationProviderOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const options = authenticationProviderOptions;
            let scopes;
            if (typeof options !== "undefined") {
                scopes = options.scopes;
            }
            if (typeof scopes === "undefined" || scopes.length === 0) {
                scopes = this.options.scopes;
            }
            if (scopes.length === 0) {
                const error = new Error();
                error.name = "EmptyScopes";
                error.message = "Scopes cannot be empty, Please provide a scopes";
                throw error;
            }
            if (this.msalApplication.getAccount()) {
                const tokenRequest = {
                    scopes,
                };
                try {
                    const authResponse = yield this.msalApplication.acquireTokenSilent(tokenRequest);
                    return authResponse.accessToken;
                }
                catch (error) {
                    if (error instanceof msal__WEBPACK_IMPORTED_MODULE_1__["InteractionRequiredAuthError"]) {
                        try {
                            const authResponse = yield this.msalApplication.acquireTokenPopup(tokenRequest);
                            return authResponse.accessToken;
                        }
                        catch (error) {
                            throw error;
                        }
                    }
                    else {
                        throw error;
                    }
                }
            }
            else {
                try {
                    const tokenRequest = {
                        scopes,
                    };
                    yield this.msalApplication.loginPopup(tokenRequest);
                    const authResponse = yield this.msalApplication.acquireTokenSilent(tokenRequest);
                    return authResponse.accessToken;
                }
                catch (error) {
                    throw error;
                }
            }
        });
    }
}
//# sourceMappingURL=ImplicitMSALAuthenticationProvider.js.map

/***/ }),

/***/ "djkT":
/*!*****************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/ImplicitMSALAuthenticationProvider.js ***!
  \*****************************************************************************************************************************************/
/*! exports provided: ImplicitMSALAuthenticationProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImplicitMSALAuthenticationProvider", function() { return ImplicitMSALAuthenticationProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var msal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! msal */ "Kxp5");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @module ImplicitMSALAuthenticationProvider
 */

/**
 * @class
 * Class representing ImplicitMSALAuthenticationProvider
 * @extends AuthenticationProvider
 */
class ImplicitMSALAuthenticationProvider {
    /**
     * @public
     * @constructor
     * Creates an instance of ImplicitMSALAuthenticationProvider
     * @param {UserAgentApplication} msalApplication - An instance of MSAL UserAgentApplication
     * @param {MSALAuthenticationProviderOptions} options - An instance of MSALAuthenticationProviderOptions
     * @returns An instance of ImplicitMSALAuthenticationProvider
     */
    constructor(msalApplication, options) {
        this.options = options;
        this.msalApplication = msalApplication;
    }
    /**
     * @public
     * @async
     * To get the access token
     * @param {AuthenticationProviderOptions} authenticationProviderOptions - The authentication provider options object
     * @returns The promise that resolves to an access token
     */
    getAccessToken(authenticationProviderOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const options = authenticationProviderOptions;
            let scopes;
            if (typeof options !== "undefined") {
                scopes = options.scopes;
            }
            if (typeof scopes === "undefined" || scopes.length === 0) {
                scopes = this.options.scopes;
            }
            if (scopes.length === 0) {
                const error = new Error();
                error.name = "EmptyScopes";
                error.message = "Scopes cannot be empty, Please provide a scopes";
                throw error;
            }
            if (this.msalApplication.getAccount()) {
                const tokenRequest = {
                    scopes,
                };
                try {
                    const authResponse = yield this.msalApplication.acquireTokenSilent(tokenRequest);
                    return authResponse.accessToken;
                }
                catch (error) {
                    if (error instanceof msal__WEBPACK_IMPORTED_MODULE_1__["InteractionRequiredAuthError"]) {
                        try {
                            const authResponse = yield this.msalApplication.acquireTokenPopup(tokenRequest);
                            return authResponse.accessToken;
                        }
                        catch (error) {
                            throw error;
                        }
                    }
                    else {
                        throw error;
                    }
                }
            }
            else {
                try {
                    const tokenRequest = {
                        scopes,
                    };
                    yield this.msalApplication.loginPopup(tokenRequest);
                    const authResponse = yield this.msalApplication.acquireTokenSilent(tokenRequest);
                    return authResponse.accessToken;
                }
                catch (error) {
                    throw error;
                }
            }
        });
    }
}
//# sourceMappingURL=ImplicitMSALAuthenticationProvider.js.map

/***/ }),

/***/ "dmtB":
/*!******************************************************!*\
  !*** ./node_modules/lit-html/lib/modify-template.js ***!
  \******************************************************/
/*! exports provided: removeNodesFromTemplate, insertNodeIntoTemplate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeNodesFromTemplate", function() { return removeNodesFromTemplate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "insertNodeIntoTemplate", function() { return insertNodeIntoTemplate; });
/* harmony import */ var _template_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./template.js */ "4yuk");
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */

const walkerNodeFilter = 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */;
/**
 * Removes the list of nodes from a Template safely. In addition to removing
 * nodes from the Template, the Template part indices are updated to match
 * the mutated Template DOM.
 *
 * As the template is walked the removal state is tracked and
 * part indices are adjusted as needed.
 *
 * div
 *   div#1 (remove) <-- start removing (removing node is div#1)
 *     div
 *       div#2 (remove)  <-- continue removing (removing node is still div#1)
 *         div
 * div <-- stop removing since previous sibling is the removing node (div#1,
 * removed 4 nodes)
 */
function removeNodesFromTemplate(template, nodesToRemove) {
    const { element: { content }, parts } = template;
    const walker = document.createTreeWalker(content, walkerNodeFilter, null, false);
    let partIndex = nextActiveIndexInTemplateParts(parts);
    let part = parts[partIndex];
    let nodeIndex = -1;
    let removeCount = 0;
    const nodesToRemoveInTemplate = [];
    let currentRemovingNode = null;
    while (walker.nextNode()) {
        nodeIndex++;
        const node = walker.currentNode;
        // End removal if stepped past the removing node
        if (node.previousSibling === currentRemovingNode) {
            currentRemovingNode = null;
        }
        // A node to remove was found in the template
        if (nodesToRemove.has(node)) {
            nodesToRemoveInTemplate.push(node);
            // Track node we're removing
            if (currentRemovingNode === null) {
                currentRemovingNode = node;
            }
        }
        // When removing, increment count by which to adjust subsequent part indices
        if (currentRemovingNode !== null) {
            removeCount++;
        }
        while (part !== undefined && part.index === nodeIndex) {
            // If part is in a removed node deactivate it by setting index to -1 or
            // adjust the index as needed.
            part.index = currentRemovingNode !== null ? -1 : part.index - removeCount;
            // go to the next active part.
            partIndex = nextActiveIndexInTemplateParts(parts, partIndex);
            part = parts[partIndex];
        }
    }
    nodesToRemoveInTemplate.forEach((n) => n.parentNode.removeChild(n));
}
const countNodes = (node) => {
    let count = (node.nodeType === 11 /* Node.DOCUMENT_FRAGMENT_NODE */) ? 0 : 1;
    const walker = document.createTreeWalker(node, walkerNodeFilter, null, false);
    while (walker.nextNode()) {
        count++;
    }
    return count;
};
const nextActiveIndexInTemplateParts = (parts, startIndex = -1) => {
    for (let i = startIndex + 1; i < parts.length; i++) {
        const part = parts[i];
        if (Object(_template_js__WEBPACK_IMPORTED_MODULE_0__["isTemplatePartActive"])(part)) {
            return i;
        }
    }
    return -1;
};
/**
 * Inserts the given node into the Template, optionally before the given
 * refNode. In addition to inserting the node into the Template, the Template
 * part indices are updated to match the mutated Template DOM.
 */
function insertNodeIntoTemplate(template, node, refNode = null) {
    const { element: { content }, parts } = template;
    // If there's no refNode, then put node at end of template.
    // No part indices need to be shifted in this case.
    if (refNode === null || refNode === undefined) {
        content.appendChild(node);
        return;
    }
    const walker = document.createTreeWalker(content, walkerNodeFilter, null, false);
    let partIndex = nextActiveIndexInTemplateParts(parts);
    let insertCount = 0;
    let walkerIndex = -1;
    while (walker.nextNode()) {
        walkerIndex++;
        const walkerNode = walker.currentNode;
        if (walkerNode === refNode) {
            insertCount = countNodes(node);
            refNode.parentNode.insertBefore(node, refNode);
        }
        while (partIndex !== -1 && parts[partIndex].index === walkerIndex) {
            // If we've inserted the node, simply adjust all subsequent parts
            if (insertCount > 0) {
                while (partIndex !== -1) {
                    parts[partIndex].index += insertCount;
                    partIndex = nextActiveIndexInTemplateParts(parts, partIndex);
                }
                return;
            }
            partIndex = nextActiveIndexInTemplateParts(parts, partIndex);
        }
    }
}
//# sourceMappingURL=modify-template.js.map

/***/ }),

/***/ "dwGj":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/sub-components/mgt-arrow-options/mgt-arrow-options-css.js ***!
  \******************************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}:host,mgt-arrow-options{position:relative;font-family:var(--default-font-family)}:host .ArrowIcon,mgt-arrow-options .ArrowIcon{font-family:FabricMDL2Icons;margin:0 0 0 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Header,mgt-arrow-options .Header{cursor:pointer}:host .Header:hover,mgt-arrow-options .Header:hover{color:var(--theme-primary-color)}:host .Menu,mgt-arrow-options .Menu{position:absolute;left:var(--arrow-options-left,0);box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap}:host .Menu.Open,mgt-arrow-options .Menu.Open{display:block}:host .MenuOption,mgt-arrow-options .MenuOption{padding:20px;cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;display:flex;align-items:center;justify-content:stretch;justify-items:stretch}:host .MenuOption:first,mgt-arrow-options .MenuOption:first{padding:12px 20px 20px 20px}:host .MenuOption:hover,mgt-arrow-options .MenuOption:hover{background-color:var(--background-color--hover,#edebe9)}:host .MenuOption:active,mgt-arrow-options .MenuOption:active{background-color:var(--background-color--active,#e1dfdd)}:host .MenuOptionCheck,mgt-arrow-options .MenuOptionCheck{font-family:FabricMDL2Icons;color:transparent;margin-right:10px}:host .MenuOptionCheck.CurrentValue,mgt-arrow-options .MenuOptionCheck.CurrentValue{color:#0078d4}
`
];
//# sourceMappingURL=mgt-arrow-options-css.js.map

/***/ }),

/***/ "e00e":
/*!***************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/components/templatedComponent.js ***!
  \***************************************************************************************/
/*! exports provided: MgtTemplatedComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtTemplatedComponent", function() { return MgtTemplatedComponent; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _utils_equals__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/equals */ "sJXD");
/* harmony import */ var _baseComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./baseComponent */ "zoxn");
/* harmony import */ var _utils_TemplateHelper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/TemplateHelper */ "jVY4");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */




/**
 * An abstract class that defines a templatable web component
 *
 * @export
 * @abstract
 * @class MgtTemplatedComponent
 * @extends {MgtBaseComponent}
 */
class MgtTemplatedComponent extends _baseComponent__WEBPACK_IMPORTED_MODULE_2__["MgtBaseComponent"] {
    constructor() {
        super();
        /**
         * Holds all templates defined by developer
         *
         * @protected
         * @memberof MgtTemplatedComponent
         */
        this.templates = {};
        this._renderedSlots = false;
        this._renderedTemplates = {};
        this._slotNamesAddedDuringRender = [];
        this.templateContext = this.templateContext || {};
    }
    /**
     * Updates the element. This method reflects property values to attributes.
     * It can be overridden to render and keep updated element DOM.
     * Setting properties inside this method will *not* trigger
     * another update.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    update(changedProperties) {
        this.templates = this.getTemplates();
        this._slotNamesAddedDuringRender = [];
        super.update(changedProperties);
    }
    /**
     * Invoked whenever the element is updated. Implement to perform
     * post-updating tasks via DOM APIs, for example, focusing an element.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * * @param changedProperties Map of changed properties with old values
     */
    updated(changedProperties) {
        super.updated(changedProperties);
        this.removeUnusedSlottedElements();
    }
    /**
     * Render a <template> by type and return content to render
     *
     * @param templateType type of template (indicated by the data-type attribute)
     * @param context the data context that should be expanded in template
     * @param slotName the slot name that will be used to host the new rendered template. set to a unique value if multiple templates of this type will be rendered. default is templateType
     */
    renderTemplate(templateType, context, slotName) {
        if (!this.hasTemplate(templateType)) {
            return null;
        }
        slotName = slotName || templateType;
        this._slotNamesAddedDuringRender.push(slotName);
        this._renderedSlots = true;
        const template = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <slot name=${slotName}></slot>
    `;
        if (this._renderedTemplates.hasOwnProperty(slotName)) {
            const { context: existingContext, slot } = this._renderedTemplates[slotName];
            if (Object(_utils_equals__WEBPACK_IMPORTED_MODULE_1__["equals"])(existingContext, context)) {
                return template;
            }
            this.removeChild(slot);
        }
        const div = document.createElement('div');
        div.slot = slotName;
        div.dataset.generated = 'template';
        _utils_TemplateHelper__WEBPACK_IMPORTED_MODULE_3__["TemplateHelper"].renderTemplate(div, this.templates[templateType], context, Object.assign({}, this.templateContext));
        this.appendChild(div);
        this._renderedTemplates[slotName] = { context, slot: div };
        this.fireCustomEvent('templateRendered', { templateType, context, element: div });
        return template;
    }
    /**
     * Check if a specific template has been provided.
     *
     * @protected
     * @param {string} templateName
     * @returns {boolean}
     * @memberof MgtTemplatedComponent
     */
    hasTemplate(templateName) {
        return this.templates && this.templates[templateName];
    }
    getTemplates() {
        const templates = {};
        // tslint:disable-next-line: prefer-for-of
        for (let i = 0; i < this.children.length; i++) {
            const child = this.children[i];
            if (child.nodeName === 'TEMPLATE') {
                const template = child;
                if (template.dataset.type) {
                    templates[template.dataset.type] = template;
                }
                else {
                    templates.default = template;
                }
                template.templateOrder = i;
            }
        }
        return templates;
    }
    removeUnusedSlottedElements() {
        if (this._renderedSlots) {
            for (let i = 0; i < this.children.length; i++) {
                const child = this.children[i];
                if (child.dataset && child.dataset.generated && !this._slotNamesAddedDuringRender.includes(child.slot)) {
                    this.removeChild(child);
                    delete this._renderedTemplates[child.slot];
                    i--;
                }
            }
            this._renderedSlots = false;
        }
    }
}
//# sourceMappingURL=templatedComponent.js.map

/***/ }),

/***/ "e33W":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/IdToken.js ***!
  \*********************************************************************************************/
/*! exports provided: IdToken */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IdToken", function() { return IdToken; });
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error/ClientAuthError */ "L9Ey");
/* harmony import */ var _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/TokenUtils */ "Tq/z");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ "UjIo");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * @hidden
 */
var IdToken = /** @class */ (function () {
    /* tslint:disable:no-string-literal */
    function IdToken(rawIdToken) {
        if (_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(rawIdToken)) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createIdTokenNullOrEmptyError(rawIdToken);
        }
        try {
            this.rawIdToken = rawIdToken;
            this.claims = _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_1__["TokenUtils"].extractIdToken(rawIdToken);
            if (this.claims) {
                if (this.claims.hasOwnProperty("iss")) {
                    this.issuer = this.claims["iss"];
                }
                if (this.claims.hasOwnProperty("oid")) {
                    this.objectId = this.claims["oid"];
                }
                if (this.claims.hasOwnProperty("sub")) {
                    this.subject = this.claims["sub"];
                }
                if (this.claims.hasOwnProperty("tid")) {
                    this.tenantId = this.claims["tid"];
                }
                if (this.claims.hasOwnProperty("ver")) {
                    this.version = this.claims["ver"];
                }
                if (this.claims.hasOwnProperty("preferred_username")) {
                    this.preferredName = this.claims["preferred_username"];
                }
                else if (this.claims.hasOwnProperty("upn")) {
                    this.preferredName = this.claims["upn"];
                }
                if (this.claims.hasOwnProperty("name")) {
                    this.name = this.claims["name"];
                }
                if (this.claims.hasOwnProperty("nonce")) {
                    this.nonce = this.claims["nonce"];
                }
                if (this.claims.hasOwnProperty("exp")) {
                    this.expiration = this.claims["exp"];
                }
                if (this.claims.hasOwnProperty("home_oid")) {
                    this.homeObjectId = this.claims["home_oid"];
                }
                if (this.claims.hasOwnProperty("sid")) {
                    this.sid = this.claims["sid"];
                }
                if (this.claims.hasOwnProperty("cloud_instance_host_name")) {
                    this.cloudInstance = this.claims["cloud_instance_host_name"];
                }
                /* tslint:enable:no-string-literal */
            }
        }
        catch (e) {
            /*
             * TODO: This error here won't really every be thrown, since extractIdToken() returns null if the decodeJwt() fails.
             * Need to add better error handling here to account for being unable to decode jwts.
             */
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createIdTokenParsingError(e);
        }
    }
    return IdToken;
}());

//# sourceMappingURL=IdToken.js.map

/***/ }),

/***/ "e54M":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/sub-components/mgt-flyout/mgt-flyout-css.js ***!
  \****************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--box-shadow,0 3.2px 7.2px 0 rgba(0,0,0,.132))}.root.visible .flyout{display:inline-block;animation-name:fadeIn;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}@keyframes fadeIn{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`
];
//# sourceMappingURL=mgt-flyout-css.js.map

/***/ }),

/***/ "e8Xr":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/cache/AccessTokenValue.js ***!
  \*************************************************************************************************/
/*! exports provided: AccessTokenValue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccessTokenValue", function() { return AccessTokenValue; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var AccessTokenValue = /** @class */ (function () {
    function AccessTokenValue(accessToken, idToken, expiresIn, homeAccountIdentifier) {
        this.accessToken = accessToken;
        this.idToken = idToken;
        this.expiresIn = expiresIn;
        this.homeAccountIdentifier = homeAccountIdentifier;
    }
    return AccessTokenValue;
}());

//# sourceMappingURL=AccessTokenValue.js.map

/***/ }),

/***/ "eByC":
/*!************************************************!*\
  !*** ./node_modules/lit-html/lib/directive.js ***!
  \************************************************/
/*! exports provided: directive, isDirective */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "directive", function() { return directive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isDirective", function() { return isDirective; });
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const directives = new WeakMap();
/**
 * Brands a function as a directive factory function so that lit-html will call
 * the function during template rendering, rather than passing as a value.
 *
 * A _directive_ is a function that takes a Part as an argument. It has the
 * signature: `(part: Part) => void`.
 *
 * A directive _factory_ is a function that takes arguments for data and
 * configuration and returns a directive. Users of directive usually refer to
 * the directive factory as the directive. For example, "The repeat directive".
 *
 * Usually a template author will invoke a directive factory in their template
 * with relevant arguments, which will then return a directive function.
 *
 * Here's an example of using the `repeat()` directive factory that takes an
 * array and a function to render an item:
 *
 * ```js
 * html`<ul><${repeat(items, (item) => html`<li>${item}</li>`)}</ul>`
 * ```
 *
 * When `repeat` is invoked, it returns a directive function that closes over
 * `items` and the template function. When the outer template is rendered, the
 * return directive function is called with the Part for the expression.
 * `repeat` then performs it's custom logic to render multiple items.
 *
 * @param f The directive factory function. Must be a function that returns a
 * function of the signature `(part: Part) => void`. The returned function will
 * be called with the part object.
 *
 * @example
 *
 * import {directive, html} from 'lit-html';
 *
 * const immutable = directive((v) => (part) => {
 *   if (part.value !== v) {
 *     part.setValue(v)
 *   }
 * });
 */
const directive = (f) => ((...args) => {
    const d = f(...args);
    directives.set(d, true);
    return d;
});
const isDirective = (o) => {
    return typeof o === 'function' && directives.has(o);
};
//# sourceMappingURL=directive.js.map

/***/ }),

/***/ "eK1D":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-todo/mgt-todo-css.js ***!
  \*********************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--task-border:2px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:2px solid #797775;--task-complete-border:2px dotted #797775;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,2px solid #e1dfdd)}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#797775));font-size:12px;font-weight:600;white-space:nowrap;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;padding:4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{flex:0 0 auto;display:flex}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{height:100%;max-width:50px;min-width:50px;flex:1 1 auto;justify-content:center;align-items:center;display:flex;cursor:pointer}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4)}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{font-family:var(--default-font-family, "Segoe UI");font-size:14px;font-weight:600;color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));margin:0 12px 0 32px}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{background:var(--task-new-add-button-disabled-background,#eaeaea);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}
`
];
//# sourceMappingURL=mgt-todo-css.js.map

/***/ }),

/***/ "eb1H":
/*!****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/IdToken.js ***!
  \****************************************************************************************/
/*! exports provided: IdToken */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IdToken", function() { return IdToken; });
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error/ClientAuthError */ "n82g");
/* harmony import */ var _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/TokenUtils */ "Ptj7");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ "k+Uk");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



/**
 * @hidden
 */
var IdToken = /** @class */ (function () {
    /* tslint:disable:no-string-literal */
    function IdToken(rawIdToken) {
        if (_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(rawIdToken)) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createIdTokenNullOrEmptyError(rawIdToken);
        }
        try {
            this.rawIdToken = rawIdToken;
            this.claims = _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_1__["TokenUtils"].extractIdToken(rawIdToken);
            if (this.claims) {
                if (this.claims.hasOwnProperty("iss")) {
                    this.issuer = this.claims["iss"];
                }
                if (this.claims.hasOwnProperty("oid")) {
                    this.objectId = this.claims["oid"];
                }
                if (this.claims.hasOwnProperty("sub")) {
                    this.subject = this.claims["sub"];
                }
                if (this.claims.hasOwnProperty("tid")) {
                    this.tenantId = this.claims["tid"];
                }
                if (this.claims.hasOwnProperty("ver")) {
                    this.version = this.claims["ver"];
                }
                if (this.claims.hasOwnProperty("preferred_username")) {
                    this.preferredName = this.claims["preferred_username"];
                }
                else if (this.claims.hasOwnProperty("upn")) {
                    this.preferredName = this.claims["upn"];
                }
                if (this.claims.hasOwnProperty("name")) {
                    this.name = this.claims["name"];
                }
                if (this.claims.hasOwnProperty("nonce")) {
                    this.nonce = this.claims["nonce"];
                }
                if (this.claims.hasOwnProperty("exp")) {
                    this.expiration = this.claims["exp"];
                }
                if (this.claims.hasOwnProperty("home_oid")) {
                    this.homeObjectId = this.claims["home_oid"];
                }
                if (this.claims.hasOwnProperty("sid")) {
                    this.sid = this.claims["sid"];
                }
                if (this.claims.hasOwnProperty("cloud_instance_host_name")) {
                    this.cloudInstance = this.claims["cloud_instance_host_name"];
                }
                /* tslint:enable:no-string-literal */
            }
        }
        catch (e) {
            /*
             * TODO: This error here won't really every be thrown, since extractIdToken() returns null if the decodeJwt() fails.
             * Need to add better error handling here to account for being unable to decode jwts.
             */
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createIdTokenParsingError(e);
        }
    }
    return IdToken;
}());

//# sourceMappingURL=IdToken.js.map

/***/ }),

/***/ "edJK":
/*!******************************************************!*\
  !*** ./node_modules/idb/build/esm/wrap-idb-value.js ***!
  \******************************************************/
/*! exports provided: a, i, r, u, w */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return reverseTransformCache; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return instanceOfAny; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "r", function() { return replaceTraps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "u", function() { return unwrap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "w", function() { return wrap; });
const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);

let idbProxyableTypes;
let cursorAdvanceMethods;
// This is a function to prevent it throwing up in node environments.
function getIdbProxyableTypes() {
    return (idbProxyableTypes ||
        (idbProxyableTypes = [
            IDBDatabase,
            IDBObjectStore,
            IDBIndex,
            IDBCursor,
            IDBTransaction,
        ]));
}
// This is a function to prevent it throwing up in node environments.
function getCursorAdvanceMethods() {
    return (cursorAdvanceMethods ||
        (cursorAdvanceMethods = [
            IDBCursor.prototype.advance,
            IDBCursor.prototype.continue,
            IDBCursor.prototype.continuePrimaryKey,
        ]));
}
const cursorRequestMap = new WeakMap();
const transactionDoneMap = new WeakMap();
const transactionStoreNamesMap = new WeakMap();
const transformCache = new WeakMap();
const reverseTransformCache = new WeakMap();
function promisifyRequest(request) {
    const promise = new Promise((resolve, reject) => {
        const unlisten = () => {
            request.removeEventListener('success', success);
            request.removeEventListener('error', error);
        };
        const success = () => {
            resolve(wrap(request.result));
            unlisten();
        };
        const error = () => {
            reject(request.error);
            unlisten();
        };
        request.addEventListener('success', success);
        request.addEventListener('error', error);
    });
    promise
        .then((value) => {
        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval
        // (see wrapFunction).
        if (value instanceof IDBCursor) {
            cursorRequestMap.set(value, request);
        }
        // Catching to avoid "Uncaught Promise exceptions"
    })
        .catch(() => { });
    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This
    // is because we create many promises from a single IDBRequest.
    reverseTransformCache.set(promise, request);
    return promise;
}
function cacheDonePromiseForTransaction(tx) {
    // Early bail if we've already created a done promise for this transaction.
    if (transactionDoneMap.has(tx))
        return;
    const done = new Promise((resolve, reject) => {
        const unlisten = () => {
            tx.removeEventListener('complete', complete);
            tx.removeEventListener('error', error);
            tx.removeEventListener('abort', error);
        };
        const complete = () => {
            resolve();
            unlisten();
        };
        const error = () => {
            reject(tx.error || new DOMException('AbortError', 'AbortError'));
            unlisten();
        };
        tx.addEventListener('complete', complete);
        tx.addEventListener('error', error);
        tx.addEventListener('abort', error);
    });
    // Cache it for later retrieval.
    transactionDoneMap.set(tx, done);
}
let idbProxyTraps = {
    get(target, prop, receiver) {
        if (target instanceof IDBTransaction) {
            // Special handling for transaction.done.
            if (prop === 'done')
                return transactionDoneMap.get(target);
            // Polyfill for objectStoreNames because of Edge.
            if (prop === 'objectStoreNames') {
                return target.objectStoreNames || transactionStoreNamesMap.get(target);
            }
            // Make tx.store return the only store in the transaction, or undefined if there are many.
            if (prop === 'store') {
                return receiver.objectStoreNames[1]
                    ? undefined
                    : receiver.objectStore(receiver.objectStoreNames[0]);
            }
        }
        // Else transform whatever we get back.
        return wrap(target[prop]);
    },
    set(target, prop, value) {
        target[prop] = value;
        return true;
    },
    has(target, prop) {
        if (target instanceof IDBTransaction &&
            (prop === 'done' || prop === 'store')) {
            return true;
        }
        return prop in target;
    },
};
function replaceTraps(callback) {
    idbProxyTraps = callback(idbProxyTraps);
}
function wrapFunction(func) {
    // Due to expected object equality (which is enforced by the caching in `wrap`), we
    // only create one new func per func.
    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.
    if (func === IDBDatabase.prototype.transaction &&
        !('objectStoreNames' in IDBTransaction.prototype)) {
        return function (storeNames, ...args) {
            const tx = func.call(unwrap(this), storeNames, ...args);
            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);
            return wrap(tx);
        };
    }
    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In
    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the
    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense
    // with real promises, so each advance methods returns a new promise for the cursor object, or
    // undefined if the end of the cursor has been reached.
    if (getCursorAdvanceMethods().includes(func)) {
        return function (...args) {
            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use
            // the original object.
            func.apply(unwrap(this), args);
            return wrap(cursorRequestMap.get(this));
        };
    }
    return function (...args) {
        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use
        // the original object.
        return wrap(func.apply(unwrap(this), args));
    };
}
function transformCachableValue(value) {
    if (typeof value === 'function')
        return wrapFunction(value);
    // This doesn't return, it just creates a 'done' promise for the transaction,
    // which is later returned for transaction.done (see idbObjectHandler).
    if (value instanceof IDBTransaction)
        cacheDonePromiseForTransaction(value);
    if (instanceOfAny(value, getIdbProxyableTypes()))
        return new Proxy(value, idbProxyTraps);
    // Return the same value back if we're not going to transform it.
    return value;
}
function wrap(value) {
    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because
    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.
    if (value instanceof IDBRequest)
        return promisifyRequest(value);
    // If we've already transformed this value before, reuse the transformed value.
    // This is faster, but it also provides object equality.
    if (transformCache.has(value))
        return transformCache.get(value);
    const newValue = transformCachableValue(value);
    // Not all types are transformed.
    // These may be primitive types, so they can't be WeakMap keys.
    if (newValue !== value) {
        transformCache.set(value, newValue);
        reverseTransformCache.set(newValue, value);
    }
    return newValue;
}
const unwrap = (value) => reverseTransformCache.get(value);




/***/ }),

/***/ "ehPe":
/*!************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/HTTPMessageHandler.js ***!
  \************************************************************************************************************************************/
/*! exports provided: HTTPMessageHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTPMessageHandler", function() { return HTTPMessageHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @class
 * @implements Middleware
 * Class for HTTPMessageHandler
 */
class HTTPMessageHandler {
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The request context object
     * @returns A promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                context.response = yield fetch(context.request, context.options);
                return;
            }
            catch (error) {
                throw error;
            }
        });
    }
}
//# sourceMappingURL=HTTPMessageHandler.js.map

/***/ }),

/***/ "eyTa":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-tasks-base/strings.js ***!
  \**********************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    cancelNewTaskSubtitle: 'cancel',
    newTaskPlaceholder: 'Task...',
    addTaskButtonSubtitle: 'Add',
    removeTaskSubtitle: 'Delete Task'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "gX3d":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-profile/mgt-person-card-profile.js ***!
  \************************************************************************************************************************************************/
/*! exports provided: MgtPersonCardProfile */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtPersonCardProfile", function() { return MgtPersonCardProfile; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../BasePersonCardSection */ "8z1x");
/* harmony import */ var _utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/SvgHelper */ "FPR2");
/* harmony import */ var _mgt_person_card_profile_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mgt-person-card-profile-css */ "AvGg");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./strings */ "jTeC");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





/**
 * The user profile subsection of the person card
 *
 * @export
 * @class MgtPersonCardProfile
 * @extends {MgtTemplatedComponent}
 */
let MgtPersonCardProfile = class MgtPersonCardProfile extends _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_1__["BasePersonCardSection"] {
    constructor(profile) {
        super();
        this.profile = profile;
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_person_card_profile_css__WEBPACK_IMPORTED_MODULE_3__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_4__["strings"];
    }
    /**
     * The name for display in the overview section.
     *
     * @readonly
     * @type {string}
     * @memberof MgtPersonCardProfile
     */
    get displayName() {
        return this.strings.SkillsAndExperienceSectionTitle;
    }
    /**
     * Returns true if the profile contains data
     * that can be rendered
     *
     * @readonly
     * @type {boolean}
     * @memberof MgtPersonCardProfile
     */
    get hasData() {
        if (!this.profile) {
            return false;
        }
        const { languages, skills, positions, educationalActivities } = this.profile;
        return ([
            this._birthdayAnniversary,
            this._personalInterests && this._personalInterests.length,
            this._professionalInterests && this._professionalInterests.length,
            languages && languages.length,
            skills && skills.length,
            positions && positions.length,
            educationalActivities && educationalActivities.length
        ].filter(v => !!v).length > 0);
    }
    /**
     * The user's profile metadata
     *
     * @protected
     * @type {IProfile}
     * @memberof MgtPersonCardProfile
     */
    get profile() {
        return this._profile;
    }
    set profile(value) {
        if (value === this._profile) {
            return;
        }
        this._profile = value;
        this._birthdayAnniversary =
            value && value.anniversaries ? value.anniversaries.find(this.isBirthdayAnniversary) : null;
        this._personalInterests = value && value.interests ? value.interests.filter(this.isPersonalInterest) : null;
        this._professionalInterests = value && value.interests ? value.interests.filter(this.isProfessionalInterest) : null;
    }
    /**
     * Render the icon for display in the navigation ribbon.
     *
     * @returns {TemplateResult}
     * @memberof MgtPersonCardProfile
     */
    renderIcon() {
        return Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["SvgIcon"].Profile);
    }
    /**
     * Reset any state in the section
     *
     * @protected
     * @memberof MgtPersonCardProfile
     */
    clearState() {
        this.profile = null;
    }
    /**
     * Render the compact view
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardProfile
     */
    renderCompactView() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root compact" dir=${this.direction}>
        ${this.renderSubSections().slice(0, 2)}
      </div>
    `;
    }
    /**
     * Render the full view
     *
     * @protected
     * @returns
     * @memberof MgtPersonCardProfile
     */
    renderFullView() {
        this.initPostRenderOperations();
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.AboutCompactSectionTitle}</div>
        ${this.renderSubSections()}
      </div>
    `;
    }
    /**
     * Renders all subSections of the profile
     * Defines order of how they render
     *
     * @protected
     * @return {*}
     * @memberof MgtPersonCardProfile
     */
    renderSubSections() {
        const subSections = [
            this.renderSkills(),
            this.renderBirthday(),
            this.renderLanguages(),
            this.renderWorkExperience(),
            this.renderEducation(),
            this.renderProfessionalInterests(),
            this.renderPersonalInterests()
        ];
        return subSections.filter(s => !!s);
    }
    /**
     * Render the user's known languages
     *
     * @protected
     * @returns
     * @memberof MgtPersonCardProfile
     */
    renderLanguages() {
        const { languages } = this._profile;
        if (!(languages && languages.length)) {
            return null;
        }
        const languageItems = [];
        for (const language of languages) {
            let proficiency = null;
            if (language.proficiency && language.proficiency.length) {
                proficiency = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <span class="language__proficiency">
            &nbsp;(${language.proficiency})
          </span>
        `;
            }
            languageItems.push(lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="token-list__item language">
          <span class="language__title">${language.displayName}</span>
          ${proficiency}
        </div>
      `);
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <section>
        <div class="section__title">${this.strings.LanguagesSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${languageItems}
          </div>
        </div>
      </section>
    `;
    }
    /**
     * Render the user's skills
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardProfile
     */
    renderSkills() {
        const { skills } = this._profile;
        if (!(skills && skills.length)) {
            return null;
        }
        const skillItems = [];
        for (const skill of skills) {
            skillItems.push(lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="token-list__item skill">
          ${skill.displayName}
        </div>
      `);
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <section>
        <div class="section__title">${this.strings.SkillsSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${skillItems}
          </div>
        </div>
      </section>
    `;
    }
    /**
     * Render the user's work experience timeline
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardProfile
     */
    renderWorkExperience() {
        if (!this._profile || !this._profile.positions) {
            return null;
        }
        const positionItems = [];
        for (const position of this._profile.positions) {
            positionItems.push(lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="data-list__item work-position">
          <div class="data-list__item__header">
            <div class="data-list__item__title">${position.detail.jobTitle}</div>
            <div class="data-list__item__date-range">
              ${this.getDisplayDateRange(position.detail)}
            </div>
          </div>
          <div class="data-list__item__content">
            <div class="work-position__company">
              ${position.detail.company.displayName}
            </div>
            <div class="work-position__location">
              ${position.detail.company.address.city}, ${position.detail.company.address.state}
            </div>
          </div>
        </div>
      `);
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <section>
        <div class="section__title">${this.strings.WorkExperienceSubSectionTitle}</div>
        <div class="section__content">
          <div class="data-list">
            ${positionItems}
          </div>
        </div>
      </section>
    `;
    }
    /**
     * Render the user's education timeline
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardProfile
     */
    renderEducation() {
        const { educationalActivities } = this._profile;
        if (!(educationalActivities && educationalActivities.length)) {
            return null;
        }
        const positionItems = [];
        for (const educationalActivity of educationalActivities) {
            positionItems.push(lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="data-list__item educational-activity">
          <div class="data-list__item__header">
            <div class="data-list__item__title">${educationalActivity.institution.displayName}</div>
            <div class="data-list__item__date-range">
              ${this.getDisplayDateRange(educationalActivity)}
            </div>
          </div>
          <div class="data-list__item__content">
            <div class="educational-activity__degree">
              ${educationalActivity.program.displayName || 'Bachelors Degree'}
            </div>
          </div>
        </div>
      `);
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <section>
        <div class="section__title">${this.strings.EducationSubSectionTitle}</div>
        <div class="section__content">
          <div class="data-list">
            ${positionItems}
          </div>
        </div>
      </section>
    `;
    }
    /**
     * Render the user's professional interests
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardProfile
     */
    renderProfessionalInterests() {
        if (!this._professionalInterests || !this._professionalInterests.length) {
            return null;
        }
        const interestItems = [];
        for (const interest of this._professionalInterests) {
            interestItems.push(lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="token-list__item interest interest--professional">
          ${interest.displayName}
        </div>
      `);
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <section>
        <div class="section__title">${this.strings.professionalInterestsSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${interestItems}
          </div>
        </div>
      </section>
    `;
    }
    /**
     * Render the user's personal interests
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardProfile
     */
    renderPersonalInterests() {
        if (!this._personalInterests || !this._personalInterests.length) {
            return null;
        }
        const interestItems = [];
        for (const interest of this._personalInterests) {
            interestItems.push(lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="token-list__item interest interest--personal">
          ${interest.displayName}
        </div>
      `);
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <section>
        <div class="section__title">${this.strings.personalInterestsSubSectionTitle}</div>
        <div class="section__content">
          <div class="token-list">
            ${interestItems}
          </div>
        </div>
      </section>
    `;
    }
    /**
     * Render the user's birthday
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardProfile
     */
    renderBirthday() {
        if (!this._birthdayAnniversary || !this._birthdayAnniversary.date) {
            return null;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <section>
        <div class="section__title">Birthday</div>
        <div class="section__content">
          <div class="birthday">
            <div class="birthday__icon">
              ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["SvgIcon"].Birthday)}
            </div>
            <div class="birthday__date">
              ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
            </div>
          </div>
        </div>
      </section>
    `;
    }
    isPersonalInterest(interest) {
        return interest.categories && interest.categories.includes('personal');
    }
    isProfessionalInterest(interest) {
        return interest.categories && interest.categories.includes('professional');
    }
    isBirthdayAnniversary(anniversary) {
        return anniversary.type === 'birthday';
    }
    getDisplayDate(date) {
        return date.toLocaleString('default', {
            day: 'numeric',
            month: 'long'
        });
    }
    // tslint:disable-next-line: completed-docs
    getDisplayDateRange(event) {
        const start = new Date(event.startMonthYear).getFullYear();
        if (start === 0) {
            return null;
        }
        const end = event.endMonthYear ? new Date(event.endMonthYear).getFullYear() : this.strings.currentYearSubtitle;
        return `${start} — ${end}`;
    }
    initPostRenderOperations() {
        setTimeout(() => {
            try {
                const sections = this.shadowRoot.querySelectorAll('section');
                sections.forEach(section => {
                    // Perform post render operations per section
                    this.handleTokenOverflow(section);
                });
            }
            catch (_a) {
                // An exception may occur if the component is suddenly removed during post render operations.
            }
        }, 0);
    }
    handleTokenOverflow(section) {
        const tokenLists = section.querySelectorAll('.token-list');
        if (!tokenLists || !tokenLists.length) {
            return;
        }
        for (const tokenList of Array.from(tokenLists)) {
            const items = tokenList.querySelectorAll('.token-list__item');
            if (!items || !items.length) {
                continue;
            }
            let overflowItems = null;
            let itemRect = items[0].getBoundingClientRect();
            const tokenListRect = tokenList.getBoundingClientRect();
            const maxtop = itemRect.height * 2 + tokenListRect.top;
            // Use (items.length - 1) to prevent [+1 more] from appearing.
            for (let i = 0; i < items.length - 1; i++) {
                itemRect = items[i].getBoundingClientRect();
                if (itemRect.top > maxtop) {
                    overflowItems = Array.from(items).slice(i, items.length);
                    break;
                }
            }
            if (overflowItems) {
                overflowItems.forEach(i => i.classList.add('overflow'));
                const overflowToken = document.createElement('div');
                overflowToken.classList.add('token-list__item');
                overflowToken.classList.add('token-list__item--show-overflow');
                overflowToken.innerText = `+ ${overflowItems.length} more`;
                overflowToken.addEventListener('click', (e) => {
                    // On click, remove [+n more] token and reveal the hidden overflow tokens.
                    overflowToken.remove();
                    overflowItems.forEach(i => i.classList.remove('overflow'));
                });
                tokenList.appendChild(overflowToken);
            }
        }
    }
};
MgtPersonCardProfile = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-person-card-profile'),
    __metadata("design:paramtypes", [Object])
], MgtPersonCardProfile);

//# sourceMappingURL=mgt-person-card-profile.js.map

/***/ }),

/***/ "gaiY":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/WindowUtils.js ***!
  \**************************************************************************************************/
/*! exports provided: WindowUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WindowUtils", function() { return WindowUtils; });
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../error/ClientAuthError */ "n82g");
/* harmony import */ var _UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UrlUtils */ "j0B3");
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Constants */ "/pXG");
/* harmony import */ var _TimeUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TimeUtils */ "JUi9");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var WindowUtils = /** @class */ (function () {
    function WindowUtils() {
    }
    /**
     * @hidden
     * Checks if the current page is running in an iframe.
     * @ignore
     */
    WindowUtils.isInIframe = function () {
        return window.parent !== window;
    };
    /**
     * @hidden
     * Check if the current page is running in a popup.
     * @ignore
     */
    WindowUtils.isInPopup = function () {
        return !!(window.opener && window.opener !== window);
    };
    /**
     * @hidden
     * @param prefix
     * @param scopes
     * @param authority
     */
    WindowUtils.generateFrameName = function (prefix, requestSignature) {
        return "" + prefix + _Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].resourceDelimiter + requestSignature;
    };
    /**
     * @hidden
     * Polls an iframe until it loads a url with a hash
     * @ignore
     */
    WindowUtils.monitorIframeForHash = function (contentWindow, timeout, urlNavigate, logger) {
        return new Promise(function (resolve, reject) {
            /*
             * Polling for iframes can be purely timing based,
             * since we don't need to account for interaction.
             */
            var nowMark = _TimeUtils__WEBPACK_IMPORTED_MODULE_3__["TimeUtils"].relativeNowMs();
            var timeoutMark = nowMark + timeout;
            logger.verbose("monitorWindowForIframe polling started");
            var intervalId = setInterval(function () {
                if (_TimeUtils__WEBPACK_IMPORTED_MODULE_3__["TimeUtils"].relativeNowMs() > timeoutMark) {
                    logger.error("monitorIframeForHash unable to find hash in url, timing out");
                    logger.errorPii("monitorIframeForHash polling timed out for url: " + urlNavigate);
                    clearInterval(intervalId);
                    reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createTokenRenewalTimeoutError());
                    return;
                }
                var href;
                try {
                    /*
                     * Will throw if cross origin,
                     * which should be caught and ignored
                     * since we need the interval to keep running while on STS UI.
                     */
                    href = contentWindow.location.href;
                }
                catch (e) { }
                if (href && _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(href)) {
                    logger.verbose("monitorIframeForHash found url in hash");
                    clearInterval(intervalId);
                    resolve(contentWindow.location.hash);
                }
            }, WindowUtils.POLLING_INTERVAL_MS);
        });
    };
    /**
     * @hidden
     * Polls a popup until it loads a url with a hash
     * @ignore
     */
    WindowUtils.monitorPopupForHash = function (contentWindow, timeout, urlNavigate, logger) {
        return new Promise(function (resolve, reject) {
            /*
             * Polling for popups needs to be tick-based,
             * since a non-trivial amount of time can be spent on interaction (which should not count against the timeout).
             */
            var maxTicks = timeout / WindowUtils.POLLING_INTERVAL_MS;
            var ticks = 0;
            logger.verbose("monitorWindowForHash polling started");
            var intervalId = setInterval(function () {
                if (contentWindow.closed) {
                    logger.error("monitorWindowForHash window closed");
                    clearInterval(intervalId);
                    reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createUserCancelledError());
                    return;
                }
                var href;
                try {
                    /*
                     * Will throw if cross origin,
                     * which should be caught and ignored
                     * since we need the interval to keep running while on STS UI.
                     */
                    href = contentWindow.location.href;
                }
                catch (e) { }
                // Don't process blank pages or cross domain
                if (!href || href === "about:blank") {
                    return;
                }
                /*
                 * Only run clock when we are on same domain for popups
                 * as popup operations can take a long time.
                 */
                ticks++;
                if (href && _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(href)) {
                    logger.verbose("monitorPopupForHash found url in hash");
                    clearInterval(intervalId);
                    resolve(contentWindow.location.hash);
                }
                else if (ticks > maxTicks) {
                    logger.error("monitorPopupForHash unable to find hash in url, timing out");
                    logger.errorPii("monitorPopupForHash polling timed out for url: " + urlNavigate);
                    clearInterval(intervalId);
                    reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createTokenRenewalTimeoutError());
                }
            }, WindowUtils.POLLING_INTERVAL_MS);
        });
    };
    /**
     * @hidden
     * Loads iframe with authorization endpoint URL
     * @ignore
     */
    WindowUtils.loadFrame = function (urlNavigate, frameName, timeoutMs, logger) {
        var _this = this;
        /*
         * This trick overcomes iframe navigation in IE
         * IE does not load the page consistently in iframe
         */
        logger.infoPii("LoadFrame: " + frameName);
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                var frameHandle = _this.loadFrameSync(urlNavigate, frameName, logger);
                if (!frameHandle) {
                    reject("Unable to load iframe with name: " + frameName);
                    return;
                }
                resolve(frameHandle);
            }, timeoutMs);
        });
    };
    /**
     * @hidden
     * Loads the iframe synchronously when the navigateTimeFrame is set to `0`
     * @param urlNavigate
     * @param frameName
     * @param logger
     */
    WindowUtils.loadFrameSync = function (urlNavigate, frameName, logger) {
        var frameHandle = WindowUtils.addHiddenIFrame(frameName, logger);
        // returning to handle null in loadFrame, also to avoid null object access errors
        if (!frameHandle) {
            return null;
        }
        else if (frameHandle.src === "" || frameHandle.src === "about:blank") {
            frameHandle.src = urlNavigate;
            logger.infoPii("Frame Name : " + frameName + " Navigated to: " + urlNavigate);
        }
        return frameHandle;
    };
    /**
     * @hidden
     * Adds the hidden iframe for silent token renewal.
     * @ignore
     */
    WindowUtils.addHiddenIFrame = function (iframeId, logger) {
        if (typeof iframeId === "undefined") {
            return null;
        }
        logger.infoPii("Add msal frame to document:" + iframeId);
        var adalFrame = document.getElementById(iframeId);
        if (!adalFrame) {
            if (document.createElement &&
                document.documentElement &&
                (window.navigator.userAgent.indexOf("MSIE 5.0") === -1)) {
                var ifr = document.createElement("iframe");
                ifr.setAttribute("id", iframeId);
                ifr.setAttribute("aria-hidden", "true");
                ifr.style.visibility = "hidden";
                ifr.style.position = "absolute";
                ifr.style.width = ifr.style.height = "0";
                ifr.style.border = "0";
                ifr.setAttribute("sandbox", "allow-scripts allow-same-origin allow-forms");
                adalFrame = document.getElementsByTagName("body")[0].appendChild(ifr);
            }
            else if (document.body && document.body.insertAdjacentHTML) {
                document.body.insertAdjacentHTML("beforeend", "<iframe name='" + iframeId + "' id='" + iframeId + "' style='display:none'></iframe>");
            }
            if (window.frames && window.frames[iframeId]) {
                adalFrame = window.frames[iframeId];
            }
        }
        return adalFrame;
    };
    /**
     * @hidden
     * Removes a hidden iframe from the page.
     * @ignore
     */
    WindowUtils.removeHiddenIframe = function (iframe) {
        if (document.body === iframe.parentNode) {
            document.body.removeChild(iframe);
        }
    };
    /**
     * @hidden
     * Find and return the iframe element with the given hash
     * @ignore
     */
    WindowUtils.getIframeWithHash = function (hash) {
        var iframes = document.getElementsByTagName("iframe");
        var iframeArray = Array.apply(null, Array(iframes.length)).map(function (iframe, index) { return iframes.item(index); }); // eslint-disable-line prefer-spread
        return iframeArray.filter(function (iframe) {
            try {
                return iframe.contentWindow.location.hash === hash;
            }
            catch (e) {
                return false;
            }
        })[0];
    };
    /**
     * @hidden
     * Returns an array of all the popups opened by MSAL
     * @ignore
     */
    WindowUtils.getPopups = function () {
        if (!window.openedWindows) {
            window.openedWindows = [];
        }
        return window.openedWindows;
    };
    /**
     * @hidden
     * Find and return the popup with the given hash
     * @ignore
     */
    WindowUtils.getPopUpWithHash = function (hash) {
        return WindowUtils.getPopups().filter(function (popup) {
            try {
                return popup.location.hash === hash;
            }
            catch (e) {
                return false;
            }
        })[0];
    };
    /**
     * @hidden
     * Add the popup to the known list of popups
     * @ignore
     */
    WindowUtils.trackPopup = function (popup) {
        WindowUtils.getPopups().push(popup);
    };
    /**
     * @hidden
     * Close all popups
     * @ignore
     */
    WindowUtils.closePopups = function () {
        WindowUtils.getPopups().forEach(function (popup) { return popup.close(); });
    };
    /**
     * @ignore
     *
     * blocks any login/acquireToken calls to reload from within a hidden iframe (generated for silent calls)
     */
    WindowUtils.blockReloadInHiddenIframes = function () {
        // return an error if called from the hidden iframe created by the msal js silent calls
        if (_UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(window.location.hash) && WindowUtils.isInIframe()) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createBlockTokenRequestsInHiddenIframeError();
        }
    };
    /**
     *
     * @param cacheStorage
     */
    WindowUtils.checkIfBackButtonIsPressed = function (cacheStorage) {
        var redirectCache = cacheStorage.getItem(_Constants__WEBPACK_IMPORTED_MODULE_2__["TemporaryCacheKeys"].REDIRECT_REQUEST);
        // if redirect request is set and there is no hash
        if (redirectCache && !_UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(window.location.hash)) {
            var splitCache = redirectCache.split(_Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].resourceDelimiter);
            splitCache.shift();
            var state = splitCache.length > 0 ? splitCache.join(_Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].resourceDelimiter) : null;
            cacheStorage.resetTempCacheItems(state);
        }
    };
    /**
     * Removes url fragment from browser url
     */
    WindowUtils.clearUrlFragment = function () {
        // Office.js sets history.replaceState to null
        if (typeof history.replaceState === "function") {
            // Full removes "#" from url
            history.replaceState(null, null, "" + window.location.pathname + window.location.search);
        }
        else {
            window.location.hash = "";
        }
    };
    /**
     * @hidden
     * Interval in milliseconds that we poll a window
     * @ignore
     */
    WindowUtils.POLLING_INTERVAL_MS = 50;
    return WindowUtils;
}());

//# sourceMappingURL=WindowUtils.js.map

/***/ }),

/***/ "h1MS":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/tasks/OneDriveLargeFileUploadTask.js ***!
  \****************************************************************************************************************************************/
/*! exports provided: OneDriveLargeFileUploadTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OneDriveLargeFileUploadTask", function() { return OneDriveLargeFileUploadTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _LargeFileUploadTask__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./LargeFileUploadTask */ "E94R");
/* harmony import */ var _OneDriveLargeFileUploadTaskUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OneDriveLargeFileUploadTaskUtil */ "/JyI");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */



/**
 * @class
 * Class representing OneDriveLargeFileUploadTask
 */
class OneDriveLargeFileUploadTask extends _LargeFileUploadTask__WEBPACK_IMPORTED_MODULE_1__["LargeFileUploadTask"] {
    /**
     * @public
     * @constructor
     * Constructs a OneDriveLargeFileUploadTask
     * @param {Client} client - The GraphClient instance
     * @param {FileObject} file - The FileObject holding details of a file that needs to be uploaded
     * @param {LargeFileUploadSession} uploadSession - The upload session to which the upload has to be done
     * @param {LargeFileUploadTaskOptions} options - The upload task options
     * @returns An instance of OneDriveLargeFileUploadTask
     */
    constructor(client, file, uploadSession, options) {
        super(client, file, uploadSession, options);
    }
    /**
     * @private
     * @static
     * Constructs the create session url for Onedrive
     * @param {string} fileName - The name of the file
     * @param {path} [path = OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH] - The path for the upload
     * @returns The constructed create session url
     */
    static constructCreateSessionUrl(fileName, path = OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH) {
        fileName = fileName.trim();
        path = path.trim();
        if (path === "") {
            path = "/";
        }
        if (path[0] !== "/") {
            path = `/${path}`;
        }
        if (path[path.length - 1] !== "/") {
            path = `${path}/`;
        }
        // we choose to encode each component of the file path separately because when encoding full URI
        // with encodeURI, special characters like # or % in the file name doesn't get encoded as desired
        return `/me/drive/root:${path
            .split("/")
            .map((p) => encodeURIComponent(p))
            .join("/")}${encodeURIComponent(fileName)}:/createUploadSession`;
    }
    /**
     * @public
     * @static
     * @async
     * Creates a OneDriveLargeFileUploadTask
     * @param {Client} client - The GraphClient instance
     * @param {Blob | Buffer | File} file - File represented as Blob, Buffer or File
     * @param {OneDriveLargeFileUploadOptions} options - The options for upload task
     * @returns The promise that will be resolves to OneDriveLargeFileUploadTask instance
     */
    static create(client, file, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const name = options.fileName;
            let content;
            let size;
            if (typeof Blob !== "undefined" && file instanceof Blob) {
                content = new File([file], name);
                size = content.size;
            }
            else if (typeof File !== "undefined" && file instanceof File) {
                content = file;
                size = content.size;
            }
            else if (typeof Buffer !== "undefined" && file instanceof Buffer) {
                const b = file;
                size = b.byteLength - b.byteOffset;
                content = b.buffer.slice(b.byteOffset, b.byteOffset + b.byteLength);
            }
            try {
                const requestUrl = OneDriveLargeFileUploadTask.constructCreateSessionUrl(options.fileName, options.path);
                const session = yield OneDriveLargeFileUploadTask.createUploadSession(client, requestUrl, options.fileName);
                const rangeSize = Object(_OneDriveLargeFileUploadTaskUtil__WEBPACK_IMPORTED_MODULE_2__["getValidRangeSize"])(options.rangeSize);
                const fileObj = {
                    name,
                    content,
                    size,
                };
                return new OneDriveLargeFileUploadTask(client, fileObj, session, {
                    rangeSize,
                });
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * @static
     * @async
     * Makes request to the server to create an upload session
     * @param {Client} client - The GraphClient instance
     * @param {string} requestUrl - The URL to create the upload session
     * @param {string} fileName - The name of a file to upload, (with extension)
     * @returns The promise that resolves to LargeFileUploadSession
     */
    static createUploadSession(client, requestUrl, fileName) {
        const _super = Object.create(null, {
            createUploadSession: { get: () => super.createUploadSession }
        });
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const payload = {
                item: {
                    "@microsoft.graph.conflictBehavior": "rename",
                    name: fileName,
                },
            };
            try {
                return _super.createUploadSession.call(this, client, requestUrl, payload);
            }
            catch (err) {
                throw err;
            }
        });
    }
    /**
     * @public
     * Commits upload session to end uploading
     * @param {string} requestUrl - The URL to commit the upload session
     * @returns The promise resolves to committed response
     */
    commit(requestUrl) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const payload = {
                    name: this.file.name,
                    "@microsoft.graph.conflictBehavior": "rename",
                    "@microsoft.graph.sourceUrl": this.uploadSession.url,
                };
                return yield this.client.api(requestUrl).put(payload);
            }
            catch (err) {
                throw err;
            }
        });
    }
}
/**
 * @private
 * @static
 * Default path for the file being uploaded
 */
OneDriveLargeFileUploadTask.DEFAULT_UPLOAD_PATH = "/";
//# sourceMappingURL=OneDriveLargeFileUploadTask.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../../../../buffer/index.js */ "tjlA").Buffer))

/***/ }),

/***/ "h8e6":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/HTTPClient.js ***!
  \*****************************************************************************************************************/
/*! exports provided: HTTPClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTPClient", function() { return HTTPClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @class
 * Class representing HTTPClient
 */
class HTTPClient {
    /**
     * @public
     * @constructor
     * Creates an instance of a HTTPClient
     * @param {...Middleware} middleware - The first middleware of the middleware chain or a sequence of all the Middleware handlers
     */
    constructor(...middleware) {
        if (!middleware || !middleware.length) {
            const error = new Error();
            error.name = "InvalidMiddlewareChain";
            error.message = "Please provide a default middleware chain or custom middleware chain";
            throw error;
        }
        this.setMiddleware(...middleware);
    }
    /**
     * @private
     * Processes the middleware parameter passed to set this.middleware property
     * The calling function should validate if middleware is not undefined or not empty.
     * @param {...Middleware} middleware - The middleware passed
     * @returns Nothing
     */
    setMiddleware(...middleware) {
        if (middleware.length > 1) {
            this.parseMiddleWareArray(middleware);
        }
        else {
            this.middleware = middleware[0];
        }
    }
    /**
     * @private
     * Processes the middleware array to construct the chain
     * and sets this.middleware property to the first middlware handler of the array
     * The calling function should validate if middleware is not undefined or not empty
     * @param {Middleware[]} middlewareArray - The array of middleware handlers
     * @returns Nothing
     */
    parseMiddleWareArray(middlewareArray) {
        middlewareArray.forEach((element, index) => {
            if (index < middlewareArray.length - 1) {
                element.setNext(middlewareArray[index + 1]);
            }
        });
        this.middleware = middlewareArray[0];
    }
    /**
     * @public
     * @async
     * To send the request through the middleware chain
     * @param {Context} context - The context of a request
     * @returns A promise that resolves to the Context
     */
    sendRequest(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                if (typeof context.request === "string" && context.options === undefined) {
                    const error = new Error();
                    error.name = "InvalidRequestOptions";
                    error.message = "Unable to execute the middleware, Please provide valid options for a request";
                    throw error;
                }
                yield this.middleware.execute(context);
                return context;
            }
            catch (error) {
                throw error;
            }
        });
    }
}
//# sourceMappingURL=HTTPClient.js.map

/***/ }),

/***/ "h916":
/*!******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/TimeUtils.js ***!
  \******************************************************************************************/
/*! exports provided: TimeUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TimeUtils", function() { return TimeUtils; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var TimeUtils = /** @class */ (function () {
    function TimeUtils() {
    }
    /**
     * Returns time in seconds for expiration based on string value passed in.
     *
     * @param expiresIn
     */
    TimeUtils.parseExpiresIn = function (expiresIn) {
        // if AAD did not send "expires_in" property, use default expiration of 3599 seconds, for some reason AAD sends 3599 as "expires_in" value instead of 3600
        if (!expiresIn) {
            expiresIn = "3599";
        }
        return parseInt(expiresIn, 10);
    };
    /**
     * Return the current time in Unix time (seconds). Date.getTime() returns in milliseconds.
     */
    TimeUtils.now = function () {
        return Math.round(new Date().getTime() / 1000.0);
    };
    /**
     * Returns the amount of time in milliseconds since the page loaded.
     */
    TimeUtils.relativeNowMs = function () {
        return window.performance.now();
    };
    return TimeUtils;
}());

//# sourceMappingURL=TimeUtils.js.map

/***/ }),

/***/ "hBCo":
/*!**********************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-proxy-provider/dist/es6/index.js ***!
  \**********************************************************************/
/*! exports provided: ProxyProvider, MgtProxyProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _ProxyProvider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ProxyProvider */ "M4Ox");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ProxyProvider", function() { return _ProxyProvider__WEBPACK_IMPORTED_MODULE_0__["ProxyProvider"]; });

/* harmony import */ var _mgt_proxy_provider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mgt-proxy-provider */ "AUyD");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtProxyProvider", function() { return _mgt_proxy_provider__WEBPACK_IMPORTED_MODULE_1__["MgtProxyProvider"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


//# sourceMappingURL=index.js.map

/***/ }),

/***/ "hT1+":
/*!**********************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-organization/mgt-person-card-organization.js ***!
  \**********************************************************************************************************************************************************/
/*! exports provided: MgtPersonCardOrganization */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtPersonCardOrganization", function() { return MgtPersonCardOrganization; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../BasePersonCardSection */ "8z1x");
/* harmony import */ var _utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/SvgHelper */ "FPR2");
/* harmony import */ var _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../mgt-person/mgt-person */ "lBzc");
/* harmony import */ var _mgt_person_card_organization_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mgt-person-card-organization-css */ "FTWT");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./strings */ "lPjk");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






/**
 * The member organization subsection of the person card
 *
 * @export
 * @class MgtPersonCardProfile
 * @extends {MgtTemplatedComponent}
 */
let MgtPersonCardOrganization = class MgtPersonCardOrganization extends _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_1__["BasePersonCardSection"] {
    constructor(state, me) {
        super();
        this._state = state;
        this._me = me;
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_person_card_organization_css__WEBPACK_IMPORTED_MODULE_4__["styles"];
    }
    /**
     * returns component strings
     *
     * @readonly
     * @protected
     * @memberof MgtBaseComponent
     */
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_5__["strings"];
    }
    /**
     * The name for display in the overview section.
     *
     * @readonly
     * @type {string}
     * @memberof MgtPersonCardOrganization
     */
    get displayName() {
        const { person, directReports } = this._state;
        if (!person.manager && directReports && directReports.length) {
            return `${this.strings.directReportsSectionTitle} (${directReports.length})`;
        }
        return this.strings.reportsToSectionTitle;
    }
    /**
     * Render the icon for display in the navigation ribbon.
     *
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderIcon() {
        return Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["SvgIcon"].Organization);
    }
    /**
     * Render the compact view
     *
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderCompactView() {
        let contentTemplate;
        if (!this._state || !this._state.person) {
            return null;
        }
        const { person, directReports } = this._state;
        if (!person) {
            return null;
        }
        else if (person.manager) {
            contentTemplate = this.renderCoworker(person.manager);
        }
        else if (directReports && directReports.length) {
            contentTemplate = this.renderCompactDirectReports();
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root compact">
        ${contentTemplate}
      </div>
    `;
    }
    /**
     * Render the full view
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderFullView() {
        let contentTemplate;
        if (!this._state || !this._state.person) {
            return null;
        }
        const { person, directReports, people } = this._state;
        if (!person && !directReports && !people) {
            return null;
        }
        else {
            const managerTemplates = this.renderManagers();
            const currentUserTemplate = this.renderCurrentUser();
            const directReportsTemplate = this.renderDirectReports();
            const coworkersTemplate = this.renderCoworkers();
            contentTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        ${managerTemplates} ${currentUserTemplate} ${directReportsTemplate} ${coworkersTemplate}
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.organizationSectionTitle}</div>
        ${contentTemplate}
      </div>
    `;
    }
    /**
     * Render a manager org member
     *
     * @protected
     * @param {User} person
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderManager(person) {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="org-member" @click=${() => this.navigateCard(person)}>
        <div class="org-member__person">
          <mgt-person
            .personDetails=${person}
            .line2Property=${'jobTitle'}
            .line3Property=${'department'}
            .fetchImage=${true}
            .view=${_mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_3__["PersonViewType"].threelines}
          ></mgt-person>
        </div>
        <div class="org-member__more">
          ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["SvgIcon"].ExpandRight)}
        </div>
      </div>
      <div class="org-member__separator"></div>
    `;
    }
    /**
     * Render a manager org member
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderManagers() {
        const { person } = this._state;
        if (!person || !person.manager) {
            return null;
        }
        const managers = [];
        let currentManager = person;
        while (currentManager.manager) {
            managers.push(currentManager.manager);
            currentManager = currentManager.manager;
        }
        if (!managers.length) {
            return null;
        }
        return managers.reverse().map(manager => this.renderManager(manager));
    }
    /**
     * Render a direct report
     *
     * @protected
     * @param {User} person
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderDirectReports() {
        const { directReports } = this._state;
        if (!directReports || !directReports.length) {
            return null;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="org-member__separator"></div>
      <div>
        ${directReports.map(person => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="org-member org-member--direct-report" @click=${() => this.navigateCard(person)}>
              <div class="org-member__person">
                <mgt-person
                  .personDetails=${person}
                  .line2Property=${'jobTitle'}
                  .line3Property=${'department'}
                  .fetchImage=${true}
                  .view=${_mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_3__["PersonViewType"].twolines}
                ></mgt-person>
              </div>
              <div class="org-member__more">
                ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_2__["SvgIcon"].ExpandRight)}
              </div>
            </div>
          `)}
      </div>
    `;
    }
    /**
     * Render direct reports in compact view
     *
     * @protected
     * @param {User} person
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderCompactDirectReports() {
        const { directReports } = this._state;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="direct-report__compact">
        ${directReports.slice(0, 6).map(person => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="direct-report" @click=${() => this.navigateCard(person)}>
              <mgt-person .personDetails=${person} .fetchImage=${true}></mgt-person>
            </div>
          `)}
      </div>
    `;
    }
    /**
     * Render the user/self member
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderCurrentUser() {
        const { person } = this._state;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="org-member org-member--target">
        <div class="org-member__person">
          <mgt-person
            .personDetails=${person}
            .line2Property=${'jobTitle'}
            .line3Property=${'department'}
            .fetchImage=${true}
            .view=${_mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_3__["PersonViewType"].threelines}
          ></mgt-person>
        </div>
      </div>
    `;
    }
    /**
     * Render a coworker org member
     *
     * @protected
     * @param {User} person
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderCoworker(person) {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="coworker" @click=${() => this.navigateCard(person)}>
        <div class="coworker__person">
          <mgt-person
            .personDetails=${person}
            .line2Property=${'jobTitle'}
            .fetchImage=${true}
            .view=${_mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_3__["PersonViewType"].twolines}
          ></mgt-person>
        </div>
      </div>
    `;
    }
    /**
     * Render a coworker org member
     *
     * @protected
     * @param {User} person
     * @returns {TemplateResult}
     * @memberof MgtPersonCardOrganization
     */
    renderCoworkers() {
        const { people } = this._state;
        if (!people || !people.length) {
            return null;
        }
        const subtitle = this._me.id === this._state.person.id
            ? this.strings.youWorkWithSubSectionTitle
            : `${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="divider"></div>
      <div class="subtitle">${subtitle}</div>
      <div>
        ${people.slice(0, 6).map(person => this.renderCoworker(person))}
      </div>
    `;
    }
};
MgtPersonCardOrganization = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-person-card-organization'),
    __metadata("design:paramtypes", [Object, Object])
], MgtPersonCardOrganization);

//# sourceMappingURL=mgt-person-card-organization.js.map

/***/ }),

/***/ "iCud":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/ValidatePolyFilling.js ***!
  \**************************************************************************************************************************/
/*! exports provided: validatePolyFilling */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "validatePolyFilling", function() { return validatePolyFilling; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @constant
 * @function
 * Validates availability of Promise and fetch in global context
 * @returns The true in case the Promise and fetch available, otherwise throws error
 */
const validatePolyFilling = () => {
    if (typeof Promise === "undefined" && typeof fetch === "undefined") {
        const error = new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");
        error.name = "PolyFillNotAvailable";
        throw error;
    }
    else if (typeof Promise === "undefined") {
        const error = new Error("Library cannot function without Promise. So, please provide polyfill for it.");
        error.name = "PolyFillNotAvailable";
        throw error;
    }
    else if (typeof fetch === "undefined") {
        const error = new Error("Library cannot function without fetch. So, please provide polyfill for it.");
        error.name = "PolyFillNotAvailable";
        throw error;
    }
    return true;
};
//# sourceMappingURL=ValidatePolyFilling.js.map

/***/ }),

/***/ "iNiz":
/*!****************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-sharepoint-provider/dist/es6/SharePointProvider.js ***!
  \****************************************************************************************/
/*! exports provided: SharePointProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SharePointProvider", function() { return SharePointProvider; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

/**
 * SharePoint Provider handler
 *
 * @export
 * @class SharePointProvider
 * @extends {IProvider}
 */
class SharePointProvider extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["IProvider"] {
    constructor(context) {
        super();
        context.aadTokenProviderFactory.getTokenProvider().then((tokenProvider) => {
            this._provider = tokenProvider;
            this.graph = Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["createFromProvider"])(this);
            this.internalLogin();
        });
    }
    /**
     * returns _provider
     *
     * @readonly
     * @memberof SharePointProvider
     */
    get provider() {
        return this._provider;
    }
    /**
     * returns _idToken
     *
     * @readonly
     * @type {boolean}
     * @memberof SharePointProvider
     */
    get isLoggedIn() {
        return !!this._idToken;
    }
    /**
     * uses provider to receive access token via SharePoint Provider
     *
     * @returns {Promise<string>}
     * @memberof SharePointProvider
     */
    getAccessToken() {
        return __awaiter(this, void 0, void 0, function* () {
            let accessToken;
            try {
                accessToken = yield this.provider.getToken('https://graph.microsoft.com');
            }
            catch (e) {
                throw e;
            }
            return accessToken;
        });
    }
    /**
     * update scopes
     *
     * @param {string[]} scopes
     * @memberof SharePointProvider
     */
    updateScopes(scopes) {
        this.scopes = scopes;
    }
    internalLogin() {
        return __awaiter(this, void 0, void 0, function* () {
            this._idToken = yield this.getAccessToken();
            this.setState(this._idToken ? _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedIn : _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["ProviderState"].SignedOut);
        });
    }
}
//# sourceMappingURL=SharePointProvider.js.map

/***/ }),

/***/ "iQg6":
/*!*****************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/styles/theme-css.js ***!
  \*****************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--dropdown-item-selected-background:#deecf9;--arrow-fill:#000000}.mgt-dark{--dropdown-item-selected-background:#333d47;--arrow-fill:#605e5c}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--button-color:#323130;--popup-color:#323130}.mgt-dark{--button-color:#f3f2f1;--popup-color:#f3f2f1}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--person-card-details-item-color:#201f1e}.mgt-dark{--person-card-details-item-color:#faf9f8}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--task-border:2px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:2px solid #797775;--task-complete-border:2px dotted #797775;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}
`
];
//# sourceMappingURL=theme-css.js.map

/***/ }),

/***/ "iVPg":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-people/mgt-people.js ***!
  \*********************************************************************************************/
/*! exports provided: PersonCardInteraction, MgtPeople */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtPeople", function() { return MgtPeople; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_repeat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/repeat */ "2Fb8");
/* harmony import */ var _graph_graph_people__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../graph/graph.people */ "r/Dn");
/* harmony import */ var _graph_graph_presence__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../graph/graph.presence */ "tpmt");
/* harmony import */ var _graph_graph_user__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../graph/graph.user */ "0Vrk");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _styles_style_helper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../styles/style-helper */ "XyBC");
/* harmony import */ var _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./../PersonCardInteraction */ "Y6V/");
/* harmony import */ var _mgt_people_css__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./mgt-people-css */ "dUYm");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PersonCardInteraction", function() { return _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_7__["PersonCardInteraction"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};










/**
 * web component to display a group of people or contacts by using their photos or initials.
 *
 * @export
 * @class MgtPeople
 * @extends {MgtTemplatedComponent}
 *
 * @cssprop --list-margin - {String} List margin for component
 * @cssprop --avatar-margin - {String} Margin for each person
 */
let MgtPeople = class MgtPeople extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_5__["MgtTemplatedComponent"] {
    constructor() {
        super();
        /**
         * Sets how the person-card is invoked
         * Set to PersonCardInteraction.none to not show the card
         *
         * @type {PersonCardInteraction}
         * @memberof MgtPerson
         */
        this.personCardInteraction = _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_7__["PersonCardInteraction"].hover;
        this.showMax = 3;
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_people_css__WEBPACK_IMPORTED_MODULE_8__["styles"];
    }
    /**
     * determines if agenda events come from specific group
     * @type {string}
     */
    get groupId() {
        return this._groupId;
    }
    set groupId(value) {
        if (this._groupId === value) {
            return;
        }
        this._groupId = value;
        this.requestStateUpdate(true);
    }
    /**
     * user id array
     *
     * @memberof MgtPeople
     */
    get userIds() {
        return this._userIds;
    }
    set userIds(value) {
        if (Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_5__["arraysAreEqual"])(this._userIds, value)) {
            return;
        }
        this._userIds = value;
        this.requestStateUpdate(true);
    }
    /**
     * allows developer to define queries of people for component
     * @type {string[]}
     */
    get peopleQueries() {
        return this._peopleQueries;
    }
    set peopleQueries(value) {
        if (Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_5__["arraysAreEqual"])(this._peopleQueries, value)) {
            return;
        }
        this._peopleQueries = value;
        this.requestStateUpdate(true);
    }
    /**
     * Request to reload the state.
     * Use reload instead of load to ensure loading events are fired.
     *
     * @protected
     * @memberof MgtBaseComponent
     */
    requestStateUpdate(force) {
        if (force) {
            this.people = null;
        }
        return super.requestStateUpdate(force);
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        if (this.isLoadingState) {
            return this.renderLoading();
        }
        if (!this.people || this.people.length === 0) {
            return this.renderNoData();
        }
        return this.renderTemplate('default', { people: this.people, max: this.showMax }) || this.renderPeople();
    }
    /**
     * Render the loading state.
     *
     * @protected
     * @returns
     * @memberof MgtPeople
     */
    renderLoading() {
        return this.renderTemplate('loading', null) || lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
    }
    /**
     * Render the list of people.
     *
     * @protected
     * @param {*} people
     * @returns {TemplateResult}
     * @memberof MgtPeople
     */
    renderPeople() {
        const maxPeople = this.people.slice(0, this.showMax);
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <ul class="people-list">
        ${Object(lit_html_directives_repeat__WEBPACK_IMPORTED_MODULE_1__["repeat"])(maxPeople, p => p.id, p => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <li class="people-person">
              ${this.renderPerson(p)}
            </li>
          `)}
        ${this.people.length > this.showMax ? this.renderOverflow() : null}
      </ul>
    `;
    }
    /**
     * Render the overflow content to represent any extra people, beyond the max.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPeople
     */
    renderOverflow() {
        const extra = this.people.length - this.showMax;
        return (this.renderTemplate('overflow', {
            extra,
            max: this.showMax,
            people: this.people
        }) ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <li class="overflow"><span>+${extra}<span></li>
      `);
    }
    /**
     * Render an individual person.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPeople
     */
    renderPerson(person) {
        let personPresence = {
            // set up default presence
            activity: 'Offline',
            availability: 'Offline',
            id: null
        };
        if (this.showPresence && this._peoplePresence) {
            personPresence = this._peoplePresence[person.id];
        }
        const avatarSize = 'small';
        return (this.renderTemplate('person', { person }, person.id) ||
            // set image to @ to flag the mgt-person component to
            // query the image from the graph
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <mgt-person
          .personDetails=${person}
          .fetchImage=${true}
          .avatarSize=${avatarSize}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${personPresence}
        ></mgt-person>
      `);
    }
    /**
     * render the no data state.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPeople
     */
    renderNoData() {
        return this.renderTemplate('no-data', null) || lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
    }
    /**
     * load state into the component.
     *
     * @protected
     * @returns
     * @memberof MgtPeople
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.people) {
                const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_5__["Providers"].globalProvider;
                if (provider && provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_5__["ProviderState"].SignedIn) {
                    const graph = provider.graph.forComponent(this);
                    // populate people
                    if (this.groupId) {
                        this.people = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_4__["findGroupMembers"])(graph, null, this.groupId, this.showMax, _graph_graph_people__WEBPACK_IMPORTED_MODULE_2__["PersonType"].person);
                    }
                    else if (this.userIds) {
                        this.people = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_4__["getUsersForUserIds"])(graph, this.userIds);
                    }
                    else if (this.peopleQueries) {
                        this.people = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_4__["getUsersForPeopleQueries"])(graph, this.peopleQueries);
                    }
                    else {
                        this.people = yield Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_2__["getPeople"])(graph);
                    }
                    // populate presence for people
                    if (this.showPresence) {
                        this._peoplePresence = yield Object(_graph_graph_presence__WEBPACK_IMPORTED_MODULE_3__["getUsersPresenceByPeople"])(graph, this.people);
                    }
                    else {
                        this._peoplePresence = null;
                    }
                }
            }
        });
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'group-id',
        type: String
    }),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [Object])
], MgtPeople.prototype, "groupId", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'user-ids',
        converter: (value, type) => {
            return value.split(',').map(v => v.trim());
        }
    }),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], MgtPeople.prototype, "userIds", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'people',
        type: Object
    }),
    __metadata("design:type", Array)
], MgtPeople.prototype, "people", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'people-queries',
        converter: (value, type) => {
            return value.split(',').map(v => v.trim());
        }
    }),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], MgtPeople.prototype, "peopleQueries", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'show-max',
        type: Number
    }),
    __metadata("design:type", Number)
], MgtPeople.prototype, "showMax", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'show-presence',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtPeople.prototype, "showPresence", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-card',
        converter: (value, type) => {
            value = value.toLowerCase();
            if (typeof _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_7__["PersonCardInteraction"][value] === 'undefined') {
                return _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_7__["PersonCardInteraction"].hover;
            }
            else {
                return _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_7__["PersonCardInteraction"][value];
            }
        }
    }),
    __metadata("design:type", Number)
], MgtPeople.prototype, "personCardInteraction", void 0);
MgtPeople = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-people'),
    __metadata("design:paramtypes", [])
], MgtPeople);

//# sourceMappingURL=mgt-people.js.map

/***/ }),

/***/ "j0B3":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/UrlUtils.js ***!
  \***********************************************************************************************/
/*! exports provided: UrlUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UrlUtils", function() { return UrlUtils; });
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Constants */ "/pXG");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ScopeSet */ "aX9C");
/* harmony import */ var _StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./StringUtils */ "k+Uk");
/* harmony import */ var _CryptoUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./CryptoUtils */ "RDZQ");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




/**
 * @hidden
 */
var UrlUtils = /** @class */ (function () {
    function UrlUtils() {
    }
    /**
     * generates the URL with QueryString Parameters
     * @param scopes
     */
    UrlUtils.createNavigateUrl = function (serverRequestParams) {
        var str = this.createNavigationUrlString(serverRequestParams);
        var authEndpoint = serverRequestParams.authorityInstance.AuthorizationEndpoint;
        // if the endpoint already has queryparams, lets add to it, otherwise add the first one
        if (authEndpoint.indexOf("?") < 0) {
            authEndpoint += "?";
        }
        else {
            authEndpoint += "&";
        }
        var requestUrl = "" + authEndpoint + str.join("&");
        return requestUrl;
    };
    /**
     * Generate the array of all QueryStringParams to be sent to the server
     * @param scopes
     */
    UrlUtils.createNavigationUrlString = function (serverRequestParams) {
        var scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_1__["ScopeSet"].appendDefaultScopes(serverRequestParams.scopes);
        var str = [];
        str.push("response_type=" + serverRequestParams.responseType);
        str.push("scope=" + encodeURIComponent(_ScopeSet__WEBPACK_IMPORTED_MODULE_1__["ScopeSet"].parseScope(scopes)));
        str.push("client_id=" + encodeURIComponent(serverRequestParams.clientId));
        str.push("redirect_uri=" + encodeURIComponent(serverRequestParams.redirectUri));
        str.push("state=" + encodeURIComponent(serverRequestParams.state));
        str.push("nonce=" + encodeURIComponent(serverRequestParams.nonce));
        str.push("client_info=1");
        str.push("x-client-SKU=" + serverRequestParams.xClientSku);
        str.push("x-client-Ver=" + serverRequestParams.xClientVer);
        if (serverRequestParams.promptValue) {
            str.push("prompt=" + encodeURIComponent(serverRequestParams.promptValue));
        }
        if (serverRequestParams.claimsValue) {
            str.push("claims=" + encodeURIComponent(serverRequestParams.claimsValue));
        }
        if (serverRequestParams.queryParameters) {
            str.push(serverRequestParams.queryParameters);
        }
        if (serverRequestParams.extraQueryParameters) {
            str.push(serverRequestParams.extraQueryParameters);
        }
        str.push("client-request-id=" + encodeURIComponent(serverRequestParams.correlationId));
        return str;
    };
    /**
     * Returns current window URL as redirect uri
     */
    UrlUtils.getCurrentUrl = function () {
        return window.location.href.split("?")[0].split("#")[0];
    };
    /**
     * Returns given URL with query string removed
     */
    UrlUtils.removeHashFromUrl = function (url) {
        return url.split("#")[0];
    };
    /**
     * Given a url like https://a:b/common/d?e=f#g, and a tenantId, returns https://a:b/tenantId/d
     * @param href The url
     * @param tenantId The tenant id to replace
     */
    UrlUtils.replaceTenantPath = function (url, tenantId) {
        var lowerCaseUrl = url.toLowerCase();
        var urlObject = this.GetUrlComponents(lowerCaseUrl);
        var pathArray = urlObject.PathSegments;
        if (tenantId && (pathArray.length !== 0 && (pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["Constants"].common || pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["SSOTypes"].ORGANIZATIONS))) {
            pathArray[0] = tenantId;
        }
        return this.constructAuthorityUriFromObject(urlObject, pathArray);
    };
    UrlUtils.constructAuthorityUriFromObject = function (urlObject, pathArray) {
        return this.CanonicalizeUri(urlObject.Protocol + "//" + urlObject.HostNameAndPort + "/" + pathArray.join("/"));
    };
    /**
     * Checks if an authority is common (ex. https://a:b/common/)
     * @param url The url
     * @returns true if authority is common and false otherwise
     */
    UrlUtils.isCommonAuthority = function (url) {
        var authority = this.CanonicalizeUri(url);
        var pathArray = this.GetUrlComponents(authority).PathSegments;
        return (pathArray.length !== 0 && pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["Constants"].common);
    };
    /**
     * Checks if an authority is for organizations (ex. https://a:b/organizations/)
     * @param url The url
     * @returns true if authority is for  and false otherwise
     */
    UrlUtils.isOrganizationsAuthority = function (url) {
        var authority = this.CanonicalizeUri(url);
        var pathArray = this.GetUrlComponents(authority).PathSegments;
        return (pathArray.length !== 0 && pathArray[0] === _Constants__WEBPACK_IMPORTED_MODULE_0__["SSOTypes"].ORGANIZATIONS);
    };
    /**
     * Parses out the components from a url string.
     * @returns An object with the various components. Please cache this value insted of calling this multiple times on the same url.
     */
    UrlUtils.GetUrlComponents = function (url) {
        if (!url) {
            throw "Url required";
        }
        // https://gist.github.com/curtisz/11139b2cfcaef4a261e0
        var regEx = RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");
        var match = url.match(regEx);
        if (!match || match.length < 6) {
            throw "Valid url required";
        }
        var urlComponents = {
            Protocol: match[1],
            HostNameAndPort: match[4],
            AbsolutePath: match[5]
        };
        var pathSegments = urlComponents.AbsolutePath.split("/");
        pathSegments = pathSegments.filter(function (val) { return val && val.length > 0; }); // remove empty elements
        urlComponents.PathSegments = pathSegments;
        if (match[6]) {
            urlComponents.Search = match[6];
        }
        if (match[8]) {
            urlComponents.Hash = match[8];
        }
        return urlComponents;
    };
    /**
     * Given a url or path, append a trailing slash if one doesnt exist
     *
     * @param url
     */
    UrlUtils.CanonicalizeUri = function (url) {
        if (url) {
            url = url.toLowerCase();
        }
        if (url && !UrlUtils.endsWith(url, "/")) {
            url += "/";
        }
        return url;
    };
    /**
     * Checks to see if the url ends with the suffix
     * Required because we are compiling for es5 instead of es6
     * @param url
     * @param str
     */
    // TODO: Rename this, not clear what it is supposed to do
    UrlUtils.endsWith = function (url, suffix) {
        if (!url || !suffix) {
            return false;
        }
        return url.indexOf(suffix, url.length - suffix.length) !== -1;
    };
    /**
     * Utils function to remove the login_hint and domain_hint from the i/p extraQueryParameters
     * @param url
     * @param name
     */
    UrlUtils.urlRemoveQueryStringParameter = function (url, name) {
        if (_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(url)) {
            return url;
        }
        var regex = new RegExp("(\\&" + name + "=)[^\&]+");
        url = url.replace(regex, "");
        // name=value&
        regex = new RegExp("(" + name + "=)[^\&]+&");
        url = url.replace(regex, "");
        // name=value
        regex = new RegExp("(" + name + "=)[^\&]+");
        url = url.replace(regex, "");
        return url;
    };
    /**
     * @hidden
     * @ignore
     *
     * Returns the anchor part(#) of the URL
     */
    UrlUtils.getHashFromUrl = function (urlStringOrFragment) {
        var hashIndex1 = urlStringOrFragment.indexOf("#");
        var hashIndex2 = urlStringOrFragment.indexOf("#/");
        if (hashIndex2 > -1) {
            return urlStringOrFragment.substring(hashIndex2 + 2);
        }
        else if (hashIndex1 > -1) {
            return urlStringOrFragment.substring(hashIndex1 + 1);
        }
        return urlStringOrFragment;
    };
    /**
     * @hidden
     * Check if the url contains a hash with known properties
     * @ignore
     */
    UrlUtils.urlContainsHash = function (urlString) {
        var parameters = UrlUtils.deserializeHash(urlString);
        return (parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ERROR_DESCRIPTION) ||
            parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ERROR) ||
            parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ACCESS_TOKEN) ||
            parameters.hasOwnProperty(_Constants__WEBPACK_IMPORTED_MODULE_0__["ServerHashParamKeys"].ID_TOKEN));
    };
    /**
     * @hidden
     * Returns deserialized portion of URL hash
     * @ignore
     */
    UrlUtils.deserializeHash = function (urlFragment) {
        var hash = UrlUtils.getHashFromUrl(urlFragment);
        return _CryptoUtils__WEBPACK_IMPORTED_MODULE_3__["CryptoUtils"].deserialize(hash);
    };
    /**
     * @ignore
     * @param {string} URI
     * @returns {string} host from the URI
     *
     * extract URI from the host
     */
    UrlUtils.getHostFromUri = function (uri) {
        // remove http:// or https:// from uri
        var extractedUri = String(uri).replace(/^(https?:)\/\//, "");
        extractedUri = extractedUri.split("/")[0];
        return extractedUri;
    };
    return UrlUtils;
}());

//# sourceMappingURL=UrlUtils.js.map

/***/ }),

/***/ "j1fA":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-people-picker/mgt-people-picker-css.js ***!
  \***************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--selected-person-background-color:#f3f2f1}.mgt-dark{--selected-person-background-color:#4f4f4f}:host{border-radius:2px;font-family:var(--default-font-family);height:38px;display:contents;height:100%;overflow:hidden}:host .root,mgt-people-picker .root{display:block}.people-picker{background-color:var(--input-background-color,#fff);border-top:var(--input-border-top,2px solid #605e5c);border-right:var(--input-border-right,2px solid #605e5c);border-bottom:var(--input-border-bottom,2px solid #605e5c);border-left:var(--input-border-left,2px solid #605e5c);border:var(--input-border,2px solid #605e5c);padding:6px 0 0}.people-picker:hover{border-color:var(--input-border-color--hover,#323130)}.people-picker.focused{border-color:var(--input-border-color--focus,#0078d4)}.people-picker .selected-list{flex:1 0 auto;display:flex;flex-wrap:wrap;vertical-align:middle;margin:0 8px;list-style-type:none;font-style:normal;font-weight:400;overflow:hidden}.people-picker .selected-list__person-wrapper{display:flex;margin:0 5px 6px 0;align-items:center;border-radius:15px;height:24px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;position:relative;background-color:var(--selected-person-background-color,#f3f2f1)}.people-picker .selected-list__person-wrapper__person{overflow:hidden;min-width:100%;--avatar-size-s:24px;margin-left:0;--color:var(--color-sub1, #323130);color:var(--color-sub1,#323130);padding-bottom:1px;padding-right:4px}.people-picker .selected-list__person-wrapper__overflow{margin-left:25px}.people-picker .selected-list__person-wrapper__overflow__gradient{content:'';position:absolute;margin-right:23px;width:10px;height:90%;top:0;right:0;background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-moz-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-o-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-ms-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%);background-image:-webkit-linear-gradient(left,rgba(255,255,255,0) 0,rgba(255,255,255,0) 60%,var(--selected-person-background-color,#f3f2f1) 100%)}.people-picker .selected-list__person-wrapper__overflow__close-icon{height:100%;top:0;margin-top:4px;margin-left:10px;position:absolute;line-height:normal;font-family:FabricMDL2Icons;padding-right:7px;cursor:pointer;right:0;background-color:var(--selected-person-background-color,#f3f2f1);color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .search-box{margin:1px 2px 8px}.people-picker .selected-list .flyout .search-box.search-box-start{line-height:normal;margin-inline-start:0;margin-inline-end:0}.people-picker .selected-list .flyout .search-box__input{box-sizing:border-box;border-width:0;border-style:none;width:100%;display:flex;flex:1 0 auto;font-family:var(--default-font-family);position:relative;line-height:normal;outline:0;font-style:normal;font-weight:400;font-size:14px;line-height:19px;background-color:var(--input-background-color,#fff);color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .search-box__input::placeholder{color:var(--placeholder-color,#605e5c)}.people-picker .selected-list .flyout .flyout-root{padding:0;border-radius:2px;min-width:260px;overflow-y:auto;text-align:left;list-style-type:none;background-color:var(--dropdown-background-color,var(--list-background-color,#fff))}.people-picker .selected-list .flyout .flyout-root li{cursor:pointer}.people-picker .selected-list .flyout .flyout-root .people-list .list-person{display:flex;flex-direction:row;align-items:center;padding:12px;font-style:normal;font-weight:600;font-size:14px}.people-picker .selected-list .flyout .flyout-root .people-list .list-person.focused,.people-picker .selected-list .flyout .flyout-root .people-list .list-person:hover{background-color:var(--dropdown-item-hover-background,var(--input-background-color--hover,#edebe9))}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area{margin-left:13px;flex:1 1 0;max-height:40px;overflow:hidden;color:var(--color-sub1,#323130)}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text{font-size:14px;font-weight:400;margin:0;padding:0}.people-picker .selected-list .flyout .flyout-root .people-list .list-person .people-person-text-area .people-person-text.highlight-search-text{font-weight:700}mgt-person{--avatar-size-s:32px;margin-left:12px;cursor:default}:host .loading-text,:host .search-error-text,mgt-people-picker .loading-text,mgt-people-picker .search-error-text{font-family:var(--default-font-family);font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;margin-left:50px;margin-right:50px;color:#0078d4}:host .message-parent,mgt-people-picker .message-parent{padding:2px;margin-top:30px;margin-bottom:30px;display:flex;flex-direction:column;align-items:center;justify-content:center;vertical-align:middle}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-weight:400;font-size:12px}:host .people-person-job-title.uppercase,mgt-people-picker .people-person-job-title.uppercase{text-transform:uppercase}mgt-flyout{flex:1 0 auto}[dir=rtl] mgt-person{margin:0 12px 0 0}[dir=rtl] .selected-list{margin-right:8px!important}[dir=rtl] .selected-list__person-wrapper{margin-left:6px!important}[dir=rtl] .selected-list__person-wrapper__person{margin-right:0!important;margin-left:4px!important}[dir=rtl] .selected-list__person-wrapper__overflow__gradient{right:auto!important;position:absolute!important;margin-right:0!important;width:10px!important;height:90%;top:0}[dir=rtl] .selected-list__person-wrapper__overflow__close-icon{right:auto!important;margin-left:5px!important;left:0!important}[dir=rtl] .people-person-text-area{margin-right:13px;margin-left:0!important}[dir=rtl] .flyout-root{text-align:right!important}
`
];
//# sourceMappingURL=mgt-people-picker-css.js.map

/***/ }),

/***/ "jEu4":
/*!**************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/index.js ***!
  \**************************************************************************************/
/*! exports provided: UserAgentApplication, Logger, LogLevel, Account, Constants, ServerHashParamKeys, Authority, CryptoUtils, UrlUtils, WindowUtils, AuthError, ClientAuthError, ServerError, ClientConfigurationError, InteractionRequiredAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _UserAgentApplication__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./UserAgentApplication */ "/AMX");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UserAgentApplication", function() { return _UserAgentApplication__WEBPACK_IMPORTED_MODULE_0__["UserAgentApplication"]; });

/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Logger */ "B52y");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Logger", function() { return _Logger__WEBPACK_IMPORTED_MODULE_1__["Logger"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LogLevel", function() { return _Logger__WEBPACK_IMPORTED_MODULE_1__["LogLevel"]; });

/* harmony import */ var _Account__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Account */ "K6T8");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Account", function() { return _Account__WEBPACK_IMPORTED_MODULE_2__["Account"]; });

/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/Constants */ "/pXG");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Constants", function() { return _utils_Constants__WEBPACK_IMPORTED_MODULE_3__["Constants"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ServerHashParamKeys", function() { return _utils_Constants__WEBPACK_IMPORTED_MODULE_3__["ServerHashParamKeys"]; });

/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./authority/Authority */ "Si2r");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Authority", function() { return _authority_Authority__WEBPACK_IMPORTED_MODULE_4__["Authority"]; });

/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils/CryptoUtils */ "RDZQ");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CryptoUtils", function() { return _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"]; });

/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils/UrlUtils */ "j0B3");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UrlUtils", function() { return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_6__["UrlUtils"]; });

/* harmony import */ var _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utils/WindowUtils */ "gaiY");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WindowUtils", function() { return _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_7__["WindowUtils"]; });

/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./error/AuthError */ "UrvO");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AuthError", function() { return _error_AuthError__WEBPACK_IMPORTED_MODULE_8__["AuthError"]; });

/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./error/ClientAuthError */ "n82g");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClientAuthError", function() { return _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_9__["ClientAuthError"]; });

/* harmony import */ var _error_ServerError__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./error/ServerError */ "+xZ/");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ServerError", function() { return _error_ServerError__WEBPACK_IMPORTED_MODULE_10__["ServerError"]; });

/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./error/ClientConfigurationError */ "SRUK");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ClientConfigurationError", function() { return _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_11__["ClientConfigurationError"]; });

/* harmony import */ var _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./error/InteractionRequiredAuthError */ "vhOk");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "InteractionRequiredAuthError", function() { return _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_12__["InteractionRequiredAuthError"]; });

/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */









// Errors





//# sourceMappingURL=index.js.map

/***/ }),

/***/ "jMoM":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/AuthenticationHandlerOptions.js ***!
  \******************************************************************************************************************/
/*! exports provided: AuthenticationHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthenticationHandlerOptions", function() { return AuthenticationHandlerOptions; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * @implements MiddlewareOptions
 * Class representing AuthenticationHandlerOptions
 */
class AuthenticationHandlerOptions {
    /**
     * @public
     * @constructor
     * To create an instance of AuthenticationHandlerOptions
     * @param {AuthenticationProvider} [authenticationProvider] - The authentication provider instance
     * @param {AuthenticationProviderOptions} [authenticationProviderOptions] - The authentication provider options instance
     * @returns An instance of AuthenticationHandlerOptions
     */
    constructor(authenticationProvider, authenticationProviderOptions) {
        this.authenticationProvider = authenticationProvider;
        this.authenticationProviderOptions = authenticationProviderOptions;
    }
}
//# sourceMappingURL=AuthenticationHandlerOptions.js.map

/***/ }),

/***/ "jTeC":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-profile/strings.js ***!
  \********************************************************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    SkillsAndExperienceSectionTitle: 'Skills & Experience',
    AboutCompactSectionTitle: 'About',
    SkillsSubSectionTitle: 'Skills',
    LanguagesSubSectionTitle: 'Languages',
    WorkExperienceSubSectionTitle: 'Work Experience',
    EducationSubSectionTitle: 'Education',
    professionalInterestsSubSectionTitle: 'Professional Interests',
    personalInterestsSubSectionTitle: 'Personal Interests',
    birthdaySubSectionTitle: 'Birthday',
    currentYearSubtitle: 'Current'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "jVY4":
/*!******************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/TemplateHelper.js ***!
  \******************************************************************************/
/*! exports provided: TemplateHelper */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TemplateHelper", function() { return TemplateHelper; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * Helper class for Template Instantiation
 *
 * @export
 * @class TemplateHelper
 */
class TemplateHelper {
    /**
     * Render a template into a HTMLElement with the appropriate data context
     *
     * Ex:
     * ```
     * <template>
     *  <div>{{myObj.someStr}}</div>
     *  <div data-for="key in myObj.list">
     *    <div>{{key.anotherStr}}</div>
     *  </div>
     * </template>
     * ```
     *
     * @param root the root element to parent the rendered content
     * @param template the template to render
     * @param context the data context to be applied
     * @param additionalContext additional context that could contain functions to transform the data
     */
    static renderTemplate(root, template, context, additionalContext) {
        // inherit context from parent template
        if (template.$parentTemplateContext) {
            context = Object.assign(Object.assign({}, context), { $parent: template.$parentTemplateContext });
        }
        let rendered;
        if (template.content && template.content.childNodes.length) {
            const templateContent = template.content.cloneNode(true);
            rendered = this.renderNode(templateContent, root, context, additionalContext);
        }
        else if (template.childNodes.length) {
            const div = document.createElement('div');
            // tslint:disable-next-line: prefer-for-of
            for (let i = 0; i < template.childNodes.length; i++) {
                div.appendChild(this.simpleCloneNode(template.childNodes[i]));
            }
            rendered = this.renderNode(div, root, context, additionalContext);
        }
        if (rendered) {
            root.appendChild(rendered);
        }
    }
    /**
     * Set an alternative binding syntax. Default is {{ <value> }}
     *
     * @static
     * @param {string} startStr start of binding syntax
     * @param {string} endStr end of binding syntax
     * @memberof TemplateHelper
     */
    static setBindingSyntax(startStr, endStr) {
        this._startExpression = startStr;
        this._endExpression = endStr;
        const start = this.escapeRegex(this._startExpression);
        const end = this.escapeRegex(this._endExpression);
        this._expression = new RegExp(`${start}\\s*\([$\\w\\.()\\[\\]]+\)\\s*${end}`, 'g');
    }
    /**
     * Global context containing data or functions available to
     * all templates for binding
     *
     * @readonly
     * @static
     * @memberof TemplateHelper
     */
    static get globalContext() {
        return this._globalContext;
    }
    static get expression() {
        if (!this._expression) {
            this.setBindingSyntax('{{', '}}');
        }
        return this._expression;
    }
    static escapeRegex(string) {
        return string.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
    }
    // simple implementation of deep cloneNode
    // required for nested templates in polyfilled browsers
    static simpleCloneNode(node) {
        if (!node) {
            return null;
        }
        const clone = node.cloneNode(false);
        // tslint:disable-next-line:prefer-for-of
        for (let i = 0; i < node.childNodes.length; i++) {
            const childClone = this.simpleCloneNode(node.childNodes[i]);
            if (childClone) {
                clone.appendChild(childClone);
            }
        }
        return clone;
    }
    static expandExpressionsAsString(str, context, additionalContext) {
        return str.replace(this.expression, (match, p1) => {
            const value = this.evalInContext(p1 || this.trimExpression(match), Object.assign(Object.assign({}, context), additionalContext));
            if (value) {
                if (typeof value === 'object') {
                    return JSON.stringify(value);
                }
                else {
                    return value.toString();
                }
            }
            return '';
        });
    }
    static renderNode(node, root, context, additionalContext) {
        if (node.nodeName === '#text') {
            node.textContent = this.expandExpressionsAsString(node.textContent, context, additionalContext);
            return node;
        }
        else if (node.nodeName === 'TEMPLATE') {
            node.$parentTemplateContext = context;
            return node;
        }
        // tslint:disable-next-line: prefer-const
        let nodeElement = node;
        // replace attribute values
        if (nodeElement.attributes) {
            // tslint:disable-next-line: prefer-for-of
            for (let i = 0; i < nodeElement.attributes.length; i++) {
                const attribute = nodeElement.attributes[i];
                if (attribute.name === 'data-props') {
                    const propsValue = this.trimExpression(attribute.value);
                    for (const prop of propsValue.split(',')) {
                        const keyValue = prop.trim().split(':');
                        if (keyValue.length === 2) {
                            const key = keyValue[0].trim();
                            const value = this.evalInContext(keyValue[1].trim(), Object.assign(Object.assign({}, context), additionalContext));
                            if (key.startsWith('@')) {
                                // event
                                if (typeof value === 'function') {
                                    nodeElement.addEventListener(key.substring(1), e => value(e, context, root));
                                }
                            }
                            else {
                                nodeElement[key] = value;
                            }
                        }
                    }
                }
                else {
                    nodeElement.setAttribute(attribute.name, this.expandExpressionsAsString(attribute.value, context, additionalContext));
                }
            }
        }
        // don't process nodes that will loop yet, but
        // keep a reference of them
        const loopChildren = [];
        // list of children to remove (ex, when data-if == false)
        const removeChildren = [];
        let previousChildWasIfAndTrue = false;
        // tslint:disable-next-line: prefer-for-of
        for (let i = 0; i < node.childNodes.length; i++) {
            const childNode = node.childNodes[i];
            const childElement = childNode;
            let previousChildWasIfAndTrueSet = false;
            if (childElement.dataset) {
                let childWillBeRemoved = false;
                if (childElement.dataset.if) {
                    const expression = childElement.dataset.if;
                    if (!this.evalBoolInContext(this.trimExpression(expression), Object.assign(Object.assign({}, context), additionalContext))) {
                        removeChildren.push(childElement);
                        childWillBeRemoved = true;
                    }
                    else {
                        childElement.removeAttribute('data-if');
                        previousChildWasIfAndTrue = true;
                        previousChildWasIfAndTrueSet = true;
                    }
                }
                else if (typeof childElement.dataset.else !== 'undefined') {
                    if (previousChildWasIfAndTrue) {
                        removeChildren.push(childElement);
                        childWillBeRemoved = true;
                    }
                    else {
                        childElement.removeAttribute('data-else');
                    }
                }
                if (childElement.dataset.for && !childWillBeRemoved) {
                    loopChildren.push(childElement);
                }
                else if (!childWillBeRemoved) {
                    this.renderNode(childNode, root, context, additionalContext);
                }
            }
            else {
                this.renderNode(childNode, root, context, additionalContext);
            }
            // clear the flag if the current node wasn't data-if
            // or if it was data-if but it wasn't true
            if (!previousChildWasIfAndTrueSet && childNode.nodeName !== '#text') {
                previousChildWasIfAndTrue = false;
            }
        }
        // now handle nodes that need to be removed
        for (const child of removeChildren) {
            nodeElement.removeChild(child);
        }
        // now handle nodes that should loop
        // tslint:disable-next-line: prefer-for-of
        for (let i = 0; i < loopChildren.length; i++) {
            const childElement = loopChildren[i];
            const loopExpression = childElement.dataset.for;
            const loopTokens = this.trimExpression(loopExpression).split(/\s+(in|of)\s+/i);
            if (loopTokens.length === 3) {
                // don't really care what's in the middle at this point
                const itemName = loopTokens[0];
                const listKey = loopTokens[2];
                const list = this.evalInContext(listKey, Object.assign(Object.assign({}, context), additionalContext));
                if (Array.isArray(list)) {
                    // first remove the child
                    // we will need to make copy of the child for
                    // each element in the list
                    childElement.removeAttribute('data-for');
                    for (let j = 0; j < list.length; j++) {
                        const newContext = Object.assign({ $index: j }, context);
                        newContext[itemName] = list[j];
                        const clone = childElement.cloneNode(true);
                        this.renderNode(clone, root, newContext, additionalContext);
                        nodeElement.insertBefore(clone, childElement);
                    }
                }
                nodeElement.removeChild(childElement);
            }
        }
        return node;
    }
    static evalBoolInContext(expression, context) {
        context = Object.assign(Object.assign({}, context), this.globalContext);
        return new Function('with(this) { return !!(' + expression + ')}').call(context);
    }
    static evalInContext(expression, context) {
        context = Object.assign(Object.assign({}, context), this.globalContext);
        const func = new Function('with(this) { return ' + expression + ';}');
        let result;
        try {
            result = func.call(context);
            // tslint:disable-next-line: no-empty
        }
        catch (e) { }
        return result;
    }
    static trimExpression(expression) {
        expression = expression.trim();
        if (expression.startsWith(this._startExpression) && expression.endsWith(this._endExpression)) {
            expression = expression.substr(this._startExpression.length, expression.length - this._startExpression.length - this._endExpression.length);
            expression = expression.trim();
        }
        return expression;
    }
}
TemplateHelper._globalContext = {};
//# sourceMappingURL=TemplateHelper.js.map

/***/ }),

/***/ "jxkD":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/telemetry/ApiEvent.js ***!
  \***************************************************************************************************/
/*! exports provided: EVENT_KEYS, API_CODE, API_EVENT_IDENTIFIER, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_KEYS", function() { return EVENT_KEYS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "API_CODE", function() { return API_CODE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "API_EVENT_IDENTIFIER", function() { return API_EVENT_IDENTIFIER; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryEvent */ "31fH");
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryConstants */ "tekO");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TelemetryUtils */ "Rgi7");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
var _a;




var EVENT_KEYS = {
    AUTHORITY: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("authority"),
    AUTHORITY_TYPE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("authority_type"),
    PROMPT: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("ui_behavior"),
    TENANT_ID: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("tenant_id"),
    USER_ID: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("user_id"),
    WAS_SUCESSFUL: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("was_successful"),
    API_ERROR_CODE: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("api_error_code"),
    LOGIN_HINT: Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("login_hint")
};
var API_CODE;
(function (API_CODE) {
    API_CODE[API_CODE["AcquireTokenRedirect"] = 2001] = "AcquireTokenRedirect";
    API_CODE[API_CODE["AcquireTokenSilent"] = 2002] = "AcquireTokenSilent";
    API_CODE[API_CODE["AcquireTokenPopup"] = 2003] = "AcquireTokenPopup";
    API_CODE[API_CODE["LoginRedirect"] = 2004] = "LoginRedirect";
    API_CODE[API_CODE["LoginPopup"] = 2005] = "LoginPopup";
    API_CODE[API_CODE["Logout"] = 2006] = "Logout";
})(API_CODE || (API_CODE = {}));
var API_EVENT_IDENTIFIER;
(function (API_EVENT_IDENTIFIER) {
    API_EVENT_IDENTIFIER["AcquireTokenRedirect"] = "AcquireTokenRedirect";
    API_EVENT_IDENTIFIER["AcquireTokenSilent"] = "AcquireTokenSilent";
    API_EVENT_IDENTIFIER["AcquireTokenPopup"] = "AcquireTokenPopup";
    API_EVENT_IDENTIFIER["LoginRedirect"] = "LoginRedirect";
    API_EVENT_IDENTIFIER["LoginPopup"] = "LoginPopup";
    API_EVENT_IDENTIFIER["Logout"] = "Logout";
})(API_EVENT_IDENTIFIER || (API_EVENT_IDENTIFIER = {}));
var mapEventIdentiferToCode = (_a = {},
    _a[API_EVENT_IDENTIFIER.AcquireTokenSilent] = API_CODE.AcquireTokenSilent,
    _a[API_EVENT_IDENTIFIER.AcquireTokenPopup] = API_CODE.AcquireTokenPopup,
    _a[API_EVENT_IDENTIFIER.AcquireTokenRedirect] = API_CODE.AcquireTokenRedirect,
    _a[API_EVENT_IDENTIFIER.LoginPopup] = API_CODE.LoginPopup,
    _a[API_EVENT_IDENTIFIER.LoginRedirect] = API_CODE.LoginRedirect,
    _a[API_EVENT_IDENTIFIER.Logout] = API_CODE.Logout,
    _a);
var ApiEvent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ApiEvent, _super);
    function ApiEvent(correlationId, piiEnabled, apiEventIdentifier) {
        var _this = _super.call(this, Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("api_event"), correlationId, apiEventIdentifier) || this;
        if (apiEventIdentifier) {
            _this.apiCode = mapEventIdentiferToCode[apiEventIdentifier];
            _this.apiEventIdentifier = apiEventIdentifier;
        }
        _this.piiEnabled = piiEnabled;
        return _this;
    }
    Object.defineProperty(ApiEvent.prototype, "apiEventIdentifier", {
        set: function (apiEventIdentifier) {
            this.event[_TelemetryConstants__WEBPACK_IMPORTED_MODULE_2__["TELEMETRY_BLOB_EVENT_NAMES"].ApiTelemIdConstStrKey] = apiEventIdentifier;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "apiCode", {
        set: function (apiCode) {
            this.event[_TelemetryConstants__WEBPACK_IMPORTED_MODULE_2__["TELEMETRY_BLOB_EVENT_NAMES"].ApiIdConstStrKey] = apiCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "authority", {
        set: function (uri) {
            this.event[EVENT_KEYS.AUTHORITY] = Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["scrubTenantFromUri"])(uri).toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "apiErrorCode", {
        set: function (errorCode) {
            this.event[EVENT_KEYS.API_ERROR_CODE] = errorCode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "tenantId", {
        set: function (tenantId) {
            this.event[EVENT_KEYS.TENANT_ID] = this.piiEnabled && tenantId ?
                Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["hashPersonalIdentifier"])(tenantId)
                : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "accountId", {
        set: function (accountId) {
            this.event[EVENT_KEYS.USER_ID] = this.piiEnabled && accountId ?
                Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["hashPersonalIdentifier"])(accountId)
                : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "wasSuccessful", {
        get: function () {
            return this.event[EVENT_KEYS.WAS_SUCESSFUL] === true;
        },
        set: function (wasSuccessful) {
            this.event[EVENT_KEYS.WAS_SUCESSFUL] = wasSuccessful;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "loginHint", {
        set: function (loginHint) {
            this.event[EVENT_KEYS.LOGIN_HINT] = this.piiEnabled && loginHint ?
                Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["hashPersonalIdentifier"])(loginHint)
                : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "authorityType", {
        set: function (authorityType) {
            this.event[EVENT_KEYS.AUTHORITY_TYPE] = authorityType.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiEvent.prototype, "promptType", {
        set: function (promptType) {
            this.event[EVENT_KEYS.PROMPT] = promptType.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    return ApiEvent;
}(_TelemetryEvent__WEBPACK_IMPORTED_MODULE_1__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (ApiEvent);
//# sourceMappingURL=ApiEvent.js.map

/***/ }),

/***/ "k+Uk":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/StringUtils.js ***!
  \**************************************************************************************************/
/*! exports provided: StringUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StringUtils", function() { return StringUtils; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var StringUtils = /** @class */ (function () {
    function StringUtils() {
    }
    /**
     * Check if a string is empty
     *
     * @param str
     */
    StringUtils.isEmpty = function (str) {
        return (typeof str === "undefined" || !str || 0 === str.length);
    };
    /**
     * Check if a string's value is a valid JSON object
     *
     * @param str
     */
    StringUtils.validateAndParseJsonCacheKey = function (str) {
        try {
            var parsedKey = JSON.parse(str);
            /**
             * There are edge cases in which JSON.parse will successfully parse a non-valid JSON object
             * (e.g. JSON.parse will parse an escaped string into an unescaped string), so adding a type check
             * of the parsed value is necessary in order to be certain that the string represents a valid JSON object.
             *
             */
            return (parsedKey && typeof parsedKey === "object") ? parsedKey : null;
        }
        catch (error) {
            return null;
        }
    };
    return StringUtils;
}());

//# sourceMappingURL=StringUtils.js.map

/***/ }),

/***/ "k/fM":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/RedirectHandler.js ***!
  \*********************************************************************************************/
/*! exports provided: RedirectHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RedirectHandler", function() { return RedirectHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _RequestMethod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../RequestMethod */ "wmib");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MiddlewareControl */ "/M1i");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./MiddlewareUtil */ "z+g4");
/* harmony import */ var _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./options/RedirectHandlerOptions */ "FDgl");
/* harmony import */ var _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./options/TelemetryHandlerOptions */ "x9B3");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */






/**
 * @class
 * Class
 * @implements Middleware
 * Class representing RedirectHandler
 */
class RedirectHandler {
    /**
     * @public
     * @constructor
     * To create an instance of RedirectHandler
     * @param {RedirectHandlerOptions} [options = new RedirectHandlerOptions()] - The redirect handler options instance
     * @returns An instance of RedirectHandler
     */
    constructor(options = new _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RedirectHandlerOptions"]()) {
        this.options = options;
    }
    /**
     * @private
     * To check whether the response has the redirect status code or not
     * @param {Response} response - The response object
     * @returns A boolean representing whether the response contains the redirect status code or not
     */
    isRedirect(response) {
        return RedirectHandler.REDIRECT_STATUS_CODES.indexOf(response.status) !== -1;
    }
    /**
     * @private
     * To check whether the response has location header or not
     * @param {Response} response - The response object
     * @returns A boolean representing the whether the response has location header or not
     */
    hasLocationHeader(response) {
        return response.headers.has(RedirectHandler.LOCATION_HEADER);
    }
    /**
     * @private
     * To get the redirect url from location header in response object
     * @param {Response} response - The response object
     * @returns A redirect url from location header
     */
    getLocationHeader(response) {
        return response.headers.get(RedirectHandler.LOCATION_HEADER);
    }
    /**
     * @private
     * To check whether the given url is a relative url or not
     * @param {string} url - The url string value
     * @returns A boolean representing whether the given url is a relative url or not
     */
    isRelativeURL(url) {
        return url.indexOf("://") === -1;
    }
    /**
     * @private
     * To check whether the authorization header in the request should be dropped for consequent redirected requests
     * @param {string} requestUrl - The request url value
     * @param {string} redirectUrl - The redirect url value
     * @returns A boolean representing whether the authorization header in the request should be dropped for consequent redirected requests
     */
    shouldDropAuthorizationHeader(requestUrl, redirectUrl) {
        const schemeHostRegex = /^[A-Za-z].+?:\/\/.+?(?=\/|$)/;
        const requestMatches = schemeHostRegex.exec(requestUrl);
        let requestAuthority;
        let redirectAuthority;
        if (requestMatches !== null) {
            requestAuthority = requestMatches[0];
        }
        const redirectMatches = schemeHostRegex.exec(redirectUrl);
        if (redirectMatches !== null) {
            redirectAuthority = redirectMatches[0];
        }
        return typeof requestAuthority !== "undefined" && typeof redirectAuthority !== "undefined" && requestAuthority !== redirectAuthority;
    }
    /**
     * @private
     * @async
     * To update a request url with the redirect url
     * @param {string} redirectUrl - The redirect url value
     * @param {Context} context - The context object value
     * @returns Nothing
     */
    updateRequestUrl(redirectUrl, context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            context.request = typeof context.request === "string" ? redirectUrl : yield Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__["cloneRequestWithNewUrl"])(redirectUrl, context.request);
        });
    }
    /**
     * @private
     * To get the options for execution of the middleware
     * @param {Context} context - The context object
     * @returns A options for middleware execution
     */
    getOptions(context) {
        let options;
        if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_2__["MiddlewareControl"]) {
            options = context.middlewareControl.getMiddlewareOptions(_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RedirectHandlerOptions"]);
        }
        if (typeof options === "undefined") {
            options = Object.assign(new _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RedirectHandlerOptions"](), this.options);
        }
        return options;
    }
    /**
     * @private
     * @async
     * To execute the next middleware and to handle in case of redirect response returned by the server
     * @param {Context} context - The context object
     * @param {number} redirectCount - The redirect count value
     * @param {RedirectHandlerOptions} options - The redirect handler options instance
     * @returns A promise that resolves to nothing
     */
    executeWithRedirect(context, redirectCount, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                yield this.nextMiddleware.execute(context);
                const response = context.response;
                if (redirectCount < options.maxRedirects && this.isRedirect(response) && this.hasLocationHeader(response) && options.shouldRedirect(response)) {
                    ++redirectCount;
                    if (response.status === RedirectHandler.STATUS_CODE_SEE_OTHER) {
                        context.options.method = _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].GET;
                        delete context.options.body;
                    }
                    else {
                        const redirectUrl = this.getLocationHeader(response);
                        if (!this.isRelativeURL(redirectUrl) && this.shouldDropAuthorizationHeader(response.url, redirectUrl)) {
                            delete context.options.headers[RedirectHandler.AUTHORIZATION_HEADER];
                        }
                        yield this.updateRequestUrl(redirectUrl, context);
                    }
                    yield this.executeWithRedirect(context, redirectCount, options);
                }
                else {
                    return;
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const redirectCount = 0;
                const options = this.getOptions(context);
                context.options.redirect = RedirectHandler.MANUAL_REDIRECT;
                _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["TelemetryHandlerOptions"].updateFeatureUsageFlag(context, _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["FeatureUsageFlag"].REDIRECT_HANDLER_ENABLED);
                return yield this.executeWithRedirect(context, redirectCount, options);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
/**
 * @private
 * @static
 * A member holding the array of redirect status codes
 */
RedirectHandler.REDIRECT_STATUS_CODES = [
    301,
    302,
    303,
    307,
    308,
];
/**
 * @private
 * @static
 * A member holding SeeOther status code
 */
RedirectHandler.STATUS_CODE_SEE_OTHER = 303;
/**
 * @private
 * @static
 * A member holding the name of the location header
 */
RedirectHandler.LOCATION_HEADER = "Location";
/**
 * @private
 * @static
 * A member representing the authorization header name
 */
RedirectHandler.AUTHORIZATION_HEADER = "Authorization";
/**
 * @private
 * @static
 * A member holding the manual redirect value
 */
RedirectHandler.MANUAL_REDIRECT = "manual";
//# sourceMappingURL=RedirectHandler.js.map

/***/ }),

/***/ "kC25":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/GraphRequestUtil.js ***!
  \***********************************************************************************************************************/
/*! exports provided: oDataQueryNames, urlJoin, serializeContent, isGraphURL */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "oDataQueryNames", function() { return oDataQueryNames; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "urlJoin", function() { return urlJoin; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "serializeContent", function() { return serializeContent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isGraphURL", function() { return isGraphURL; });
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Constants */ "/FJK");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module GraphRequestUtil
 */

/**
 * To hold list of OData query params
 */
const oDataQueryNames = ["$select", "$expand", "$orderby", "$filter", "$top", "$skip", "$skipToken", "$count"];
/**
 * To construct the URL by appending the segments with "/"
 * @param {string[]} urlSegments - The array of strings
 * @returns The constructed URL string
 */
const urlJoin = (urlSegments) => {
    const removePostSlash = (s) => s.replace(/\/+$/, "");
    const removePreSlash = (s) => s.replace(/^\/+/, "");
    const joiner = (pre, cur) => [removePostSlash(pre), removePreSlash(cur)].join("/");
    const parts = Array.prototype.slice.call(urlSegments);
    return parts.reduce(joiner);
};
/**
 * Serializes the content
 * @param {any} content - The content value that needs to be serialized
 * @returns The serialized content
 *
 * Note:
 * This conversion is required due to the following reasons:
 * Body parameter of Request method of isomorphic-fetch only accepts Blob, ArrayBuffer, FormData, TypedArrays string.
 * Node.js platform does not support Blob, FormData. Javascript File object inherits from Blob so it is also not supported in node. Therefore content of type Blob, File, FormData will only come from browsers.
 * Parallel to ArrayBuffer in javascript, node provides Buffer interface. Node's Buffer is able to send the arbitrary binary data to the server successfully for both Browser and Node platform. Whereas sending binary data via ArrayBuffer or TypedArrays was only possible using Browser. To support both Node and Browser, `serializeContent` converts TypedArrays or ArrayBuffer to `Node Buffer`.
 * If the data received is in JSON format, `serializeContent` converts the JSON to string.
 */
const serializeContent = (content) => {
    const className = content && content.constructor && content.constructor.name;
    if (className === "Buffer" || className === "Blob" || className === "File" || className === "FormData" || typeof content === "string") {
        return content;
    }
    if (className === "ArrayBuffer") {
        content = Buffer.from(content);
    }
    else if (className === "Int8Array" || className === "Int16Array" || className === "Int32Array" || className === "Uint8Array" || className === "Uint16Array" || className === "Uint32Array" || className === "Uint8ClampedArray" || className === "Float32Array" || className === "Float64Array" || className === "DataView") {
        content = Buffer.from(content.buffer);
    }
    else {
        try {
            content = JSON.stringify(content);
        }
        catch (error) {
            throw new Error("Unable to stringify the content");
        }
    }
    return content;
};
/**
 * Checks if the url is one of the service root endpoints for Microsoft Graph and Graph Explorer.
 * @param {string} url - The url to be verified
 * @returns {boolean} - Returns true if the url is a Graph URL
 */
const isGraphURL = (url) => {
    // Valid Graph URL pattern - https://graph.microsoft.com/{version}/{resource}?{query-parameters}
    // Valid Graph URL example - https://graph.microsoft.com/v1.0/
    url = url.toLowerCase();
    if (url.indexOf("https://") !== -1) {
        url = url.replace("https://", "");
        // Find where the host ends
        const startofPortNoPos = url.indexOf(":");
        const endOfHostStrPos = url.indexOf("/");
        let hostName = "";
        if (endOfHostStrPos !== -1) {
            if (startofPortNoPos !== -1 && startofPortNoPos < endOfHostStrPos) {
                hostName = url.substring(0, startofPortNoPos);
                return _Constants__WEBPACK_IMPORTED_MODULE_0__["GRAPH_URLS"].has(hostName);
            }
            // Parse out the host
            hostName = url.substring(0, endOfHostStrPos);
            return _Constants__WEBPACK_IMPORTED_MODULE_0__["GRAPH_URLS"].has(hostName);
        }
    }
    return false;
};
//# sourceMappingURL=GraphRequestUtil.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../../../buffer/index.js */ "tjlA").Buffer))

/***/ }),

/***/ "kDYw":
/*!*******************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/EventDispatcher.js ***!
  \*******************************************************************************/
/*! exports provided: EventDispatcher */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventDispatcher", function() { return EventDispatcher; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * Provider EventDispatcher
 *
 * @export
 * @class EventDispatcher
 * @template E
 */
class EventDispatcher {
    constructor() {
        this.eventHandlers = [];
    }
    /**
     * fires event handler
     *
     * @param {E} event
     * @memberof EventDispatcher
     */
    fire(event) {
        for (const handler of this.eventHandlers) {
            handler(event);
        }
    }
    /**
     * adds eventHandler
     *
     * @param {EventHandler<E>} eventHandler
     * @memberof EventDispatcher
     */
    add(eventHandler) {
        this.eventHandlers.push(eventHandler);
    }
    /**
     * removes eventHandler
     *
     * @param {EventHandler<E>} eventHandler
     * @memberof EventDispatcher
     */
    remove(eventHandler) {
        for (let i = 0; i < this.eventHandlers.length; i++) {
            if (this.eventHandlers[i] === eventHandler) {
                this.eventHandlers.splice(i, 1);
                i--;
            }
        }
    }
}
//# sourceMappingURL=EventDispatcher.js.map

/***/ }),

/***/ "kM4i":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/MiddlewareUtil.js ***!
  \********************************************************************************************************************************/
/*! exports provided: generateUUID, getRequestHeader, setRequestHeader, appendRequestHeader, cloneRequestWithNewUrl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateUUID", function() { return generateUUID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getRequestHeader", function() { return getRequestHeader; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setRequestHeader", function() { return setRequestHeader; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "appendRequestHeader", function() { return appendRequestHeader; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cloneRequestWithNewUrl", function() { return cloneRequestWithNewUrl; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @constant
 * To generate the UUID
 * @returns The UUID string
 */
const generateUUID = () => {
    let uuid = "";
    for (let j = 0; j < 32; j++) {
        if (j === 8 || j === 12 || j === 16 || j === 20) {
            uuid += "-";
        }
        uuid += Math.floor(Math.random() * 16).toString(16);
    }
    return uuid;
};
/**
 * @constant
 * To get the request header from the request
 * @param {RequestInfo} request - The request object or the url string
 * @param {FetchOptions|undefined} options - The request options object
 * @param {string} key - The header key string
 * @returns A header value for the given key from the request
 */
const getRequestHeader = (request, options, key) => {
    let value = null;
    if (typeof Request !== "undefined" && request instanceof Request) {
        value = request.headers.get(key);
    }
    else if (typeof options !== "undefined" && options.headers !== undefined) {
        if (typeof Headers !== "undefined" && options.headers instanceof Headers) {
            value = options.headers.get(key);
        }
        else if (options.headers instanceof Array) {
            const headers = options.headers;
            for (let i = 0, l = headers.length; i < l; i++) {
                if (headers[i][0] === key) {
                    value = headers[i][1];
                    break;
                }
            }
        }
        else if (options.headers[key] !== undefined) {
            value = options.headers[key];
        }
    }
    return value;
};
/**
 * @constant
 * To set the header value to the given request
 * @param {RequestInfo} request - The request object or the url string
 * @param {FetchOptions|undefined} options - The request options object
 * @param {string} key - The header key string
 * @param {string } value - The header value string
 * @returns Nothing
 */
const setRequestHeader = (request, options, key, value) => {
    if (typeof Request !== "undefined" && request instanceof Request) {
        request.headers.set(key, value);
    }
    else if (typeof options !== "undefined") {
        if (options.headers === undefined) {
            options.headers = new Headers({
                [key]: value,
            });
        }
        else {
            if (typeof Headers !== "undefined" && options.headers instanceof Headers) {
                options.headers.set(key, value);
            }
            else if (options.headers instanceof Array) {
                let i = 0;
                const l = options.headers.length;
                for (; i < l; i++) {
                    const header = options.headers[i];
                    if (header[0] === key) {
                        header[1] = value;
                        break;
                    }
                }
                if (i === l) {
                    options.headers.push([key, value]);
                }
            }
            else {
                Object.assign(options.headers, { [key]: value });
            }
        }
    }
};
/**
 * @constant
 * To append the header value to the given request
 * @param {RequestInfo} request - The request object or the url string
 * @param {FetchOptions|undefined} options - The request options object
 * @param {string} key - The header key string
 * @param {string } value - The header value string
 * @returns Nothing
 */
const appendRequestHeader = (request, options, key, value) => {
    if (typeof Request !== "undefined" && request instanceof Request) {
        request.headers.append(key, value);
    }
    else if (typeof options !== "undefined") {
        if (options.headers === undefined) {
            options.headers = new Headers({
                [key]: value,
            });
        }
        else {
            if (typeof Headers !== "undefined" && options.headers instanceof Headers) {
                options.headers.append(key, value);
            }
            else if (options.headers instanceof Array) {
                options.headers.push([key, value]);
            }
            else if (options.headers === undefined) {
                options.headers = { [key]: value };
            }
            else if (options.headers[key] === undefined) {
                options.headers[key] = value;
            }
            else {
                options.headers[key] += `, ${value}`;
            }
        }
    }
};
/**
 * @constant
 * To clone the request with the new url
 * @param {string} url - The new url string
 * @param {Request} request - The request object
 * @returns A promise that resolves to request object
 */
const cloneRequestWithNewUrl = (newUrl, request) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](undefined, void 0, void 0, function* () {
    const body = request.headers.get("Content-Type") ? yield request.blob() : yield Promise.resolve(undefined);
    const { method, headers, referrer, referrerPolicy, mode, credentials, cache, redirect, integrity, keepalive, signal } = request;
    return new Request(newUrl, { method, headers, body, referrer, referrerPolicy, mode, credentials, cache, redirect, integrity, keepalive, signal });
});
//# sourceMappingURL=MiddlewareUtil.js.map

/***/ }),

/***/ "kVK+":
/*!***************************************!*\
  !*** ./node_modules/ieee754/index.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = ((value * c) - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}


/***/ }),

/***/ "l50I":
/*!************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/cache/AccessTokenValue.js ***!
  \************************************************************************************************************/
/*! exports provided: AccessTokenValue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccessTokenValue", function() { return AccessTokenValue; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var AccessTokenValue = /** @class */ (function () {
    function AccessTokenValue(accessToken, idToken, expiresIn, homeAccountIdentifier) {
        this.accessToken = accessToken;
        this.idToken = idToken;
        this.expiresIn = expiresIn;
        this.homeAccountIdentifier = homeAccountIdentifier;
    }
    return AccessTokenValue;
}());

//# sourceMappingURL=AccessTokenValue.js.map

/***/ }),

/***/ "l9ev":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-files/mgt-person-card-files-css.js ***!
  \************************************************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .file{display:flex;align-items:center;padding:11px 20px}:host .root .file:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .file:last-child{margin-bottom:unset}:host .root .file .file__icon{width:28px;min-width:28px;height:28px;margin-right:12px;display:flex;align-items:center;justify-content:center}:host .root .file .file__icon img{height:28px;width:28px}:host .root .file .file__details{min-width:0;margin-right:40px}:host .root .file .file__details .file__name{font-size:14px;color:var(--color-sub1,#323130)}:host .root .file .file__details .file__last-modified{font-size:12px;color:var(--color-sub2,#797775)}:host .root .file .file__details>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[dir=rtl] .file__icon{margin-right:0!important}[dir=rtl] .file__details{margin-right:12px!important}
`
];
//# sourceMappingURL=mgt-person-card-files-css.js.map

/***/ }),

/***/ "lBzc":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person/mgt-person.js ***!
  \*********************************************************************************************/
/*! exports provided: PersonCardInteraction, PersonViewType, MgtPerson */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PersonViewType", function() { return PersonViewType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtPerson", function() { return MgtPerson; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var _graph_graph_people__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../graph/graph.people */ "r/Dn");
/* harmony import */ var _graph_graph_photos__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../graph/graph.photos */ "xch7");
/* harmony import */ var _graph_graph_presence__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../graph/graph.presence */ "tpmt");
/* harmony import */ var _graph_graph_user__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../graph/graph.user */ "0Vrk");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _styles_style_helper__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../styles/style-helper */ "XyBC");
/* harmony import */ var _utils_SvgHelper__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../utils/SvgHelper */ "FPR2");
/* harmony import */ var _sub_components_mgt_flyout_mgt_flyout__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sub-components/mgt-flyout/mgt-flyout */ "8Crj");
/* harmony import */ var _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./../PersonCardInteraction */ "Y6V/");
/* harmony import */ var _mgt_person_css__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./mgt-person-css */ "TsON");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PersonCardInteraction", function() { return _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var MgtPerson_1;













/**
 * Enumeration to define what parts of the person component render
 *
 * @export
 * @enum {number}
 */
var PersonViewType;
(function (PersonViewType) {
    /**
     * Render only the avatar
     */
    PersonViewType[PersonViewType["avatar"] = 2] = "avatar";
    /**
     * Render the avatar and one line of text
     */
    PersonViewType[PersonViewType["oneline"] = 3] = "oneline";
    /**
     * Render the avatar and two lines of text
     */
    PersonViewType[PersonViewType["twolines"] = 4] = "twolines";
    /**
     * Render the avatar and three lines of text
     */
    PersonViewType[PersonViewType["threelines"] = 5] = "threelines";
})(PersonViewType || (PersonViewType = {}));
/**
 * The person component is used to display a person or contact by using their photo, name, and/or email address.
 *
 * @export
 * @class MgtPerson
 * @extends {MgtTemplatedComponent}
 *
 * @cssprop --avatar-size - {Length} Avatar size
 * @cssprop --avatar-border - {String} Avatar border
 * @cssprop --avatar-border-radius - {String} Avatar border radius
 * @cssprop --initials-color - {Color} Initials color
 * @cssprop --initials-background-color - {Color} Initials background color
 * @cssprop --font-family - {String} Font family
 * @cssprop --font-size - {Length} Font size
 * @cssprop --font-weight - {Length} Font weight
 * @cssprop --color - {Color} Color
 * @cssprop --presence-background-color - {Color} Presence badge background color
 * @cssprop --presence-icon-color - {Color} Presence badge icon color
 * @cssprop --text-transform - {String} text transform
 * @cssprop --line2-font-size - {Length} Line 2 font size
 * @cssprop --line2-font-weight - {Length} Line 2 font weight
 * @cssprop --line2-color - {Color} Line 2 color
 * @cssprop --line2-text-transform - {String} Line 2 text transform
 * @cssprop --line3-font-size - {Length} Line 2 font size
 * @cssprop --line3-font-weight - {Length} Line 2 font weight
 * @cssprop --line3-color - {Color} Line 2 color
 * @cssprop --line3-text-transform - {String} Line 2 text transform
 * @cssprop --details-spacing - {Length} spacing between avatar and person details
 */
let MgtPerson = MgtPerson_1 = class MgtPerson extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["MgtTemplatedComponent"] {
    constructor() {
        super();
        // defaults
        this.personCardInteraction = _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"].none;
        this.line1Property = 'displayName';
        this.line2Property = 'email';
        this.line3Property = 'jobTitle';
        this.view = PersonViewType.avatar;
        this.avatarSize = 'auto';
        this._isInvalidImageSrc = false;
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * user the `css` tag function.
     */
    static get styles() {
        return _mgt_person_css__WEBPACK_IMPORTED_MODULE_11__["styles"];
    }
    /**
     * allows developer to define name of person for component
     * @type {string}
     */
    get personQuery() {
        return this._personQuery;
    }
    set personQuery(value) {
        if (value === this._personQuery) {
            return;
        }
        this._personQuery = value;
        this.personDetails = null;
        this.requestStateUpdate();
    }
    /**
     * user-id property allows developer to use id value to determine person
     * @type {string}
     */
    get userId() {
        return this._userId;
    }
    set userId(value) {
        if (value === this._userId) {
            return;
        }
        this._userId = value;
        this.personDetails = null;
        this.requestStateUpdate();
    }
    /**
     * object containing Graph details on person
     * @type {IDynamicPerson}
     */
    get personDetails() {
        return this._personDetails;
    }
    set personDetails(value) {
        if (this._personDetails === value) {
            return;
        }
        this._personDetails = value;
        if (value && value.displayName) {
            this._personAvatarBg = this.getColorFromName(value.displayName);
        }
        else {
            this._personAvatarBg = 'gray20';
        }
        this._fetchedImage = null;
        this._fetchedPresence = null;
        this.requestStateUpdate();
        this.requestUpdate('personDetails');
    }
    /**
     * Set the image of the person
     *
     * @type {string}
     * @memberof MgtPersonCard
     */
    get personImage() {
        return this._personImage || this._fetchedImage;
    }
    set personImage(value) {
        if (value === this._personImage) {
            return;
        }
        this._isInvalidImageSrc = !value;
        const oldValue = this._personImage;
        this._personImage = value;
        this.requestUpdate('personImage', oldValue);
    }
    /**
     * Gets or sets presence of person
     *
     * @type {MicrosoftGraphBeta.Presence}
     * @memberof MgtPerson
     */
    get personPresence() {
        return this._personPresence || this._fetchedPresence;
    }
    set personPresence(value) {
        if (value === this._personPresence) {
            return;
        }
        const oldValue = this._personPresence;
        this._personPresence = value;
        this.requestUpdate('personPresence', oldValue);
    }
    /**
     * Gets the flyout element
     *
     * @protected
     * @type {MgtFlyout}
     * @memberof MgtPerson
     */
    get flyout() {
        return this.renderRoot.querySelector('.flyout');
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        // Loading
        if (this.isLoadingState && !this.personDetails) {
            return this.renderLoading();
        }
        // Prep data
        const person = this.personDetails;
        const image = this.getImage();
        const presence = this.personPresence || this._fetchedPresence;
        if (!person && !image) {
            return this.renderNoData();
        }
        // Default template
        let personTemplate = this.renderTemplate('default', { person, personImage: image });
        if (!personTemplate) {
            const detailsTemplate = this.renderDetails(person);
            const imageWithPresenceTemplate = this.renderAvatar(person, image, presence);
            personTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="person-root">
          ${imageWithPresenceTemplate} ${detailsTemplate}
        </div>
      `;
        }
        if (this.personCardInteraction !== _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"].none) {
            personTemplate = this.renderFlyout(personTemplate, person, image, presence);
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div
        class="root"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
      >
        ${personTemplate}
      </div>
    `;
    }
    /**
     * Render the loading state
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPerson
     */
    renderLoading() {
        return this.renderTemplate('loading', null) || lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
    }
    /**
     * Render the state when no data is available
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPerson
     */
    renderNoData() {
        const noDataTemplate = this.renderTemplate('no-data', null);
        if (noDataTemplate) {
            return noDataTemplate;
        }
        const avatarClasses = {
            'avatar-icon': true,
            'ms-Icon': true,
            'ms-Icon--Contact': true,
            small: !this.isLargeAvatar()
        };
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <i class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(avatarClasses)}></i>
    `;
    }
    /**
     * Render the image part of the person template.
     * If the image is unavailable, the person's initials will be used instead.
     *
     * @protected
     * @param {string} [imageSrc]
     * @param {IDynamicPerson} [personDetails]
     * @returns
     * @memberof MgtPerson
     */
    renderImage(personDetails, imageSrc) {
        const title = personDetails && this.personCardInteraction === _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"].none
            ? personDetails.displayName || Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_2__["getEmailFromGraphEntity"])(personDetails) || ''
            : '';
        if (imageSrc && !this._isInvalidImageSrc) {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="img-wrapper">
          <img alt=${title} src=${imageSrc} @error=${() => (this._isInvalidImageSrc = true)} />
        </div>
      `;
        }
        else if (personDetails) {
            const initials = this.getInitials(personDetails);
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <span class="initials-text" aria-label="${initials}">
          ${initials && initials.length
                ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
                ${initials}
              `
                : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
                <i class="ms-Icon ms-Icon--Contact contact-icon"></i>
              `}
        </span>
      `;
        }
    }
    /**
     * Render presence for the person.
     *
     * @protected
     * @param
     * @memberof MgtPersonCard
     */
    renderPresence(presence) {
        if (!this.showPresence || !presence) {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
        }
        let statusClass = null;
        // attach appropriate css class to show different icons
        switch (presence.availability) {
            case 'DoNotDisturb':
                switch (presence.activity) {
                    case 'OutOfOffice':
                        statusClass = 'presence-oof-dnd';
                        break;
                    default:
                        statusClass = 'presence-dnd';
                        break;
                }
                break;
            case 'BeRightBack':
                statusClass = 'presence-away';
                break;
            case 'Available':
                switch (presence.activity) {
                    case 'Available':
                        statusClass = 'presence-available';
                        break;
                    case 'OutOfOffice':
                        statusClass = 'presence-oof-available';
                        break;
                }
                break;
            case 'Busy':
                switch (presence.activity) {
                    case 'OutOfOffice':
                        statusClass = 'presence-oof-busy';
                        break;
                    default:
                        // 'Busy', 'InACall', 'InAMeeting'
                        statusClass = 'presence-busy';
                        break;
                }
                break;
            case 'Away':
                switch (presence.activity) {
                    case 'Away':
                        statusClass = 'presence-away';
                        break;
                    case 'OutOfOffice':
                        statusClass = 'presence-oof-offline';
                        break;
                }
                break;
            case 'Offline':
                switch (presence.activity) {
                    case 'Offline':
                        statusClass = 'presence-offline';
                        break;
                    case 'OutOfOffice':
                        statusClass = 'presence-oof-offline';
                        break;
                }
                break;
            default:
                statusClass = 'presence-offline';
                break;
        }
        const presenceClasses = {
            'ms-Icon': true,
            'presence-basic': true
        };
        presenceClasses[statusClass] = true;
        // workaround because SkypeArrow icon from fluent doesn't work ¯\_(ツ)_/¯
        let iconHtml = null;
        if (statusClass === 'presence-oof-offline') {
            iconHtml = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="ms-Icon presence-basic presence-oof-offline-wrapper">
          <i class="presence-oof-offline">
            ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_8__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_8__["SvgIcon"].SkypeArrow, '#666666')}
          </i>
        </div>
      `;
        }
        else {
            iconHtml = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <i class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(presenceClasses)} aria-hidden="true"></i>
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="user-presence" title=${presence.activity} aria-label=${presence.activity}>
        ${iconHtml}
      </div>
    `;
    }
    /**
     * Render image with presence for the person.
     *
     * @protected
     * @param
     * @memberof MgtPersonCard
     */
    renderAvatar(personDetails, image, presence) {
        const title = this.personDetails && this.personCardInteraction === _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"].none
            ? this.personDetails.displayName || Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_2__["getEmailFromGraphEntity"])(this.personDetails) || ''
            : '';
        const imageClasses = {
            initials: !image || this._isInvalidImageSrc,
            small: !this.isLargeAvatar(),
            'user-avatar': true
        };
        if ((!image || this._isInvalidImageSrc) && this.personDetails) {
            // add avatar background color
            imageClasses[this._personAvatarBg] = true;
        }
        const imageTemplate = this.renderImage(personDetails, image);
        const presenceTemplate = this.renderPresence(presence);
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(imageClasses)} title=${title} aria-label=${title}>
        ${imageTemplate} ${presenceTemplate}
      </div>
    `;
    }
    /**
     * Render the details part of the person template.
     *
     * @protected
     * @param {IDynamicPerson} [person]
     * @param {string} [image]
     * @returns {TemplateResult}
     * @memberof MgtPerson
     */
    renderDetails(person) {
        if (!person || this.view === PersonViewType.avatar) {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
        }
        const details = [];
        if (this.view > PersonViewType.avatar) {
            const text = this.getTextFromProperty(person, this.line1Property);
            if (text) {
                details.push(lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <div class="line1" aria-label="${text}">${text}</div>
        `);
            }
        }
        if (this.view > PersonViewType.oneline) {
            const text = this.getTextFromProperty(person, this.line2Property);
            if (text) {
                details.push(lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <div class="line2" aria-label="${text}">${text}</div>
        `);
            }
        }
        if (this.view > PersonViewType.twolines) {
            const text = this.getTextFromProperty(person, this.line3Property);
            if (text) {
                details.push(lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <div class="line3" aria-label="${text}">${text}</div>
        `);
            }
        }
        const detailsClasses = Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({
            details: true,
            small: !this.isLargeAvatar()
        });
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="${detailsClasses}">
        ${details}
      </div>
    `;
    }
    /**
     * Render the details flyout.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPerson
     */
    renderFlyout(anchor, personDetails, image, presence) {
        const flyoutContent = this._personCardShouldRender
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <div slot="flyout">
            ${this.renderFlyoutContent(personDetails, image, presence)}
          </div>
        `
            : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${false}>
        ${anchor} ${flyoutContent}
      </mgt-flyout>
    `;
    }
    /**
     * Render the flyout menu content.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPerson
     */
    renderFlyoutContent(personDetails, image, presence) {
        return (this.renderTemplate('person-card', { person: personDetails, personImage: image }) ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <mgt-person-card
          .personDetails=${personDetails}
          .personImage=${image}
          .personPresence=${presence}
          .showPresence=${this.showPresence}
        ></mgt-person-card>
      `);
    }
    /**
     * load state into the component.
     *
     * @protected
     * @returns
     * @memberof MgtPerson
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["Providers"].globalProvider;
            if (!provider || provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["ProviderState"].Loading) {
                return;
            }
            if (provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["ProviderState"].SignedOut) {
                this.personDetails = null;
                return;
            }
            const graph = provider.graph.forComponent(this);
            if (this.personDetails) {
                if (!this.personDetails.personImage && (this.fetchImage && !this.personImage && !this._fetchedImage)) {
                    const image = yield Object(_graph_graph_photos__WEBPACK_IMPORTED_MODULE_3__["getPersonImage"])(graph, this.personDetails, MgtPerson_1.config.useContactApis);
                    if (image) {
                        this.personDetails.personImage = image;
                        this._fetchedImage = image;
                    }
                }
            }
            else if (this.userId || this.personQuery === 'me') {
                // Use userId or 'me' query to get the person and image
                const person = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_5__["getUserWithPhoto"])(graph, this.userId);
                this.personDetails = person;
                this._fetchedImage = this.getImage();
            }
            else if (this.personQuery) {
                // Use the personQuery to find our person.
                const people = yield Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_2__["findPeople"])(graph, this.personQuery, 1);
                if (people && people.length) {
                    this.personDetails = people[0];
                    const image = yield Object(_graph_graph_photos__WEBPACK_IMPORTED_MODULE_3__["getPersonImage"])(graph, people[0], MgtPerson_1.config.useContactApis);
                    if (image) {
                        this.personDetails.personImage = image;
                        this._fetchedImage = image;
                    }
                }
            }
            // populate presence
            const defaultPresence = {
                activity: 'Offline',
                availability: 'Offline',
                id: null
            };
            if (this.showPresence && !this.personPresence && !this._fetchedPresence) {
                try {
                    if (this.personDetails && this.personDetails.id) {
                        // setting userId to 'me' ensures only the presence.read permission is required
                        const userId = this.personQuery !== 'me' ? this.personDetails.id : null;
                        this._fetchedPresence = yield Object(_graph_graph_presence__WEBPACK_IMPORTED_MODULE_4__["getUserPresence"])(graph, userId);
                    }
                    else {
                        this._fetchedPresence = defaultPresence;
                    }
                }
                catch (_) {
                    // set up a default Presence in case beta api changes or getting error code
                    this._fetchedPresence = defaultPresence;
                }
            }
        });
    }
    /**
     * Gets the user initials
     *
     * @protected
     * @returns {string}
     * @memberof MgtPerson
     */
    getInitials(person) {
        if (!person) {
            person = this.personDetails;
        }
        if (person.initials) {
            return person.initials;
        }
        let initials = '';
        if (person.givenName) {
            initials += person.givenName[0].toUpperCase();
        }
        if (person.surname) {
            initials += person.surname[0].toUpperCase();
        }
        if (!initials && person.displayName) {
            const name = person.displayName.split(/\s+/);
            for (let i = 0; i < 2 && i < name.length; i++) {
                if (name[i][0] && this.isLetter(name[i][0])) {
                    initials += name[i][0].toUpperCase();
                }
            }
        }
        return initials;
    }
    /**
     * Gets color from name
     *
     * @protected
     * @param {string} name
     * @returns {string}
     * @memberof MgtPerson
     */
    getColorFromName(name) {
        const charCodes = name
            .split('')
            .map(char => char.charCodeAt(0))
            .join('');
        const nameInt = parseInt(charCodes, 10);
        const colors = [
            'pinkRed10',
            'red20',
            'red10',
            'orange20',
            'orangeYellow20',
            'green10',
            'green20',
            'cyan20',
            'cyan30',
            'cyanBlue10',
            'cyanBlue20',
            'blue10',
            'blueMagenta30',
            'blueMagenta20',
            'magenta20',
            'magenta10',
            'magentaPink10',
            'orange30',
            'gray30',
            'gray20'
        ];
        return colors[nameInt % colors.length];
    }
    getImage() {
        if (this.personImage) {
            return this.personImage;
        }
        if (this._fetchedImage) {
            return this._fetchedImage;
        }
        const person = this.personDetails;
        return person && person.personImage ? person.personImage : null;
    }
    isLetter(char) {
        try {
            return char.match(new RegExp('\\p{L}', 'u'));
        }
        catch (e) {
            return char.toLowerCase() !== char.toUpperCase();
        }
    }
    getTextFromProperty(personDetails, prop) {
        if (!prop || prop.length === 0) {
            return null;
        }
        const properties = prop.trim().split(',');
        let text;
        let i = 0;
        while (!text && i < properties.length) {
            const currentProp = properties[i].trim();
            switch (currentProp) {
                case 'mail':
                case 'email':
                    text = Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_2__["getEmailFromGraphEntity"])(personDetails);
                    break;
                default:
                    text = personDetails[currentProp];
            }
            i++;
        }
        return text;
    }
    isLargeAvatar() {
        return this.avatarSize === 'large' || (this.avatarSize === 'auto' && this.view > PersonViewType.oneline);
    }
    handleMouseClick(e) {
        if (this.personCardInteraction === _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"].click) {
            this.showPersonCard();
        }
    }
    handleMouseEnter(e) {
        clearTimeout(this._mouseEnterTimeout);
        clearTimeout(this._mouseLeaveTimeout);
        if (this.personCardInteraction !== _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"].hover) {
            return;
        }
        this._mouseEnterTimeout = setTimeout(this.showPersonCard.bind(this), 500);
    }
    handleMouseLeave(e) {
        clearTimeout(this._mouseEnterTimeout);
        clearTimeout(this._mouseLeaveTimeout);
        this._mouseLeaveTimeout = setTimeout(this.hidePersonCard.bind(this), 500);
    }
    hidePersonCard() {
        const flyout = this.flyout;
        if (flyout) {
            flyout.isOpen = false;
        }
        const personCard = (this.querySelector('mgt-person-card') ||
            this.renderRoot.querySelector('mgt-person-card'));
        if (personCard) {
            personCard.isExpanded = false;
            personCard.clearHistory();
        }
    }
    showPersonCard() {
        if (!this._personCardShouldRender) {
            this._personCardShouldRender = true;
        }
        const flyout = this.flyout;
        if (flyout) {
            flyout.isOpen = true;
        }
    }
};
/**
 * Global Configuration object for all
 * person components
 *
 * @static
 * @type {MgtPersonConfig}
 * @memberof MgtPerson
 */
MgtPerson.config = {
    useContactApis: true
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-query'
    }),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MgtPerson.prototype, "personQuery", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'user-id'
    }),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MgtPerson.prototype, "userId", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'show-presence',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtPerson.prototype, "showPresence", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'avatar-size',
        type: String
    }),
    __metadata("design:type", String)
], MgtPerson.prototype, "avatarSize", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-details',
        type: Object
    }),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], MgtPerson.prototype, "personDetails", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-image',
        type: String
    }),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [String])
], MgtPerson.prototype, "personImage", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'fetch-image',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtPerson.prototype, "fetchImage", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-presence',
        type: Object
    }),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], MgtPerson.prototype, "personPresence", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-card',
        converter: (value, type) => {
            value = value.toLowerCase();
            if (typeof _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"][value] === 'undefined') {
                return _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"].none;
            }
            else {
                return _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_10__["PersonCardInteraction"][value];
            }
        }
    }),
    __metadata("design:type", Number)
], MgtPerson.prototype, "personCardInteraction", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'line1-property' }),
    __metadata("design:type", String)
], MgtPerson.prototype, "line1Property", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'line2-property' }),
    __metadata("design:type", String)
], MgtPerson.prototype, "line2Property", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'line3-property' }),
    __metadata("design:type", String)
], MgtPerson.prototype, "line3Property", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        converter: value => {
            if (!value || value.length === 0) {
                return PersonViewType.avatar;
            }
            value = value.toLowerCase();
            if (typeof PersonViewType[value] === 'undefined') {
                return PersonViewType.avatar;
            }
            else {
                return PersonViewType[value];
            }
        }
    }),
    __metadata("design:type", Number)
], MgtPerson.prototype, "view", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["internalProperty"])(),
    __metadata("design:type", String)
], MgtPerson.prototype, "_fetchedImage", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["internalProperty"])(),
    __metadata("design:type", Object)
], MgtPerson.prototype, "_fetchedPresence", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["internalProperty"])(),
    __metadata("design:type", Boolean)
], MgtPerson.prototype, "_isInvalidImageSrc", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["internalProperty"])(),
    __metadata("design:type", Boolean)
], MgtPerson.prototype, "_personCardShouldRender", void 0);
MgtPerson = MgtPerson_1 = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-person'),
    __metadata("design:paramtypes", [])
], MgtPerson);

//# sourceMappingURL=mgt-person.js.map

/***/ }),

/***/ "lPjk":
/*!*************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-organization/strings.js ***!
  \*************************************************************************************************************************************/
/*! exports provided: strings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "strings", function() { return strings; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
const strings = {
    reportsToSectionTitle: 'Reports to',
    directReportsSectionTitle: 'Direct reports',
    organizationSectionTitle: 'Organization',
    youWorkWithSubSectionTitle: 'You work with',
    userWorksWithSubSectionTitle: 'works with'
};
//# sourceMappingURL=strings.js.map

/***/ }),

/***/ "lRz9":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/UserAgentApplication.js ***!
  \**********************************************************************************************************/
/*! exports provided: UserAgentApplication */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserAgentApplication", function() { return UserAgentApplication; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _cache_AccessTokenKey__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cache/AccessTokenKey */ "9eIZ");
/* harmony import */ var _cache_AccessTokenValue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./cache/AccessTokenValue */ "l50I");
/* harmony import */ var _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ServerRequestParameters */ "FbQe");
/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./authority/Authority */ "UYCr");
/* harmony import */ var _ClientInfo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ClientInfo */ "Sje5");
/* harmony import */ var _IdToken__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./IdToken */ "e33W");
/* harmony import */ var _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./cache/AuthCache */ "q5Ih");
/* harmony import */ var _Account__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Account */ "cY1T");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ScopeSet */ "qfGv");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./utils/StringUtils */ "UjIo");
/* harmony import */ var _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./utils/WindowUtils */ "ZVnu");
/* harmony import */ var _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./utils/TokenUtils */ "Tq/z");
/* harmony import */ var _utils_TimeUtils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./utils/TimeUtils */ "b7Qq");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./utils/UrlUtils */ "6r4W");
/* harmony import */ var _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./utils/RequestUtils */ "JeFn");
/* harmony import */ var _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./utils/ResponseUtils */ "6i0k");
/* harmony import */ var _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./authority/AuthorityFactory */ "cGuR");
/* harmony import */ var _Configuration__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Configuration */ "A+Uu");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./error/ClientConfigurationError */ "UBea");
/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./error/AuthError */ "MEWQ");
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./error/ClientAuthError */ "L9Ey");
/* harmony import */ var _error_ServerError__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./error/ServerError */ "n3St");
/* harmony import */ var _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./error/InteractionRequiredAuthError */ "pgW6");
/* harmony import */ var _AuthResponse__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./AuthResponse */ "55I0");
/* harmony import */ var _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./telemetry/TelemetryManager */ "b+K5");
/* harmony import */ var _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./telemetry/ApiEvent */ "BoDS");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./utils/Constants */ "MQw9");
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./utils/CryptoUtils */ "oish");
/* harmony import */ var _authority_TrustedAuthority__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./authority/TrustedAuthority */ "bYYR");
/* harmony import */ var _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./utils/AuthCacheUtils */ "UOdp");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */































// default authority
var DEFAULT_AUTHORITY = "https://login.microsoftonline.com/common";
/**
 * UserAgentApplication class
 *
 * Object Instance that the developer can use to make loginXX OR acquireTokenXX functions
 */
var UserAgentApplication = /** @class */ (function () {
    /**
     * @constructor
     * Constructor for the UserAgentApplication used to instantiate the UserAgentApplication object
     *
     * Important attributes in the Configuration object for auth are:
     * - clientID: the application ID of your application.
     * You can obtain one by registering your application with our Application registration portal : https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredAppsPreview
     * - authority: the authority URL for your application.
     *
     * In Azure AD, authority is a URL indicating the Azure active directory that MSAL uses to obtain tokens.
     * It is of the form https://login.microsoftonline.com/&lt;Enter_the_Tenant_Info_Here&gt;.
     * If your application supports Accounts in one organizational directory, replace "Enter_the_Tenant_Info_Here" value with the Tenant Id or Tenant name (for example, contoso.microsoft.com).
     * If your application supports Accounts in any organizational directory, replace "Enter_the_Tenant_Info_Here" value with organizations.
     * If your application supports Accounts in any organizational directory and personal Microsoft accounts, replace "Enter_the_Tenant_Info_Here" value with common.
     * To restrict support to Personal Microsoft accounts only, replace "Enter_the_Tenant_Info_Here" value with consumers.
     *
     *
     * In Azure B2C, authority is of the form https://&lt;instance&gt;/tfp/&lt;tenant&gt;/&lt;policyName&gt;/
     *
     * @param {@link (Configuration:type)} configuration object for the MSAL UserAgentApplication instance
     */
    function UserAgentApplication(configuration) {
        // callbacks for token/error
        this.authResponseCallback = null;
        this.tokenReceivedCallback = null;
        this.errorReceivedCallback = null;
        // Set the Configuration
        this.config = Object(_Configuration__WEBPACK_IMPORTED_MODULE_18__["buildConfiguration"])(configuration);
        this.logger = this.config.system.logger;
        this.clientId = this.config.auth.clientId;
        this.inCookie = this.config.cache.storeAuthStateInCookie;
        this.telemetryManager = this.getTelemetryManagerFromConfig(this.config.system.telemetry, this.clientId);
        _authority_TrustedAuthority__WEBPACK_IMPORTED_MODULE_29__["TrustedAuthority"].setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority, this.config.auth.knownAuthorities);
        _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromConfig(this.config.auth.authority, this.config.auth.authorityMetadata);
        // if no authority is passed, set the default: "https://login.microsoftonline.com/common"
        this.authority = this.config.auth.authority || DEFAULT_AUTHORITY;
        // cache keys msal - typescript throws an error if any value other than "localStorage" or "sessionStorage" is passed
        this.cacheStorage = new _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"](this.clientId, this.config.cache.cacheLocation, this.inCookie);
        // Initialize window handling code
        window.activeRenewals = {};
        window.renewStates = [];
        window.callbackMappedToRenewStates = {};
        window.promiseMappedToRenewStates = {};
        window.msal = this;
        var urlHash = window.location.hash;
        var urlContainsHash = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlContainsHash(urlHash);
        // check if back button is pressed
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].checkIfBackButtonIsPressed(this.cacheStorage);
        // On the server 302 - Redirect, handle this
        if (urlContainsHash) {
            var stateInfo = this.getResponseState(urlHash);
            if (stateInfo.method === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
                this.handleRedirectAuthenticationResponse(urlHash);
            }
        }
    }
    Object.defineProperty(UserAgentApplication.prototype, "authority", {
        /**
         * Method to manage the authority URL.
         *
         * @returns {string} authority
         */
        get: function () {
            return this.authorityInstance.CanonicalAuthority;
        },
        /**
         * setter for the authority URL
         * @param {string} authority
         */
        // If the developer passes an authority, create an instance
        set: function (val) {
            this.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(val, this.config.auth.validateAuthority);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Get the current authority instance from the MSAL configuration object
     *
     * @returns {@link Authority} authority instance
     */
    UserAgentApplication.prototype.getAuthorityInstance = function () {
        return this.authorityInstance;
    };
    UserAgentApplication.prototype.handleRedirectCallback = function (authOrTokenCallback, errorReceivedCallback) {
        if (!authOrTokenCallback) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createInvalidCallbackObjectError(authOrTokenCallback);
        }
        // Set callbacks
        if (errorReceivedCallback) {
            this.tokenReceivedCallback = authOrTokenCallback;
            this.errorReceivedCallback = errorReceivedCallback;
            this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).");
        }
        else {
            this.authResponseCallback = authOrTokenCallback;
        }
        if (this.redirectError) {
            this.authErrorHandler(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, this.redirectError, this.redirectResponse);
        }
        else if (this.redirectResponse) {
            this.authResponseHandler(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, this.redirectResponse);
        }
    };
    /**
     * Public API to verify if the URL contains the hash with known properties
     * @param hash
     */
    UserAgentApplication.prototype.urlContainsHash = function (hash) {
        this.logger.verbose("UrlContainsHash has been called");
        return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlContainsHash(hash);
    };
    UserAgentApplication.prototype.authResponseHandler = function (interactionType, response, resolve) {
        this.logger.verbose("AuthResponseHandler has been called");
        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
            this.logger.verbose("Interaction type is redirect");
            if (this.errorReceivedCallback) {
                this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response");
                this.tokenReceivedCallback(response);
            }
            else if (this.authResponseCallback) {
                this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response");
                this.authResponseCallback(null, response);
            }
        }
        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup) {
            this.logger.verbose("Interaction type is popup, resolving");
            resolve(response);
        }
        else {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidInteractionTypeError();
        }
    };
    UserAgentApplication.prototype.authErrorHandler = function (interactionType, authErr, response, reject) {
        this.logger.verbose("AuthErrorHandler has been called");
        // set interaction_status to complete
        this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
            this.logger.verbose("Interaction type is redirect");
            if (this.errorReceivedCallback) {
                this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback");
                this.errorReceivedCallback(authErr, response.accountState);
            }
            else if (this.authResponseCallback) {
                this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error");
                this.authResponseCallback(authErr, response);
            }
            else {
                this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error");
                throw authErr;
            }
        }
        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup) {
            this.logger.verbose("Interaction type is popup, rejecting");
            reject(authErr);
        }
        else {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidInteractionTypeError();
        }
    };
    // #endregion
    /**
     * Use when initiating the login process by redirecting the user's browser to the authorization endpoint.
     * @param {@link (AuthenticationParameters:type)}
     */
    UserAgentApplication.prototype.loginRedirect = function (userRequest) {
        this.logger.verbose("LoginRedirect has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, true, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect);
        this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, true, request, null, null);
    };
    /**
     * Use when you want to obtain an access_token for your API by redirecting the user's browser window to the authorization endpoint.
     * @param {@link (AuthenticationParameters:type)}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     */
    UserAgentApplication.prototype.acquireTokenRedirect = function (userRequest) {
        this.logger.verbose("AcquireTokenRedirect has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect);
        this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect, false, request, null, null);
    };
    /**
     * Use when initiating the login process via opening a popup window in the user's browser
     *
     * @param {@link (AuthenticationParameters:type)}
     *
     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object
     */
    UserAgentApplication.prototype.loginPopup = function (userRequest) {
        var _this = this;
        this.logger.verbose("LoginPopup has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, true, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup);
        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].LoginPopup);
        return new Promise(function (resolve, reject) {
            _this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup, true, request, resolve, reject);
        })
            .then(function (resp) {
            _this.logger.verbose("Successfully logged in");
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);
            return resp;
        })
            .catch(function (error) {
            _this.cacheStorage.resetTempCacheItems(request.state);
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);
            throw error;
        });
    };
    /**
     * Use when you want to obtain an access_token for your API via opening a popup window in the user's browser
     * @param {@link AuthenticationParameters}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object
     */
    UserAgentApplication.prototype.acquireTokenPopup = function (userRequest) {
        var _this = this;
        this.logger.verbose("AcquireTokenPopup has been called");
        // validate request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup);
        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].AcquireTokenPopup);
        return new Promise(function (resolve, reject) {
            _this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup, false, request, resolve, reject);
        })
            .then(function (resp) {
            _this.logger.verbose("Successfully acquired token");
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);
            return resp;
        })
            .catch(function (error) {
            _this.cacheStorage.resetTempCacheItems(request.state);
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);
            throw error;
        });
    };
    // #region Acquire Token
    /**
     * Use when initiating the login process or when you want to obtain an access_token for your API,
     * either by redirecting the user's browser window to the authorization endpoint or via opening a popup window in the user's browser.
     * @param {@link (AuthenticationParameters:type)}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     */
    UserAgentApplication.prototype.acquireTokenInteractive = function (interactionType, isLoginCall, request, resolve, reject) {
        var _this = this;
        this.logger.verbose("AcquireTokenInteractive has been called");
        // block the request if made from the hidden iframe
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].blockReloadInHiddenIframes();
        var interactionProgress = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].REDIRECT_REQUEST, "" + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].resourceDelimiter + request.state);
        }
        // If already in progress, do not proceed
        if (interactionProgress === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress) {
            var thrownError = isLoginCall ? _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createLoginInProgressError() : _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createAcquireTokenInProgressError();
            var stateOnlyResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(this.getAccountState(request.state));
            this.cacheStorage.resetTempCacheItems(request.state);
            this.authErrorHandler(interactionType, thrownError, stateOnlyResponse, reject);
            return;
        }
        // Get the account object if a session exists
        var account;
        if (request && request.account && !isLoginCall) {
            account = request.account;
            this.logger.verbose("Account set from request");
        }
        else {
            account = this.getAccount();
            this.logger.verbose("Account set from MSAL Cache");
        }
        // If no session exists, prompt the user to login.
        if (!account && !_ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].isSSOParam(request)) {
            if (isLoginCall) {
                // extract ADAL id_token if exists
                var adalIdToken = this.extractADALIdToken();
                // silent login if ADAL id_token is retrieved successfully - SSO
                if (adalIdToken && !request.scopes) {
                    this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");
                    var tokenRequest = this.buildIDTokenRequest(request);
                    this.silentLogin = true;
                    this.acquireTokenSilent(tokenRequest).then(function (response) {
                        _this.silentLogin = false;
                        _this.logger.info("Unified cache call is successful");
                        _this.authResponseHandler(interactionType, response, resolve);
                        return;
                    }, function (error) {
                        _this.silentLogin = false;
                        _this.logger.error("Error occurred during unified cache ATS: " + error);
                        // proceed to login since ATS failed
                        _this.acquireTokenHelper(null, interactionType, isLoginCall, request, resolve, reject);
                    });
                }
                // No ADAL token found, proceed to login
                else {
                    this.logger.verbose("Login call but no token found, proceed to login");
                    this.acquireTokenHelper(null, interactionType, isLoginCall, request, resolve, reject);
                }
            }
            // AcquireToken call, but no account or context given, so throw error
            else {
                this.logger.verbose("AcquireToken call, no context or account given");
                this.logger.info("User login is required");
                var stateOnlyResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(this.getAccountState(request.state));
                this.cacheStorage.resetTempCacheItems(request.state);
                this.authErrorHandler(interactionType, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createUserLoginRequiredError(), stateOnlyResponse, reject);
                return;
            }
        }
        // User session exists
        else {
            this.logger.verbose("User session exists, login not required");
            this.acquireTokenHelper(account, interactionType, isLoginCall, request, resolve, reject);
        }
    };
    /**
     * @hidden
     * @ignore
     * Helper function to acquireToken
     *
     */
    UserAgentApplication.prototype.acquireTokenHelper = function (account, interactionType, isLoginCall, request, resolve, reject) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var requestSignature, serverAuthenticationRequest, acquireTokenAuthority, popUpWindow, responseType, loginStartPage, urlNavigate, hash, error_1, navigate, err_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.logger.verbose("AcquireTokenHelper has been called");
                        this.logger.verbose("Interaction type: " + interactionType + ". isLoginCall: " + isLoginCall);
                        // Track the acquireToken progress
                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress);
                        requestSignature = request.scopes ? request.scopes.join(" ").toLowerCase() : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes.join(" ");
                        this.logger.verbosePii("Request signature: " + requestSignature);
                        acquireTokenAuthority = (request && request.authority) ? _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata) : this.authorityInstance;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 11, , 12]);
                        if (!!acquireTokenAuthority.hasCachedMetadata()) return [3 /*break*/, 3];
                        this.logger.verbose("No cached metadata for authority");
                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromNetwork(acquireTokenAuthority, this.telemetryManager, request.correlationId)];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.logger.verbose("Cached metadata found for authority");
                        _a.label = 4;
                    case 4:
                        responseType = isLoginCall ? _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ResponseTypes"].id_token : this.getTokenType(account, request.scopes);
                        loginStartPage = request.redirectStartPage || window.location.href;
                        serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"](acquireTokenAuthority, this.clientId, responseType, this.getRedirectUri(request && request.redirectUri), request.scopes, request.state, request.correlationId);
                        this.logger.verbose("Finished building server authentication request");
                        this.updateCacheEntries(serverAuthenticationRequest, account, isLoginCall, loginStartPage);
                        this.logger.verbose("Updating cache entries");
                        // populate QueryParameters (sid/login_hint) and any other extraQueryParameters set by the developer
                        serverAuthenticationRequest.populateQueryParams(account, request);
                        this.logger.verbose("Query parameters populated from account");
                        urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].createNavigateUrl(serverAuthenticationRequest) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].response_mode_fragment;
                        // set state in cache
                        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeRedirect) {
                            if (!isLoginCall) {
                                this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_ACQ_TOKEN, request.state), serverAuthenticationRequest.state, this.inCookie);
                                this.logger.verbose("State cached for redirect");
                                this.logger.verbosePii("State cached: " + serverAuthenticationRequest.state);
                            }
                            else {
                                this.logger.verbose("Interaction type redirect but login call is true. State not cached");
                            }
                        }
                        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup) {
                            window.renewStates.push(serverAuthenticationRequest.state);
                            window.requestType = isLoginCall ? _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
                            this.logger.verbose("State saved to window");
                            this.logger.verbosePii("State saved: " + serverAuthenticationRequest.state);
                            // Register callback to capture results from server
                            this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);
                        }
                        else {
                            this.logger.verbose("Invalid interaction error. State not cached");
                            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidInteractionTypeError();
                        }
                        if (!(interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypePopup)) return [3 /*break*/, 9];
                        this.logger.verbose("Interaction type is popup. Generating popup window");
                        // Generate a popup window
                        try {
                            popUpWindow = this.openPopup(urlNavigate, "msal", _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].popUpWidth, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].popUpHeight);
                            // Push popup window handle onto stack for tracking
                            _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].trackPopup(popUpWindow);
                        }
                        catch (e) {
                            this.logger.info(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.code + ":" + _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.desc);
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.code);
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthErrorMessage"].popUpWindowError.desc);
                            if (reject) {
                                reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createPopupWindowError());
                                return [2 /*return*/];
                            }
                        }
                        if (!popUpWindow) return [3 /*break*/, 8];
                        _a.label = 5;
                    case 5:
                        _a.trys.push([5, 7, , 8]);
                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].monitorPopupForHash(popUpWindow, this.config.system.loadFrameTimeout, urlNavigate, this.logger)];
                    case 6:
                        hash = _a.sent();
                        this.handleAuthenticationResponse(hash);
                        // Request completed successfully, set to completed
                        this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
                        this.logger.info("Closing popup window");
                        // TODO: Check how this can be extracted for any framework specific code?
                        if (this.config.framework.isAngular) {
                            this.broadcast("msal:popUpHashChanged", hash);
                        }
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].closePopups();
                        return [3 /*break*/, 8];
                    case 7:
                        error_1 = _a.sent();
                        if (reject) {
                            reject(error_1);
                        }
                        if (this.config.framework.isAngular) {
                            this.broadcast("msal:popUpClosed", error_1.errorCode + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].resourceDelimiter + error_1.errorMessage);
                        }
                        else {
                            // Request failed, set to canceled
                            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
                            popUpWindow.close();
                        }
                        return [3 /*break*/, 8];
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        // If onRedirectNavigate is implemented, invoke it and provide urlNavigate
                        if (request.onRedirectNavigate) {
                            this.logger.verbose("Invoking onRedirectNavigate callback");
                            navigate = request.onRedirectNavigate(urlNavigate);
                            // Returning false from onRedirectNavigate will stop navigation
                            if (navigate !== false) {
                                this.logger.verbose("onRedirectNavigate did not return false, navigating");
                                this.navigateWindow(urlNavigate);
                            }
                            else {
                                this.logger.verbose("onRedirectNavigate returned false, stopping navigation");
                            }
                        }
                        else {
                            // Otherwise, perform navigation
                            this.logger.verbose("Navigating window to urlNavigate");
                            this.navigateWindow(urlNavigate);
                        }
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        err_1 = _a.sent();
                        this.logger.error(err_1);
                        this.cacheStorage.resetTempCacheItems(request.state);
                        this.authErrorHandler(interactionType, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createEndpointResolutionError(err_1.toString), Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(request.state), reject);
                        if (popUpWindow) {
                            popUpWindow.close();
                        }
                        return [3 /*break*/, 12];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * API interfacing idToken request when applications already have a session/hint acquired by authorization client applications
     * @param request
     */
    UserAgentApplication.prototype.ssoSilent = function (request) {
        this.logger.verbose("ssoSilent has been called");
        // throw an error on an empty request
        if (!request) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createEmptyRequestError();
        }
        // throw an error on no hints passed
        if (!request.sid && !request.loginHint) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createSsoSilentError();
        }
        return this.acquireTokenSilent(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, request, { scopes: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes }));
    };
    /**
     * Use this function to obtain a token before every call to the API / resource provider
     *
     * MSAL return's a cached token when available
     * Or it send's a request to the STS to obtain a new token using a hidden iframe.
     *
     * @param {@link AuthenticationParameters}
     *
     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters
     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object
     *
     */
    UserAgentApplication.prototype.acquireTokenSilent = function (userRequest) {
        var _this = this;
        this.logger.verbose("AcquireTokenSilent has been called");
        // validate the request
        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].interactionTypeSilent);
        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].AcquireTokenSilent);
        var requestSignature = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].createRequestSignature(request);
        return new Promise(function (resolve, reject) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
            var scope, account, adalIdToken, responseType, serverAuthenticationRequest, adalIdTokenObject, userContainedClaims, authErr, cacheResultResponse, logMessage, err_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        // block the request if made from the hidden iframe
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].blockReloadInHiddenIframes();
                        scope = request.scopes.join(" ").toLowerCase();
                        this.logger.verbosePii("Serialized scopes: " + scope);
                        if (request.account) {
                            account = request.account;
                            this.logger.verbose("Account set from request");
                        }
                        else {
                            account = this.getAccount();
                            this.logger.verbose("Account set from MSAL Cache");
                        }
                        adalIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].adalIdToken);
                        // In the event of no account being passed in the config, no session id, and no pre-existing adalIdToken, user will need to log in
                        if (!account && !(request.sid || request.loginHint) && _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(adalIdToken)) {
                            this.logger.info("User login is required");
                            // The promise rejects with a UserLoginRequiredError, which should be caught and user should be prompted to log in interactively
                            return [2 /*return*/, reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createUserLoginRequiredError())];
                        }
                        responseType = this.getTokenType(account, request.scopes);
                        this.logger.verbose("Response type: " + responseType);
                        serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"](_authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata), this.clientId, responseType, this.getRedirectUri(request.redirectUri), request.scopes, request.state, request.correlationId);
                        this.logger.verbose("Finished building server authentication request");
                        // populate QueryParameters (sid/login_hint) and any other extraQueryParameters set by the developer
                        if (_ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].isSSOParam(request) || account) {
                            serverAuthenticationRequest.populateQueryParams(account, request, null, true);
                            this.logger.verbose("Query parameters populated from existing SSO or account");
                        }
                        // if user didn't pass login_hint/sid and adal's idtoken is present, extract the login_hint from the adalIdToken
                        else if (!account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(adalIdToken)) {
                            adalIdTokenObject = _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__["TokenUtils"].extractIdToken(adalIdToken);
                            this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters");
                            serverAuthenticationRequest.populateQueryParams(account, null, adalIdTokenObject, true);
                        }
                        else {
                            this.logger.verbose("No additional query parameters added");
                        }
                        userContainedClaims = request.claimsRequest || serverAuthenticationRequest.claimsValue;
                        // If request.forceRefresh is set to true, force a request for a new token instead of getting it from the cache
                        if (!userContainedClaims && !request.forceRefresh) {
                            try {
                                cacheResultResponse = this.getCachedToken(serverAuthenticationRequest, account);
                            }
                            catch (e) {
                                authErr = e;
                            }
                        }
                        if (!cacheResultResponse) return [3 /*break*/, 1];
                        this.logger.verbose("Token found in cache lookup");
                        this.logger.verbosePii("Scopes found: " + JSON.stringify(cacheResultResponse.scopes));
                        resolve(cacheResultResponse);
                        return [2 /*return*/, null];
                    case 1:
                        if (!authErr) return [3 /*break*/, 2];
                        this.logger.infoPii(authErr.errorCode + ":" + authErr.errorMessage);
                        reject(authErr);
                        return [2 /*return*/, null];
                    case 2:
                        logMessage = void 0;
                        if (userContainedClaims) {
                            logMessage = "Skipped cache lookup since claims were given";
                        }
                        else if (request.forceRefresh) {
                            logMessage = "Skipped cache lookup since request.forceRefresh option was set to true";
                        }
                        else {
                            logMessage = "No valid token found in cache lookup";
                        }
                        this.logger.verbose(logMessage);
                        // Cache result can return null if cache is empty. In that case, set authority to default value if no authority is passed to the API.
                        if (!serverAuthenticationRequest.authorityInstance) {
                            serverAuthenticationRequest.authorityInstance = request.authority ?
                                _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata)
                                : this.authorityInstance;
                        }
                        this.logger.verbosePii("Authority instance: " + serverAuthenticationRequest.authority);
                        _a.label = 3;
                    case 3:
                        _a.trys.push([3, 7, , 8]);
                        if (!!serverAuthenticationRequest.authorityInstance.hasCachedMetadata()) return [3 /*break*/, 5];
                        this.logger.verbose("No cached metadata for authority");
                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromNetwork(serverAuthenticationRequest.authorityInstance, this.telemetryManager, request.correlationId)];
                    case 4:
                        _a.sent();
                        this.logger.verbose("Authority has been updated with endpoint discovery response");
                        return [3 /*break*/, 6];
                    case 5:
                        this.logger.verbose("Cached metadata found for authority");
                        _a.label = 6;
                    case 6:
                        /*
                         * refresh attempt with iframe
                         * Already renewing for this scope, callback when we get the token.
                         */
                        if (window.activeRenewals[requestSignature]) {
                            this.logger.verbose("Renewing token in progress. Registering callback");
                            // Active renewals contains the state for each renewal.
                            this.registerCallback(window.activeRenewals[requestSignature], requestSignature, resolve, reject);
                        }
                        else {
                            if (request.scopes && _ScopeSet__WEBPACK_IMPORTED_MODULE_9__["ScopeSet"].onlyContainsOidcScopes(request.scopes)) {
                                /*
                                 * App uses idToken to send to api endpoints
                                 * Default scope is tracked as OIDC scopes to store this token
                                 */
                                this.logger.verbose("OpenID Connect scopes only, renewing idToken");
                                this.silentLogin = true;
                                this.renewIdToken(requestSignature, resolve, reject, account, serverAuthenticationRequest);
                            }
                            else {
                                // renew access token
                                this.logger.verbose("Renewing access token");
                                this.renewToken(requestSignature, resolve, reject, account, serverAuthenticationRequest);
                            }
                        }
                        return [3 /*break*/, 8];
                    case 7:
                        err_2 = _a.sent();
                        this.logger.error(err_2);
                        reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createEndpointResolutionError(err_2.toString()));
                        return [2 /*return*/, null];
                    case 8: return [2 /*return*/];
                }
            });
        }); })
            .then(function (res) {
            _this.logger.verbose("Successfully acquired token");
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);
            return res;
        })
            .catch(function (error) {
            _this.cacheStorage.resetTempCacheItems(request.state);
            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);
            throw error;
        });
    };
    // #endregion
    // #region Popup Window Creation
    /**
     * @hidden
     *
     * Configures popup window for login.
     *
     * @param urlNavigate
     * @param title
     * @param popUpWidth
     * @param popUpHeight
     * @ignore
     * @hidden
     */
    UserAgentApplication.prototype.openPopup = function (urlNavigate, title, popUpWidth, popUpHeight) {
        this.logger.verbose("OpenPopup has been called");
        try {
            /**
             * adding winLeft and winTop to account for dual monitor
             * using screenLeft and screenTop for IE8 and earlier
             */
            var winLeft = window.screenLeft ? window.screenLeft : window.screenX;
            var winTop = window.screenTop ? window.screenTop : window.screenY;
            /**
             * window.innerWidth displays browser window"s height and width excluding toolbars
             * using document.documentElement.clientWidth for IE8 and earlier
             */
            var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            var height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
            var left = ((width / 2) - (popUpWidth / 2)) + winLeft;
            var top_1 = ((height / 2) - (popUpHeight / 2)) + winTop;
            // open the window
            var popupWindow = window.open(urlNavigate, title, "width=" + popUpWidth + ", height=" + popUpHeight + ", top=" + top_1 + ", left=" + left + ", scrollbars=yes");
            if (!popupWindow) {
                throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createPopupWindowError();
            }
            if (popupWindow.focus) {
                popupWindow.focus();
            }
            return popupWindow;
        }
        catch (e) {
            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createPopupWindowError(e.toString());
        }
    };
    // #endregion
    // #region Iframe Management
    /**
     * @hidden
     * Calling _loadFrame but with a timeout to signal failure in loadframeStatus. Callbacks are left.
     * registered when network errors occur and subsequent token requests for same resource are registered to the pending request.
     * @ignore
     */
    UserAgentApplication.prototype.loadIframeTimeout = function (urlNavigate, frameName, requestSignature) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var expectedState, iframe, _a, hash, error_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        expectedState = window.activeRenewals[requestSignature];
                        this.logger.verbosePii("Set loading state to pending for: " + requestSignature + ":" + expectedState);
                        this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, expectedState), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress);
                        if (!this.config.system.navigateFrameWait) return [3 /*break*/, 2];
                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].loadFrame(urlNavigate, frameName, this.config.system.navigateFrameWait, this.logger)];
                    case 1:
                        _a = _b.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        _a = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].loadFrameSync(urlNavigate, frameName, this.logger);
                        _b.label = 3;
                    case 3:
                        iframe = _a;
                        _b.label = 4;
                    case 4:
                        _b.trys.push([4, 6, , 7]);
                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].monitorIframeForHash(iframe.contentWindow, this.config.system.loadFrameTimeout, urlNavigate, this.logger)];
                    case 5:
                        hash = _b.sent();
                        if (hash) {
                            this.handleAuthenticationResponse(hash);
                        }
                        return [3 /*break*/, 7];
                    case 6:
                        error_2 = _b.sent();
                        if (this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, expectedState)) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress) {
                            // fail the iframe session if it's in pending state
                            this.logger.verbose("Loading frame has timed out after: " + (this.config.system.loadFrameTimeout / 1000) + " seconds for scope/authority " + requestSignature + ":" + expectedState);
                            // Error after timeout
                            if (expectedState && window.callbackMappedToRenewStates[expectedState]) {
                                window.callbackMappedToRenewStates[expectedState](null, error_2);
                            }
                            this.cacheStorage.removeItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, expectedState));
                        }
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].removeHiddenIframe(iframe);
                        throw error_2;
                    case 7:
                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].removeHiddenIframe(iframe);
                        return [2 /*return*/];
                }
            });
        });
    };
    // #endregion
    // #region General Helpers
    /**
     * @hidden
     * Used to redirect the browser to the STS authorization endpoint
     * @param {string} urlNavigate - URL of the authorization endpoint
     */
    UserAgentApplication.prototype.navigateWindow = function (urlNavigate, popupWindow) {
        // Navigate if valid URL
        if (urlNavigate && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(urlNavigate)) {
            var navigateWindow = popupWindow ? popupWindow : window;
            var logMessage = popupWindow ? "Navigated Popup window to:" + urlNavigate : "Navigate to:" + urlNavigate;
            this.logger.infoPii(logMessage);
            navigateWindow.location.assign(urlNavigate);
        }
        else {
            this.logger.info("Navigate url is empty");
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Navigate url is empty");
        }
    };
    /**
     * @hidden
     * Used to add the developer requested callback to the array of callbacks for the specified scopes. The updated array is stored on the window object
     * @param {string} expectedState - Unique state identifier (guid).
     * @param {string} scope - Developer requested permissions. Not all scopes are guaranteed to be included in the access token returned.
     * @param {Function} resolve - The resolve function of the promise object.
     * @param {Function} reject - The reject function of the promise object.
     * @ignore
     */
    UserAgentApplication.prototype.registerCallback = function (expectedState, requestSignature, resolve, reject) {
        var _this = this;
        // track active renewals
        window.activeRenewals[requestSignature] = expectedState;
        // initialize callbacks mapped array
        if (!window.promiseMappedToRenewStates[expectedState]) {
            window.promiseMappedToRenewStates[expectedState] = [];
        }
        // indexing on the current state, push the callback params to callbacks mapped
        window.promiseMappedToRenewStates[expectedState].push({ resolve: resolve, reject: reject });
        // Store the server response in the current window??
        if (!window.callbackMappedToRenewStates[expectedState]) {
            window.callbackMappedToRenewStates[expectedState] = function (response, error) {
                // reset active renewals
                window.activeRenewals[requestSignature] = null;
                // for all promiseMappedtoRenewStates for a given 'state' - call the reject/resolve with error/token respectively
                for (var i = 0; i < window.promiseMappedToRenewStates[expectedState].length; ++i) {
                    try {
                        if (error) {
                            window.promiseMappedToRenewStates[expectedState][i].reject(error);
                        }
                        else if (response) {
                            window.promiseMappedToRenewStates[expectedState][i].resolve(response);
                        }
                        else {
                            _this.cacheStorage.resetTempCacheItems(expectedState);
                            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Error and response are both null");
                        }
                    }
                    catch (e) {
                        _this.logger.warning(e);
                    }
                }
                // reset
                window.promiseMappedToRenewStates[expectedState] = null;
                window.callbackMappedToRenewStates[expectedState] = null;
            };
        }
    };
    // #endregion
    // #region Logout
    /**
     * Use to log out the current user, and redirect the user to the postLogoutRedirectUri.
     * Default behaviour is to redirect the user to `window.location.href`.
     */
    UserAgentApplication.prototype.logout = function (correlationId) {
        this.logger.verbose("Logout has been called");
        this.logoutAsync(correlationId);
    };
    /**
     * Async version of logout(). Use to log out the current user.
     * @param correlationId Request correlationId
     */
    UserAgentApplication.prototype.logoutAsync = function (correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var requestCorrelationId, apiEvent, correlationIdParam, postLogoutQueryParam, urlNavigate, error_3;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        requestCorrelationId = correlationId || _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_28__["CryptoUtils"].createNewGuid();
                        apiEvent = this.telemetryManager.createAndStartApiEvent(requestCorrelationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__["API_EVENT_IDENTIFIER"].Logout);
                        this.clearCache();
                        this.account = null;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 5, , 6]);
                        if (!!this.authorityInstance.hasCachedMetadata()) return [3 /*break*/, 3];
                        this.logger.verbose("No cached metadata for authority");
                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].saveMetadataFromNetwork(this.authorityInstance, this.telemetryManager, correlationId)];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.logger.verbose("Cached metadata found for authority");
                        _a.label = 4;
                    case 4:
                        correlationIdParam = "client-request-id=" + requestCorrelationId;
                        postLogoutQueryParam = void 0;
                        if (this.getPostLogoutRedirectUri()) {
                            postLogoutQueryParam = "&post_logout_redirect_uri=" + encodeURIComponent(this.getPostLogoutRedirectUri());
                            this.logger.verbose("redirectUri found and set");
                        }
                        else {
                            postLogoutQueryParam = "";
                            this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty");
                        }
                        urlNavigate = void 0;
                        if (this.authorityInstance.EndSessionEndpoint) {
                            urlNavigate = this.authorityInstance.EndSessionEndpoint + "?" + correlationIdParam + postLogoutQueryParam;
                            this.logger.verbose("EndSessionEndpoint found and urlNavigate set");
                            this.logger.verbosePii("urlNavigate set to: " + this.authorityInstance.EndSessionEndpoint);
                        }
                        else {
                            urlNavigate = this.authority + "oauth2/v2.0/logout?" + correlationIdParam + postLogoutQueryParam;
                            this.logger.verbose("No endpoint, urlNavigate set to default");
                        }
                        this.telemetryManager.stopAndFlushApiEvent(requestCorrelationId, apiEvent, true);
                        this.logger.verbose("Navigating window to urlNavigate");
                        this.navigateWindow(urlNavigate);
                        return [3 /*break*/, 6];
                    case 5:
                        error_3 = _a.sent();
                        this.telemetryManager.stopAndFlushApiEvent(requestCorrelationId, apiEvent, false, error_3.errorCode);
                        return [3 /*break*/, 6];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * @hidden
     * Clear all access tokens and ID tokens in the cache.
     * @ignore
     */
    UserAgentApplication.prototype.clearCache = function () {
        this.logger.verbose("Clearing cache");
        window.renewStates = [];
        var tokenCacheItems = this.cacheStorage.getAllTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].homeAccountIdentifier);
        for (var i = 0; i < tokenCacheItems.length; i++) {
            this.cacheStorage.removeItem(JSON.stringify(tokenCacheItems[i].key));
        }
        this.cacheStorage.resetCacheItems();
        this.cacheStorage.clearMsalCookie();
        this.logger.verbose("Cache cleared");
    };
    /**
     * @hidden
     * Clear a given access token from the cache.
     *
     * @param accessToken
     */
    UserAgentApplication.prototype.clearCacheForScope = function (accessToken) {
        this.logger.verbose("Clearing access token from cache");
        var accessTokenItems = this.cacheStorage.getAllAccessTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].homeAccountIdentifier);
        for (var i = 0; i < accessTokenItems.length; i++) {
            var token = accessTokenItems[i];
            if (token.value.accessToken === accessToken) {
                this.cacheStorage.removeItem(JSON.stringify(token.key));
                this.logger.verbosePii("Access token removed: " + token.key);
            }
        }
    };
    // #endregion
    // #region Response
    /**
     * @hidden
     * @ignore
     * Checks if the redirect response is received from the STS. In case of redirect, the url fragment has either id_token, access_token or error.
     * @param {string} hash - Hash passed from redirect page.
     * @returns {Boolean} - true if response contains id_token, access_token or error, false otherwise.
     */
    UserAgentApplication.prototype.isCallback = function (hash) {
        this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0.");
        this.logger.verbose("isCallback has been called");
        return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlContainsHash(hash);
    };
    /**
     * @hidden
     * Used to call the constructor callback with the token/error
     * @param {string} [hash=window.location.hash] - Hash fragment of Url.
     */
    UserAgentApplication.prototype.processCallBack = function (hash, stateInfo, parentCallback) {
        this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");
        // get the state info from the hash
        if (!stateInfo) {
            this.logger.verbose("StateInfo is null, getting stateInfo from hash");
            stateInfo = this.getResponseState(hash);
        }
        var response;
        var authErr;
        // Save the token info from the hash
        try {
            response = this.saveTokenFromHash(hash, stateInfo);
        }
        catch (err) {
            authErr = err;
        }
        try {
            // Clear the cookie in the hash
            this.cacheStorage.clearMsalCookie(stateInfo.state);
            var accountState = this.getAccountState(stateInfo.state);
            if (response) {
                if ((stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken) || response.accessToken) {
                    if (window.parent !== window) {
                        this.logger.verbose("Window is in iframe, acquiring token silently");
                    }
                    else {
                        this.logger.verbose("Acquiring token interactive in progress");
                    }
                    this.logger.verbose("Response tokenType set to " + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN);
                    response.tokenType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN;
                }
                else if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login) {
                    this.logger.verbose("Response tokenType set to " + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN);
                    response.tokenType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN;
                }
                if (!parentCallback) {
                    this.logger.verbose("Setting redirectResponse");
                    this.redirectResponse = response;
                    return;
                }
            }
            else if (!parentCallback) {
                this.logger.verbose("Response is null, setting redirectResponse with state");
                this.redirectResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__["buildResponseStateOnly"])(accountState);
                this.redirectError = authErr;
                this.cacheStorage.resetTempCacheItems(stateInfo.state);
                return;
            }
            this.logger.verbose("Calling callback provided to processCallback");
            parentCallback(response, authErr);
        }
        catch (err) {
            this.logger.error("Error occurred in token received callback function: " + err);
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createErrorInCallbackFunction(err.toString());
        }
    };
    /**
     * @hidden
     * This method must be called for processing the response received from the STS if using popups or iframes. It extracts the hash, processes the token or error
     * information and saves it in the cache. It then resolves the promises with the result.
     * @param {string} [hash=window.location.hash] - Hash fragment of Url.
     */
    UserAgentApplication.prototype.handleAuthenticationResponse = function (hash) {
        this.logger.verbose("HandleAuthenticationResponse has been called");
        // retrieve the hash
        var locationHash = hash || window.location.hash;
        // if (window.parent !== window), by using self, window.parent becomes equal to window in getResponseState method specifically
        var stateInfo = this.getResponseState(locationHash);
        this.logger.verbose("Obtained state from response");
        var tokenResponseCallback = window.callbackMappedToRenewStates[stateInfo.state];
        this.processCallBack(locationHash, stateInfo, tokenResponseCallback);
    };
    /**
     * @hidden
     * This method must be called for processing the response received from the STS when using redirect flows. It extracts the hash, processes the token or error
     * information and saves it in the cache. The result can then be accessed by user registered callbacks.
     * @param {string} [hash=window.location.hash] - Hash fragment of Url.
     */
    UserAgentApplication.prototype.handleRedirectAuthenticationResponse = function (hash) {
        this.logger.info("Returned from redirect url");
        this.logger.verbose("HandleRedirectAuthenticationResponse has been called");
        // clear hash from window
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].clearUrlFragment();
        this.logger.verbose("Window.location.hash cleared");
        // if (window.parent !== window), by using self, window.parent becomes equal to window in getResponseState method specifically
        var stateInfo = this.getResponseState(hash);
        // if set to navigate to loginRequest page post login
        if (this.config.auth.navigateToLoginRequestUrl && window.parent === window) {
            this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");
            var loginRequestUrl = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].LOGIN_REQUEST, stateInfo.state), this.inCookie);
            // Redirect to home page if login request url is null (real null or the string null)
            if (!loginRequestUrl || loginRequestUrl === "null") {
                this.logger.error("Unable to get valid login request url from cache, redirecting to home page");
                window.location.assign("/");
                return;
            }
            else {
                this.logger.verbose("Valid login request url obtained from cache");
                var currentUrl = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].removeHashFromUrl(window.location.href);
                var finalRedirectUrl = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].removeHashFromUrl(loginRequestUrl);
                if (currentUrl !== finalRedirectUrl) {
                    this.logger.verbose("Current url is not login request url, navigating");
                    this.logger.verbosePii("CurrentUrl: " + currentUrl + ", finalRedirectUrl: " + finalRedirectUrl);
                    window.location.assign("" + finalRedirectUrl + hash);
                    return;
                }
                else {
                    this.logger.verbose("Current url matches login request url");
                    var loginRequestUrlComponents = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].GetUrlComponents(loginRequestUrl);
                    if (loginRequestUrlComponents.Hash) {
                        this.logger.verbose("Login request url contains hash, resetting non-msal hash");
                        window.location.hash = loginRequestUrlComponents.Hash;
                    }
                }
            }
        }
        else if (!this.config.auth.navigateToLoginRequestUrl) {
            this.logger.verbose("Default navigation to start page after login turned off");
        }
        this.processCallBack(hash, stateInfo, null);
    };
    /**
     * @hidden
     * Creates a stateInfo object from the URL fragment and returns it.
     * @param {string} hash  -  Hash passed from redirect page
     * @returns {TokenResponse} an object created from the redirect response from AAD comprising of the keys - parameters, requestType, stateMatch, stateResponse and valid.
     * @ignore
     */
    UserAgentApplication.prototype.getResponseState = function (hash) {
        this.logger.verbose("GetResponseState has been called");
        var parameters = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].deserializeHash(hash);
        var stateResponse;
        if (!parameters) {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Hash was not parsed correctly.");
        }
        if (parameters.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].STATE)) {
            this.logger.verbose("Hash contains state. Creating stateInfo object");
            var parsedState = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].parseLibraryState(parameters.state);
            stateResponse = {
                requestType: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].unknown,
                state: parameters.state,
                timestamp: parsedState.ts,
                method: parsedState.method,
                stateMatch: false
            };
        }
        else {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Hash does not contain state.");
        }
        /*
         * async calls can fire iframe and login request at the same time if developer does not use the API as expected
         * incoming callback needs to be looked up to find the request type
         */
        // loginRedirect
        if (stateResponse.state === this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_LOGIN, stateResponse.state), this.inCookie) || stateResponse.state === this.silentAuthenticationState) {
            this.logger.verbose("State matches cached state, setting requestType to login");
            stateResponse.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login;
            stateResponse.stateMatch = true;
            return stateResponse;
        }
        // acquireTokenRedirect
        else if (stateResponse.state === this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_ACQ_TOKEN, stateResponse.state), this.inCookie)) {
            this.logger.verbose("State matches cached state, setting requestType to renewToken");
            stateResponse.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
            stateResponse.stateMatch = true;
            return stateResponse;
        }
        // external api requests may have many renewtoken requests for different resource
        if (!stateResponse.stateMatch) {
            this.logger.verbose("State does not match cached state, setting requestType to type from window");
            stateResponse.requestType = window.requestType;
            var statesInParentContext = window.renewStates;
            for (var i = 0; i < statesInParentContext.length; i++) {
                if (statesInParentContext[i] === stateResponse.state) {
                    this.logger.verbose("Matching state found for request");
                    stateResponse.stateMatch = true;
                    break;
                }
            }
            if (!stateResponse.stateMatch) {
                this.logger.verbose("Matching state not found for request");
            }
        }
        return stateResponse;
    };
    // #endregion
    // #region Token Processing (Extract to TokenProcessing.ts)
    /**
     * @hidden
     * Used to get token for the specified set of scopes from the cache
     * @param {@link ServerRequestParameters} - Request sent to the STS to obtain an id_token/access_token
     * @param {Account} account - Account for which the scopes were requested
     */
    UserAgentApplication.prototype.getCachedToken = function (serverAuthenticationRequest, account) {
        this.logger.verbose("GetCachedToken has been called");
        var scopes = serverAuthenticationRequest.scopes;
        /**
         * Id Token should be returned in every acquireTokenSilent call. The only exception is a response_type = token
         * request when a valid ID Token is not present in the cache.
         */
        var idToken = this.getCachedIdToken(serverAuthenticationRequest, account);
        var authResponse = this.getCachedAccessToken(serverAuthenticationRequest, account, scopes);
        var accountState = this.getAccountState(serverAuthenticationRequest.state);
        return _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__["ResponseUtils"].buildAuthResponse(idToken, authResponse, serverAuthenticationRequest, account, scopes, accountState);
    };
    /**
     * @hidden
     *
     * Uses passed in authority to further filter an array of tokenCacheItems until only the token being searched for remains, then returns that tokenCacheItem.
     * This method will throw if authority filtering still yields multiple matching tokens and will return null if not tokens match the authority passed in.
     *
     * @param authority
     * @param tokenCacheItems
     * @param request
     * @param requestScopes
     * @param tokenType
     */
    UserAgentApplication.prototype.getTokenCacheItemByAuthority = function (authority, tokenCacheItems, requestScopes, tokenType) {
        var _this = this;
        var filteredAuthorityItems;
        if (_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].isCommonAuthority(authority) || _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].isOrganizationsAuthority(authority)) {
            filteredAuthorityItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__["AuthCacheUtils"].filterTokenCacheItemsByDomain(tokenCacheItems, _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].GetUrlComponents(authority).HostNameAndPort);
        }
        else {
            filteredAuthorityItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__["AuthCacheUtils"].filterTokenCacheItemsByAuthority(tokenCacheItems, authority);
        }
        if (filteredAuthorityItems.length === 1) {
            return filteredAuthorityItems[0];
        }
        else if (filteredAuthorityItems.length > 1) {
            this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token.");
            filteredAuthorityItems.forEach(function (accessTokenCacheItem) {
                _this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
            });
            return null;
        }
        else {
            this.logger.verbose("No matching tokens of type " + tokenType + " found");
            return null;
        }
    };
    /**
     *
     * @hidden
     *
     * Searches the token cache for an ID Token that matches the request parameter and returns it as an IdToken object.
     *
     * @param serverAuthenticationRequest
     * @param account
     */
    UserAgentApplication.prototype.getCachedIdToken = function (serverAuthenticationRequest, account) {
        this.logger.verbose("Getting all cached tokens of type ID Token");
        var idTokenCacheItems = this.cacheStorage.getAllIdTokens(this.clientId, account ? account.homeAccountIdentifier : null);
        var matchAuthority = serverAuthenticationRequest.authority || this.authority;
        var idTokenCacheItem = this.getTokenCacheItemByAuthority(matchAuthority, idTokenCacheItems, null, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN);
        if (idTokenCacheItem) {
            this.logger.verbose("Evaluating ID token found");
            var idTokenIsStillValid = this.evaluateTokenExpiration(idTokenCacheItem);
            if (idTokenIsStillValid) {
                this.logger.verbose("ID token expiration is within offset, using ID token found in cache");
                var idTokenValue = idTokenCacheItem.value;
                if (idTokenValue) {
                    this.logger.verbose("ID Token found in cache is valid and unexpired");
                }
                else {
                    this.logger.verbose("ID Token found in cache is invalid");
                }
                return (idTokenValue) ? new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](idTokenValue.idToken) : null;
            }
            else {
                this.logger.verbose("Cached ID token is expired, removing from cache");
                this.cacheStorage.removeItem(JSON.stringify(idTokenCacheItem.key));
                return null;
            }
        }
        else {
            this.logger.verbose("No tokens found");
            return null;
        }
    };
    /**
     *
     * @hidden
     *
     * Searches the token cache for an access token that matches the request parameters and returns it as an AuthResponse.
     *
     * @param serverAuthenticationRequest
     * @param account
     * @param scopes
     */
    UserAgentApplication.prototype.getCachedAccessToken = function (serverAuthenticationRequest, account, scopes) {
        this.logger.verbose("Getting all cached tokens of type Access Token");
        var tokenCacheItems = this.cacheStorage.getAllAccessTokens(this.clientId, account ? account.homeAccountIdentifier : null);
        var scopeFilteredTokenCacheItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__["AuthCacheUtils"].filterTokenCacheItemsByScope(tokenCacheItems, scopes);
        var matchAuthority = serverAuthenticationRequest.authority || this.authority;
        // serverAuthenticationRequest.authority can only be common or organizations if not null
        var accessTokenCacheItem = this.getTokenCacheItemByAuthority(matchAuthority, scopeFilteredTokenCacheItems, scopes, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN);
        if (!accessTokenCacheItem) {
            this.logger.verbose("No matching token found when filtering by scope and authority");
            var authorityList = this.getUniqueAuthority(tokenCacheItems, "authority");
            if (authorityList.length > 1) {
                throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createMultipleAuthoritiesInCacheError(scopes.toString());
            }
            this.logger.verbose("Single authority used, setting authorityInstance");
            serverAuthenticationRequest.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(authorityList[0], this.config.auth.validateAuthority);
            return null;
        }
        else {
            serverAuthenticationRequest.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(accessTokenCacheItem.key.authority, this.config.auth.validateAuthority);
            this.logger.verbose("Evaluating access token found");
            var tokenIsStillValid = this.evaluateTokenExpiration(accessTokenCacheItem);
            // The response value will stay null if token retrieved from the cache is expired, otherwise it will be populated with said token's data
            if (tokenIsStillValid) {
                this.logger.verbose("Access token expiration is within offset, using access token found in cache");
                if (!account) {
                    account = this.getAccount();
                    if (!account) {
                        throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Account should not be null here.");
                    }
                }
                var aState = this.getAccountState(serverAuthenticationRequest.state);
                var response = {
                    uniqueId: "",
                    tenantId: "",
                    tokenType: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN,
                    idToken: null,
                    idTokenClaims: null,
                    accessToken: accessTokenCacheItem.value.accessToken,
                    scopes: accessTokenCacheItem.key.scopes.split(" "),
                    expiresOn: new Date(Number(accessTokenCacheItem.value.expiresIn) * 1000),
                    account: account,
                    accountState: aState,
                    fromCache: true
                };
                return response;
            }
            else {
                this.logger.verbose("Access token expired, removing from cache");
                this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
                return null;
            }
        }
    };
    /**
     * Returns true if the token passed in is within the acceptable expiration time offset, false if it is expired.
     * @param tokenCacheItem
     * @param serverAuthenticationRequest
     */
    UserAgentApplication.prototype.evaluateTokenExpiration = function (tokenCacheItem) {
        var expiration = Number(tokenCacheItem.value.expiresIn);
        return _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__["TokenUtils"].validateExpirationIsWithinOffset(expiration, this.config.system.tokenRenewalOffsetSeconds);
    };
    /**
     * @hidden
     * Used to get a unique list of authorities from the cache
     * @param {Array<AccessTokenCacheItem>}  accessTokenCacheItems - accessTokenCacheItems saved in the cache
     * @ignore
     */
    UserAgentApplication.prototype.getUniqueAuthority = function (accessTokenCacheItems, property) {
        this.logger.verbose("GetUniqueAuthority has been called");
        var authorityList = [];
        var flags = [];
        accessTokenCacheItems.forEach(function (element) {
            if (element.key.hasOwnProperty(property) && (flags.indexOf(element.key[property]) === -1)) {
                flags.push(element.key[property]);
                authorityList.push(element.key[property]);
            }
        });
        return authorityList;
    };
    /**
     * @hidden
     * Check if ADAL id_token exists and return if exists.
     *
     */
    UserAgentApplication.prototype.extractADALIdToken = function () {
        this.logger.verbose("ExtractADALIdToken has been called");
        var adalIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].adalIdToken);
        return (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(adalIdToken)) ? _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__["TokenUtils"].extractIdToken(adalIdToken) : null;
    };
    /**
     * @hidden
     * Acquires access token using a hidden iframe.
     * @ignore
     */
    UserAgentApplication.prototype.renewToken = function (requestSignature, resolve, reject, account, serverAuthenticationRequest) {
        this.logger.verbose("RenewToken has been called");
        this.logger.verbosePii("RenewToken scope and authority: " + requestSignature);
        var frameName = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].generateFrameName(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["FramePrefix"].TOKEN_FRAME, requestSignature);
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].addHiddenIFrame(frameName, this.logger);
        this.updateCacheEntries(serverAuthenticationRequest, account, false);
        this.logger.verbosePii("RenewToken expected state: " + serverAuthenticationRequest.state);
        // Build urlNavigate with "prompt=none" and navigate to URL in hidden iFrame
        var urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlRemoveQueryStringParameter(_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].createNavigateUrl(serverAuthenticationRequest), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt_none + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].response_mode_fragment;
        window.renewStates.push(serverAuthenticationRequest.state);
        window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
        this.logger.verbose("Set window.renewState and requestType");
        this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);
        this.logger.infoPii("Navigate to: " + urlNavigate);
        this.loadIframeTimeout(urlNavigate, frameName, requestSignature).catch(function (error) { return reject(error); });
    };
    /**
     * @hidden
     * Renews idtoken for app's own backend when clientId is passed as a single scope in the scopes array.
     * @ignore
     */
    UserAgentApplication.prototype.renewIdToken = function (requestSignature, resolve, reject, account, serverAuthenticationRequest) {
        this.logger.info("RenewIdToken has been called");
        var frameName = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].generateFrameName(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["FramePrefix"].ID_TOKEN_FRAME, requestSignature);
        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__["WindowUtils"].addHiddenIFrame(frameName, this.logger);
        this.updateCacheEntries(serverAuthenticationRequest, account, false);
        this.logger.verbose("RenewIdToken expected state: " + serverAuthenticationRequest.state);
        // Build urlNavigate with "prompt=none" and navigate to URL in hidden iFrame
        var urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].urlRemoveQueryStringParameter(_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].createNavigateUrl(serverAuthenticationRequest), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].prompt_none + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].response_mode_fragment;
        if (this.silentLogin) {
            this.logger.verbose("Silent login is true, set silentAuthenticationState");
            window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login;
            this.silentAuthenticationState = serverAuthenticationRequest.state;
        }
        else {
            this.logger.verbose("Not silent login, set window.renewState and requestType");
            window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken;
            window.renewStates.push(serverAuthenticationRequest.state);
        }
        // note: scope here is clientId
        this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);
        this.logger.infoPii("Navigate to:\" " + urlNavigate);
        this.loadIframeTimeout(urlNavigate, frameName, requestSignature).catch(function (error) { return reject(error); });
    };
    /**
     * @hidden
     *
     * This method builds an Access Token Cache item and saves it to the cache, returning the original
     * AuthResponse augmented with a parsed expiresOn attribute.
     *
     * @param response The AuthResponse object that contains the token to be saved
     * @param authority The authority under which the ID token will be cached
     * @param scopes The scopes to be added to the cache item key (undefined for ID token cache items)
     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier
     * @param expiration Token expiration timestamp
     */
    UserAgentApplication.prototype.saveToken = function (response, authority, scopes, clientInfo, expiration) {
        var accessTokenKey = new _cache_AccessTokenKey__WEBPACK_IMPORTED_MODULE_1__["AccessTokenKey"](authority, this.clientId, scopes, clientInfo.uid, clientInfo.utid);
        var accessTokenValue = new _cache_AccessTokenValue__WEBPACK_IMPORTED_MODULE_2__["AccessTokenValue"](response.accessToken, response.idToken.rawIdToken, expiration.toString(), clientInfo.encodeClientInfo());
        this.cacheStorage.setItem(JSON.stringify(accessTokenKey), JSON.stringify(accessTokenValue));
        if (expiration) {
            this.logger.verbose("New expiration set for token");
            response.expiresOn = new Date(expiration * 1000);
        }
        else {
            this.logger.error("Could not parse expiresIn parameter for access token");
        }
        return response;
    };
    /**
     * @hidden
     *
     * This method sets up the elements of an ID Token cache item and calls saveToken to save it in
     * Access Token Cache item format for the client application to use.
     *
     * @param response The AuthResponse object that will be used to build the cache item
     * @param authority The authority under which the ID token will be cached
     * @param parameters The response's Hash Params, which contain the ID token returned from the server
     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier
     * @param idTokenObj ID Token object from which the ID token's expiration is extracted
     */
    /* tslint:disable:no-string-literal */
    UserAgentApplication.prototype.saveIdToken = function (response, authority, parameters, clientInfo, idTokenObj) {
        this.logger.verbose("SaveIdToken has been called");
        var idTokenResponse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, response);
        // Scopes are undefined so they don't show up in ID token cache key
        var scopes;
        idTokenResponse.scopes = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes;
        idTokenResponse.accessToken = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN];
        var expiration = Number(idTokenObj.expiration);
        // Set ID Token item in cache
        this.logger.verbose("Saving ID token to cache");
        return this.saveToken(idTokenResponse, authority, scopes, clientInfo, expiration);
    };
    /**
     * @hidden
     *
     * This method sets up the elements of an Access Token cache item and calls saveToken to save it to the cache
     *
     * @param response The AuthResponse object that will be used to build the cache item
     * @param authority The authority under which the access token will be cached
     * @param parameters The response's Hash Params, which contain the access token returned from the server
     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier
     */
    /* tslint:disable:no-string-literal */
    UserAgentApplication.prototype.saveAccessToken = function (response, authority, parameters, clientInfo) {
        this.logger.verbose("SaveAccessToken has been called");
        var accessTokenResponse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, response);
        // read the scopes
        var scope = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SCOPE];
        var consentedScopes = scope.split(" ");
        // retrieve all access tokens from the cache, remove the dup scopes
        var accessTokenCacheItems = this.cacheStorage.getAllAccessTokens(this.clientId, authority);
        this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");
        for (var i = 0; i < accessTokenCacheItems.length; i++) {
            var accessTokenCacheItem = accessTokenCacheItems[i];
            if (accessTokenCacheItem.key.homeAccountIdentifier === response.account.homeAccountIdentifier) {
                var cachedScopes = accessTokenCacheItem.key.scopes.split(" ");
                if (_ScopeSet__WEBPACK_IMPORTED_MODULE_9__["ScopeSet"].isIntersectingScopes(cachedScopes, consentedScopes)) {
                    this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));
                }
            }
        }
        accessTokenResponse.accessToken = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN];
        accessTokenResponse.scopes = consentedScopes;
        var expiresIn = _utils_TimeUtils__WEBPACK_IMPORTED_MODULE_13__["TimeUtils"].parseExpiresIn(parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].EXPIRES_IN]);
        var parsedState = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__["RequestUtils"].parseLibraryState(parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].STATE]);
        var expiration = parsedState.ts + expiresIn;
        this.logger.verbose("Saving access token to cache");
        return this.saveToken(accessTokenResponse, authority, scope, clientInfo, expiration);
    };
    /**
     * @hidden
     * Saves token or error received in the response from AAD in the cache. In case of id_token, it also creates the account object.
     * @ignore
     */
    UserAgentApplication.prototype.saveTokenFromHash = function (hash, stateInfo) {
        this.logger.verbose("SaveTokenFromHash has been called");
        this.logger.info("State status: " + stateInfo.stateMatch + "; Request type: " + stateInfo.requestType);
        var response = {
            uniqueId: "",
            tenantId: "",
            tokenType: "",
            idToken: null,
            idTokenClaims: null,
            accessToken: null,
            scopes: [],
            expiresOn: null,
            account: null,
            accountState: "",
            fromCache: false
        };
        var error;
        var hashParams = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].deserializeHash(hash);
        var authorityKey = "";
        var acquireTokenAccountKey = "";
        var idTokenObj = null;
        // If server returns an error
        if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION) || hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR)) {
            this.logger.verbose("Server returned an error");
            this.logger.infoPii("Error : " + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR] + "; Error description: " + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR]);
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            // login
            if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].login) {
                this.logger.verbose("RequestType is login, caching login error, generating authorityKey");
                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].LOGIN_ERROR, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION] + ":" + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR]);
                authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(stateInfo.state);
            }
            // acquireToken
            if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].renewToken) {
                this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey");
                authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(stateInfo.state);
                var account = this.getAccount();
                var accountId = void 0;
                if (account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(account.homeAccountIdentifier)) {
                    accountId = account.homeAccountIdentifier;
                    this.logger.verbose("AccountId is set");
                }
                else {
                    accountId = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
                    this.logger.verbose("AccountId is set as no_account");
                }
                acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(accountId, stateInfo.state);
            }
            var _a = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR, hashErr = hashParams[_a], _b = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION, hashErrDesc = hashParams[_b];
            if (_error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__["InteractionRequiredAuthError"].isInteractionRequiredError(hashErr) ||
                _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__["InteractionRequiredAuthError"].isInteractionRequiredError(hashErrDesc)) {
                error = new _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__["InteractionRequiredAuthError"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR], hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            }
            else {
                error = new _error_ServerError__WEBPACK_IMPORTED_MODULE_22__["ServerError"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR], hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ERROR_DESCRIPTION]);
            }
        }
        // If the server returns "Success"
        else {
            this.logger.verbose("Server returns success");
            // Verify the state from redirect and record tokens to storage if exists
            if (stateInfo.stateMatch) {
                this.logger.info("State is right");
                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SESSION_STATE)) {
                    this.logger.verbose("Fragment has session state, caching");
                    this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].SESSION_STATE, stateInfo.state), hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SESSION_STATE]);
                }
                response.accountState = this.getAccountState(stateInfo.state);
                var clientInfo = void 0;
                // Process access_token
                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN)) {
                    this.logger.info("Fragment has access token");
                    response.accessToken = hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ACCESS_TOKEN];
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SCOPE)) {
                        response.scopes = hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].SCOPE].split(" ");
                    }
                    // retrieve the id_token from response if present
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN)) {
                        this.logger.verbose("Fragment has id_token");
                        idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN]);
                    }
                    else {
                        this.logger.verbose("No idToken on fragment, getting idToken from cache");
                        idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].IDTOKEN));
                    }
                    response = _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__["ResponseUtils"].setResponseIdToken(response, idTokenObj);
                    // set authority
                    var authority = this.populateAuthority(stateInfo.state, this.inCookie, this.cacheStorage, idTokenObj);
                    this.logger.verbose("Got authority from cache");
                    // retrieve client_info - if it is not found, generate the uid and utid from idToken
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO)) {
                        this.logger.verbose("Fragment has clientInfo");
                        clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO], authority);
                    }
                    else if (this.authorityInstance.AuthorityType === _authority_Authority__WEBPACK_IMPORTED_MODULE_4__["AuthorityType"].Adfs) {
                        clientInfo = _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"].createClientInfoFromIdToken(idTokenObj, authority);
                    }
                    else {
                        this.logger.warning("ClientInfo not received in the response from AAD");
                    }
                    response.account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idTokenObj, clientInfo);
                    this.logger.verbose("Account object created from response");
                    var accountKey = void 0;
                    if (response.account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(response.account.homeAccountIdentifier)) {
                        this.logger.verbose("AccountKey set");
                        accountKey = response.account.homeAccountIdentifier;
                    }
                    else {
                        this.logger.verbose("AccountKey set as no_account");
                        accountKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
                    }
                    acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(accountKey, stateInfo.state);
                    var acquireTokenAccountKey_noaccount = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account, stateInfo.state);
                    this.logger.verbose("AcquireTokenAccountKey generated");
                    var cachedAccount = this.cacheStorage.getItem(acquireTokenAccountKey);
                    var acquireTokenAccount = void 0;
                    // Check with the account in the Cache
                    if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(cachedAccount)) {
                        acquireTokenAccount = JSON.parse(cachedAccount);
                        this.logger.verbose("AcquireToken request account retrieved from cache");
                        if (response.account && acquireTokenAccount && _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].compareAccounts(response.account, acquireTokenAccount)) {
                            response = this.saveAccessToken(response, authority, hashParams, clientInfo);
                            this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request");
                        }
                        else {
                            this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request");
                        }
                    }
                    else if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(this.cacheStorage.getItem(acquireTokenAccountKey_noaccount))) {
                        this.logger.verbose("No acquireToken account retrieved from cache");
                        response = this.saveAccessToken(response, authority, hashParams, clientInfo);
                    }
                }
                // Process id_token
                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN)) {
                    this.logger.info("Fragment has idToken");
                    // set the idToken
                    idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN]);
                    // set authority
                    var authority = this.populateAuthority(stateInfo.state, this.inCookie, this.cacheStorage, idTokenObj);
                    response = _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__["ResponseUtils"].setResponseIdToken(response, idTokenObj);
                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO)) {
                        this.logger.verbose("Fragment has clientInfo");
                        clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].CLIENT_INFO], authority);
                    }
                    else if (this.authorityInstance.AuthorityType === _authority_Authority__WEBPACK_IMPORTED_MODULE_4__["AuthorityType"].Adfs) {
                        clientInfo = _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"].createClientInfoFromIdToken(idTokenObj, authority);
                    }
                    else {
                        this.logger.warning("ClientInfo not received in the response from AAD");
                    }
                    this.account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idTokenObj, clientInfo);
                    response.account = this.account;
                    this.logger.verbose("Account object created from response");
                    if (idTokenObj && idTokenObj.nonce) {
                        this.logger.verbose("IdToken has nonce");
                        // check nonce integrity if idToken has nonce - throw an error if not matched
                        var cachedNonce = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].NONCE_IDTOKEN, stateInfo.state), this.inCookie);
                        if (idTokenObj.nonce !== cachedNonce) {
                            this.account = null;
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].LOGIN_ERROR, "Nonce Mismatch. Expected Nonce: " + cachedNonce + "," + "Actual Nonce: " + idTokenObj.nonce);
                            this.logger.error("Nonce Mismatch. Expected Nonce: " + cachedNonce + ", Actual Nonce: " + idTokenObj.nonce);
                            error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createNonceMismatchError(cachedNonce, idTokenObj.nonce);
                        }
                        // Save the token
                        else {
                            this.logger.verbose("Nonce matches, saving idToken to cache");
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].IDTOKEN, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ServerHashParamKeys"].ID_TOKEN], this.inCookie);
                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].CLIENT_INFO, clientInfo.encodeClientInfo(), this.inCookie);
                            // Save idToken as access token item for app itself
                            this.saveIdToken(response, authority, hashParams, clientInfo, idTokenObj);
                        }
                    }
                    else {
                        this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state");
                        authorityKey = stateInfo.state;
                        acquireTokenAccountKey = stateInfo.state;
                        this.logger.error("Invalid id_token received in the response");
                        error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidIdTokenError(idTokenObj);
                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, error.errorCode);
                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, error.errorMessage);
                    }
                }
            }
            // State mismatch - unexpected/invalid state
            else {
                this.logger.verbose("State mismatch");
                authorityKey = stateInfo.state;
                acquireTokenAccountKey = stateInfo.state;
                var expectedState = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_LOGIN, stateInfo.state), this.inCookie);
                this.logger.error("State Mismatch. Expected State: " + expectedState + ", Actual State: " + stateInfo.state);
                error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__["ClientAuthError"].createInvalidStateError(stateInfo.state, expectedState);
                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR, error.errorCode);
                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["ErrorCacheKeys"].ERROR_DESC, error.errorMessage);
            }
        }
        // Set status to completed
        this.cacheStorage.removeItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].RENEW_STATUS, stateInfo.state));
        this.cacheStorage.resetTempCacheItems(stateInfo.state);
        this.logger.verbose("Status set to complete, temporary cache cleared");
        // this is required if navigateToLoginRequestUrl=false
        if (this.inCookie) {
            this.logger.verbose("InCookie is true, setting authorityKey in cookie");
            this.cacheStorage.setItemCookie(authorityKey, "", -1);
            this.cacheStorage.clearMsalCookie(stateInfo.state);
        }
        if (error) {
            // Error case, set status to cancelled
            throw error;
        }
        if (!response) {
            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__["AuthError"].createUnexpectedError("Response is null");
        }
        return response;
    };
    /**
     * Set Authority when saving Token from the hash
     * @param state
     * @param inCookie
     * @param cacheStorage
     * @param idTokenObj
     * @param response
     */
    UserAgentApplication.prototype.populateAuthority = function (state, inCookie, cacheStorage, idTokenObj) {
        this.logger.verbose("PopulateAuthority has been called");
        var authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(state);
        var cachedAuthority = cacheStorage.getItem(authorityKey, inCookie);
        // retrieve the authority from cache and replace with tenantID
        return _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(cachedAuthority) ? cachedAuthority : _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].replaceTenantPath(cachedAuthority, idTokenObj.tenantId);
    };
    /* tslint:enable:no-string-literal */
    // #endregion
    // #region Account
    /**
     * Returns the signed in account
     * (the account object is created at the time of successful login)
     * or null when no state is found
     * @returns {@link Account} - the account object stored in MSAL
     */
    UserAgentApplication.prototype.getAccount = function () {
        // if a session already exists, get the account from the session
        if (this.account) {
            return this.account;
        }
        // frame is used to get idToken and populate the account for the given session
        var rawIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].IDTOKEN, this.inCookie);
        var rawClientInfo = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["PersistentCacheKeys"].CLIENT_INFO, this.inCookie);
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(rawIdToken) && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(rawClientInfo)) {
            var idToken = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](rawIdToken);
            var clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](rawClientInfo, "");
            this.account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idToken, clientInfo);
            return this.account;
        }
        // if login not yet done, return null
        return null;
    };
    /**
     * @hidden
     *
     * Extracts state value from the accountState sent with the authentication request.
     * @returns {string} scope.
     * @ignore
     */
    UserAgentApplication.prototype.getAccountState = function (state) {
        if (state) {
            var splitIndex = state.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].resourceDelimiter);
            if (splitIndex > -1 && splitIndex + 1 < state.length) {
                return state.substring(splitIndex + 1);
            }
        }
        return state;
    };
    /**
     * Use to get a list of unique accounts in MSAL cache based on homeAccountIdentifier.
     *
     * @param {@link Array<Account>} Account - all unique accounts in MSAL cache.
     */
    UserAgentApplication.prototype.getAllAccounts = function () {
        var accounts = [];
        var accessTokenCacheItems = this.cacheStorage.getAllAccessTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].homeAccountIdentifier);
        for (var i = 0; i < accessTokenCacheItems.length; i++) {
            var idToken = new _IdToken__WEBPACK_IMPORTED_MODULE_6__["IdToken"](accessTokenCacheItems[i].value.idToken);
            var clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__["ClientInfo"](accessTokenCacheItems[i].value.homeAccountIdentifier, "");
            var account = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].createAccount(idToken, clientInfo);
            accounts.push(account);
        }
        return this.getUniqueAccounts(accounts);
    };
    /**
     * @hidden
     *
     * Used to filter accounts based on homeAccountIdentifier
     * @param {Array<Account>}  Accounts - accounts saved in the cache
     * @ignore
     */
    UserAgentApplication.prototype.getUniqueAccounts = function (accounts) {
        if (!accounts || accounts.length <= 1) {
            return accounts;
        }
        var flags = [];
        var uniqueAccounts = [];
        for (var index = 0; index < accounts.length; ++index) {
            if (accounts[index].homeAccountIdentifier && flags.indexOf(accounts[index].homeAccountIdentifier) === -1) {
                flags.push(accounts[index].homeAccountIdentifier);
                uniqueAccounts.push(accounts[index]);
            }
        }
        return uniqueAccounts;
    };
    // #endregion
    // #region Angular
    /**
     * @hidden
     *
     * Broadcast messages - Used only for Angular?  *
     * @param eventName
     * @param data
     */
    UserAgentApplication.prototype.broadcast = function (eventName, data) {
        var evt = new CustomEvent(eventName, { detail: data });
        window.dispatchEvent(evt);
    };
    /**
     * @hidden
     *
     * Helper function to retrieve the cached token
     *
     * @param scopes
     * @param {@link Account} account
     * @param state
     * @return {@link AuthResponse} AuthResponse
     */
    UserAgentApplication.prototype.getCachedTokenInternal = function (scopes, account, state, correlationId) {
        // Get the current session's account object
        var accountObject = account || this.getAccount();
        if (!accountObject) {
            return null;
        }
        // Construct AuthenticationRequest based on response type; set "redirectUri" from the "request" which makes this call from Angular - for this.getRedirectUri()
        var newAuthority = this.authorityInstance ? this.authorityInstance : _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__["AuthorityFactory"].CreateInstance(this.authority, this.config.auth.validateAuthority);
        var responseType = this.getTokenType(accountObject, scopes);
        var serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"](newAuthority, this.clientId, responseType, this.getRedirectUri(), scopes, state, correlationId);
        // get cached token
        return this.getCachedToken(serverAuthenticationRequest, account);
    };
    /**
     * @hidden
     *
     * Get scopes for the Endpoint - Used in Angular to track protected and unprotected resources without interaction from the developer app
     * Note: Please check if we need to set the "redirectUri" from the "request" which makes this call from Angular - for this.getRedirectUri()
     *
     * @param endpoint
     */
    UserAgentApplication.prototype.getScopesForEndpoint = function (endpoint) {
        // if user specified list of unprotectedResources, no need to send token to these endpoints, return null.
        if (this.config.framework.unprotectedResources.length > 0) {
            for (var i = 0; i < this.config.framework.unprotectedResources.length; i++) {
                if (endpoint.indexOf(this.config.framework.unprotectedResources[i]) > -1) {
                    return null;
                }
            }
        }
        // process all protected resources and send the matched one
        if (this.config.framework.protectedResourceMap.size > 0) {
            for (var _i = 0, _a = Array.from(this.config.framework.protectedResourceMap.keys()); _i < _a.length; _i++) {
                var key = _a[_i];
                // configEndpoint is like /api/Todo requested endpoint can be /api/Todo/1
                if (endpoint.indexOf(key) > -1) {
                    return this.config.framework.protectedResourceMap.get(key);
                }
            }
        }
        /*
         * default resource will be clientid if nothing specified
         * App will use idtoken for calls to itself
         * check if it's staring from http or https, needs to match with app host
         */
        if (endpoint.indexOf("http://") > -1 || endpoint.indexOf("https://") > -1) {
            if (_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].getHostFromUri(endpoint) === _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].getHostFromUri(this.getRedirectUri())) {
                return new Array(this.clientId);
            }
        }
        else {
            /*
             * in angular level, the url for $http interceptor call could be relative url,
             * if it's relative call, we'll treat it as app backend call.
             */
            return new Array(this.clientId);
        }
        // if not the app's own backend or not a domain listed in the endpoints structure
        return null;
    };
    /**
     * Return boolean flag to developer to help inform if login is in progress
     * @returns {boolean} true/false
     */
    UserAgentApplication.prototype.getLoginInProgress = function () {
        return this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress;
    };
    /**
     * @hidden
     * @ignore
     *
     * @param loginInProgress
     */
    UserAgentApplication.prototype.setInteractionInProgress = function (inProgress) {
        if (inProgress) {
            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress);
        }
        else {
            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS);
        }
    };
    /**
     * @hidden
     * @ignore
     *
     * @param loginInProgress
     */
    UserAgentApplication.prototype.setloginInProgress = function (loginInProgress) {
        this.setInteractionInProgress(loginInProgress);
    };
    /**
     * @hidden
     * @ignore
     *
     * returns the status of acquireTokenInProgress
     */
    UserAgentApplication.prototype.getAcquireTokenInProgress = function () {
        return this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].INTERACTION_STATUS) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].inProgress;
    };
    /**
     * @hidden
     * @ignore
     *
     * @param acquireTokenInProgress
     */
    UserAgentApplication.prototype.setAcquireTokenInProgress = function (acquireTokenInProgress) {
        this.setInteractionInProgress(acquireTokenInProgress);
    };
    /**
     * @hidden
     * @ignore
     *
     * returns the logger handle
     */
    UserAgentApplication.prototype.getLogger = function () {
        return this.logger;
    };
    /**
     * Sets the logger callback.
     * @param logger Logger callback
     */
    UserAgentApplication.prototype.setLogger = function (logger) {
        this.logger = logger;
    };
    // #endregion
    // #region Getters and Setters
    /**
     * Use to get the redirect uri configured in MSAL or null.
     * Evaluates redirectUri if its a function, otherwise simply returns its value.
     *
     * @returns {string} redirect URL
     */
    UserAgentApplication.prototype.getRedirectUri = function (reqRedirectUri) {
        if (reqRedirectUri) {
            return reqRedirectUri;
        }
        else if (typeof this.config.auth.redirectUri === "function") {
            return this.config.auth.redirectUri();
        }
        return this.config.auth.redirectUri;
    };
    /**
     * Use to get the post logout redirect uri configured in MSAL or null.
     * Evaluates postLogoutredirectUri if its a function, otherwise simply returns its value.
     *
     * @returns {string} post logout redirect URL
     */
    UserAgentApplication.prototype.getPostLogoutRedirectUri = function () {
        if (typeof this.config.auth.postLogoutRedirectUri === "function") {
            return this.config.auth.postLogoutRedirectUri();
        }
        return this.config.auth.postLogoutRedirectUri;
    };
    /**
     * Use to get the current {@link Configuration} object in MSAL
     *
     * @returns {@link Configuration}
     */
    UserAgentApplication.prototype.getCurrentConfiguration = function () {
        if (!this.config) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createNoSetConfigurationError();
        }
        return this.config;
    };
    /**
     * @ignore
     *
     * Utils function to create the Authentication
     * @param {@link account} account object
     * @param scopes
     *
     * @returns {string} token type: token, id_token or id_token token
     *
     */
    UserAgentApplication.prototype.getTokenType = function (accountObject, scopes) {
        var accountsMatch = _Account__WEBPACK_IMPORTED_MODULE_8__["Account"].compareAccounts(accountObject, this.getAccount());
        return _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__["ServerRequestParameters"].determineResponseType(accountsMatch, scopes);
    };
    /**
     * @hidden
     * @ignore
     *
     * Sets the cachekeys for and stores the account information in cache
     * @param account
     * @param state
     * @hidden
     */
    UserAgentApplication.prototype.setAccountCache = function (account, state) {
        // Cache acquireTokenAccountKey
        var accountId = account ? this.getAccountId(account) : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
        var acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAcquireTokenAccountKey(accountId, state);
        this.cacheStorage.setItem(acquireTokenAccountKey, JSON.stringify(account));
    };
    /**
     * @hidden
     * @ignore
     *
     * Sets the cacheKey for and stores the authority information in cache
     * @param state
     * @param authority
     * @hidden
     */
    UserAgentApplication.prototype.setAuthorityCache = function (state, authority) {
        // Cache authorityKey
        var authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateAuthorityKey(state);
        this.cacheStorage.setItem(authorityKey, _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__["UrlUtils"].CanonicalizeUri(authority), this.inCookie);
    };
    /**
     * Updates account, authority, and nonce in cache
     * @param serverAuthenticationRequest
     * @param account
     * @hidden
     * @ignore
     */
    UserAgentApplication.prototype.updateCacheEntries = function (serverAuthenticationRequest, account, isLoginCall, loginStartPage) {
        // Cache Request Originator Page
        if (loginStartPage) {
            this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].LOGIN_REQUEST, serverAuthenticationRequest.state), loginStartPage, this.inCookie);
        }
        // Cache account and authority
        if (isLoginCall) {
            // Cache the state
            this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].STATE_LOGIN, serverAuthenticationRequest.state), serverAuthenticationRequest.state, this.inCookie);
        }
        else {
            this.setAccountCache(account, serverAuthenticationRequest.state);
        }
        // Cache authorityKey
        this.setAuthorityCache(serverAuthenticationRequest.state, serverAuthenticationRequest.authority);
        // Cache nonce
        this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__["AuthCache"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__["TemporaryCacheKeys"].NONCE_IDTOKEN, serverAuthenticationRequest.state), serverAuthenticationRequest.nonce, this.inCookie);
    };
    /**
     * Returns the unique identifier for the logged in account
     * @param account
     * @hidden
     * @ignore
     */
    UserAgentApplication.prototype.getAccountId = function (account) {
        // return `${account.accountIdentifier}` + Constants.resourceDelimiter + `${account.homeAccountIdentifier}`;
        var accountId;
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__["StringUtils"].isEmpty(account.homeAccountIdentifier)) {
            accountId = account.homeAccountIdentifier;
        }
        else {
            accountId = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].no_account;
        }
        return accountId;
    };
    /**
     * @ignore
     * @param extraQueryParameters
     *
     * Construct 'tokenRequest' from the available data in adalIdToken
     */
    UserAgentApplication.prototype.buildIDTokenRequest = function (request) {
        var tokenRequest = {
            scopes: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__["Constants"].oidcScopes,
            authority: this.authority,
            account: this.getAccount(),
            extraQueryParameters: request.extraQueryParameters,
            correlationId: request.correlationId
        };
        return tokenRequest;
    };
    /**
     * @ignore
     * @param config
     * @param clientId
     *
     * Construct TelemetryManager from Configuration
     */
    UserAgentApplication.prototype.getTelemetryManagerFromConfig = function (config, clientId) {
        if (!config) { // if unset
            return _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__["default"].getTelemetrymanagerStub(clientId, this.logger);
        }
        // if set then validate
        var applicationName = config.applicationName, applicationVersion = config.applicationVersion, telemetryEmitter = config.telemetryEmitter;
        if (!applicationName || !applicationVersion || !telemetryEmitter) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__["ClientConfigurationError"].createTelemetryConfigError(config);
        }
        // if valid then construct
        var telemetryPlatform = {
            applicationName: applicationName,
            applicationVersion: applicationVersion
        };
        var telemetryManagerConfig = {
            platform: telemetryPlatform,
            clientId: clientId
        };
        return new _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__["default"](telemetryManagerConfig, telemetryEmitter, this.logger);
    };
    return UserAgentApplication;
}());

//# sourceMappingURL=UserAgentApplication.js.map

/***/ }),

/***/ "lgJW":
/*!*********************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/ChaosHandlerOptions.js ***!
  \*********************************************************************************************************************************************/
/*! exports provided: ChaosHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChaosHandlerOptions", function() { return ChaosHandlerOptions; });
/* harmony import */ var _ChaosStrategy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ChaosStrategy */ "WJ2Y");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module ChaosHandlerOptions
 */

/**
 * Class representing ChaosHandlerOptions
 * @class
 * Class
 * @implements MiddlewareOptions
 */
class ChaosHandlerOptions {
    /**
     * @public
     * @constructor
     * To create an instance of Testing Handler Options
     * @param {ChaosStrategy} ChaosStrategy - Specifies the startegy used for the Testing Handler -> RAMDOM/MANUAL
     * @param {string} statusMessage - The Message to be returned in the response
     * @param {number?} statusCode - The statusCode to be returned in the response
     * @param {number?} chaosPercentage - The percentage of randomness/chaos in the handler
     * @param {any?} responseBody - The response body to be returned in the response
     * @returns An instance of ChaosHandlerOptions
     */
    constructor(chaosStrategy = _ChaosStrategy__WEBPACK_IMPORTED_MODULE_0__["ChaosStrategy"].RANDOM, statusMessage = "Some error Happened", statusCode, chaosPercentage, responseBody) {
        this.chaosStrategy = chaosStrategy;
        this.statusCode = statusCode;
        this.statusMessage = statusMessage;
        this.chaosPercentage = chaosPercentage !== undefined ? chaosPercentage : 10;
        this.responseBody = responseBody;
        if (this.chaosPercentage > 100) {
            throw new Error("Error Pecentage can not be more than 100");
        }
    }
}
//# sourceMappingURL=ChaosHandlerOptions.js.map

/***/ }),

/***/ "mHPW":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-agenda/mgt-agenda-css.js ***!
  \*************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--event-background-color:#ffffff}.mgt-dark{--event-background-color:#161514}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,var(--color-sub1,#323130))}:host .agenda>.group:first-child>.header,mgt-agenda .agenda>.group:first-child>.header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background-color,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px var(--box-shadow-color,rgba(0,0,0,.092)));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:125px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,var(--color,#000));font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,var(--color-sub1,#323130))}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location-icon svg,mgt-agenda .event-location-icon svg{height:12px}:host .event-location-icon svg path,mgt-agenda .event-location-icon svg path{stroke:var(--event-location-color,var(--color,#000))}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,var(--color,#000));margin:0 0 0 4px;line-height:17px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:var(--event-background-color,#fff);border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}[dir=rtl] .event-location{margin:0 4px 0 0}[dir=rtl] .event-time-container{direction:ltr;margin:18px 18px 18px 38px}[dir=rtl] .event-details-container{margin:14px 0 14px 18px}[dir=rtl] .event-details-container .event-subject{margin:0 0 0 18px}[dir=rtl] .event-details-container .event-location-container{margin:8px 0 0 18px}
`
];
//# sourceMappingURL=mgt-agenda-css.js.map

/***/ }),

/***/ "mWN4":
/*!**********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/Account.js ***!
  \**********************************************************************************/
/*! exports provided: Account */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Account", function() { return Account; });
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ "qD3l");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/StringUtils */ "Ft/c");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


/**
 * accountIdentifier       combination of idToken.uid and idToken.utid
 * homeAccountIdentifier   combination of clientInfo.uid and clientInfo.utid
 * userName                idToken.preferred_username
 * name                    idToken.name
 * idToken                 idToken
 * sid                     idToken.sid - session identifier
 * environment             idtoken.issuer (the authority that issues the token)
 */
var Account = /** @class */ (function () {
    /**
     * Creates an Account Object
     * @praram accountIdentifier
     * @param homeAccountIdentifier
     * @param userName
     * @param name
     * @param idToken
     * @param sid
     * @param environment
     */
    function Account(accountIdentifier, homeAccountIdentifier, userName, name, idTokenClaims, sid, environment) {
        this.accountIdentifier = accountIdentifier;
        this.homeAccountIdentifier = homeAccountIdentifier;
        this.userName = userName;
        this.name = name;
        // will be deprecated soon
        this.idToken = idTokenClaims;
        this.idTokenClaims = idTokenClaims;
        this.sid = sid;
        this.environment = environment;
    }
    /**
     * @hidden
     * @param idToken
     * @param clientInfo
     */
    Account.createAccount = function (idToken, clientInfo) {
        // create accountIdentifier
        var accountIdentifier = idToken.objectId || idToken.subject;
        // create homeAccountIdentifier
        var uid = clientInfo ? clientInfo.uid : "";
        var utid = clientInfo ? clientInfo.utid : "";
        var homeAccountIdentifier;
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_1__["StringUtils"].isEmpty(uid)) {
            homeAccountIdentifier = _utils_StringUtils__WEBPACK_IMPORTED_MODULE_1__["StringUtils"].isEmpty(utid) ? _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(uid) : _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(uid) + "." + _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__["CryptoUtils"].base64Encode(utid);
        }
        return new Account(accountIdentifier, homeAccountIdentifier, idToken.preferredName, idToken.name, idToken.claims, idToken.sid, idToken.issuer);
    };
    /**
     * Utils function to compare two Account objects - used to check if the same user account is logged in
     *
     * @param a1: Account object
     * @param a2: Account object
     */
    Account.compareAccounts = function (a1, a2) {
        if (!a1 || !a2) {
            return false;
        }
        if (a1.homeAccountIdentifier && a2.homeAccountIdentifier) {
            if (a1.homeAccountIdentifier === a2.homeAccountIdentifier) {
                return true;
            }
        }
        return false;
    };
    return Account;
}());

//# sourceMappingURL=Account.js.map

/***/ }),

/***/ "mb9z":
/*!***********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/ScopeSet.js ***!
  \***********************************************************************************/
/*! exports provided: ScopeSet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScopeSet", function() { return ScopeSet; });
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error/ClientConfigurationError */ "ovzL");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ "vFME");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var ScopeSet = /** @class */ (function () {
    function ScopeSet() {
    }
    /**
     * Check if there are dup scopes in a given request
     *
     * @param cachedScopes
     * @param scopes
     */
    // TODO: Rename this, intersecting scopes isn't a great name for duplicate checker
    ScopeSet.isIntersectingScopes = function (cachedScopes, scopes) {
        var convertedCachedScopes = this.trimAndConvertArrayToLowerCase(cachedScopes.slice());
        var requestScopes = this.trimAndConvertArrayToLowerCase(scopes.slice());
        for (var i = 0; i < requestScopes.length; i++) {
            if (convertedCachedScopes.indexOf(requestScopes[i].toLowerCase()) > -1) {
                return true;
            }
        }
        return false;
    };
    /**
     * Check if a given scope is present in the request
     *
     * @param cachedScopes
     * @param scopes
     */
    ScopeSet.containsScope = function (cachedScopes, scopes) {
        var convertedCachedScopes = this.trimAndConvertArrayToLowerCase(cachedScopes.slice());
        var requestScopes = this.trimAndConvertArrayToLowerCase(scopes.slice());
        return requestScopes.every(function (value) { return convertedCachedScopes.indexOf(value.toString().toLowerCase()) >= 0; });
    };
    /**
     *  Trims and converts string to lower case
     *
     * @param scopes
     */
    // TODO: Rename this, too generic name for a function that only deals with scopes
    ScopeSet.trimAndConvertToLowerCase = function (scope) {
        return scope.trim().toLowerCase();
    };
    /**
     * Performs trimAndConvertToLowerCase on string array
     * @param scopes
     */
    ScopeSet.trimAndConvertArrayToLowerCase = function (scopes) {
        var _this = this;
        return scopes.map(function (scope) { return _this.trimAndConvertToLowerCase(scope); });
    };
    /**
     * Trims each scope in scopes array
     * @param scopes
     */
    ScopeSet.trimScopes = function (scopes) {
        return scopes.map(function (scope) { return scope.trim(); });
    };
    /**
     * Remove one element from a scope array
     *
     * @param scopes
     * @param scope
     */
    // TODO: Rename this, too generic name for a function that only deals with scopes
    ScopeSet.removeElement = function (scopes, scope) {
        var scopeVal = this.trimAndConvertToLowerCase(scope);
        return scopes.filter(function (value) { return value !== scopeVal; });
    };
    /**
     * Parse the scopes into a formatted scopeList
     * @param scopes
     */
    ScopeSet.parseScope = function (scopes) {
        var scopeList = "";
        if (scopes) {
            for (var i = 0; i < scopes.length; ++i) {
                scopeList += (i !== scopes.length - 1) ? scopes[i] + " " : scopes[i];
            }
        }
        return scopeList;
    };
    /**
     * @hidden
     *
     * Used to validate the scopes input parameter requested  by the developer.
     * @param {Array<string>} scopes - Developer requested permissions. Not all scopes are guaranteed to be included in the access token returned.
     * @param {boolean} scopesRequired - Boolean indicating whether the scopes array is required or not
     * @ignore
     */
    ScopeSet.validateInputScope = function (scopes, scopesRequired) {
        if (!scopes) {
            if (scopesRequired) {
                throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createScopesRequiredError(scopes);
            }
            else {
                return;
            }
        }
        // Check that scopes is an array object (also throws error if scopes == null)
        if (!Array.isArray(scopes)) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createScopesNonArrayError(scopes);
        }
        // Check that scopes is not an empty array
        if (scopes.length < 1 && scopesRequired) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createEmptyScopesArrayError(scopes.toString());
        }
    };
    /**
     * @hidden
     *
     * Extracts scope value from the state sent with the authentication request.
     * @param {string} state
     * @returns {string} scope.
     * @ignore
     */
    ScopeSet.getScopeFromState = function (state) {
        if (state) {
            var splitIndex = state.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter);
            if (splitIndex > -1 && splitIndex + 1 < state.length) {
                return state.substring(splitIndex + 1);
            }
        }
        return "";
    };
    /**
     * @ignore
     * Appends extraScopesToConsent if passed
     * @param {@link AuthenticationParameters}
     */
    ScopeSet.appendScopes = function (reqScopes, reqExtraScopesToConsent) {
        if (reqScopes) {
            var convertedExtraScopes = reqExtraScopesToConsent ? this.trimAndConvertArrayToLowerCase(reqExtraScopesToConsent.slice()) : null;
            var convertedReqScopes = this.trimAndConvertArrayToLowerCase(reqScopes.slice());
            return convertedExtraScopes ? convertedReqScopes.concat(convertedExtraScopes) : convertedReqScopes;
        }
        return null;
    };
    // #endregion
    /**
     * @ignore
     * Returns true if the scopes array only contains openid and/or profile
     */
    ScopeSet.onlyContainsOidcScopes = function (scopes) {
        var scopesCount = scopes.length;
        var oidcScopesFound = 0;
        if (scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope) > -1) {
            oidcScopesFound += 1;
        }
        if (scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope) > -1) {
            oidcScopesFound += 1;
        }
        return (scopesCount > 0 && scopesCount === oidcScopesFound);
    };
    /**
     * @ignore
     * Returns true if the scopes array only contains openid and/or profile
     */
    ScopeSet.containsAnyOidcScopes = function (scopes) {
        var containsOpenIdScope = scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope) > -1;
        var containsProfileScope = scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope) > -1;
        return (containsOpenIdScope || containsProfileScope);
    };
    /**
     * @ignore
     * Returns true if the clientId is the only scope in the array
     */
    ScopeSet.onlyContainsClientId = function (scopes, clientId) {
        // Double negation to force false value returned in case scopes is null
        return !!scopes && (scopes.indexOf(clientId) > -1 && scopes.length === 1);
    };
    /**
     * @ignore
     * Adds missing OIDC scopes to scopes array without duplication. Since STS requires OIDC scopes for
     * all implicit flow requests, 'openid' and 'profile' should always be included in the final request
     */
    ScopeSet.appendDefaultScopes = function (scopes) {
        var extendedScopes = scopes;
        if (extendedScopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope) === -1) {
            extendedScopes.push(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope);
        }
        if (extendedScopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope) === -1) {
            extendedScopes.push(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope);
        }
        return extendedScopes;
    };
    /**
     * @ignore
     * Removes present OIDC scopes from scopes array.
     */
    ScopeSet.removeDefaultScopes = function (scopes) {
        return scopes.filter(function (scope) {
            return (scope !== _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope && scope !== _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope);
        });
    };
    /**
     * @ignore
     * Removes clientId from scopes array if included as only scope. If it's not the only scope, it is treated as a resource scope.
     * @param scopes Array<string>: Pre-normalized scopes array
     * @param clientId string: The application's clientId that is searched for in the scopes array
     */
    ScopeSet.translateClientIdIfSingleScope = function (scopes, clientId) {
        return this.onlyContainsClientId(scopes, clientId) ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].oidcScopes : scopes;
    };
    return ScopeSet;
}());

//# sourceMappingURL=ScopeSet.js.map

/***/ }),

/***/ "mrSG":
/*!*****************************************!*\
  !*** ./node_modules/tslib/tslib.es6.js ***!
  \*****************************************/
/*! exports provided: __extends, __assign, __rest, __decorate, __param, __metadata, __awaiter, __generator, __exportStar, __values, __read, __spread, __spreadArrays, __await, __asyncGenerator, __asyncDelegator, __asyncValues, __makeTemplateObject, __importStar, __importDefault */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__extends", function() { return __extends; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__assign", function() { return __assign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__rest", function() { return __rest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__decorate", function() { return __decorate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__param", function() { return __param; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__metadata", function() { return __metadata; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__awaiter", function() { return __awaiter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__generator", function() { return __generator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__exportStar", function() { return __exportStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__values", function() { return __values; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__read", function() { return __read; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spread", function() { return __spread; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spreadArrays", function() { return __spreadArrays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__await", function() { return __await; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncGenerator", function() { return __asyncGenerator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncDelegator", function() { return __asyncDelegator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncValues", function() { return __asyncValues; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__makeTemplateObject", function() { return __makeTemplateObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importStar", function() { return __importStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importDefault", function() { return __importDefault; });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __spreadArrays() {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
};

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),

/***/ "mx/S":
/*!******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/cache/AuthCache.js ***!
  \******************************************************************************************/
/*! exports provided: AuthCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthCache", function() { return AuthCache; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/Constants */ "vFME");
/* harmony import */ var _AccessTokenCacheItem__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AccessTokenCacheItem */ "9Xmr");
/* harmony import */ var _BrowserStorage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./BrowserStorage */ "Z2zU");
/* harmony import */ var _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/RequestUtils */ "tjEs");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/StringUtils */ "Ft/c");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */






/**
 * @hidden
 */
var AuthCache = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AuthCache, _super);
    function AuthCache(clientId, cacheLocation, storeAuthStateInCookie) {
        var _this = _super.call(this, cacheLocation) || this;
        _this.clientId = clientId;
        // This is hardcoded to true for now. We may make this configurable in the future
        _this.rollbackEnabled = true;
        _this.migrateCacheEntries(storeAuthStateInCookie);
        return _this;
    }
    /**
     * Support roll back to old cache schema until the next major release: true by default now
     * @param storeAuthStateInCookie
     */
    AuthCache.prototype.migrateCacheEntries = function (storeAuthStateInCookie) {
        var _this = this;
        var idTokenKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].IDTOKEN;
        var clientInfoKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].CLIENT_INFO;
        var errorKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR;
        var errorDescKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR_DESC;
        var idTokenValue = _super.prototype.getItem.call(this, idTokenKey);
        var clientInfoValue = _super.prototype.getItem.call(this, clientInfoKey);
        var errorValue = _super.prototype.getItem.call(this, errorKey);
        var errorDescValue = _super.prototype.getItem.call(this, errorDescKey);
        var values = [idTokenValue, clientInfoValue, errorValue, errorDescValue];
        var keysToMigrate = [_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].IDTOKEN, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].CLIENT_INFO, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR_DESC];
        keysToMigrate.forEach(function (cacheKey, index) { return _this.duplicateCacheEntry(cacheKey, values[index], storeAuthStateInCookie); });
    };
    /**
     * Utility function to help with roll back keys
     * @param newKey
     * @param value
     * @param storeAuthStateInCookie
     */
    AuthCache.prototype.duplicateCacheEntry = function (newKey, value, storeAuthStateInCookie) {
        if (value) {
            this.setItem(newKey, value, storeAuthStateInCookie);
        }
    };
    /**
     * Prepend msal.<client-id> to each key; Skip for any JSON object as Key (defined schemas do not need the key appended: AccessToken Keys or the upcoming schema)
     * @param key
     * @param addInstanceId
     */
    AuthCache.prototype.generateCacheKey = function (key, addInstanceId) {
        try {
            // Defined schemas do not need the key appended
            JSON.parse(key);
            return key;
        }
        catch (e) {
            if (key.indexOf("" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix) === 0 || key.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].adalIdToken) === 0) {
                return key;
            }
            return addInstanceId ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + this.clientId + "." + key : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + key;
        }
    };
    /**
     * Validates that the input cache key contains the account search terms (clientId and homeAccountIdentifier) and
     * then whether or not it contains the "scopes", depending on the token type being searched for. With matching account
     * search terms, Access Token search tries to match the "scopes" keyword, while Id Token search expects "scopes" to not be included.
     * @param key
     * @param clientId
     * @param homeAccountIdentifier
     * @param tokenType
     */
    AuthCache.prototype.matchKeyForType = function (key, clientId, homeAccountIdentifier, tokenType) {
        // All valid token cache item keys are valid JSON objects, ignore keys that aren't
        var parsedKey = _utils_StringUtils__WEBPACK_IMPORTED_MODULE_5__["StringUtils"].validateAndParseJsonCacheKey(key);
        if (!parsedKey) {
            return null;
        }
        // Does the cache item match the request account
        var accountMatches = key.match(clientId) && key.match(homeAccountIdentifier);
        // Does the cache item match the requested token type
        var tokenTypeMatches = false;
        switch (tokenType) {
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ACCESS_TOKEN:
                // Cache item is an access token if scopes are included in the cache item key
                tokenTypeMatches = !!key.match(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].scopes);
                break;
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ID_TOKEN:
                // Cache may be an ID token if scopes are NOT included in the cache item key
                tokenTypeMatches = !key.match(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].scopes);
                break;
        }
        return (accountMatches && tokenTypeMatches) ? parsedKey : null;
    };
    /**
     * add value to storage
     * @param key
     * @param value
     * @param enableCookieStorage
     */
    AuthCache.prototype.setItem = function (key, value, enableCookieStorage) {
        _super.prototype.setItem.call(this, this.generateCacheKey(key, true), value, enableCookieStorage);
        // Values stored in cookies will have rollback disabled to minimize cookie length
        if (this.rollbackEnabled && !enableCookieStorage) {
            _super.prototype.setItem.call(this, this.generateCacheKey(key, false), value, enableCookieStorage);
        }
    };
    /**
     * get one item by key from storage
     * @param key
     * @param enableCookieStorage
     */
    AuthCache.prototype.getItem = function (key, enableCookieStorage) {
        return _super.prototype.getItem.call(this, this.generateCacheKey(key, true), enableCookieStorage);
    };
    /**
     * remove value from storage
     * @param key
     */
    AuthCache.prototype.removeItem = function (key) {
        _super.prototype.removeItem.call(this, this.generateCacheKey(key, true));
        if (this.rollbackEnabled) {
            _super.prototype.removeItem.call(this, this.generateCacheKey(key, false));
        }
    };
    /**
     * Reset the cache items
     */
    AuthCache.prototype.resetCacheItems = function () {
        var storage = window[this.cacheLocation];
        var key;
        for (key in storage) {
            // Check if key contains msal prefix; For now, we are clearing all cache items created by MSAL.js
            if (storage.hasOwnProperty(key) && (key.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix) !== -1)) {
                _super.prototype.removeItem.call(this, key);
                // TODO: Clear cache based on client id (clarify use cases where this is needed)
            }
        }
    };
    /**
     * Reset all temporary cache items
     */
    AuthCache.prototype.resetTempCacheItems = function (state) {
        var _this = this;
        var stateId = state && _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__["RequestUtils"].parseLibraryState(state).id;
        var isTokenRenewalInProgress = this.tokenRenewalInProgress(state);
        var storage = window[this.cacheLocation];
        // check state and remove associated cache
        if (stateId && !isTokenRenewalInProgress) {
            Object.keys(storage).forEach(function (key) {
                if (key.indexOf(stateId) !== -1) {
                    _this.removeItem(key);
                    _super.prototype.clearItemCookie.call(_this, key);
                }
            });
        }
        // delete the interaction status cache
        this.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].INTERACTION_STATUS);
        this.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].REDIRECT_REQUEST);
    };
    /**
     * Set cookies for IE
     * @param cName
     * @param cValue
     * @param expires
     */
    AuthCache.prototype.setItemCookie = function (cName, cValue, expires) {
        _super.prototype.setItemCookie.call(this, this.generateCacheKey(cName, true), cValue, expires);
        if (this.rollbackEnabled) {
            _super.prototype.setItemCookie.call(this, this.generateCacheKey(cName, false), cValue, expires);
        }
    };
    AuthCache.prototype.clearItemCookie = function (cName) {
        _super.prototype.clearItemCookie.call(this, this.generateCacheKey(cName, true));
        if (this.rollbackEnabled) {
            _super.prototype.clearItemCookie.call(this, this.generateCacheKey(cName, false));
        }
    };
    /**
     * get one item by key from cookies
     * @param cName
     */
    AuthCache.prototype.getItemCookie = function (cName) {
        return _super.prototype.getItemCookie.call(this, this.generateCacheKey(cName, true));
    };
    /**
     * Get all tokens of a certain type from the cache
     * @param clientId
     * @param homeAccountIdentifier
     * @param tokenType
     */
    AuthCache.prototype.getAllTokensByType = function (clientId, homeAccountIdentifier, tokenType) {
        var _this = this;
        var results = Object.keys(window[this.cacheLocation]).reduce(function (tokens, key) {
            var matchedTokenKey = _this.matchKeyForType(key, clientId, homeAccountIdentifier, tokenType);
            if (matchedTokenKey) {
                var value = _this.getItem(key);
                if (value) {
                    try {
                        var newAccessTokenCacheItem = new _AccessTokenCacheItem__WEBPACK_IMPORTED_MODULE_2__["AccessTokenCacheItem"](matchedTokenKey, JSON.parse(value));
                        return tokens.concat([newAccessTokenCacheItem]);
                    }
                    catch (err) {
                        // Skip cache items with non-valid JSON values
                        return tokens;
                    }
                }
            }
            return tokens;
        }, []);
        return results;
    };
    /**
     * Get all access tokens in the cache
     * @param clientId
     * @param homeAccountIdentifier
     */
    AuthCache.prototype.getAllAccessTokens = function (clientId, homeAccountIdentifier) {
        return this.getAllTokensByType(clientId, homeAccountIdentifier, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ACCESS_TOKEN);
    };
    /**
     * Get all id tokens in the cache in the form of AccessTokenCacheItem objects so they are
     * in a normalized format and can make use of the existing cached access token validation logic
     */
    AuthCache.prototype.getAllIdTokens = function (clientId, homeAccountIdentifier) {
        return this.getAllTokensByType(clientId, homeAccountIdentifier, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ID_TOKEN);
    };
    /**
     * Get all access and ID tokens in the cache
     * @param clientId
     * @param homeAccountIdentifier
     */
    AuthCache.prototype.getAllTokens = function (clientId, homeAccountIdentifier) {
        var accessTokens = this.getAllAccessTokens(clientId, homeAccountIdentifier);
        var idTokens = this.getAllIdTokens(clientId, homeAccountIdentifier);
        return accessTokens.concat(idTokens);
    };
    /**
     * Return if the token renewal is still in progress
     *
     * @param stateValue
     */
    AuthCache.prototype.tokenRenewalInProgress = function (stateValue) {
        var renewStatus = this.getItem(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].RENEW_STATUS, stateValue));
        return !!(renewStatus && renewStatus === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].inProgress);
    };
    /**
     * Clear all cookies
     */
    AuthCache.prototype.clearMsalCookie = function (state) {
        var _this = this;
        /*
         * If state is truthy, remove values associated with that request.
         * Otherwise, remove all MSAL cookies.
         */
        if (state) {
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].NONCE_IDTOKEN, state));
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].STATE_LOGIN, state));
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].LOGIN_REQUEST, state));
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].STATE_ACQ_TOKEN, state));
        }
        else {
            var cookies = document.cookie.split(";");
            cookies.forEach(function (cookieString) {
                var cookieName = cookieString.trim().split("=")[0];
                if (cookieName.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix) > -1) {
                    _super.prototype.clearItemCookie.call(_this, cookieName);
                }
            });
        }
    };
    /**
     * Create acquireTokenAccountKey to cache account object
     * @param accountId
     * @param state
     */
    AuthCache.generateAcquireTokenAccountKey = function (accountId, state) {
        var stateId = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__["RequestUtils"].parseLibraryState(state).id;
        return "" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].ACQUIRE_TOKEN_ACCOUNT + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + accountId + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + stateId;
    };
    /**
     * Create authorityKey to cache authority
     * @param state
     */
    AuthCache.generateAuthorityKey = function (state) {
        return AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].AUTHORITY, state);
    };
    /**
     * Generates the cache key for temporary cache items, using request state
     * @param tempCacheKey Cache key prefix
     * @param state Request state value
     */
    AuthCache.generateTemporaryCacheKey = function (tempCacheKey, state) {
        // Use the state id (a guid), in the interest of shorter key names, which is important for cookies.
        var stateId = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__["RequestUtils"].parseLibraryState(state).id;
        return "" + tempCacheKey + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + stateId;
    };
    return AuthCache;
}(_BrowserStorage__WEBPACK_IMPORTED_MODULE_3__["BrowserStorage"]));

//# sourceMappingURL=AuthCache.js.map

/***/ }),

/***/ "n3St":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/error/ServerError.js ***!
  \*******************************************************************************************************/
/*! exports provided: ServerErrorMessage, ServerError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerErrorMessage", function() { return ServerErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerError", function() { return ServerError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuthError */ "MEWQ");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var ServerErrorMessage = {
    serverUnavailable: {
        code: "server_unavailable",
        desc: "Server is temporarily unavailable."
    },
    unknownServerError: {
        code: "unknown_server_error"
    },
};
/**
 * Error thrown when there is an error with the server code, for example, unavailability.
 */
var ServerError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ServerError, _super);
    function ServerError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ServerError";
        Object.setPrototypeOf(_this, ServerError.prototype);
        return _this;
    }
    ServerError.createServerUnavailableError = function () {
        return new ServerError(ServerErrorMessage.serverUnavailable.code, ServerErrorMessage.serverUnavailable.desc);
    };
    ServerError.createUnknownServerError = function (errorDesc) {
        return new ServerError(ServerErrorMessage.unknownServerError.code, errorDesc);
    };
    return ServerError;
}(_AuthError__WEBPACK_IMPORTED_MODULE_1__["AuthError"]));

//# sourceMappingURL=ServerError.js.map

/***/ }),

/***/ "n82g":
/*!******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/error/ClientAuthError.js ***!
  \******************************************************************************************************/
/*! exports provided: ClientAuthErrorMessage, ClientAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientAuthErrorMessage", function() { return ClientAuthErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientAuthError", function() { return ClientAuthError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuthError */ "UrvO");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StringUtils */ "k+Uk");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */



var ClientAuthErrorMessage = {
    multipleCacheAuthorities: {
        code: "multiple_authorities",
        desc: "Multiple authorities found in the cache. Pass authority in the API overload."
    },
    endpointResolutionError: {
        code: "endpoints_resolution_error",
        desc: "Error: could not resolve endpoints. Please check network and try again."
    },
    popUpWindowError: {
        code: "popup_window_error",
        desc: "Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."
    },
    tokenRenewalError: {
        code: "token_renewal_error",
        desc: "Token renewal operation failed due to timeout."
    },
    invalidIdToken: {
        code: "invalid_id_token",
        desc: "Invalid ID token format."
    },
    invalidStateError: {
        code: "invalid_state_error",
        desc: "Invalid state."
    },
    nonceMismatchError: {
        code: "nonce_mismatch_error",
        desc: "Nonce is not matching, Nonce received: "
    },
    loginProgressError: {
        code: "login_progress_error",
        desc: "Login_In_Progress: Error during login call - login is already in progress."
    },
    acquireTokenProgressError: {
        code: "acquiretoken_progress_error",
        desc: "AcquireToken_In_Progress: Error during login call - login is already in progress."
    },
    userCancelledError: {
        code: "user_cancelled",
        desc: "User cancelled the flow."
    },
    callbackError: {
        code: "callback_error",
        desc: "Error occurred in token received callback function."
    },
    userLoginRequiredError: {
        code: "user_login_error",
        desc: "User login is required. For silent calls, request must contain either sid or login_hint"
    },
    userDoesNotExistError: {
        code: "user_non_existent",
        desc: "User object does not exist. Please call a login API."
    },
    clientInfoDecodingError: {
        code: "client_info_decoding_error",
        desc: "The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."
    },
    clientInfoNotPopulatedError: {
        code: "client_info_not_populated_error",
        desc: "The service did not populate client_info in the response, Please verify with the service team"
    },
    nullOrEmptyIdToken: {
        code: "null_or_empty_id_token",
        desc: "The idToken is null or empty. Please review the trace to determine the root cause."
    },
    idTokenNotParsed: {
        code: "id_token_parsing_error",
        desc: "ID token cannot be parsed. Please review stack trace to determine root cause."
    },
    tokenEncodingError: {
        code: "token_encoding_error",
        desc: "The token to be decoded is not encoded correctly."
    },
    invalidInteractionType: {
        code: "invalid_interaction_type",
        desc: "The interaction type passed to the handler was incorrect or unknown"
    },
    cacheParseError: {
        code: "cannot_parse_cache",
        desc: "The cached token key is not a valid JSON and cannot be parsed"
    },
    blockTokenRequestsInHiddenIframe: {
        code: "block_token_requests",
        desc: "Token calls are blocked in hidden iframes"
    }
};
/**
 * Error thrown when there is an error in the client code running on the browser.
 */
var ClientAuthError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ClientAuthError, _super);
    function ClientAuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ClientAuthError";
        Object.setPrototypeOf(_this, ClientAuthError.prototype);
        return _this;
    }
    ClientAuthError.createEndpointResolutionError = function (errDetail) {
        var errorMessage = ClientAuthErrorMessage.endpointResolutionError.desc;
        if (errDetail && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(errDetail)) {
            errorMessage += " Details: " + errDetail;
        }
        return new ClientAuthError(ClientAuthErrorMessage.endpointResolutionError.code, errorMessage);
    };
    ClientAuthError.createMultipleAuthoritiesInCacheError = function (scope) {
        return new ClientAuthError(ClientAuthErrorMessage.multipleCacheAuthorities.code, "Cache error for scope " + scope + ": " + ClientAuthErrorMessage.multipleCacheAuthorities.desc + ".");
    };
    ClientAuthError.createPopupWindowError = function (errDetail) {
        var errorMessage = ClientAuthErrorMessage.popUpWindowError.desc;
        if (errDetail && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(errDetail)) {
            errorMessage += " Details: " + errDetail;
        }
        return new ClientAuthError(ClientAuthErrorMessage.popUpWindowError.code, errorMessage);
    };
    ClientAuthError.createTokenRenewalTimeoutError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.tokenRenewalError.code, ClientAuthErrorMessage.tokenRenewalError.desc);
    };
    ClientAuthError.createInvalidIdTokenError = function (idToken) {
        return new ClientAuthError(ClientAuthErrorMessage.invalidIdToken.code, ClientAuthErrorMessage.invalidIdToken.desc + " Given token: " + idToken);
    };
    // TODO: Is this not a security flaw to send the user the state expected??
    ClientAuthError.createInvalidStateError = function (invalidState, actualState) {
        return new ClientAuthError(ClientAuthErrorMessage.invalidStateError.code, ClientAuthErrorMessage.invalidStateError.desc + " " + invalidState + ", state expected : " + actualState + ".");
    };
    // TODO: Is this not a security flaw to send the user the Nonce expected??
    ClientAuthError.createNonceMismatchError = function (invalidNonce, actualNonce) {
        return new ClientAuthError(ClientAuthErrorMessage.nonceMismatchError.code, ClientAuthErrorMessage.nonceMismatchError.desc + " " + invalidNonce + ", nonce expected : " + actualNonce + ".");
    };
    ClientAuthError.createLoginInProgressError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.loginProgressError.code, ClientAuthErrorMessage.loginProgressError.desc);
    };
    ClientAuthError.createAcquireTokenInProgressError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.acquireTokenProgressError.code, ClientAuthErrorMessage.acquireTokenProgressError.desc);
    };
    ClientAuthError.createUserCancelledError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userCancelledError.code, ClientAuthErrorMessage.userCancelledError.desc);
    };
    ClientAuthError.createErrorInCallbackFunction = function (errorDesc) {
        return new ClientAuthError(ClientAuthErrorMessage.callbackError.code, ClientAuthErrorMessage.callbackError.desc + " " + errorDesc + ".");
    };
    ClientAuthError.createUserLoginRequiredError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userLoginRequiredError.code, ClientAuthErrorMessage.userLoginRequiredError.desc);
    };
    ClientAuthError.createUserDoesNotExistError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.userDoesNotExistError.code, ClientAuthErrorMessage.userDoesNotExistError.desc);
    };
    ClientAuthError.createClientInfoDecodingError = function (caughtError) {
        return new ClientAuthError(ClientAuthErrorMessage.clientInfoDecodingError.code, ClientAuthErrorMessage.clientInfoDecodingError.desc + " Failed with error: " + caughtError);
    };
    ClientAuthError.createClientInfoNotPopulatedError = function (caughtError) {
        return new ClientAuthError(ClientAuthErrorMessage.clientInfoNotPopulatedError.code, ClientAuthErrorMessage.clientInfoNotPopulatedError.desc + " Failed with error: " + caughtError);
    };
    ClientAuthError.createIdTokenNullOrEmptyError = function (invalidRawTokenString) {
        return new ClientAuthError(ClientAuthErrorMessage.nullOrEmptyIdToken.code, ClientAuthErrorMessage.nullOrEmptyIdToken.desc + " Raw ID Token Value: " + invalidRawTokenString);
    };
    ClientAuthError.createIdTokenParsingError = function (caughtParsingError) {
        return new ClientAuthError(ClientAuthErrorMessage.idTokenNotParsed.code, ClientAuthErrorMessage.idTokenNotParsed.desc + " Failed with error: " + caughtParsingError);
    };
    ClientAuthError.createTokenEncodingError = function (incorrectlyEncodedToken) {
        return new ClientAuthError(ClientAuthErrorMessage.tokenEncodingError.code, ClientAuthErrorMessage.tokenEncodingError.desc + " Attempted to decode: " + incorrectlyEncodedToken);
    };
    ClientAuthError.createInvalidInteractionTypeError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.invalidInteractionType.code, ClientAuthErrorMessage.invalidInteractionType.desc);
    };
    ClientAuthError.createCacheParseError = function (key) {
        var errorMessage = "invalid key: " + key + ", " + ClientAuthErrorMessage.cacheParseError.desc;
        return new ClientAuthError(ClientAuthErrorMessage.cacheParseError.code, errorMessage);
    };
    ClientAuthError.createBlockTokenRequestsInHiddenIframeError = function () {
        return new ClientAuthError(ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.code, ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.desc);
    };
    return ClientAuthError;
}(_AuthError__WEBPACK_IMPORTED_MODULE_1__["AuthError"]));

//# sourceMappingURL=ClientAuthError.js.map

/***/ }),

/***/ "nT0M":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/ChaosStrategy.js ***!
  \***************************************************************************************************/
/*! exports provided: ChaosStrategy */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChaosStrategy", function() { return ChaosStrategy; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module ChaosStrategy
 */
/**
 * Strategy used for Testing Handler
 * @enum
 */
var ChaosStrategy;
(function (ChaosStrategy) {
    ChaosStrategy[ChaosStrategy["MANUAL"] = 0] = "MANUAL";
    ChaosStrategy[ChaosStrategy["RANDOM"] = 1] = "RANDOM";
})(ChaosStrategy || (ChaosStrategy = {}));
//# sourceMappingURL=ChaosStrategy.js.map

/***/ }),

/***/ "nVLA":
/*!*******************************************************!*\
  !*** ./node_modules/@microsoft/mgt/dist/es6/index.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _microsoft_mgt_components__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/mgt-components */ "rYEk");
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _microsoft_mgt_components__WEBPACK_IMPORTED_MODULE_1__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _microsoft_mgt_components__WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _microsoft_mgt_msal_provider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/mgt-msal-provider */ "ZDPT");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MsalProvider", function() { return _microsoft_mgt_msal_provider__WEBPACK_IMPORTED_MODULE_2__["MsalProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtMsalProvider", function() { return _microsoft_mgt_msal_provider__WEBPACK_IMPORTED_MODULE_2__["MgtMsalProvider"]; });

/* harmony import */ var _microsoft_mgt_teams_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @microsoft/mgt-teams-provider */ "+syW");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TeamsProvider", function() { return _microsoft_mgt_teams_provider__WEBPACK_IMPORTED_MODULE_3__["TeamsProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtTeamsProvider", function() { return _microsoft_mgt_teams_provider__WEBPACK_IMPORTED_MODULE_3__["MgtTeamsProvider"]; });

/* harmony import */ var _microsoft_mgt_proxy_provider__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @microsoft/mgt-proxy-provider */ "hBCo");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ProxyProvider", function() { return _microsoft_mgt_proxy_provider__WEBPACK_IMPORTED_MODULE_4__["ProxyProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MgtProxyProvider", function() { return _microsoft_mgt_proxy_provider__WEBPACK_IMPORTED_MODULE_4__["MgtProxyProvider"]; });

/* harmony import */ var _microsoft_mgt_sharepoint_provider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @microsoft/mgt-sharepoint-provider */ "2GLH");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SharePointProvider", function() { return _microsoft_mgt_sharepoint_provider__WEBPACK_IMPORTED_MODULE_5__["SharePointProvider"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */






//# sourceMappingURL=index.js.map

/***/ }),

/***/ "nWAj":
/*!************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/HTTPMessageHandler.js ***!
  \************************************************************************************************/
/*! exports provided: HTTPMessageHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTPMessageHandler", function() { return HTTPMessageHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @class
 * @implements Middleware
 * Class for HTTPMessageHandler
 */
class HTTPMessageHandler {
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The request context object
     * @returns A promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                context.response = yield fetch(context.request, context.options);
                return;
            }
            catch (error) {
                throw error;
            }
        });
    }
}
//# sourceMappingURL=HTTPMessageHandler.js.map

/***/ }),

/***/ "nclX":
/*!******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-tasks/mgt-tasks.graph.todo.js ***!
  \******************************************************************************************************/
/*! exports provided: addTodoTask, getAllMyTodoGroups, getAllTodoTasksForFolder, getFoldersForTodoGroup, getSingleTodoGroup, removeTodoTask, setTodoTaskComplete, setTodoTaskIncomplete, setTodoTaskDetails */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addTodoTask", function() { return addTodoTask; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getAllMyTodoGroups", function() { return getAllMyTodoGroups; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getAllTodoTasksForFolder", function() { return getAllTodoTasksForFolder; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFoldersForTodoGroup", function() { return getFoldersForTodoGroup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSingleTodoGroup", function() { return getSingleTodoGroup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeTodoTask", function() { return removeTodoTask; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setTodoTaskComplete", function() { return setTodoTaskComplete; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setTodoTaskIncomplete", function() { return setTodoTaskIncomplete; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setTodoTaskDetails", function() { return setTodoTaskDetails; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

/**
 * async promise, allows developer to add new to-do task
 *
 * @param {*} newTask
 * @returns {Promise<OutlookTask>}
 * @memberof BetaGraph
 */
function addTodoTask(graph, newTask) {
    return __awaiter(this, void 0, void 0, function* () {
        const { parentFolderId = null } = newTask;
        if (parentFolderId) {
            return yield graph
                .api(`/me/outlook/taskFolders/${parentFolderId}/tasks`)
                .header('Cache-Control', 'no-store')
                .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
                .post(newTask);
        }
        else {
            return yield graph
                .api('/me/outlook/tasks')
                .header('Cache-Control', 'no-store')
                .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
                .post(newTask);
        }
    });
}
/**
 * async promise, returns all Outlook taskGroups associated with the logged in user
 *
 * @returns {Promise<OutlookTaskGroup[]>}
 * @memberof BetaGraph
 */
function getAllMyTodoGroups(graph) {
    return __awaiter(this, void 0, void 0, function* () {
        const groups = yield graph
            .api('/me/outlook/taskGroups')
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.Read'))
            .get();
        return groups && groups.value;
    });
}
/**
 * async promise, returns all Outlook tasks associated with a taskFolder with folderId
 *
 * @param {string} folderId
 * @returns {Promise<OutlookTask[]>}
 * @memberof BetaGraph
 */
function getAllTodoTasksForFolder(graph, folderId) {
    return __awaiter(this, void 0, void 0, function* () {
        const tasks = yield graph
            .api(`/me/outlook/taskFolders/${folderId}/tasks`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.Read'))
            .get();
        return tasks && tasks.value;
    });
}
/**
 * async promise, returns all Outlook taskFolders associated with groupId
 *
 * @param {string} groupId
 * @returns {Promise<OutlookTaskFolder[]>}
 * @memberof BetaGraph
 */
function getFoldersForTodoGroup(graph, groupId) {
    return __awaiter(this, void 0, void 0, function* () {
        const folders = yield graph
            .api(`/me/outlook/taskGroups/${groupId}/taskFolders`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.Read'))
            .get();
        return folders && folders.value;
    });
}
/**
 * async promise, returns to-do tasks from Outlook groups associated with a groupId
 *
 * @param {string} groupId
 * @returns {Promise<OutlookTaskGroup>}
 * @memberof BetaGraph
 */
function getSingleTodoGroup(graph, groupId) {
    return __awaiter(this, void 0, void 0, function* () {
        const group = yield graph
            .api(`/me/outlook/taskGroups/${groupId}`)
            .header('Cache-Control', 'no-store')
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.Read'))
            .get();
        return group;
    });
}
/**
 * async promise, allows developer to remove task based on taskId
 *
 * @param {string} taskId
 * @param {string} eTag
 * @returns {Promise<any>}
 * @memberof BetaGraph
 */
function removeTodoTask(graph, taskId, eTag) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield graph
            .api(`/me/outlook/tasks/${taskId}`)
            .header('Cache-Control', 'no-store')
            .header('If-Match', eTag)
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
            .delete();
    });
}
/**
 * async promise, allows developer to set to-do task to completed state
 *
 * @param {string} taskId
 * @param {string} eTag
 * @returns {Promise<OutlookTask>}
 * @memberof BetaGraph
 */
function setTodoTaskComplete(graph, taskId, eTag) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield setTodoTaskDetails(graph, taskId, {
            isReminderOn: false,
            status: 'completed'
        }, eTag);
    });
}
/**
 * async promise, allows developer to set to-do task to incomplete state
 *
 * @param {string} taskId
 * @param {string} eTag
 * @returns {Promise<OutlookTask>}
 * @memberof BetaGraph
 */
function setTodoTaskIncomplete(graph, taskId, eTag) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield setTodoTaskDetails(graph, taskId, {
            isReminderOn: true,
            status: 'notStarted'
        }, eTag);
    });
}
/**
 * async promise, allows developer to redefine to-do Task details associated with a taskId
 *
 * @param {string} taskId
 * @param {*} task
 * @param {string} eTag
 * @returns {Promise<OutlookTask>}
 * @memberof BetaGraph
 */
function setTodoTaskDetails(graph, taskId, task, eTag) {
    return __awaiter(this, void 0, void 0, function* () {
        return yield graph
            .api(`/me/outlook/tasks/${taskId}`)
            .header('Cache-Control', 'no-store')
            .header('If-Match', eTag)
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])('Tasks.ReadWrite'))
            .patch(task);
    });
}
//# sourceMappingURL=mgt-tasks.graph.todo.js.map

/***/ }),

/***/ "nz8i":
/*!******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/ComponentMiddlewareOptions.js ***!
  \******************************************************************************************/
/*! exports provided: ComponentMiddlewareOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComponentMiddlewareOptions", function() { return ComponentMiddlewareOptions; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * Middleware Options used for component telemetry
 *
 * @export
 * @class ComponentMiddlewareOptions
 * @implements {MiddlewareOptions}
 */
class ComponentMiddlewareOptions {
    constructor(component) {
        if (typeof component === 'string') {
            this.componentName = component;
        }
        else {
            this.componentName = component.tagName.toLowerCase();
        }
    }
}
//# sourceMappingURL=ComponentMiddlewareOptions.js.map

/***/ }),

/***/ "ocZF":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/MiddlewareControl.js ***!
  \***********************************************************************************************************************************/
/*! exports provided: MiddlewareControl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MiddlewareControl", function() { return MiddlewareControl; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * Class representing MiddlewareControl
 */
class MiddlewareControl {
    /**
     * @public
     * @constructor
     * Creates an instance of MiddlewareControl
     * @param {MiddlewareOptions[]} [middlewareOptions = []] - The array of middlewareOptions
     * @returns The instance of MiddlewareControl
     */
    constructor(middlewareOptions = []) {
        // tslint:disable-next-line:ban-types
        this.middlewareOptions = new Map();
        for (const option of middlewareOptions) {
            const fn = option.constructor;
            this.middlewareOptions.set(fn, option);
        }
    }
    /**
     * @public
     * To get the middleware option using the class of the option
     * @param {Function} fn - The class of the strongly typed option class
     * @returns The middleware option
     * @example
     * // if you wanted to return the middleware option associated with this class (MiddlewareControl)
     * // call this function like this:
     * getMiddlewareOptions(MiddlewareControl)
     */
    // tslint:disable-next-line:ban-types
    getMiddlewareOptions(fn) {
        return this.middlewareOptions.get(fn);
    }
    /**
     * @public
     * To set the middleware options using the class of the option
     * @param {Function} fn - The class of the strongly typed option class
     * @param {MiddlewareOptions} option - The strongly typed middleware option
     * @returns nothing
     */
    // tslint:disable-next-line:ban-types
    setMiddlewareOptions(fn, option) {
        this.middlewareOptions.set(fn, option);
    }
}
//# sourceMappingURL=MiddlewareControl.js.map

/***/ }),

/***/ "oish":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/utils/CryptoUtils.js ***!
  \*******************************************************************************************************/
/*! exports provided: CryptoUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CryptoUtils", function() { return CryptoUtils; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var CryptoUtils = /** @class */ (function () {
    function CryptoUtils() {
    }
    /**
     * Creates a new random GUID
     * @returns string (GUID)
     */
    CryptoUtils.createNewGuid = function () {
        /*
         * RFC4122: The version 4 UUID is meant for generating UUIDs from truly-random or
         * pseudo-random numbers.
         * The algorithm is as follows:
         *     Set the two most significant bits (bits 6 and 7) of the
         *        clock_seq_hi_and_reserved to zero and one, respectively.
         *     Set the four most significant bits (bits 12 through 15) of the
         *        time_hi_and_version field to the 4-bit version number from
         *        Section 4.1.3. Version4
         *     Set all the other bits to randomly (or pseudo-randomly) chosen
         *     values.
         * UUID                   = time-low "-" time-mid "-"time-high-and-version "-"clock-seq-reserved and low(2hexOctet)"-" node
         * time-low               = 4hexOctet
         * time-mid               = 2hexOctet
         * time-high-and-version  = 2hexOctet
         * clock-seq-and-reserved = hexOctet:
         * clock-seq-low          = hexOctet
         * node                   = 6hexOctet
         * Format: xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx
         * y could be 1000, 1001, 1010, 1011 since most significant two bits needs to be 10
         * y values are 8, 9, A, B
         */
        var cryptoObj = window.crypto; // for IE 11
        if (cryptoObj && cryptoObj.getRandomValues) {
            var buffer = new Uint8Array(16);
            cryptoObj.getRandomValues(buffer);
            // buffer[6] and buffer[7] represents the time_hi_and_version field. We will set the four most significant bits (4 through 7) of buffer[6] to represent decimal number 4 (UUID version number).
            buffer[6] |= 0x40; // buffer[6] | 01000000 will set the 6 bit to 1.
            buffer[6] &= 0x4f; // buffer[6] & 01001111 will set the 4, 5, and 7 bit to 0 such that bits 4-7 == 0100 = "4".
            // buffer[8] represents the clock_seq_hi_and_reserved field. We will set the two most significant bits (6 and 7) of the clock_seq_hi_and_reserved to zero and one, respectively.
            buffer[8] |= 0x80; // buffer[8] | 10000000 will set the 7 bit to 1.
            buffer[8] &= 0xbf; // buffer[8] & 10111111 will set the 6 bit to 0.
            return CryptoUtils.decimalToHex(buffer[0]) + CryptoUtils.decimalToHex(buffer[1])
                + CryptoUtils.decimalToHex(buffer[2]) + CryptoUtils.decimalToHex(buffer[3])
                + "-" + CryptoUtils.decimalToHex(buffer[4]) + CryptoUtils.decimalToHex(buffer[5])
                + "-" + CryptoUtils.decimalToHex(buffer[6]) + CryptoUtils.decimalToHex(buffer[7])
                + "-" + CryptoUtils.decimalToHex(buffer[8]) + CryptoUtils.decimalToHex(buffer[9])
                + "-" + CryptoUtils.decimalToHex(buffer[10]) + CryptoUtils.decimalToHex(buffer[11])
                + CryptoUtils.decimalToHex(buffer[12]) + CryptoUtils.decimalToHex(buffer[13])
                + CryptoUtils.decimalToHex(buffer[14]) + CryptoUtils.decimalToHex(buffer[15]);
        }
        else {
            var guidHolder = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";
            var hex = "0123456789abcdef";
            var r = 0;
            var guidResponse = "";
            for (var i = 0; i < 36; i++) {
                if (guidHolder[i] !== "-" && guidHolder[i] !== "4") {
                    // each x and y needs to be random
                    r = Math.random() * 16 | 0;
                }
                if (guidHolder[i] === "x") {
                    guidResponse += hex[r];
                }
                else if (guidHolder[i] === "y") {
                    // clock-seq-and-reserved first hex is filtered and remaining hex values are random
                    r &= 0x3; // bit and with 0011 to set pos 2 to zero ?0??
                    r |= 0x8; // set pos 3 to 1 as 1???
                    guidResponse += hex[r];
                }
                else {
                    guidResponse += guidHolder[i];
                }
            }
            return guidResponse;
        }
    };
    /**
     * verifies if a string is  GUID
     * @param guid
     */
    CryptoUtils.isGuid = function (guid) {
        var regexGuid = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;
        return regexGuid.test(guid);
    };
    /**
     * Decimal to Hex
     *
     * @param num
     */
    CryptoUtils.decimalToHex = function (num) {
        var hex = num.toString(16);
        while (hex.length < 2) {
            hex = "0" + hex;
        }
        return hex;
    };
    // See: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#Solution_4_%E2%80%93_escaping_the_string_before_encoding_it
    /**
     * encoding string to base64 - platform specific check
     *
     * @param input
     */
    CryptoUtils.base64Encode = function (input) {
        return btoa(encodeURIComponent(input).replace(/%([0-9A-F]{2})/g, function toSolidBytes(match, p1) {
            return String.fromCharCode(Number("0x" + p1));
        }));
    };
    /**
     * Decodes a base64 encoded string.
     *
     * @param input
     */
    CryptoUtils.base64Decode = function (input) {
        var encodedString = input.replace(/-/g, "+").replace(/_/g, "/");
        switch (encodedString.length % 4) {
            case 0:
                break;
            case 2:
                encodedString += "==";
                break;
            case 3:
                encodedString += "=";
                break;
            default:
                throw new Error("Invalid base64 string");
        }
        return decodeURIComponent(atob(encodedString).split("").map(function (c) {
            return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(""));
    };
    /**
     * deserialize a string
     *
     * @param query
     */
    CryptoUtils.deserialize = function (query) {
        var match; // Regex for replacing addition symbol with a space
        var pl = /\+/g;
        var search = /([^&=]+)=([^&]*)/g;
        var decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); };
        var obj = {};
        match = search.exec(query);
        while (match) {
            obj[decode(match[1])] = decode(match[2]);
            match = search.exec(query);
        }
        return obj;
    };
    return CryptoUtils;
}());

//# sourceMappingURL=CryptoUtils.js.map

/***/ }),

/***/ "ovzL":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/error/ClientConfigurationError.js ***!
  \*********************************************************************************************************/
/*! exports provided: ClientConfigurationErrorMessage, ClientConfigurationError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientConfigurationErrorMessage", function() { return ClientConfigurationErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClientConfigurationError", function() { return ClientConfigurationError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _ClientAuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ClientAuthError */ "859E");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var ClientConfigurationErrorMessage = {
    configurationNotSet: {
        code: "no_config_set",
        desc: "Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."
    },
    storageNotSupported: {
        code: "storage_not_supported",
        desc: "The value for the cacheLocation is not supported."
    },
    noRedirectCallbacksSet: {
        code: "no_redirect_callbacks",
        desc: "No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. " +
            "More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."
    },
    invalidCallbackObject: {
        code: "invalid_callback_object",
        desc: "The object passed for the callback was invalid. " +
            "More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."
    },
    scopesRequired: {
        code: "scopes_required",
        desc: "Scopes are required to obtain an access token."
    },
    emptyScopes: {
        code: "empty_input_scopes_error",
        desc: "Scopes cannot be passed as empty array."
    },
    nonArrayScopes: {
        code: "nonarray_input_scopes_error",
        desc: "Scopes cannot be passed as non-array."
    },
    invalidPrompt: {
        code: "invalid_prompt_value",
        desc: "Supported prompt values are 'login', 'select_account', 'consent' and 'none'",
    },
    invalidAuthorityType: {
        code: "invalid_authority_type",
        desc: "The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."
    },
    authorityUriInsecure: {
        code: "authority_uri_insecure",
        desc: "Authority URIs must use https."
    },
    authorityUriInvalidPath: {
        code: "authority_uri_invalid_path",
        desc: "Given authority URI is invalid."
    },
    unsupportedAuthorityValidation: {
        code: "unsupported_authority_validation",
        desc: "The authority validation is not supported for this authority type."
    },
    untrustedAuthority: {
        code: "untrusted_authority",
        desc: "The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."
    },
    b2cAuthorityUriInvalidPath: {
        code: "b2c_authority_uri_invalid_path",
        desc: "The given URI for the B2C authority is invalid."
    },
    b2cKnownAuthoritiesNotSet: {
        code: "b2c_known_authorities_not_set",
        desc: "Must set known authorities when validateAuthority is set to True and using B2C"
    },
    claimsRequestParsingError: {
        code: "claims_request_parsing_error",
        desc: "Could not parse the given claims request object."
    },
    emptyRequestError: {
        code: "empty_request_error",
        desc: "Request object is required."
    },
    invalidCorrelationIdError: {
        code: "invalid_guid_sent_as_correlationId",
        desc: "Please set the correlationId as a valid guid"
    },
    telemetryConfigError: {
        code: "telemetry_config_error",
        desc: "Telemetry config is not configured with required values"
    },
    ssoSilentError: {
        code: "sso_silent_error",
        desc: "request must contain either sid or login_hint"
    },
    invalidAuthorityMetadataError: {
        code: "authority_metadata_error",
        desc: "Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."
    }
};
/**
 * Error thrown when there is an error in configuration of the .js library.
 */
var ClientConfigurationError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ClientConfigurationError, _super);
    function ClientConfigurationError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "ClientConfigurationError";
        Object.setPrototypeOf(_this, ClientConfigurationError.prototype);
        return _this;
    }
    ClientConfigurationError.createNoSetConfigurationError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.configurationNotSet.code, "" + ClientConfigurationErrorMessage.configurationNotSet.desc);
    };
    ClientConfigurationError.createStorageNotSupportedError = function (givenCacheLocation) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.storageNotSupported.code, ClientConfigurationErrorMessage.storageNotSupported.desc + " Given location: " + givenCacheLocation);
    };
    ClientConfigurationError.createRedirectCallbacksNotSetError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.noRedirectCallbacksSet.code, ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc);
    };
    ClientConfigurationError.createInvalidCallbackObjectError = function (callbackObject) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidCallbackObject.code, ClientConfigurationErrorMessage.invalidCallbackObject.desc + " Given value for callback function: " + callbackObject);
    };
    ClientConfigurationError.createEmptyScopesArrayError = function (scopesValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.emptyScopes.code, ClientConfigurationErrorMessage.emptyScopes.desc + " Given value: " + scopesValue + ".");
    };
    ClientConfigurationError.createScopesNonArrayError = function (scopesValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.nonArrayScopes.code, ClientConfigurationErrorMessage.nonArrayScopes.desc + " Given value: " + scopesValue + ".");
    };
    ClientConfigurationError.createScopesRequiredError = function (scopesValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.scopesRequired.code, ClientConfigurationErrorMessage.scopesRequired.desc + " Given value: " + scopesValue);
    };
    ClientConfigurationError.createInvalidPromptError = function (promptValue) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidPrompt.code, ClientConfigurationErrorMessage.invalidPrompt.desc + " Given value: " + promptValue);
    };
    ClientConfigurationError.createClaimsRequestParsingError = function (claimsRequestParseError) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.claimsRequestParsingError.code, ClientConfigurationErrorMessage.claimsRequestParsingError.desc + " Given value: " + claimsRequestParseError);
    };
    ClientConfigurationError.createEmptyRequestError = function () {
        var _a = ClientConfigurationErrorMessage.emptyRequestError, code = _a.code, desc = _a.desc;
        return new ClientConfigurationError(code, desc);
    };
    ClientConfigurationError.createInvalidCorrelationIdError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidCorrelationIdError.code, ClientConfigurationErrorMessage.invalidCorrelationIdError.desc);
    };
    ClientConfigurationError.createKnownAuthoritiesNotSetError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.code, ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.desc);
    };
    ClientConfigurationError.createInvalidAuthorityTypeError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidAuthorityType.code, ClientConfigurationErrorMessage.invalidAuthorityType.desc);
    };
    ClientConfigurationError.createUntrustedAuthorityError = function (host) {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.untrustedAuthority.code, ClientConfigurationErrorMessage.untrustedAuthority.desc + " Provided Authority: " + host);
    };
    ClientConfigurationError.createTelemetryConfigError = function (config) {
        var _a = ClientConfigurationErrorMessage.telemetryConfigError, code = _a.code, desc = _a.desc;
        var requiredKeys = {
            applicationName: "string",
            applicationVersion: "string",
            telemetryEmitter: "function"
        };
        var missingKeys = Object.keys(requiredKeys)
            .reduce(function (keys, key) {
            return config[key] ? keys : keys.concat([key + " (" + requiredKeys[key] + ")"]);
        }, []);
        return new ClientConfigurationError(code, desc + " mising values: " + missingKeys.join(","));
    };
    ClientConfigurationError.createSsoSilentError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.ssoSilentError.code, ClientConfigurationErrorMessage.ssoSilentError.desc);
    };
    ClientConfigurationError.createInvalidAuthorityMetadataError = function () {
        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidAuthorityMetadataError.code, ClientConfigurationErrorMessage.invalidAuthorityMetadataError.desc);
    };
    return ClientConfigurationError;
}(_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__["ClientAuthError"]));

//# sourceMappingURL=ClientConfigurationError.js.map

/***/ }),

/***/ "ozJC":
/*!*********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/GraphPageIterator.js ***!
  \*********************************************************************************/
/*! exports provided: GraphPageIterator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphPageIterator", function() { return GraphPageIterator; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/**
 * A helper class to assist in getting multiple pages from a resource
 *
 * @export
 * @class GraphPageIterator
 * @template T
 */
class GraphPageIterator {
    /**
     * Gets all the items already fetched for this request
     *
     * @readonly
     * @type {T[]}
     * @memberof GraphPageIterator
     */
    get value() {
        return this._value;
    }
    /**
     * Gets wheather this request has more pages
     *
     * @readonly
     * @type {boolean}
     * @memberof GraphPageIterator
     */
    get hasNext() {
        return !!this._nextLink;
    }
    /**
     * Creates a new GraphPageIterator
     *
     * @static
     * @template T - the type of entities expected from this request
     * @param {IGraph} graph - the graph instance to use for making requests
     * @param {GraphRequest} request - the initial request
     * @param {string} [version] - optional version to use for the requests - by default uses the default version
     * from the graph parameter
     * @returns a GraphPageIterator
     * @memberof GraphPageIterator
     */
    static create(graph, request, version) {
        return __awaiter(this, void 0, void 0, function* () {
            const response = yield request.get();
            if (response && response.value) {
                const iterator = new GraphPageIterator();
                iterator._graph = graph;
                iterator._value = response.value;
                iterator._nextLink = response['@odata.nextLink'];
                iterator._version = version || graph.version;
                return iterator;
            }
            return null;
        });
    }
    /**
     * Gets the next page for this request
     *
     * @returns {Promise<T[]>}
     * @memberof GraphPageIterator
     */
    next() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this._nextLink) {
                const nextResource = this._nextLink.split(this._version)[1];
                const response = yield this._graph
                    .api(nextResource)
                    .version(this._version)
                    .get();
                if (response && response.value && response.value.length) {
                    this._value = this._value.concat(response.value);
                    this._nextLink = response['@odata.nextLink'];
                    return response.value;
                }
            }
            return null;
        });
    }
}
//# sourceMappingURL=GraphPageIterator.js.map

/***/ }),

/***/ "pRai":
/*!**************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/ValidatePolyFilling.js ***!
  \**************************************************************************************/
/*! exports provided: validatePolyFilling */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "validatePolyFilling", function() { return validatePolyFilling; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @constant
 * @function
 * Validates availability of Promise and fetch in global context
 * @returns The true in case the Promise and fetch available, otherwise throws error
 */
const validatePolyFilling = () => {
    if (typeof Promise === "undefined" && typeof fetch === "undefined") {
        const error = new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");
        error.name = "PolyFillNotAvailable";
        throw error;
    }
    else if (typeof Promise === "undefined") {
        const error = new Error("Library cannot function without Promise. So, please provide polyfill for it.");
        error.name = "PolyFillNotAvailable";
        throw error;
    }
    else if (typeof fetch === "undefined") {
        const error = new Error("Library cannot function without fetch. So, please provide polyfill for it.");
        error.name = "PolyFillNotAvailable";
        throw error;
    }
    return true;
};
//# sourceMappingURL=ValidatePolyFilling.js.map

/***/ }),

/***/ "pgW6":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/error/InteractionRequiredAuthError.js ***!
  \************************************************************************************************************************/
/*! exports provided: InteractionRequiredAuthErrorMessage, InteractionRequiredAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractionRequiredAuthErrorMessage", function() { return InteractionRequiredAuthErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractionRequiredAuthError", function() { return InteractionRequiredAuthError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _ServerError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ServerError */ "n3St");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var InteractionRequiredAuthErrorMessage = {
    interactionRequired: {
        code: "interaction_required"
    },
    consentRequired: {
        code: "consent_required"
    },
    loginRequired: {
        code: "login_required"
    },
};
/**
 * Error thrown when the user is required to perform an interactive token request.
 */
var InteractionRequiredAuthError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](InteractionRequiredAuthError, _super);
    function InteractionRequiredAuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "InteractionRequiredAuthError";
        Object.setPrototypeOf(_this, InteractionRequiredAuthError.prototype);
        return _this;
    }
    InteractionRequiredAuthError.isInteractionRequiredError = function (errorString) {
        var interactionRequiredCodes = [
            InteractionRequiredAuthErrorMessage.interactionRequired.code,
            InteractionRequiredAuthErrorMessage.consentRequired.code,
            InteractionRequiredAuthErrorMessage.loginRequired.code
        ];
        return errorString && interactionRequiredCodes.indexOf(errorString) > -1;
    };
    InteractionRequiredAuthError.createLoginRequiredAuthError = function (errorDesc) {
        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.loginRequired.code, errorDesc);
    };
    InteractionRequiredAuthError.createInteractionRequiredAuthError = function (errorDesc) {
        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.interactionRequired.code, errorDesc);
    };
    InteractionRequiredAuthError.createConsentRequiredAuthError = function (errorDesc) {
        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.consentRequired.code, errorDesc);
    };
    return InteractionRequiredAuthError;
}(_ServerError__WEBPACK_IMPORTED_MODULE_1__["ServerError"]));

//# sourceMappingURL=InteractionRequiredAuthError.js.map

/***/ }),

/***/ "pkRw":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/content/BatchResponseContent.js ***!
  \***********************************************************************************************/
/*! exports provided: BatchResponseContent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchResponseContent", function() { return BatchResponseContent; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * Class that handles BatchResponseContent
 */
class BatchResponseContent {
    /**
     * @public
     * @constructor
     * Creates the BatchResponseContent instance
     * @param {BatchResponseBody} response - The response body returned for batch request from server
     * @returns An instance of a BatchResponseContent
     */
    constructor(response) {
        this.responses = new Map();
        this.update(response);
    }
    /**
     * @private
     * Creates native Response object from the json representation of it.
     * @param {KeyValuePairObject} responseJSON - The response json value
     * @returns The Response Object instance
     */
    createResponseObject(responseJSON) {
        const body = responseJSON.body;
        const options = {};
        options.status = responseJSON.status;
        if (responseJSON.statusText !== undefined) {
            options.statusText = responseJSON.statusText;
        }
        options.headers = responseJSON.headers;
        if (options.headers !== undefined && options.headers["Content-Type"] !== undefined) {
            if (options.headers["Content-Type"].split(";")[0] === "application/json") {
                const bodyString = JSON.stringify(body);
                return new Response(bodyString, options);
            }
        }
        return new Response(body, options);
    }
    /**
     * @public
     * Updates the Batch response content instance with given responses.
     * @param {BatchResponseBody} response - The response json representing batch response message
     * @returns Nothing
     */
    update(response) {
        this.nextLink = response["@odata.nextLink"];
        const responses = response.responses;
        for (let i = 0, l = responses.length; i < l; i++) {
            this.responses.set(responses[i].id, this.createResponseObject(responses[i]));
        }
    }
    /**
     * @public
     * To get the response of a request for a given request id
     * @param {string} requestId - The request id value
     * @returns The Response object instance for the particular request
     */
    getResponseById(requestId) {
        return this.responses.get(requestId);
    }
    /**
     * @public
     * To get all the responses of the batch request
     * @returns The Map of id and Response objects
     */
    getResponses() {
        return this.responses;
    }
    /**
     * @public
     * To get the iterator for the responses
     * @returns The Iterable generator for the response objects
     */
    *getResponsesIterator() {
        const iterator = this.responses.entries();
        let cur = iterator.next();
        while (!cur.done) {
            yield cur.value;
            cur = iterator.next();
        }
    }
}
//# sourceMappingURL=BatchResponseContent.js.map

/***/ }),

/***/ "q5Ih":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/cache/AuthCache.js ***!
  \*****************************************************************************************************/
/*! exports provided: AuthCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthCache", function() { return AuthCache; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/Constants */ "MQw9");
/* harmony import */ var _AccessTokenCacheItem__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AccessTokenCacheItem */ "/LVv");
/* harmony import */ var _BrowserStorage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./BrowserStorage */ "6YFA");
/* harmony import */ var _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/RequestUtils */ "JeFn");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/StringUtils */ "UjIo");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */






/**
 * @hidden
 */
var AuthCache = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AuthCache, _super);
    function AuthCache(clientId, cacheLocation, storeAuthStateInCookie) {
        var _this = _super.call(this, cacheLocation) || this;
        _this.clientId = clientId;
        // This is hardcoded to true for now. We may make this configurable in the future
        _this.rollbackEnabled = true;
        _this.migrateCacheEntries(storeAuthStateInCookie);
        return _this;
    }
    /**
     * Support roll back to old cache schema until the next major release: true by default now
     * @param storeAuthStateInCookie
     */
    AuthCache.prototype.migrateCacheEntries = function (storeAuthStateInCookie) {
        var _this = this;
        var idTokenKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].IDTOKEN;
        var clientInfoKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].CLIENT_INFO;
        var errorKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR;
        var errorDescKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR_DESC;
        var idTokenValue = _super.prototype.getItem.call(this, idTokenKey);
        var clientInfoValue = _super.prototype.getItem.call(this, clientInfoKey);
        var errorValue = _super.prototype.getItem.call(this, errorKey);
        var errorDescValue = _super.prototype.getItem.call(this, errorDescKey);
        var values = [idTokenValue, clientInfoValue, errorValue, errorDescValue];
        var keysToMigrate = [_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].IDTOKEN, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["PersistentCacheKeys"].CLIENT_INFO, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ErrorCacheKeys"].ERROR_DESC];
        keysToMigrate.forEach(function (cacheKey, index) { return _this.duplicateCacheEntry(cacheKey, values[index], storeAuthStateInCookie); });
    };
    /**
     * Utility function to help with roll back keys
     * @param newKey
     * @param value
     * @param storeAuthStateInCookie
     */
    AuthCache.prototype.duplicateCacheEntry = function (newKey, value, storeAuthStateInCookie) {
        if (value) {
            this.setItem(newKey, value, storeAuthStateInCookie);
        }
    };
    /**
     * Prepend msal.<client-id> to each key; Skip for any JSON object as Key (defined schemas do not need the key appended: AccessToken Keys or the upcoming schema)
     * @param key
     * @param addInstanceId
     */
    AuthCache.prototype.generateCacheKey = function (key, addInstanceId) {
        try {
            // Defined schemas do not need the key appended
            JSON.parse(key);
            return key;
        }
        catch (e) {
            if (key.indexOf("" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix) === 0 || key.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].adalIdToken) === 0) {
                return key;
            }
            return addInstanceId ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + this.clientId + "." + key : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix + "." + key;
        }
    };
    /**
     * Validates that the input cache key contains the account search terms (clientId and homeAccountIdentifier) and
     * then whether or not it contains the "scopes", depending on the token type being searched for. With matching account
     * search terms, Access Token search tries to match the "scopes" keyword, while Id Token search expects "scopes" to not be included.
     * @param key
     * @param clientId
     * @param homeAccountIdentifier
     * @param tokenType
     */
    AuthCache.prototype.matchKeyForType = function (key, clientId, homeAccountIdentifier, tokenType) {
        // All valid token cache item keys are valid JSON objects, ignore keys that aren't
        var parsedKey = _utils_StringUtils__WEBPACK_IMPORTED_MODULE_5__["StringUtils"].validateAndParseJsonCacheKey(key);
        if (!parsedKey) {
            return null;
        }
        // Does the cache item match the request account
        var accountMatches = key.match(clientId) && key.match(homeAccountIdentifier);
        // Does the cache item match the requested token type
        var tokenTypeMatches = false;
        switch (tokenType) {
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ACCESS_TOKEN:
                // Cache item is an access token if scopes are included in the cache item key
                tokenTypeMatches = !!key.match(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].scopes);
                break;
            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ID_TOKEN:
                // Cache may be an ID token if scopes are NOT included in the cache item key
                tokenTypeMatches = !key.match(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].scopes);
                break;
        }
        return (accountMatches && tokenTypeMatches) ? parsedKey : null;
    };
    /**
     * add value to storage
     * @param key
     * @param value
     * @param enableCookieStorage
     */
    AuthCache.prototype.setItem = function (key, value, enableCookieStorage) {
        _super.prototype.setItem.call(this, this.generateCacheKey(key, true), value, enableCookieStorage);
        // Values stored in cookies will have rollback disabled to minimize cookie length
        if (this.rollbackEnabled && !enableCookieStorage) {
            _super.prototype.setItem.call(this, this.generateCacheKey(key, false), value, enableCookieStorage);
        }
    };
    /**
     * get one item by key from storage
     * @param key
     * @param enableCookieStorage
     */
    AuthCache.prototype.getItem = function (key, enableCookieStorage) {
        return _super.prototype.getItem.call(this, this.generateCacheKey(key, true), enableCookieStorage);
    };
    /**
     * remove value from storage
     * @param key
     */
    AuthCache.prototype.removeItem = function (key) {
        _super.prototype.removeItem.call(this, this.generateCacheKey(key, true));
        if (this.rollbackEnabled) {
            _super.prototype.removeItem.call(this, this.generateCacheKey(key, false));
        }
    };
    /**
     * Reset the cache items
     */
    AuthCache.prototype.resetCacheItems = function () {
        var storage = window[this.cacheLocation];
        var key;
        for (key in storage) {
            // Check if key contains msal prefix; For now, we are clearing all cache items created by MSAL.js
            if (storage.hasOwnProperty(key) && (key.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix) !== -1)) {
                _super.prototype.removeItem.call(this, key);
                // TODO: Clear cache based on client id (clarify use cases where this is needed)
            }
        }
    };
    /**
     * Reset all temporary cache items
     */
    AuthCache.prototype.resetTempCacheItems = function (state) {
        var _this = this;
        var stateId = state && _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__["RequestUtils"].parseLibraryState(state).id;
        var isTokenRenewalInProgress = this.tokenRenewalInProgress(state);
        var storage = window[this.cacheLocation];
        // check state and remove associated cache
        if (stateId && !isTokenRenewalInProgress) {
            Object.keys(storage).forEach(function (key) {
                if (key.indexOf(stateId) !== -1) {
                    _this.removeItem(key);
                    _super.prototype.clearItemCookie.call(_this, key);
                }
            });
        }
        // delete the interaction status cache
        this.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].INTERACTION_STATUS);
        this.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].REDIRECT_REQUEST);
    };
    /**
     * Set cookies for IE
     * @param cName
     * @param cValue
     * @param expires
     */
    AuthCache.prototype.setItemCookie = function (cName, cValue, expires) {
        _super.prototype.setItemCookie.call(this, this.generateCacheKey(cName, true), cValue, expires);
        if (this.rollbackEnabled) {
            _super.prototype.setItemCookie.call(this, this.generateCacheKey(cName, false), cValue, expires);
        }
    };
    AuthCache.prototype.clearItemCookie = function (cName) {
        _super.prototype.clearItemCookie.call(this, this.generateCacheKey(cName, true));
        if (this.rollbackEnabled) {
            _super.prototype.clearItemCookie.call(this, this.generateCacheKey(cName, false));
        }
    };
    /**
     * get one item by key from cookies
     * @param cName
     */
    AuthCache.prototype.getItemCookie = function (cName) {
        return _super.prototype.getItemCookie.call(this, this.generateCacheKey(cName, true));
    };
    /**
     * Get all tokens of a certain type from the cache
     * @param clientId
     * @param homeAccountIdentifier
     * @param tokenType
     */
    AuthCache.prototype.getAllTokensByType = function (clientId, homeAccountIdentifier, tokenType) {
        var _this = this;
        var results = Object.keys(window[this.cacheLocation]).reduce(function (tokens, key) {
            var matchedTokenKey = _this.matchKeyForType(key, clientId, homeAccountIdentifier, tokenType);
            if (matchedTokenKey) {
                var value = _this.getItem(key);
                if (value) {
                    try {
                        var newAccessTokenCacheItem = new _AccessTokenCacheItem__WEBPACK_IMPORTED_MODULE_2__["AccessTokenCacheItem"](matchedTokenKey, JSON.parse(value));
                        return tokens.concat([newAccessTokenCacheItem]);
                    }
                    catch (err) {
                        // Skip cache items with non-valid JSON values
                        return tokens;
                    }
                }
            }
            return tokens;
        }, []);
        return results;
    };
    /**
     * Get all access tokens in the cache
     * @param clientId
     * @param homeAccountIdentifier
     */
    AuthCache.prototype.getAllAccessTokens = function (clientId, homeAccountIdentifier) {
        return this.getAllTokensByType(clientId, homeAccountIdentifier, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ACCESS_TOKEN);
    };
    /**
     * Get all id tokens in the cache in the form of AccessTokenCacheItem objects so they are
     * in a normalized format and can make use of the existing cached access token validation logic
     */
    AuthCache.prototype.getAllIdTokens = function (clientId, homeAccountIdentifier) {
        return this.getAllTokensByType(clientId, homeAccountIdentifier, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["ServerHashParamKeys"].ID_TOKEN);
    };
    /**
     * Get all access and ID tokens in the cache
     * @param clientId
     * @param homeAccountIdentifier
     */
    AuthCache.prototype.getAllTokens = function (clientId, homeAccountIdentifier) {
        var accessTokens = this.getAllAccessTokens(clientId, homeAccountIdentifier);
        var idTokens = this.getAllIdTokens(clientId, homeAccountIdentifier);
        return accessTokens.concat(idTokens);
    };
    /**
     * Return if the token renewal is still in progress
     *
     * @param stateValue
     */
    AuthCache.prototype.tokenRenewalInProgress = function (stateValue) {
        var renewStatus = this.getItem(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].RENEW_STATUS, stateValue));
        return !!(renewStatus && renewStatus === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].inProgress);
    };
    /**
     * Clear all cookies
     */
    AuthCache.prototype.clearMsalCookie = function (state) {
        var _this = this;
        /*
         * If state is truthy, remove values associated with that request.
         * Otherwise, remove all MSAL cookies.
         */
        if (state) {
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].NONCE_IDTOKEN, state));
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].STATE_LOGIN, state));
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].LOGIN_REQUEST, state));
            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].STATE_ACQ_TOKEN, state));
        }
        else {
            var cookies = document.cookie.split(";");
            cookies.forEach(function (cookieString) {
                var cookieName = cookieString.trim().split("=")[0];
                if (cookieName.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].cachePrefix) > -1) {
                    _super.prototype.clearItemCookie.call(_this, cookieName);
                }
            });
        }
    };
    /**
     * Create acquireTokenAccountKey to cache account object
     * @param accountId
     * @param state
     */
    AuthCache.generateAcquireTokenAccountKey = function (accountId, state) {
        var stateId = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__["RequestUtils"].parseLibraryState(state).id;
        return "" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].ACQUIRE_TOKEN_ACCOUNT + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + accountId + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + stateId;
    };
    /**
     * Create authorityKey to cache authority
     * @param state
     */
    AuthCache.generateAuthorityKey = function (state) {
        return AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["TemporaryCacheKeys"].AUTHORITY, state);
    };
    /**
     * Generates the cache key for temporary cache items, using request state
     * @param tempCacheKey Cache key prefix
     * @param state Request state value
     */
    AuthCache.generateTemporaryCacheKey = function (tempCacheKey, state) {
        // Use the state id (a guid), in the interest of shorter key names, which is important for cookies.
        var stateId = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__["RequestUtils"].parseLibraryState(state).id;
        return "" + tempCacheKey + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + stateId;
    };
    return AuthCache;
}(_BrowserStorage__WEBPACK_IMPORTED_MODULE_3__["BrowserStorage"]));

//# sourceMappingURL=AuthCache.js.map

/***/ }),

/***/ "q5Kr":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/RetryHandlerOptions.js ***!
  \*********************************************************************************************************/
/*! exports provided: RetryHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RetryHandlerOptions", function() { return RetryHandlerOptions; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @class
 * @implements MiddlewareOptions
 * Class for RetryHandlerOptions
 */
class RetryHandlerOptions {
    /**
     * @public
     * @constructor
     * To create an instance of RetryHandlerOptions
     * @param {number} [delay = RetryHandlerOptions.DEFAULT_DELAY] - The delay value in seconds
     * @param {number} [maxRetries = RetryHandlerOptions.DEFAULT_MAX_RETRIES] - The maxRetries value
     * @param {ShouldRetry} [shouldRetry = RetryHandlerOptions.DEFAULT_SHOULD_RETRY] - The shouldRetry callback function
     * @returns An instance of RetryHandlerOptions
     */
    constructor(delay = RetryHandlerOptions.DEFAULT_DELAY, maxRetries = RetryHandlerOptions.DEFAULT_MAX_RETRIES, shouldRetry = RetryHandlerOptions.DEFAULT_SHOULD_RETRY) {
        if (delay > RetryHandlerOptions.MAX_DELAY && maxRetries > RetryHandlerOptions.MAX_MAX_RETRIES) {
            const error = new Error(`Delay and MaxRetries should not be more than ${RetryHandlerOptions.MAX_DELAY} and ${RetryHandlerOptions.MAX_MAX_RETRIES}`);
            error.name = "MaxLimitExceeded";
            throw error;
        }
        else if (delay > RetryHandlerOptions.MAX_DELAY) {
            const error = new Error(`Delay should not be more than ${RetryHandlerOptions.MAX_DELAY}`);
            error.name = "MaxLimitExceeded";
            throw error;
        }
        else if (maxRetries > RetryHandlerOptions.MAX_MAX_RETRIES) {
            const error = new Error(`MaxRetries should not be more than ${RetryHandlerOptions.MAX_MAX_RETRIES}`);
            error.name = "MaxLimitExceeded";
            throw error;
        }
        else if (delay < 0 && maxRetries < 0) {
            const error = new Error(`Delay and MaxRetries should not be negative`);
            error.name = "MinExpectationNotMet";
            throw error;
        }
        else if (delay < 0) {
            const error = new Error(`Delay should not be negative`);
            error.name = "MinExpectationNotMet";
            throw error;
        }
        else if (maxRetries < 0) {
            const error = new Error(`MaxRetries should not be negative`);
            error.name = "MinExpectationNotMet";
            throw error;
        }
        this.delay = Math.min(delay, RetryHandlerOptions.MAX_DELAY);
        this.maxRetries = Math.min(maxRetries, RetryHandlerOptions.MAX_MAX_RETRIES);
        this.shouldRetry = shouldRetry;
    }
    /**
     * @public
     * To get the maximum delay
     * @returns A maximum delay
     */
    getMaxDelay() {
        return RetryHandlerOptions.MAX_DELAY;
    }
}
/**
 * @private
 * @static
 * A member holding default delay value in seconds
 */
RetryHandlerOptions.DEFAULT_DELAY = 3;
/**
 * @private
 * @static
 * A member holding default maxRetries value
 */
RetryHandlerOptions.DEFAULT_MAX_RETRIES = 3;
/**
 * @private
 * @static
 * A member holding maximum delay value in seconds
 */
RetryHandlerOptions.MAX_DELAY = 180;
/**
 * @private
 * @static
 * A member holding maximum maxRetries value
 */
RetryHandlerOptions.MAX_MAX_RETRIES = 10;
/**
 * @private
 * A member holding default shouldRetry callback
 */
RetryHandlerOptions.DEFAULT_SHOULD_RETRY = () => true;
//# sourceMappingURL=RetryHandlerOptions.js.map

/***/ }),

/***/ "qD3l":
/*!********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/CryptoUtils.js ***!
  \********************************************************************************************/
/*! exports provided: CryptoUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CryptoUtils", function() { return CryptoUtils; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var CryptoUtils = /** @class */ (function () {
    function CryptoUtils() {
    }
    /**
     * Creates a new random GUID
     * @returns string (GUID)
     */
    CryptoUtils.createNewGuid = function () {
        /*
         * RFC4122: The version 4 UUID is meant for generating UUIDs from truly-random or
         * pseudo-random numbers.
         * The algorithm is as follows:
         *     Set the two most significant bits (bits 6 and 7) of the
         *        clock_seq_hi_and_reserved to zero and one, respectively.
         *     Set the four most significant bits (bits 12 through 15) of the
         *        time_hi_and_version field to the 4-bit version number from
         *        Section 4.1.3. Version4
         *     Set all the other bits to randomly (or pseudo-randomly) chosen
         *     values.
         * UUID                   = time-low "-" time-mid "-"time-high-and-version "-"clock-seq-reserved and low(2hexOctet)"-" node
         * time-low               = 4hexOctet
         * time-mid               = 2hexOctet
         * time-high-and-version  = 2hexOctet
         * clock-seq-and-reserved = hexOctet:
         * clock-seq-low          = hexOctet
         * node                   = 6hexOctet
         * Format: xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx
         * y could be 1000, 1001, 1010, 1011 since most significant two bits needs to be 10
         * y values are 8, 9, A, B
         */
        var cryptoObj = window.crypto; // for IE 11
        if (cryptoObj && cryptoObj.getRandomValues) {
            var buffer = new Uint8Array(16);
            cryptoObj.getRandomValues(buffer);
            // buffer[6] and buffer[7] represents the time_hi_and_version field. We will set the four most significant bits (4 through 7) of buffer[6] to represent decimal number 4 (UUID version number).
            buffer[6] |= 0x40; // buffer[6] | 01000000 will set the 6 bit to 1.
            buffer[6] &= 0x4f; // buffer[6] & 01001111 will set the 4, 5, and 7 bit to 0 such that bits 4-7 == 0100 = "4".
            // buffer[8] represents the clock_seq_hi_and_reserved field. We will set the two most significant bits (6 and 7) of the clock_seq_hi_and_reserved to zero and one, respectively.
            buffer[8] |= 0x80; // buffer[8] | 10000000 will set the 7 bit to 1.
            buffer[8] &= 0xbf; // buffer[8] & 10111111 will set the 6 bit to 0.
            return CryptoUtils.decimalToHex(buffer[0]) + CryptoUtils.decimalToHex(buffer[1])
                + CryptoUtils.decimalToHex(buffer[2]) + CryptoUtils.decimalToHex(buffer[3])
                + "-" + CryptoUtils.decimalToHex(buffer[4]) + CryptoUtils.decimalToHex(buffer[5])
                + "-" + CryptoUtils.decimalToHex(buffer[6]) + CryptoUtils.decimalToHex(buffer[7])
                + "-" + CryptoUtils.decimalToHex(buffer[8]) + CryptoUtils.decimalToHex(buffer[9])
                + "-" + CryptoUtils.decimalToHex(buffer[10]) + CryptoUtils.decimalToHex(buffer[11])
                + CryptoUtils.decimalToHex(buffer[12]) + CryptoUtils.decimalToHex(buffer[13])
                + CryptoUtils.decimalToHex(buffer[14]) + CryptoUtils.decimalToHex(buffer[15]);
        }
        else {
            var guidHolder = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";
            var hex = "0123456789abcdef";
            var r = 0;
            var guidResponse = "";
            for (var i = 0; i < 36; i++) {
                if (guidHolder[i] !== "-" && guidHolder[i] !== "4") {
                    // each x and y needs to be random
                    r = Math.random() * 16 | 0;
                }
                if (guidHolder[i] === "x") {
                    guidResponse += hex[r];
                }
                else if (guidHolder[i] === "y") {
                    // clock-seq-and-reserved first hex is filtered and remaining hex values are random
                    r &= 0x3; // bit and with 0011 to set pos 2 to zero ?0??
                    r |= 0x8; // set pos 3 to 1 as 1???
                    guidResponse += hex[r];
                }
                else {
                    guidResponse += guidHolder[i];
                }
            }
            return guidResponse;
        }
    };
    /**
     * verifies if a string is  GUID
     * @param guid
     */
    CryptoUtils.isGuid = function (guid) {
        var regexGuid = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;
        return regexGuid.test(guid);
    };
    /**
     * Decimal to Hex
     *
     * @param num
     */
    CryptoUtils.decimalToHex = function (num) {
        var hex = num.toString(16);
        while (hex.length < 2) {
            hex = "0" + hex;
        }
        return hex;
    };
    // See: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#Solution_4_%E2%80%93_escaping_the_string_before_encoding_it
    /**
     * encoding string to base64 - platform specific check
     *
     * @param input
     */
    CryptoUtils.base64Encode = function (input) {
        return btoa(encodeURIComponent(input).replace(/%([0-9A-F]{2})/g, function toSolidBytes(match, p1) {
            return String.fromCharCode(Number("0x" + p1));
        }));
    };
    /**
     * Decodes a base64 encoded string.
     *
     * @param input
     */
    CryptoUtils.base64Decode = function (input) {
        var encodedString = input.replace(/-/g, "+").replace(/_/g, "/");
        switch (encodedString.length % 4) {
            case 0:
                break;
            case 2:
                encodedString += "==";
                break;
            case 3:
                encodedString += "=";
                break;
            default:
                throw new Error("Invalid base64 string");
        }
        return decodeURIComponent(atob(encodedString).split("").map(function (c) {
            return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(""));
    };
    /**
     * deserialize a string
     *
     * @param query
     */
    CryptoUtils.deserialize = function (query) {
        var match; // Regex for replacing addition symbol with a space
        var pl = /\+/g;
        var search = /([^&=]+)=([^&]*)/g;
        var decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); };
        var obj = {};
        match = search.exec(query);
        while (match) {
            obj[decode(match[1])] = decode(match[2]);
            match = search.exec(query);
        }
        return obj;
    };
    return CryptoUtils;
}());

//# sourceMappingURL=CryptoUtils.js.map

/***/ }),

/***/ "qcns":
/*!***************************************************!*\
  !*** ./node_modules/lit-html/lib/shady-render.js ***!
  \***************************************************/
/*! exports provided: html, svg, TemplateResult, shadyTemplateFactory, render */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shadyTemplateFactory", function() { return shadyTemplateFactory; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom.js */ "tFPJ");
/* harmony import */ var _modify_template_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./modify-template.js */ "dmtB");
/* harmony import */ var _render_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./render.js */ "wmha");
/* harmony import */ var _template_factory_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./template-factory.js */ "PqmH");
/* harmony import */ var _template_instance_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./template-instance.js */ "6unr");
/* harmony import */ var _template_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./template.js */ "4yuk");
/* harmony import */ var _lit_html_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../lit-html.js */ "AaG5");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "html", function() { return _lit_html_js__WEBPACK_IMPORTED_MODULE_6__["html"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "svg", function() { return _lit_html_js__WEBPACK_IMPORTED_MODULE_6__["svg"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TemplateResult", function() { return _lit_html_js__WEBPACK_IMPORTED_MODULE_6__["TemplateResult"]; });

/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * Module to add shady DOM/shady CSS polyfill support to lit-html template
 * rendering. See the [[render]] method for details.
 *
 * @packageDocumentation
 */
/**
 * Do not remove this comment; it keeps typedoc from misplacing the module
 * docs.
 */







// Get a key to lookup in `templateCaches`.
const getTemplateCacheKey = (type, scopeName) => `${type}--${scopeName}`;
let compatibleShadyCSSVersion = true;
if (typeof window.ShadyCSS === 'undefined') {
    compatibleShadyCSSVersion = false;
}
else if (typeof window.ShadyCSS.prepareTemplateDom === 'undefined') {
    console.warn(`Incompatible ShadyCSS version detected. ` +
        `Please update to at least @webcomponents/webcomponentsjs@2.0.2 and ` +
        `@webcomponents/shadycss@1.3.1.`);
    compatibleShadyCSSVersion = false;
}
/**
 * Template factory which scopes template DOM using ShadyCSS.
 * @param scopeName {string}
 */
const shadyTemplateFactory = (scopeName) => (result) => {
    const cacheKey = getTemplateCacheKey(result.type, scopeName);
    let templateCache = _template_factory_js__WEBPACK_IMPORTED_MODULE_3__["templateCaches"].get(cacheKey);
    if (templateCache === undefined) {
        templateCache = {
            stringsArray: new WeakMap(),
            keyString: new Map()
        };
        _template_factory_js__WEBPACK_IMPORTED_MODULE_3__["templateCaches"].set(cacheKey, templateCache);
    }
    let template = templateCache.stringsArray.get(result.strings);
    if (template !== undefined) {
        return template;
    }
    const key = result.strings.join(_template_js__WEBPACK_IMPORTED_MODULE_5__["marker"]);
    template = templateCache.keyString.get(key);
    if (template === undefined) {
        const element = result.getTemplateElement();
        if (compatibleShadyCSSVersion) {
            window.ShadyCSS.prepareTemplateDom(element, scopeName);
        }
        template = new _template_js__WEBPACK_IMPORTED_MODULE_5__["Template"](result, element);
        templateCache.keyString.set(key, template);
    }
    templateCache.stringsArray.set(result.strings, template);
    return template;
};
const TEMPLATE_TYPES = ['html', 'svg'];
/**
 * Removes all style elements from Templates for the given scopeName.
 */
const removeStylesFromLitTemplates = (scopeName) => {
    TEMPLATE_TYPES.forEach((type) => {
        const templates = _template_factory_js__WEBPACK_IMPORTED_MODULE_3__["templateCaches"].get(getTemplateCacheKey(type, scopeName));
        if (templates !== undefined) {
            templates.keyString.forEach((template) => {
                const { element: { content } } = template;
                // IE 11 doesn't support the iterable param Set constructor
                const styles = new Set();
                Array.from(content.querySelectorAll('style')).forEach((s) => {
                    styles.add(s);
                });
                Object(_modify_template_js__WEBPACK_IMPORTED_MODULE_1__["removeNodesFromTemplate"])(template, styles);
            });
        }
    });
};
const shadyRenderSet = new Set();
/**
 * For the given scope name, ensures that ShadyCSS style scoping is performed.
 * This is done just once per scope name so the fragment and template cannot
 * be modified.
 * (1) extracts styles from the rendered fragment and hands them to ShadyCSS
 * to be scoped and appended to the document
 * (2) removes style elements from all lit-html Templates for this scope name.
 *
 * Note, <style> elements can only be placed into templates for the
 * initial rendering of the scope. If <style> elements are included in templates
 * dynamically rendered to the scope (after the first scope render), they will
 * not be scoped and the <style> will be left in the template and rendered
 * output.
 */
const prepareTemplateStyles = (scopeName, renderedDOM, template) => {
    shadyRenderSet.add(scopeName);
    // If `renderedDOM` is stamped from a Template, then we need to edit that
    // Template's underlying template element. Otherwise, we create one here
    // to give to ShadyCSS, which still requires one while scoping.
    const templateElement = !!template ? template.element : document.createElement('template');
    // Move styles out of rendered DOM and store.
    const styles = renderedDOM.querySelectorAll('style');
    const { length } = styles;
    // If there are no styles, skip unnecessary work
    if (length === 0) {
        // Ensure prepareTemplateStyles is called to support adding
        // styles via `prepareAdoptedCssText` since that requires that
        // `prepareTemplateStyles` is called.
        //
        // ShadyCSS will only update styles containing @apply in the template
        // given to `prepareTemplateStyles`. If no lit Template was given,
        // ShadyCSS will not be able to update uses of @apply in any relevant
        // template. However, this is not a problem because we only create the
        // template for the purpose of supporting `prepareAdoptedCssText`,
        // which doesn't support @apply at all.
        window.ShadyCSS.prepareTemplateStyles(templateElement, scopeName);
        return;
    }
    const condensedStyle = document.createElement('style');
    // Collect styles into a single style. This helps us make sure ShadyCSS
    // manipulations will not prevent us from being able to fix up template
    // part indices.
    // NOTE: collecting styles is inefficient for browsers but ShadyCSS
    // currently does this anyway. When it does not, this should be changed.
    for (let i = 0; i < length; i++) {
        const style = styles[i];
        style.parentNode.removeChild(style);
        condensedStyle.textContent += style.textContent;
    }
    // Remove styles from nested templates in this scope.
    removeStylesFromLitTemplates(scopeName);
    // And then put the condensed style into the "root" template passed in as
    // `template`.
    const content = templateElement.content;
    if (!!template) {
        Object(_modify_template_js__WEBPACK_IMPORTED_MODULE_1__["insertNodeIntoTemplate"])(template, condensedStyle, content.firstChild);
    }
    else {
        content.insertBefore(condensedStyle, content.firstChild);
    }
    // Note, it's important that ShadyCSS gets the template that `lit-html`
    // will actually render so that it can update the style inside when
    // needed (e.g. @apply native Shadow DOM case).
    window.ShadyCSS.prepareTemplateStyles(templateElement, scopeName);
    const style = content.querySelector('style');
    if (window.ShadyCSS.nativeShadow && style !== null) {
        // When in native Shadow DOM, ensure the style created by ShadyCSS is
        // included in initially rendered output (`renderedDOM`).
        renderedDOM.insertBefore(style.cloneNode(true), renderedDOM.firstChild);
    }
    else if (!!template) {
        // When no style is left in the template, parts will be broken as a
        // result. To fix this, we put back the style node ShadyCSS removed
        // and then tell lit to remove that node from the template.
        // There can be no style in the template in 2 cases (1) when Shady DOM
        // is in use, ShadyCSS removes all styles, (2) when native Shadow DOM
        // is in use ShadyCSS removes the style if it contains no content.
        // NOTE, ShadyCSS creates its own style so we can safely add/remove
        // `condensedStyle` here.
        content.insertBefore(condensedStyle, content.firstChild);
        const removes = new Set();
        removes.add(condensedStyle);
        Object(_modify_template_js__WEBPACK_IMPORTED_MODULE_1__["removeNodesFromTemplate"])(template, removes);
    }
};
/**
 * Extension to the standard `render` method which supports rendering
 * to ShadowRoots when the ShadyDOM (https://github.com/webcomponents/shadydom)
 * and ShadyCSS (https://github.com/webcomponents/shadycss) polyfills are used
 * or when the webcomponentsjs
 * (https://github.com/webcomponents/webcomponentsjs) polyfill is used.
 *
 * Adds a `scopeName` option which is used to scope element DOM and stylesheets
 * when native ShadowDOM is unavailable. The `scopeName` will be added to
 * the class attribute of all rendered DOM. In addition, any style elements will
 * be automatically re-written with this `scopeName` selector and moved out
 * of the rendered DOM and into the document `<head>`.
 *
 * It is common to use this render method in conjunction with a custom element
 * which renders a shadowRoot. When this is done, typically the element's
 * `localName` should be used as the `scopeName`.
 *
 * In addition to DOM scoping, ShadyCSS also supports a basic shim for css
 * custom properties (needed only on older browsers like IE11) and a shim for
 * a deprecated feature called `@apply` that supports applying a set of css
 * custom properties to a given location.
 *
 * Usage considerations:
 *
 * * Part values in `<style>` elements are only applied the first time a given
 * `scopeName` renders. Subsequent changes to parts in style elements will have
 * no effect. Because of this, parts in style elements should only be used for
 * values that will never change, for example parts that set scope-wide theme
 * values or parts which render shared style elements.
 *
 * * Note, due to a limitation of the ShadyDOM polyfill, rendering in a
 * custom element's `constructor` is not supported. Instead rendering should
 * either done asynchronously, for example at microtask timing (for example
 * `Promise.resolve()`), or be deferred until the first time the element's
 * `connectedCallback` runs.
 *
 * Usage considerations when using shimmed custom properties or `@apply`:
 *
 * * Whenever any dynamic changes are made which affect
 * css custom properties, `ShadyCSS.styleElement(element)` must be called
 * to update the element. There are two cases when this is needed:
 * (1) the element is connected to a new parent, (2) a class is added to the
 * element that causes it to match different custom properties.
 * To address the first case when rendering a custom element, `styleElement`
 * should be called in the element's `connectedCallback`.
 *
 * * Shimmed custom properties may only be defined either for an entire
 * shadowRoot (for example, in a `:host` rule) or via a rule that directly
 * matches an element with a shadowRoot. In other words, instead of flowing from
 * parent to child as do native css custom properties, shimmed custom properties
 * flow only from shadowRoots to nested shadowRoots.
 *
 * * When using `@apply` mixing css shorthand property names with
 * non-shorthand names (for example `border` and `border-width`) is not
 * supported.
 */
const render = (result, container, options) => {
    if (!options || typeof options !== 'object' || !options.scopeName) {
        throw new Error('The `scopeName` option is required.');
    }
    const scopeName = options.scopeName;
    const hasRendered = _render_js__WEBPACK_IMPORTED_MODULE_2__["parts"].has(container);
    const needsScoping = compatibleShadyCSSVersion &&
        container.nodeType === 11 /* Node.DOCUMENT_FRAGMENT_NODE */ &&
        !!container.host;
    // Handle first render to a scope specially...
    const firstScopeRender = needsScoping && !shadyRenderSet.has(scopeName);
    // On first scope render, render into a fragment; this cannot be a single
    // fragment that is reused since nested renders can occur synchronously.
    const renderContainer = firstScopeRender ? document.createDocumentFragment() : container;
    Object(_render_js__WEBPACK_IMPORTED_MODULE_2__["render"])(result, renderContainer, Object.assign({ templateFactory: shadyTemplateFactory(scopeName) }, options));
    // When performing first scope render,
    // (1) We've rendered into a fragment so that there's a chance to
    // `prepareTemplateStyles` before sub-elements hit the DOM
    // (which might cause them to render based on a common pattern of
    // rendering in a custom element's `connectedCallback`);
    // (2) Scope the template with ShadyCSS one time only for this scope.
    // (3) Render the fragment into the container and make sure the
    // container knows its `part` is the one we just rendered. This ensures
    // DOM will be re-used on subsequent renders.
    if (firstScopeRender) {
        const part = _render_js__WEBPACK_IMPORTED_MODULE_2__["parts"].get(renderContainer);
        _render_js__WEBPACK_IMPORTED_MODULE_2__["parts"].delete(renderContainer);
        // ShadyCSS might have style sheets (e.g. from `prepareAdoptedCssText`)
        // that should apply to `renderContainer` even if the rendered value is
        // not a TemplateInstance. However, it will only insert scoped styles
        // into the document if `prepareTemplateStyles` has already been called
        // for the given scope name.
        const template = part.value instanceof _template_instance_js__WEBPACK_IMPORTED_MODULE_4__["TemplateInstance"] ?
            part.value.template :
            undefined;
        prepareTemplateStyles(scopeName, renderContainer, template);
        Object(_dom_js__WEBPACK_IMPORTED_MODULE_0__["removeNodes"])(container, container.firstChild);
        container.appendChild(renderContainer);
        _render_js__WEBPACK_IMPORTED_MODULE_2__["parts"].set(container, part);
    }
    // After elements have hit the DOM, update styling if this is the
    // initial render to this container.
    // This is needed whenever dynamic changes are made so it would be
    // safest to do every render; however, this would regress performance
    // so we leave it up to the user to call `ShadyCSS.styleElement`
    // for dynamic changes.
    if (!hasRendered && needsScoping) {
        window.ShadyCSS.styleElement(container.host);
    }
};
//# sourceMappingURL=shady-render.js.map

/***/ }),

/***/ "qfGv":
/*!**********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/node_modules/msal/lib-es6/ScopeSet.js ***!
  \**********************************************************************************************/
/*! exports provided: ScopeSet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScopeSet", function() { return ScopeSet; });
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error/ClientConfigurationError */ "UBea");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ "MQw9");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var ScopeSet = /** @class */ (function () {
    function ScopeSet() {
    }
    /**
     * Check if there are dup scopes in a given request
     *
     * @param cachedScopes
     * @param scopes
     */
    // TODO: Rename this, intersecting scopes isn't a great name for duplicate checker
    ScopeSet.isIntersectingScopes = function (cachedScopes, scopes) {
        var convertedCachedScopes = this.trimAndConvertArrayToLowerCase(cachedScopes.slice());
        var requestScopes = this.trimAndConvertArrayToLowerCase(scopes.slice());
        for (var i = 0; i < requestScopes.length; i++) {
            if (convertedCachedScopes.indexOf(requestScopes[i].toLowerCase()) > -1) {
                return true;
            }
        }
        return false;
    };
    /**
     * Check if a given scope is present in the request
     *
     * @param cachedScopes
     * @param scopes
     */
    ScopeSet.containsScope = function (cachedScopes, scopes) {
        var convertedCachedScopes = this.trimAndConvertArrayToLowerCase(cachedScopes.slice());
        var requestScopes = this.trimAndConvertArrayToLowerCase(scopes.slice());
        return requestScopes.every(function (value) { return convertedCachedScopes.indexOf(value.toString().toLowerCase()) >= 0; });
    };
    /**
     *  Trims and converts string to lower case
     *
     * @param scopes
     */
    // TODO: Rename this, too generic name for a function that only deals with scopes
    ScopeSet.trimAndConvertToLowerCase = function (scope) {
        return scope.trim().toLowerCase();
    };
    /**
     * Performs trimAndConvertToLowerCase on string array
     * @param scopes
     */
    ScopeSet.trimAndConvertArrayToLowerCase = function (scopes) {
        var _this = this;
        return scopes.map(function (scope) { return _this.trimAndConvertToLowerCase(scope); });
    };
    /**
     * Trims each scope in scopes array
     * @param scopes
     */
    ScopeSet.trimScopes = function (scopes) {
        return scopes.map(function (scope) { return scope.trim(); });
    };
    /**
     * Remove one element from a scope array
     *
     * @param scopes
     * @param scope
     */
    // TODO: Rename this, too generic name for a function that only deals with scopes
    ScopeSet.removeElement = function (scopes, scope) {
        var scopeVal = this.trimAndConvertToLowerCase(scope);
        return scopes.filter(function (value) { return value !== scopeVal; });
    };
    /**
     * Parse the scopes into a formatted scopeList
     * @param scopes
     */
    ScopeSet.parseScope = function (scopes) {
        var scopeList = "";
        if (scopes) {
            for (var i = 0; i < scopes.length; ++i) {
                scopeList += (i !== scopes.length - 1) ? scopes[i] + " " : scopes[i];
            }
        }
        return scopeList;
    };
    /**
     * @hidden
     *
     * Used to validate the scopes input parameter requested  by the developer.
     * @param {Array<string>} scopes - Developer requested permissions. Not all scopes are guaranteed to be included in the access token returned.
     * @param {boolean} scopesRequired - Boolean indicating whether the scopes array is required or not
     * @ignore
     */
    ScopeSet.validateInputScope = function (scopes, scopesRequired) {
        if (!scopes) {
            if (scopesRequired) {
                throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createScopesRequiredError(scopes);
            }
            else {
                return;
            }
        }
        // Check that scopes is an array object (also throws error if scopes == null)
        if (!Array.isArray(scopes)) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createScopesNonArrayError(scopes);
        }
        // Check that scopes is not an empty array
        if (scopes.length < 1 && scopesRequired) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__["ClientConfigurationError"].createEmptyScopesArrayError(scopes.toString());
        }
    };
    /**
     * @hidden
     *
     * Extracts scope value from the state sent with the authentication request.
     * @param {string} state
     * @returns {string} scope.
     * @ignore
     */
    ScopeSet.getScopeFromState = function (state) {
        if (state) {
            var splitIndex = state.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter);
            if (splitIndex > -1 && splitIndex + 1 < state.length) {
                return state.substring(splitIndex + 1);
            }
        }
        return "";
    };
    /**
     * @ignore
     * Appends extraScopesToConsent if passed
     * @param {@link AuthenticationParameters}
     */
    ScopeSet.appendScopes = function (reqScopes, reqExtraScopesToConsent) {
        if (reqScopes) {
            var convertedExtraScopes = reqExtraScopesToConsent ? this.trimAndConvertArrayToLowerCase(reqExtraScopesToConsent.slice()) : null;
            var convertedReqScopes = this.trimAndConvertArrayToLowerCase(reqScopes.slice());
            return convertedExtraScopes ? convertedReqScopes.concat(convertedExtraScopes) : convertedReqScopes;
        }
        return null;
    };
    // #endregion
    /**
     * @ignore
     * Returns true if the scopes array only contains openid and/or profile
     */
    ScopeSet.onlyContainsOidcScopes = function (scopes) {
        var scopesCount = scopes.length;
        var oidcScopesFound = 0;
        if (scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope) > -1) {
            oidcScopesFound += 1;
        }
        if (scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope) > -1) {
            oidcScopesFound += 1;
        }
        return (scopesCount > 0 && scopesCount === oidcScopesFound);
    };
    /**
     * @ignore
     * Returns true if the scopes array only contains openid and/or profile
     */
    ScopeSet.containsAnyOidcScopes = function (scopes) {
        var containsOpenIdScope = scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope) > -1;
        var containsProfileScope = scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope) > -1;
        return (containsOpenIdScope || containsProfileScope);
    };
    /**
     * @ignore
     * Returns true if the clientId is the only scope in the array
     */
    ScopeSet.onlyContainsClientId = function (scopes, clientId) {
        // Double negation to force false value returned in case scopes is null
        return !!scopes && (scopes.indexOf(clientId) > -1 && scopes.length === 1);
    };
    /**
     * @ignore
     * Adds missing OIDC scopes to scopes array without duplication. Since STS requires OIDC scopes for
     * all implicit flow requests, 'openid' and 'profile' should always be included in the final request
     */
    ScopeSet.appendDefaultScopes = function (scopes) {
        var extendedScopes = scopes;
        if (extendedScopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope) === -1) {
            extendedScopes.push(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope);
        }
        if (extendedScopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope) === -1) {
            extendedScopes.push(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope);
        }
        return extendedScopes;
    };
    /**
     * @ignore
     * Removes present OIDC scopes from scopes array.
     */
    ScopeSet.removeDefaultScopes = function (scopes) {
        return scopes.filter(function (scope) {
            return (scope !== _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].openidScope && scope !== _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].profileScope);
        });
    };
    /**
     * @ignore
     * Removes clientId from scopes array if included as only scope. If it's not the only scope, it is treated as a resource scope.
     * @param scopes Array<string>: Pre-normalized scopes array
     * @param clientId string: The application's clientId that is searched for in the scopes array
     */
    ScopeSet.translateClientIdIfSingleScope = function (scopes, clientId) {
        return this.onlyContainsClientId(scopes, clientId) ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].oidcScopes : scopes;
    };
    return ScopeSet;
}());

//# sourceMappingURL=ScopeSet.js.map

/***/ }),

/***/ "r/Dn":
/*!*******************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/graph/graph.people.js ***!
  \*******************************************************************************/
/*! exports provided: PersonType, findPeople, getPeople, getEmailFromGraphEntity, findContactsByEmail */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PersonType", function() { return PersonType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findPeople", function() { return findPeople; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPeople", function() { return getPeople; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getEmailFromGraphEntity", function() { return getEmailFromGraphEntity; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findContactsByEmail", function() { return findContactsByEmail; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _utils_Utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/Utils */ "vQVX");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


/**
 * Person Type enum
 *
 * @export
 * @enum {number}
 */
var PersonType;
(function (PersonType) {
    /**
     * Any type
     */
    PersonType[PersonType["any"] = 0] = "any";
    /**
     * A Person such as User or Contact
     */
    PersonType["person"] = "person";
    /**
     * A group
     */
    PersonType["group"] = "group";
})(PersonType || (PersonType = {}));
/**
 * Definition of cache structure
 */
const cacheSchema = {
    name: 'people',
    stores: {
        contacts: {},
        groupPeople: {},
        peopleQuery: {}
    },
    version: 1
};
/**
 * Defines the expiration time
 */
const getPeopleInvalidationTime = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.people.invalidationPeriod || _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.defaultInvalidationPeriod;
/**
 * Whether the people store is enabled
 */
const peopleCacheEnabled = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.people.isEnabled && _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.isEnabled;
/**
 * Name of the contacts store name
 */
const contactsStore = 'contacts';
/**
 * Name of group people store name
 */
const groupStore = 'groupPeople';
/**
 * Name of people store name
 */
const peopleStore = 'peopleQuery';
/**
 * async promise, returns all Graph people who are most relevant contacts to the signed in user.
 *
 * @param {string} query
 * @param {number} [top=10] - number of people to return
 * @param {PersonType} [personType=PersonType.person] - the type of person to search for
 * @returns {(Promise<Person[]>)}
 */
function findPeople(graph, query, top = 10, personType = PersonType.person) {
    return __awaiter(this, void 0, void 0, function* () {
        const scopes = 'people.read';
        let cache;
        if (peopleCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, peopleStore);
            const result = peopleCacheEnabled() ? yield cache.getValue(query) : null;
            if (result && getPeopleInvalidationTime() > Date.now() - result.timeCached) {
                return result.results.map(peopleStr => JSON.parse(peopleStr));
            }
        }
        let filterQuery = '';
        if (personType !== PersonType.any) {
            // converts personType to capitalized case
            const personTypeString = personType
                .toString()
                .charAt(0)
                .toUpperCase() + personType.toString().slice(1);
            filterQuery = `personType/class eq '${personTypeString}'`;
        }
        const graphResult = yield graph
            .api('/me/people')
            .search('"' + query + '"')
            .top(top)
            .filter(filterQuery)
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(scopes))
            .get();
        if (peopleCacheEnabled() && graphResult) {
            const item = { maxResults: top, results: null };
            item.results = graphResult.value.map(personStr => JSON.stringify(personStr));
            cache.putValue(query, item);
        }
        return graphResult ? graphResult.value : null;
    });
}
/**
 * async promise to the Graph for People, by default, it will request the most frequent contacts for the signed in user.
 *
 * @returns {(Promise<Person[]>)}
 * @memberof Graph
 */
function getPeople(graph) {
    return __awaiter(this, void 0, void 0, function* () {
        const scopes = 'people.read';
        let cache;
        if (peopleCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, peopleStore);
            const cacheRes = yield cache.getValue('*');
            if (cacheRes && getPeopleInvalidationTime() > Date.now() - cacheRes.timeCached) {
                return cacheRes.results.map(ppl => JSON.parse(ppl));
            }
        }
        const uri = '/me/people';
        const people = yield graph
            .api(uri)
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(scopes))
            .filter("personType/class eq 'Person'")
            .get();
        if (peopleCacheEnabled() && people) {
            cache.putValue('*', { maxResults: 10, results: people.value.map(ppl => JSON.stringify(ppl)) });
        }
        return people ? people.value : null;
    });
}
/**
 * returns a promise that resolves after specified time
 * @param time in milliseconds
 */
function getEmailFromGraphEntity(entity) {
    const person = entity;
    const user = entity;
    const contact = entity;
    if (user.mail) {
        return Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_1__["extractEmailAddress"])(user.mail);
    }
    else if (person.scoredEmailAddresses && person.scoredEmailAddresses.length) {
        return Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_1__["extractEmailAddress"])(person.scoredEmailAddresses[0].address);
    }
    else if (contact.emailAddresses && contact.emailAddresses.length) {
        return Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_1__["extractEmailAddress"])(contact.emailAddresses[0].address);
    }
    return null;
}
/**
 * async promise, returns a Graph contact associated with the email provided
 *
 * @param {string} email
 * @returns {(Promise<Contact[]>)}
 * @memberof Graph
 */
function findContactsByEmail(graph, email) {
    return __awaiter(this, void 0, void 0, function* () {
        const scopes = 'contacts.read';
        let cache;
        if (peopleCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, contactsStore);
            const contact = yield cache.getValue(email);
            if (contact && getPeopleInvalidationTime() > Date.now() - contact.timeCached) {
                return JSON.parse(contact.person);
            }
        }
        const result = yield graph
            .api('/me/contacts')
            .filter(`emailAddresses/any(a:a/address eq '${email}')`)
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(scopes))
            .get();
        if (peopleCacheEnabled() && result) {
            cache.putValue(email, { person: JSON.stringify(result.value) });
        }
        return result ? result.value : null;
    });
}
//# sourceMappingURL=graph.people.js.map

/***/ }),

/***/ "rHXU":
/*!*********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/dist/es6/mgt-msal-provider.js ***!
  \*********************************************************************************/
/*! exports provided: MgtMsalProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtMsalProvider", function() { return MgtMsalProvider; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _MsalProvider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MsalProvider */ "Y3UZ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



/**
 * Authentication Library Provider for Microsoft personal accounts
 *
 * @export
 * @class MgtMsalProvider
 * @extends {MgtBaseProvider}
 */
let MgtMsalProvider = class MgtMsalProvider extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["MgtBaseProvider"] {
    constructor() {
        super(...arguments);
        /**
         * String alphanumerical value relation to a specific user
         *
         * @memberof MgtMsalProvider
         */
        this.clientId = '';
    }
    /**
     * Gets whether this provider can be used in this environment
     *
     * @readonly
     * @memberof MgtMsalProvider
     */
    get isAvailable() {
        return true;
    }
    /**
     * method called to initialize the provider. Each derived class should provide their own implementation.
     *
     * @protected
     * @memberof MgtMsalProvider
     */
    initializeProvider() {
        if (this.clientId) {
            const config = {
                clientId: this.clientId
            };
            if (this.loginType && this.loginType.length > 1) {
                let loginType = this.loginType.toLowerCase();
                loginType = loginType[0].toUpperCase() + loginType.slice(1);
                const loginTypeEnum = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["LoginType"][loginType];
                config.loginType = loginTypeEnum;
            }
            if (this.authority) {
                config.authority = this.authority;
            }
            if (this.scopes) {
                const scope = this.scopes.split(',');
                if (scope && scope.length > 0) {
                    config.scopes = scope;
                }
            }
            if (this.redirectUri) {
                config.redirectUri = this.redirectUri;
            }
            this.provider = new _MsalProvider__WEBPACK_IMPORTED_MODULE_2__["MsalProvider"](config);
            _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_1__["Providers"].globalProvider = this.provider;
        }
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'client-id',
        type: String
    }),
    __metadata("design:type", Object)
], MgtMsalProvider.prototype, "clientId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'login-type',
        type: String
    }),
    __metadata("design:type", Object)
], MgtMsalProvider.prototype, "loginType", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Object)
], MgtMsalProvider.prototype, "authority", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'scopes',
        type: String
    }),
    __metadata("design:type", Object)
], MgtMsalProvider.prototype, "scopes", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'redirect-uri',
        type: String
    }),
    __metadata("design:type", Object)
], MgtMsalProvider.prototype, "redirectUri", void 0);
MgtMsalProvider = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-msal-provider')
], MgtMsalProvider);

//# sourceMappingURL=mgt-msal-provider.js.map

/***/ }),

/***/ "rPdB":
/*!********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/WindowUtils.js ***!
  \********************************************************************************************/
/*! exports provided: WindowUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WindowUtils", function() { return WindowUtils; });
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../error/ClientAuthError */ "859E");
/* harmony import */ var _UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UrlUtils */ "8P3k");
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Constants */ "vFME");
/* harmony import */ var _TimeUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TimeUtils */ "h916");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var WindowUtils = /** @class */ (function () {
    function WindowUtils() {
    }
    /**
     * @hidden
     * Checks if the current page is running in an iframe.
     * @ignore
     */
    WindowUtils.isInIframe = function () {
        return window.parent !== window;
    };
    /**
     * @hidden
     * Check if the current page is running in a popup.
     * @ignore
     */
    WindowUtils.isInPopup = function () {
        return !!(window.opener && window.opener !== window);
    };
    /**
     * @hidden
     * @param prefix
     * @param scopes
     * @param authority
     */
    WindowUtils.generateFrameName = function (prefix, requestSignature) {
        return "" + prefix + _Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].resourceDelimiter + requestSignature;
    };
    /**
     * @hidden
     * Polls an iframe until it loads a url with a hash
     * @ignore
     */
    WindowUtils.monitorIframeForHash = function (contentWindow, timeout, urlNavigate, logger) {
        return new Promise(function (resolve, reject) {
            /*
             * Polling for iframes can be purely timing based,
             * since we don't need to account for interaction.
             */
            var nowMark = _TimeUtils__WEBPACK_IMPORTED_MODULE_3__["TimeUtils"].relativeNowMs();
            var timeoutMark = nowMark + timeout;
            logger.verbose("monitorWindowForIframe polling started");
            var intervalId = setInterval(function () {
                if (_TimeUtils__WEBPACK_IMPORTED_MODULE_3__["TimeUtils"].relativeNowMs() > timeoutMark) {
                    logger.error("monitorIframeForHash unable to find hash in url, timing out");
                    logger.errorPii("monitorIframeForHash polling timed out for url: " + urlNavigate);
                    clearInterval(intervalId);
                    reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createTokenRenewalTimeoutError());
                    return;
                }
                var href;
                try {
                    /*
                     * Will throw if cross origin,
                     * which should be caught and ignored
                     * since we need the interval to keep running while on STS UI.
                     */
                    href = contentWindow.location.href;
                }
                catch (e) { }
                if (href && _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(href)) {
                    logger.verbose("monitorIframeForHash found url in hash");
                    clearInterval(intervalId);
                    resolve(contentWindow.location.hash);
                }
            }, WindowUtils.POLLING_INTERVAL_MS);
        });
    };
    /**
     * @hidden
     * Polls a popup until it loads a url with a hash
     * @ignore
     */
    WindowUtils.monitorPopupForHash = function (contentWindow, timeout, urlNavigate, logger) {
        return new Promise(function (resolve, reject) {
            /*
             * Polling for popups needs to be tick-based,
             * since a non-trivial amount of time can be spent on interaction (which should not count against the timeout).
             */
            var maxTicks = timeout / WindowUtils.POLLING_INTERVAL_MS;
            var ticks = 0;
            logger.verbose("monitorWindowForHash polling started");
            var intervalId = setInterval(function () {
                if (contentWindow.closed) {
                    logger.error("monitorWindowForHash window closed");
                    clearInterval(intervalId);
                    reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createUserCancelledError());
                    return;
                }
                var href;
                try {
                    /*
                     * Will throw if cross origin,
                     * which should be caught and ignored
                     * since we need the interval to keep running while on STS UI.
                     */
                    href = contentWindow.location.href;
                }
                catch (e) { }
                // Don't process blank pages or cross domain
                if (!href || href === "about:blank") {
                    return;
                }
                /*
                 * Only run clock when we are on same domain for popups
                 * as popup operations can take a long time.
                 */
                ticks++;
                if (href && _UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(href)) {
                    logger.verbose("monitorPopupForHash found url in hash");
                    clearInterval(intervalId);
                    resolve(contentWindow.location.hash);
                }
                else if (ticks > maxTicks) {
                    logger.error("monitorPopupForHash unable to find hash in url, timing out");
                    logger.errorPii("monitorPopupForHash polling timed out for url: " + urlNavigate);
                    clearInterval(intervalId);
                    reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createTokenRenewalTimeoutError());
                }
            }, WindowUtils.POLLING_INTERVAL_MS);
        });
    };
    /**
     * @hidden
     * Loads iframe with authorization endpoint URL
     * @ignore
     */
    WindowUtils.loadFrame = function (urlNavigate, frameName, timeoutMs, logger) {
        var _this = this;
        /*
         * This trick overcomes iframe navigation in IE
         * IE does not load the page consistently in iframe
         */
        logger.infoPii("LoadFrame: " + frameName);
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                var frameHandle = _this.loadFrameSync(urlNavigate, frameName, logger);
                if (!frameHandle) {
                    reject("Unable to load iframe with name: " + frameName);
                    return;
                }
                resolve(frameHandle);
            }, timeoutMs);
        });
    };
    /**
     * @hidden
     * Loads the iframe synchronously when the navigateTimeFrame is set to `0`
     * @param urlNavigate
     * @param frameName
     * @param logger
     */
    WindowUtils.loadFrameSync = function (urlNavigate, frameName, logger) {
        var frameHandle = WindowUtils.addHiddenIFrame(frameName, logger);
        // returning to handle null in loadFrame, also to avoid null object access errors
        if (!frameHandle) {
            return null;
        }
        else if (frameHandle.src === "" || frameHandle.src === "about:blank") {
            frameHandle.src = urlNavigate;
            logger.infoPii("Frame Name : " + frameName + " Navigated to: " + urlNavigate);
        }
        return frameHandle;
    };
    /**
     * @hidden
     * Adds the hidden iframe for silent token renewal.
     * @ignore
     */
    WindowUtils.addHiddenIFrame = function (iframeId, logger) {
        if (typeof iframeId === "undefined") {
            return null;
        }
        logger.infoPii("Add msal frame to document:" + iframeId);
        var adalFrame = document.getElementById(iframeId);
        if (!adalFrame) {
            if (document.createElement &&
                document.documentElement &&
                (window.navigator.userAgent.indexOf("MSIE 5.0") === -1)) {
                var ifr = document.createElement("iframe");
                ifr.setAttribute("id", iframeId);
                ifr.setAttribute("aria-hidden", "true");
                ifr.style.visibility = "hidden";
                ifr.style.position = "absolute";
                ifr.style.width = ifr.style.height = "0";
                ifr.style.border = "0";
                ifr.setAttribute("sandbox", "allow-scripts allow-same-origin allow-forms");
                adalFrame = document.getElementsByTagName("body")[0].appendChild(ifr);
            }
            else if (document.body && document.body.insertAdjacentHTML) {
                document.body.insertAdjacentHTML("beforeend", "<iframe name='" + iframeId + "' id='" + iframeId + "' style='display:none'></iframe>");
            }
            if (window.frames && window.frames[iframeId]) {
                adalFrame = window.frames[iframeId];
            }
        }
        return adalFrame;
    };
    /**
     * @hidden
     * Removes a hidden iframe from the page.
     * @ignore
     */
    WindowUtils.removeHiddenIframe = function (iframe) {
        if (document.body === iframe.parentNode) {
            document.body.removeChild(iframe);
        }
    };
    /**
     * @hidden
     * Find and return the iframe element with the given hash
     * @ignore
     */
    WindowUtils.getIframeWithHash = function (hash) {
        var iframes = document.getElementsByTagName("iframe");
        var iframeArray = Array.apply(null, Array(iframes.length)).map(function (iframe, index) { return iframes.item(index); }); // eslint-disable-line prefer-spread
        return iframeArray.filter(function (iframe) {
            try {
                return iframe.contentWindow.location.hash === hash;
            }
            catch (e) {
                return false;
            }
        })[0];
    };
    /**
     * @hidden
     * Returns an array of all the popups opened by MSAL
     * @ignore
     */
    WindowUtils.getPopups = function () {
        if (!window.openedWindows) {
            window.openedWindows = [];
        }
        return window.openedWindows;
    };
    /**
     * @hidden
     * Find and return the popup with the given hash
     * @ignore
     */
    WindowUtils.getPopUpWithHash = function (hash) {
        return WindowUtils.getPopups().filter(function (popup) {
            try {
                return popup.location.hash === hash;
            }
            catch (e) {
                return false;
            }
        })[0];
    };
    /**
     * @hidden
     * Add the popup to the known list of popups
     * @ignore
     */
    WindowUtils.trackPopup = function (popup) {
        WindowUtils.getPopups().push(popup);
    };
    /**
     * @hidden
     * Close all popups
     * @ignore
     */
    WindowUtils.closePopups = function () {
        WindowUtils.getPopups().forEach(function (popup) { return popup.close(); });
    };
    /**
     * @ignore
     *
     * blocks any login/acquireToken calls to reload from within a hidden iframe (generated for silent calls)
     */
    WindowUtils.blockReloadInHiddenIframes = function () {
        // return an error if called from the hidden iframe created by the msal js silent calls
        if (_UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(window.location.hash) && WindowUtils.isInIframe()) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_0__["ClientAuthError"].createBlockTokenRequestsInHiddenIframeError();
        }
    };
    /**
     *
     * @param cacheStorage
     */
    WindowUtils.checkIfBackButtonIsPressed = function (cacheStorage) {
        var redirectCache = cacheStorage.getItem(_Constants__WEBPACK_IMPORTED_MODULE_2__["TemporaryCacheKeys"].REDIRECT_REQUEST);
        // if redirect request is set and there is no hash
        if (redirectCache && !_UrlUtils__WEBPACK_IMPORTED_MODULE_1__["UrlUtils"].urlContainsHash(window.location.hash)) {
            var splitCache = redirectCache.split(_Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].resourceDelimiter);
            splitCache.shift();
            var state = splitCache.length > 0 ? splitCache.join(_Constants__WEBPACK_IMPORTED_MODULE_2__["Constants"].resourceDelimiter) : null;
            cacheStorage.resetTempCacheItems(state);
        }
    };
    /**
     * Removes url fragment from browser url
     */
    WindowUtils.clearUrlFragment = function () {
        // Office.js sets history.replaceState to null
        if (typeof history.replaceState === "function") {
            // Full removes "#" from url
            history.replaceState(null, null, "" + window.location.pathname + window.location.search);
        }
        else {
            window.location.hash = "";
        }
    };
    /**
     * @hidden
     * Interval in milliseconds that we poll a window
     * @ignore
     */
    WindowUtils.POLLING_INTERVAL_MS = 50;
    return WindowUtils;
}());

//# sourceMappingURL=WindowUtils.js.map

/***/ }),

/***/ "rQCx":
/*!*********************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/RedirectHandler.js ***!
  \*********************************************************************************************************************************/
/*! exports provided: RedirectHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RedirectHandler", function() { return RedirectHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _RequestMethod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../RequestMethod */ "umkM");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MiddlewareControl */ "ocZF");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./MiddlewareUtil */ "kM4i");
/* harmony import */ var _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./options/RedirectHandlerOptions */ "Ytee");
/* harmony import */ var _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./options/TelemetryHandlerOptions */ "Rgfv");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */






/**
 * @class
 * Class
 * @implements Middleware
 * Class representing RedirectHandler
 */
class RedirectHandler {
    /**
     * @public
     * @constructor
     * To create an instance of RedirectHandler
     * @param {RedirectHandlerOptions} [options = new RedirectHandlerOptions()] - The redirect handler options instance
     * @returns An instance of RedirectHandler
     */
    constructor(options = new _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RedirectHandlerOptions"]()) {
        this.options = options;
    }
    /**
     * @private
     * To check whether the response has the redirect status code or not
     * @param {Response} response - The response object
     * @returns A boolean representing whether the response contains the redirect status code or not
     */
    isRedirect(response) {
        return RedirectHandler.REDIRECT_STATUS_CODES.indexOf(response.status) !== -1;
    }
    /**
     * @private
     * To check whether the response has location header or not
     * @param {Response} response - The response object
     * @returns A boolean representing the whether the response has location header or not
     */
    hasLocationHeader(response) {
        return response.headers.has(RedirectHandler.LOCATION_HEADER);
    }
    /**
     * @private
     * To get the redirect url from location header in response object
     * @param {Response} response - The response object
     * @returns A redirect url from location header
     */
    getLocationHeader(response) {
        return response.headers.get(RedirectHandler.LOCATION_HEADER);
    }
    /**
     * @private
     * To check whether the given url is a relative url or not
     * @param {string} url - The url string value
     * @returns A boolean representing whether the given url is a relative url or not
     */
    isRelativeURL(url) {
        return url.indexOf("://") === -1;
    }
    /**
     * @private
     * To check whether the authorization header in the request should be dropped for consequent redirected requests
     * @param {string} requestUrl - The request url value
     * @param {string} redirectUrl - The redirect url value
     * @returns A boolean representing whether the authorization header in the request should be dropped for consequent redirected requests
     */
    shouldDropAuthorizationHeader(requestUrl, redirectUrl) {
        const schemeHostRegex = /^[A-Za-z].+?:\/\/.+?(?=\/|$)/;
        const requestMatches = schemeHostRegex.exec(requestUrl);
        let requestAuthority;
        let redirectAuthority;
        if (requestMatches !== null) {
            requestAuthority = requestMatches[0];
        }
        const redirectMatches = schemeHostRegex.exec(redirectUrl);
        if (redirectMatches !== null) {
            redirectAuthority = redirectMatches[0];
        }
        return typeof requestAuthority !== "undefined" && typeof redirectAuthority !== "undefined" && requestAuthority !== redirectAuthority;
    }
    /**
     * @private
     * @async
     * To update a request url with the redirect url
     * @param {string} redirectUrl - The redirect url value
     * @param {Context} context - The context object value
     * @returns Nothing
     */
    updateRequestUrl(redirectUrl, context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            context.request = typeof context.request === "string" ? redirectUrl : yield Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_3__["cloneRequestWithNewUrl"])(redirectUrl, context.request);
        });
    }
    /**
     * @private
     * To get the options for execution of the middleware
     * @param {Context} context - The context object
     * @returns A options for middleware execution
     */
    getOptions(context) {
        let options;
        if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_2__["MiddlewareControl"]) {
            options = context.middlewareControl.getMiddlewareOptions(_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RedirectHandlerOptions"]);
        }
        if (typeof options === "undefined") {
            options = Object.assign(new _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RedirectHandlerOptions"](), this.options);
        }
        return options;
    }
    /**
     * @private
     * @async
     * To execute the next middleware and to handle in case of redirect response returned by the server
     * @param {Context} context - The context object
     * @param {number} redirectCount - The redirect count value
     * @param {RedirectHandlerOptions} options - The redirect handler options instance
     * @returns A promise that resolves to nothing
     */
    executeWithRedirect(context, redirectCount, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                yield this.nextMiddleware.execute(context);
                const response = context.response;
                if (redirectCount < options.maxRedirects && this.isRedirect(response) && this.hasLocationHeader(response) && options.shouldRedirect(response)) {
                    ++redirectCount;
                    if (response.status === RedirectHandler.STATUS_CODE_SEE_OTHER) {
                        context.options.method = _RequestMethod__WEBPACK_IMPORTED_MODULE_1__["RequestMethod"].GET;
                        delete context.options.body;
                    }
                    else {
                        const redirectUrl = this.getLocationHeader(response);
                        if (!this.isRelativeURL(redirectUrl) && this.shouldDropAuthorizationHeader(response.url, redirectUrl)) {
                            delete context.options.headers[RedirectHandler.AUTHORIZATION_HEADER];
                        }
                        yield this.updateRequestUrl(redirectUrl, context);
                    }
                    yield this.executeWithRedirect(context, redirectCount, options);
                }
                else {
                    return;
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * To execute the current middleware
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const redirectCount = 0;
                const options = this.getOptions(context);
                context.options.redirect = RedirectHandler.MANUAL_REDIRECT;
                _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["TelemetryHandlerOptions"].updateFeatureUsageFlag(context, _options_TelemetryHandlerOptions__WEBPACK_IMPORTED_MODULE_5__["FeatureUsageFlag"].REDIRECT_HANDLER_ENABLED);
                return yield this.executeWithRedirect(context, redirectCount, options);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
/**
 * @private
 * @static
 * A member holding the array of redirect status codes
 */
RedirectHandler.REDIRECT_STATUS_CODES = [
    301,
    302,
    303,
    307,
    308,
];
/**
 * @private
 * @static
 * A member holding SeeOther status code
 */
RedirectHandler.STATUS_CODE_SEE_OTHER = 303;
/**
 * @private
 * @static
 * A member holding the name of the location header
 */
RedirectHandler.LOCATION_HEADER = "Location";
/**
 * @private
 * @static
 * A member representing the authorization header name
 */
RedirectHandler.AUTHORIZATION_HEADER = "Authorization";
/**
 * @private
 * @static
 * A member holding the manual redirect value
 */
RedirectHandler.MANUAL_REDIRECT = "manual";
//# sourceMappingURL=RedirectHandler.js.map

/***/ }),

/***/ "rYEk":
/*!******************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/index.js ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _components_components__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./components/components */ "2n9K");
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _components_components__WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _components_components__WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _graph_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./graph/types */ "3AmW");
/* harmony import */ var _graph_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_graph_types__WEBPACK_IMPORTED_MODULE_1__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _graph_types__WEBPACK_IMPORTED_MODULE_1__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _graph_types__WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


//# sourceMappingURL=index.js.map

/***/ }),

/***/ "rrN1":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/sub-components/mgt-dot-options/mgt-dot-options-css.js ***!
  \**************************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}:host,mgt-dot-options{font-family:var(--default-font-family)}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:var(--box-shadow-color,rgba(0,0,0,.092)) 0 0 40px 5px;background:var(--background-color,#fff);z-index:1;display:none;color:var(--color,#000);white-space:nowrap;transform:var(--dot-options-translateX,translateX(-50px))}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:var(--background-color--hover,#edebe9)}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:var(--background-color--active,#e1dfdd)}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}
`
];
//# sourceMappingURL=mgt-dot-options-css.js.map

/***/ }),

/***/ "rwpb":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-agenda/mgt-agenda.graph.js ***!
  \***************************************************************************************************/
/*! exports provided: getEventsPageIterator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getEventsPageIterator", function() { return getEventsPageIterator; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * returns Calender events iterator associated with either the logged in user or a specific groupId
 *
 * @param {Date} startDateTime
 * @param {Date} endDateTime
 * @param {string} [groupId]
 * @param {string} preferredTimezone
 * @returns {(Promise<Event[]>)}
 * @memberof Graph
 */
function getEventsPageIterator(graph, startDateTime, endDateTime, groupId, preferredTimezone) {
    const scopes = 'calendars.read';
    const sdt = `startdatetime=${startDateTime.toISOString()}`;
    const edt = `enddatetime=${endDateTime.toISOString()}`;
    let uri;
    if (groupId) {
        uri = `groups/${groupId}/calendar`;
    }
    else {
        uri = 'me';
    }
    uri += `/calendarview?${sdt}&${edt}`;
    let request = graph
        .api(uri)
        .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(scopes))
        .orderby('start/dateTime');
    if (preferredTimezone) {
        request = request.header('Prefer', `outlook.timezone="${preferredTimezone}"`);
    }
    return _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["GraphPageIterator"].create(graph, request);
}
//# sourceMappingURL=mgt-agenda.graph.js.map

/***/ }),

/***/ "s+xp":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-tasks/mgt-tasks.js ***!
  \*******************************************************************************************/
/*! exports provided: TasksSource, MgtTasks */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TasksSource", function() { return TasksSource; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtTasks", function() { return MgtTasks; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var lit_html_directives_repeat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit-html/directives/repeat */ "2Fb8");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _utils_Utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/Utils */ "vQVX");
/* harmony import */ var _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./../PersonCardInteraction */ "Y6V/");
/* harmony import */ var _mgt_tasks_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./mgt-tasks-css */ "srwK");
/* harmony import */ var _task_sources__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./task-sources */ "FE8f");
/* harmony import */ var _graph_graph_user__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../graph/graph.user */ "0Vrk");
/* harmony import */ var _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../mgt-person/mgt-person */ "lBzc");
/* harmony import */ var _sub_components_mgt_arrow_options_mgt_arrow_options__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sub-components/mgt-arrow-options/mgt-arrow-options */ "29R+");
/* harmony import */ var _sub_components_mgt_dot_options_mgt_dot_options__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sub-components/mgt-dot-options/mgt-dot-options */ "4J3T");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./strings */ "LmLl");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};













/**
 * Defines how a person card is shown when a user interacts with
 * a person component
 *
 * @export
 * @enum {number}
 */
var TasksSource;
(function (TasksSource) {
    /**
     * Use Microsoft Planner
     */
    TasksSource[TasksSource["planner"] = 0] = "planner";
    /**
     * Use Microsoft To-Do
     */
    TasksSource[TasksSource["todo"] = 1] = "todo";
})(TasksSource || (TasksSource = {}));
// Strings and Resources for different task contexts
// tslint:disable-next-line: completed-docs
const TASK_RES = {
    todo: {
        BASE_SELF_ASSIGNED: 'All Tasks',
        BUCKETS_SELF_ASSIGNED: 'All Tasks',
        BUCKET_NOT_FOUND: 'Folder not found',
        PLANS_SELF_ASSIGNED: 'All groups',
        PLAN_NOT_FOUND: 'Group not found'
    },
    // tslint:disable-next-line: object-literal-sort-keys
    planner: {
        BASE_SELF_ASSIGNED: 'Assigned to Me',
        BUCKETS_SELF_ASSIGNED: 'All Tasks',
        BUCKET_NOT_FOUND: 'Bucket not found',
        PLANS_SELF_ASSIGNED: 'All Plans',
        PLAN_NOT_FOUND: 'Plan not found'
    }
};
// tslint:disable-next-line: completed-docs
const plannerAssignment = {
    '@odata.type': 'microsoft.graph.plannerAssignment',
    orderHint: 'string !'
};
/**
 * Web component enables the user to view, add, remove, complete, or edit tasks. It works with tasks in Microsoft Planner or Microsoft To-Do.
 *
 * @export
 * @class MgtTasks
 * @extends {MgtBaseComponent}
 *
 * @fires taskAdded - Fires when a new task has been created.
 * @fires taskChanged - Fires when task metadata has been changed, such as marking completed.
 * @fires taskClick - Fires when the user clicks or taps on a task.
 * @fires taskRemoved - Fires when an existing task has been deleted.
 *
 * @cssprop --tasks-header-padding - {String} Tasks header padding
 * @cssprop --tasks-header-margin - {String} Tasks header margin
 * @cssprop --tasks-title-padding - {String} Tasks title padding
 * @cssprop --tasks-plan-title-font-size - {Length} Tasks plan title font size
 * @cssprop --tasks-plan-title-padding - {String} Tasks plan title padding
 * @cssprop --tasks-new-button-width - {String} Tasks new button width
 * @cssprop --tasks-new-button-height - {String} Tasks new button height
 * @cssprop --tasks-new-button-color - {Color} Tasks new button color
 * @cssprop --tasks-new-button-background - {String} Tasks new button background
 * @cssprop --tasks-new-button-border - {String} Tasks new button border
 * @cssprop --tasks-new-button-hover-background - {Color} Tasks new button hover background
 * @cssprop --tasks-new-button-active-background - {Color} Tasks new button active background
 * @cssprop --tasks-new-task-name-margin - {String} Tasks new task name margin
 * @cssprop --task-margin - {String} Task margin
 * @cssprop --task-box-shadow - {String} Task box shadow
 * @cssprop --task-background - {Color} Task background
 * @cssprop --task-border - {String} Task border
 * @cssprop --task-header-color - {Color} Task header color
 * @cssprop --task-header-margin - {String} Task header margin
 * @cssprop --task-detail-icon-margin -{String}  Task detail icon margin
 * @cssprop --task-new-margin - {String} Task new margin
 * @cssprop --task-new-border - {String} Task new border
 * @cssprop --task-new-line-margin - {String} Task new line margin
 * @cssprop --tasks-new-line-border - {String} Tasks new line border
 * @cssprop --task-new-input-margin - {String} Task new input margin
 * @cssprop --task-new-input-padding - {String} Task new input padding
 * @cssprop --task-new-input-font-size - {Length} Task new input font size
 * @cssprop --task-new-input-active-border - {String} Task new input active border
 * @cssprop --task-new-select-border - {String} Task new select border
 * @cssprop --task-new-add-button-background - {Color} Task new add button background
 * @cssprop --task-new-add-button-disabled-background - {Color} Task new add button disabled background
 * @cssprop --task-new-cancel-button-color - {Color} Task new cancel button color
 * @cssprop --task-complete-background - {Color} Task complete background
 * @cssprop --task-complete-border - {String} Task complete border
 * @cssprop --task-complete-header-color - {Color} Task complete header color
 * @cssprop --task-complete-detail-color - {Color} Task complete detail color
 * @cssprop --task-complete-detail-icon-color - {Color} Task complete detail icon color
 * @cssprop --tasks-background-color - {Color} Task background color
 * @cssprop --task-icon-alignment - {String} Task icon alignment
 * @cssprop --task-icon-background - {Color} Task icon color
 * @cssprop --task-icon-background-completed - {Color} Task icon background color when completed
 * @cssprop --task-icon-border - {String} Task icon border styles
 * @cssprop --task-icon-border-completed - {String} Task icon border style when task is completed
 * @cssprop --task-icon-border-radius - {String} Task icon border radius
 * @cssprop --task-icon-color - {Color} Task icon color
 * @cssprop --task-icon-color-completed - {Color} Task icon color when completed
 */
let MgtTasks = class MgtTasks extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__["MgtTemplatedComponent"] {
    constructor() {
        super();
        /**
         * determines which task source is loaded, either planner or todo
         * @type {TasksSource}
         */
        this.dataSource = TasksSource.planner;
        this._me = null;
        this._newTaskName = '';
        this._newTaskDueDate = null;
        this._newTaskGroupId = '';
        this._newTaskFolderId = '';
        this._groups = [];
        this._folders = [];
        this._tasks = [];
        this._hiddenTasks = [];
        this._loadingTasks = [];
        this.previousMediaQuery = this.mediaQuery;
        this.onResize = this.onResize.bind(this);
    }
    /**
     * determines whether todo, or planner functionality for task component
     *
     * @readonly
     * @type {TasksStringResource}
     * @memberof MgtTasks
     */
    get res() {
        switch (this.dataSource) {
            case TasksSource.todo:
                return TASK_RES.todo;
            case TasksSource.planner:
            default:
                return TASK_RES.planner;
        }
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_tasks_css__WEBPACK_IMPORTED_MODULE_6__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_12__["strings"];
    }
    /**
     * Get whether new task view is visible
     *
     * @memberof MgtTasks
     */
    get isNewTaskVisible() {
        return this._isNewTaskVisible;
    }
    /**
     * Set whether new task is visible
     *
     * @memberof MgtTasks
     */
    set isNewTaskVisible(value) {
        this._isNewTaskVisible = value;
        if (!value) {
            this._newTaskDueDate = null;
            this._newTaskName = '';
            this._newTaskGroupId = '';
        }
    }
    /**
     * updates provider state
     *
     * @memberof MgtTasks
     */
    connectedCallback() {
        super.connectedCallback();
        window.addEventListener('resize', this.onResize);
    }
    /**
     * removes updates on provider state
     *
     * @memberof MgtTasks
     */
    disconnectedCallback() {
        window.removeEventListener('resize', this.onResize);
        super.disconnectedCallback();
    }
    /**
     * Synchronizes property values when attributes change.
     *
     * @param {*} name
     * @param {*} oldValue
     * @param {*} newValue
     * @memberof MgtTasks
     */
    attributeChangedCallback(name, oldVal, newVal) {
        super.attributeChangedCallback(name, oldVal, newVal);
        if (name === 'data-source') {
            if (this.dataSource === TasksSource.planner) {
                this._currentGroup = this.initialId;
                this._currentFolder = this.initialBucketId;
            }
            else if (this.dataSource === TasksSource.todo) {
                this._currentGroup = null;
                this._currentFolder = this.initialId;
            }
            this._newTaskFolderId = '';
            this._newTaskGroupId = '';
            this._newTaskDueDate = null;
            this._newTaskName = '';
            this._newTaskBeingAdded = false;
            this._tasks = [];
            this._folders = [];
            this._groups = [];
            this._hasDoneInitialLoad = false;
            this._inTaskLoad = false;
            this._todoDefaultSet = false;
            this.requestStateUpdate();
        }
    }
    /**
     * Invoked when the element is first updated. Implement to perform one time
     * work on the element after update.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * @param _changedProperties Map of changed properties with old values
     */
    firstUpdated(changedProperties) {
        super.firstUpdated(changedProperties);
        if (this.initialId && !this._currentGroup) {
            if (this.dataSource === TasksSource.planner) {
                this._currentGroup = this.initialId;
            }
            else if (this.dataSource === TasksSource.todo) {
                this._currentFolder = this.initialId;
            }
        }
        if (this.dataSource === TasksSource.planner && this.initialBucketId && !this._currentFolder) {
            this._currentFolder = this.initialBucketId;
        }
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        let tasks = this._tasks
            .filter(task => this.isTaskInSelectedGroupFilter(task))
            .filter(task => this.isTaskInSelectedFolderFilter(task))
            .filter(task => !this._hiddenTasks.includes(task.id));
        if (this.taskFilter) {
            tasks = tasks.filter(task => this.taskFilter(task._raw));
        }
        const loadingTask = this._inTaskLoad && !this._hasDoneInitialLoad ? this.renderLoadingTask() : null;
        let header;
        if (!this.hideHeader) {
            header = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="Header" dir=${this.direction}>
          ${this.renderPlanOptions()}
        </div>
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      ${header}
      <div class="Tasks" dir=${this.direction}>
        ${this._isNewTaskVisible ? this.renderNewTask() : null} ${loadingTask}
        ${Object(lit_html_directives_repeat__WEBPACK_IMPORTED_MODULE_2__["repeat"])(tasks, task => task.id, task => this.renderTask(task))}
      </div>
    `;
    }
    /**
     * loads tasks from dataSource
     *
     * @returns
     * @memberof MgtTasks
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            const ts = this.getTaskSource();
            if (!ts) {
                return;
            }
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__["Providers"].globalProvider;
            if (!provider || provider.state !== _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__["ProviderState"].SignedIn) {
                return;
            }
            this._inTaskLoad = true;
            let meTask;
            if (!this._me) {
                const graph = provider.graph.forComponent(this);
                meTask = Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_8__["getMe"])(graph);
            }
            if (this.groupId && this.dataSource === TasksSource.planner) {
                yield this._loadTasksForGroup(ts);
            }
            else if (this.targetId) {
                if (this.dataSource === TasksSource.todo) {
                    yield this._loadTargetTodoTasks(ts);
                }
                else {
                    yield this._loadTargetPlannerTasks(ts);
                }
            }
            else {
                yield this._loadAllTasks(ts);
            }
            if (meTask) {
                this._me = yield meTask;
            }
            this._inTaskLoad = false;
            this._hasDoneInitialLoad = true;
        });
    }
    onResize() {
        if (this.mediaQuery !== this.previousMediaQuery) {
            this.previousMediaQuery = this.mediaQuery;
            this.requestUpdate();
        }
    }
    _loadTargetTodoTasks(ts) {
        return __awaiter(this, void 0, void 0, function* () {
            const groups = yield ts.getTaskGroups();
            const folders = (yield Promise.all(groups.map(group => ts.getTaskFoldersForTaskGroup(group.id)))).reduce((cur, ret) => [...cur, ...ret], []);
            const tasks = (yield Promise.all(folders.map(folder => ts.getTasksForTaskFolder(folder.id, folder.parentId)))).reduce((cur, ret) => [...cur, ...ret], []);
            this._tasks = tasks;
            this._folders = folders;
            this._groups = groups;
            this._currentGroup = null;
        });
    }
    _loadTargetPlannerTasks(ts) {
        return __awaiter(this, void 0, void 0, function* () {
            const group = yield ts.getTaskGroup(this.targetId);
            let folders = yield ts.getTaskFoldersForTaskGroup(group.id);
            if (this.targetBucketId) {
                folders = folders.filter(folder => folder.id === this.targetBucketId);
            }
            const tasks = (yield Promise.all(folders.map(folder => ts.getTasksForTaskFolder(folder.id, folder.parentId)))).reduce((cur, ret) => [...cur, ...ret], []);
            this._tasks = tasks;
            this._folders = folders;
            this._groups = [group];
        });
    }
    _loadAllTasks(ts) {
        return __awaiter(this, void 0, void 0, function* () {
            const groups = yield ts.getTaskGroups();
            const folders = (yield Promise.all(groups.map(group => ts.getTaskFoldersForTaskGroup(group.id)))).reduce((cur, ret) => [...cur, ...ret], []);
            if (!this.initialId && this.dataSource === TasksSource.todo && !this._todoDefaultSet) {
                this._todoDefaultSet = true;
                const defaultFolder = folders.find(d => d._raw.isDefaultFolder);
                if (defaultFolder) {
                    this._currentFolder = defaultFolder.id;
                }
            }
            const tasks = (yield Promise.all(folders.map(folder => ts.getTasksForTaskFolder(folder.id, folder.parentId)))).reduce((cur, ret) => [...cur, ...ret], []);
            this._tasks = tasks;
            this._folders = folders;
            this._groups = groups;
        });
    }
    _loadTasksForGroup(ts) {
        return __awaiter(this, void 0, void 0, function* () {
            const groups = yield ts.getTaskGroupsForGroup(this.groupId);
            const folders = (yield Promise.all(groups.map(group => ts.getTaskFoldersForTaskGroup(group.id)))).reduce((cur, ret) => [...cur, ...ret], []);
            const tasks = (yield Promise.all(folders.map(folder => ts.getTasksForTaskFolder(folder.id, folder.parentId)))).reduce((cur, ret) => [...cur, ...ret], []);
            this._tasks = tasks;
            this._folders = folders;
            this._groups = groups;
        });
    }
    addTask(name, dueDate, topParentId, immediateParentId, assignments = {}) {
        return __awaiter(this, void 0, void 0, function* () {
            const ts = this.getTaskSource();
            if (!ts) {
                return;
            }
            const newTask = {
                assignments,
                dueDate,
                immediateParentId,
                name,
                topParentId
            };
            this._newTaskBeingAdded = true;
            const task = yield ts.addTask(newTask);
            this.fireCustomEvent('taskAdded', task);
            yield this.requestStateUpdate();
            this._newTaskBeingAdded = false;
            this.isNewTaskVisible = false;
        });
    }
    completeTask(task) {
        return __awaiter(this, void 0, void 0, function* () {
            const ts = this.getTaskSource();
            if (!ts) {
                return;
            }
            this._loadingTasks = [...this._loadingTasks, task.id];
            yield ts.setTaskComplete(task.id, task.eTag);
            this.fireCustomEvent('taskChanged', task);
            yield this.requestStateUpdate();
            this._loadingTasks = this._loadingTasks.filter(id => id !== task.id);
        });
    }
    uncompleteTask(task) {
        return __awaiter(this, void 0, void 0, function* () {
            const ts = this.getTaskSource();
            if (!ts) {
                return;
            }
            this._loadingTasks = [...this._loadingTasks, task.id];
            yield ts.setTaskIncomplete(task.id, task.eTag);
            this.fireCustomEvent('taskChanged', task);
            yield this.requestStateUpdate();
            this._loadingTasks = this._loadingTasks.filter(id => id !== task.id);
        });
    }
    removeTask(task) {
        return __awaiter(this, void 0, void 0, function* () {
            const ts = this.getTaskSource();
            if (!ts) {
                return;
            }
            this._hiddenTasks = [...this._hiddenTasks, task.id];
            yield ts.removeTask(task.id, task.eTag);
            this.fireCustomEvent('taskRemoved', task);
            yield this.requestStateUpdate();
            this._hiddenTasks = this._hiddenTasks.filter(id => id !== task.id);
        });
    }
    assignPeople(task, people) {
        return __awaiter(this, void 0, void 0, function* () {
            const ts = this.getTaskSource();
            if (!ts) {
                return;
            }
            // create previously selected people Object
            let savedSelectedPeople = [];
            if (task) {
                if (task.assignments) {
                    savedSelectedPeople = Object.keys(task.assignments).sort();
                }
            }
            const newPeopleIds = people.map(person => {
                return person.id;
            });
            // new people from people picker
            const isEqual = newPeopleIds.length === savedSelectedPeople.length &&
                newPeopleIds.sort().every((value, index) => {
                    return value === savedSelectedPeople[index];
                });
            if (isEqual) {
                return;
            }
            const peopleObj = {};
            if (people.length === 0) {
                // tslint:disable-next-line: prefer-for-of
                for (let i = 0; i < savedSelectedPeople.length; i++) {
                    peopleObj[savedSelectedPeople[i]] = null;
                }
            }
            if (people) {
                // tslint:disable-next-line: prefer-for-of
                for (let i = 0; i < savedSelectedPeople.length; i++) {
                    // tslint:disable-next-line: prefer-for-of
                    for (let j = 0; j < people.length; j++) {
                        if (savedSelectedPeople[i] !== people[j].id) {
                            peopleObj[savedSelectedPeople[i]] = null;
                            break;
                        }
                        else {
                            peopleObj[savedSelectedPeople[i]] = plannerAssignment;
                        }
                    }
                }
                // tslint:disable-next-line: prefer-for-of
                for (let i = 0; i < people.length; i++) {
                    peopleObj[people[i].id] = plannerAssignment;
                }
            }
            if (task) {
                this._loadingTasks = [...this._loadingTasks, task.id];
                yield ts.assignPeopleToTask(task.id, peopleObj, task.eTag);
                yield this.requestStateUpdate();
                this._loadingTasks = this._loadingTasks.filter(id => id !== task.id);
            }
        });
    }
    onAddTaskClick(e) {
        const picker = this.getPeoplePicker(null);
        const peopleObj = {};
        if (picker) {
            for (const person of picker.selectedPeople) {
                if (picker.selectedPeople.length) {
                    peopleObj[person.id] = plannerAssignment;
                }
            }
        }
        if (!this._newTaskBeingAdded && this._newTaskName && (this._currentGroup || this._newTaskGroupId)) {
            this.addTask(this._newTaskName, this._newTaskDueDate, !this._currentGroup ? this._newTaskGroupId : this._currentGroup, !this._currentFolder ? this._newTaskFolderId : this._currentFolder, peopleObj);
        }
    }
    renderPlanOptions() {
        const p = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__["Providers"].globalProvider;
        if (!p || p.state !== _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__["ProviderState"].SignedIn) {
            return null;
        }
        if (this._inTaskLoad && !this._hasDoneInitialLoad) {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <span class="LoadingHeader"></span>
      `;
        }
        const addButton = this.readOnly || this._isNewTaskVisible
            ? null
            : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div
              class="AddBarItem NewTaskButton"
              @click="${() => {
                this.isNewTaskVisible = !this.isNewTaskVisible;
            }}"
            >
              <span class="TaskIcon"></span>
              <span>${this.strings.addTaskButtonSubtitle}</span>
            </div>
          `;
        if (this.dataSource === TasksSource.planner) {
            const currentGroup = this._groups.find(d => d.id === this._currentGroup) || {
                title: this.res.BASE_SELF_ASSIGNED
            };
            const groupOptions = {
                [this.res.BASE_SELF_ASSIGNED]: e => {
                    this._currentGroup = null;
                    this._currentFolder = null;
                }
            };
            for (const group of this._groups) {
                groupOptions[group.title] = e => {
                    this._currentGroup = group.id;
                    this._currentFolder = null;
                };
            }
            const groupSelect = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <mgt-arrow-options .options="${groupOptions}" .value="${currentGroup.title}"></mgt-arrow-options>
      `;
            const divider = !this._currentGroup
                ? null
                : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <span class="TaskIcon Divider">/</span>
          `;
            const currentFolder = this._folders.find(d => d.id === this._currentFolder) || {
                name: this.res.BUCKETS_SELF_ASSIGNED
            };
            const folderOptions = {
                [this.res.BUCKETS_SELF_ASSIGNED]: e => {
                    this._currentFolder = null;
                }
            };
            for (const folder of this._folders.filter(d => d.parentId === this._currentGroup)) {
                folderOptions[folder.name] = e => {
                    this._currentFolder = folder.id;
                };
            }
            const folderSelect = this.targetBucketId
                ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <span class="PlanTitle">
              ${this._folders[0] && this._folders[0].name}
            </span>
          `
                : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <mgt-arrow-options .options="${folderOptions}" .value="${currentFolder.name}"></mgt-arrow-options>
          `;
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="TitleCont">
          ${groupSelect} ${divider} ${!this._currentGroup ? null : folderSelect}
        </div>
        ${addButton}
      `;
        }
        else {
            const folder = this._folders.find(d => d.id === this.targetId) || { name: this.res.BUCKETS_SELF_ASSIGNED };
            const currentFolder = this._folders.find(d => d.id === this._currentFolder) || {
                name: this.res.BUCKETS_SELF_ASSIGNED
            };
            const folderOptions = {};
            for (const d of this._folders) {
                folderOptions[d.name] = () => {
                    this._currentFolder = d.id;
                };
            }
            folderOptions[this.res.BUCKETS_SELF_ASSIGNED] = e => {
                this._currentFolder = null;
            };
            const folderSelect = this.targetId
                ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <span class="PlanTitle">
              ${folder.name}
            </span>
          `
                : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <mgt-arrow-options .value="${currentFolder.name}" .options="${folderOptions}"></mgt-arrow-options>
          `;
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <span class="TitleCont">
          ${folderSelect}
        </span>
        ${addButton}
      `;
        }
    }
    renderNewTask() {
        const taskTitle = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <input
        type="text"
        placeholder=${this.strings.newTaskPlaceholder}
        .value="${this._newTaskName}"
        label="new-taskName-input"
        aria-label="new-taskName-input"
        role="input"
        @input="${(e) => {
            this._newTaskName = e.target.value;
        }}"
      />
    `;
        const groups = this._groups;
        if (groups.length > 0 && !this._newTaskGroupId) {
            this._newTaskGroupId = groups[0].id;
        }
        const group = this.dataSource === TasksSource.todo
            ? null
            : this._currentGroup
                ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <span>${this.getPlanTitle(this._currentGroup)}</span>
            </span>
          `
                : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <span class="NewTaskGroup">
              ${this.renderPlannerIcon()}
              <select
                .value="${this._newTaskGroupId}"
                @change="${(e) => {
                    this._newTaskGroupId = e.target.value;
                }}"
              >
                ${this._groups.map(plan => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
                    <option value="${plan.id}">${plan.title}</option>
                  `)}
              </select>
            </span>
          `;
        const folders = this._folders.filter(folder => (this._currentGroup && folder.parentId === this._currentGroup) ||
            (!this._currentGroup && folder.parentId === this._newTaskGroupId));
        if (folders.length > 0 && !this._newTaskFolderId) {
            this._newTaskFolderId = folders[0].id;
        }
        const taskFolder = this._currentFolder
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <span>${this.getFolderName(this._currentFolder)}</span>
          </span>
        `
            : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <span class="NewTaskBucket">
            ${this.renderBucketIcon()}
            <select
              .value="${this._newTaskFolderId}"
              @change="${(e) => {
                this._newTaskFolderId = e.target.value;
            }}"
            >
              ${folders.map(folder => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
                  <option value="${folder.id}">${folder.name}</option>
                `)}
            </select>
          </span>
        `;
        const taskDue = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <span class="NewTaskDue">
        <input
          type="date"
          label="new-taskDate-input"
          aria-label="new-taskDate-input"
          role="input"
          .value="${this.dateToInputValue(this._newTaskDueDate)}"
          @change="${(e) => {
            const value = e.target.value;
            if (value) {
                this._newTaskDueDate = new Date(value + 'T17:00');
            }
            else {
                this._newTaskDueDate = null;
            }
        }}"
        />
      </span>
    `;
        const taskPeople = this.dataSource === TasksSource.todo ? null : this.renderAssignedPeople(null);
        const taskAdd = this._newTaskBeingAdded
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <div class="TaskAddButtonContainer"></div>
        `
            : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <div class="TaskAddButtonContainer ${this._newTaskName === '' ? 'Disabled' : ''}">
            <div class="TaskIcon TaskCancel" @click="${() => (this.isNewTaskVisible = false)}">
              <span>${this.strings.cancelNewTaskSubtitle}</span>
            </div>
            <div class="TaskIcon TaskAdd" @click="${this.onAddTaskClick}">
              <span></span>
            </div>
          </div>
        `;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="Task NewTask Incomplete">
        <div class="TaskContent">
          <div class="TaskDetailsContainer">
            <div class="TaskTitle">
              ${taskTitle}
            </div>
            <div class="TaskDetails">
              ${group} ${taskFolder} ${taskDue} ${taskPeople}
            </div>
          </div>
        </div>
        ${taskAdd}
      </div>
    `;
    }
    togglePeoplePicker(task) {
        const picker = this.getPeoplePicker(task);
        const mgtPeople = this.getMgtPeople(task);
        const flyout = this.getFlyout(task);
        if (picker && mgtPeople && flyout) {
            if (flyout.isOpen) {
                flyout.close();
            }
            else {
                picker.selectedPeople = mgtPeople.people;
                flyout.open();
                window.requestAnimationFrame(() => {
                    picker.focus();
                });
            }
        }
    }
    updateAssignedPeople(task) {
        const picker = this.getPeoplePicker(task);
        const mgtPeople = this.getMgtPeople(task);
        if (picker && picker.selectedPeople !== mgtPeople.people) {
            mgtPeople.people = picker.selectedPeople;
            this.assignPeople(task, picker.selectedPeople);
        }
    }
    getPeoplePicker(task) {
        const taskId = task ? task.id : 'newTask';
        const picker = this.renderRoot.querySelector(`.picker-${taskId}`);
        return picker;
    }
    getMgtPeople(task) {
        const taskId = task ? task.id : 'newTask';
        const mgtPeople = this.renderRoot.querySelector(`.people-${taskId}`);
        return mgtPeople;
    }
    getFlyout(task) {
        const taskId = task ? task.id : 'newTask';
        const flyout = this.renderRoot.querySelector(`.flyout-${taskId}`);
        return flyout;
    }
    renderTask(task) {
        const { name = 'Task', completed = false, dueDate } = task;
        const isLoading = this._loadingTasks.includes(task.id);
        const taskCheckClasses = {
            Complete: !isLoading && completed,
            Loading: isLoading,
            TaskCheck: true,
            TaskIcon: true
        };
        const taskCheckContent = isLoading
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          
        `
            : completed
                ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          
        `
                : null;
        const taskCheck = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <span class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(taskCheckClasses)}><span class="TaskCheckContent">${taskCheckContent}</span></span>
    `;
        const groupTitle = this._currentGroup ? null : this.getPlanTitle(task.topParentId);
        const folderTitle = this._currentFolder ? null : this.getFolderName(task.immediateParentId);
        const context = { task: Object.assign(Object.assign({}, task._raw), { groupTitle, folderTitle }) };
        const taskTemplate = this.renderTemplate('task', context, task.id);
        if (taskTemplate) {
            return taskTemplate;
        }
        let taskDetails = this.renderTemplate('task-details', context, `task-details-${task.id}`);
        if (!taskDetails) {
            const group = this.dataSource === TasksSource.todo || this._currentGroup
                ? null
                : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
              <div class="TaskDetail TaskGroup">
                ${this.renderPlannerIcon()}
                <span>${this.getPlanTitle(task.topParentId)}</span>
              </div>
            `;
            const folder = this._currentFolder
                ? null
                : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="TaskDetail TaskBucket">
              ${this.renderBucketIcon()}
              <span>${this.getFolderName(task.immediateParentId)}</span>
            </div>
          `;
            const taskDue = !dueDate
                ? null
                : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="TaskDetail TaskDue">
              <span>Due ${Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_4__["getShortDateString"])(dueDate)}</span>
            </div>
          `;
            const taskPeople = this.dataSource !== TasksSource.todo ? this.renderAssignedPeople(task) : null;
            taskDetails = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="TaskTitle">
          ${name}
        </div>
        ${group} ${folder} ${taskPeople} ${taskDue}
      `;
        }
        const taskOptions = this.readOnly || this.hideOptions
            ? null
            : lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="TaskOptions">
              <mgt-dot-options
                .options="${{
                [this.strings.removeTaskSubtitle]: () => this.removeTask(task)
            }}"
              ></mgt-dot-options>
            </div>
          `;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div
        class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({
            Complete: completed,
            Incomplete: !completed,
            ReadOnly: this.readOnly,
            Task: true
        })}
      >
        <div
          class="TaskContent"
          @click=${() => {
            this.handleTaskClick(task);
        }}
        >
          <span
            class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({
            Complete: completed,
            Incomplete: !completed,
            TaskCheckContainer: true
        })}
            @click="${e => {
            if (!this.readOnly) {
                if (!task.completed) {
                    this.completeTask(task);
                }
                else {
                    this.uncompleteTask(task);
                }
                e.stopPropagation();
                e.preventDefault();
            }
        }}"
          >
            ${taskCheck}
          </span>
          <div class="TaskDetailsContainer ${this.mediaQuery} ${this._currentGroup ? 'NoPlan' : ''}">
            ${taskDetails}
          </div>
          ${taskOptions}

          <div class="Divider"></div>
        </div>
      </div>
    `;
    }
    renderAssignedPeople(task) {
        let assignedPeopleHTML = null;
        const taskAssigneeClasses = {
            NewTaskAssignee: task === null,
            TaskAssignee: task !== null,
            TaskDetail: task !== null
        };
        const assignedPeople = task
            ? Object.keys(task.assignments).map(key => {
                return key;
            })
            : [];
        const noPeopleTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <template data-type="no-data">
        <i class="login-icon ms-Icon ms-Icon--Contact"></i>
      </template>
    `;
        const taskId = task ? task.id : 'newTask';
        taskAssigneeClasses[`flyout-${taskId}`] = true;
        assignedPeopleHTML = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <mgt-people
        class="people-${taskId}"
        .userIds="${assignedPeople}"
        .personCardInteraction=${_PersonCardInteraction__WEBPACK_IMPORTED_MODULE_5__["PersonCardInteraction"].none}
        @click=${(e) => {
            this.togglePeoplePicker(task);
            e.stopPropagation();
        }}
        >${noPeopleTemplate}
      </mgt-people>
    `;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <mgt-flyout light-dismiss class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(taskAssigneeClasses)} @closed=${e => this.updateAssignedPeople(task)}>
        ${assignedPeopleHTML}
        <div slot="flyout" class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({ Picker: true })}>
          <mgt-people-picker
            class="picker-${taskId}"
            @click=${(e) => e.stopPropagation()}
          ></mgt-people-picker>
        </div>
      </mgt-flyout>
    `;
    }
    handleTaskClick(task) {
        if (task) {
            this.fireCustomEvent('taskClick', { task: task._raw });
        }
    }
    renderLoadingTask() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="Task LoadingTask">
        <div class="TaskContent">
          <div class="TaskCheckContainer">
            <div class="TaskCheck"></div>
          </div>
          <div class="TaskDetailsContainer">
            <div class="TaskTitle"></div>
            <div class="TaskDetails">
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
              <span class="TaskDetail">
                <div class="TaskDetailIcon"></div>
                <div class="TaskDetailName"></div>
              </span>
            </div>
          </div>
        </div>
      </div>
    `;
    }
    renderPlannerIcon() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.223 1.156C6.98 1.26 6.769 1.404 6.586 1.586C6.403 1.768 6.261 1.98 6.157 2.223C6.052 2.465 6 2.724 6 3H2V17H14V3H10C10 2.724 9.948 2.465 9.844 2.223C9.74 1.98 9.596 1.768 9.414 1.586C9.231 1.404 9.02 1.26 8.777 1.156C8.535 1.053 8.276 1 8 1C7.723 1 7.465 1.053 7.223 1.156ZM5 4H7V3C7 2.86 7.026 2.729 7.078 2.609C7.13 2.49 7.202 2.385 7.293 2.293C7.384 2.202 7.49 2.131 7.609 2.079C7.73 2.026 7.859 2 8 2C8.14 2 8.271 2.026 8.39 2.079C8.511 2.131 8.616 2.202 8.707 2.293C8.798 2.385 8.87 2.49 8.922 2.609C8.974 2.729 9 2.86 9 3V4H11V5H5V4ZM12 6V4H13V16H3V4H4V6H12Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 12.3517L5.49956 14.2037L4.14856 12.8517L4.85156 12.1487L5.49956 12.7967L6.64856 11.6487L7.35156 12.3517Z"
          fill="#3C3C3C"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M7.35156 8.35168L5.49956 10.2037L4.14856 8.85168L4.85156 8.14868L5.49956 8.79668L6.64856 7.64868L7.35156 8.35168Z"
          fill="#3C3C3C"
        />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 14H12.001V13H8V14Z" fill="#3C3C3C" />
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10H12.001V9H8V10Z" fill="#3C3C3C" />
      </svg>
    `;
    }
    renderBucketIcon() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z"
          fill="#3C3C3C"
        />
      </svg>
    `;
    }
    getTaskSource() {
        const p = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__["Providers"].globalProvider;
        if (!p || p.state !== _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_3__["ProviderState"].SignedIn) {
            return null;
        }
        const graph = p.graph.forComponent(this);
        if (this.dataSource === TasksSource.planner) {
            return new _task_sources__WEBPACK_IMPORTED_MODULE_7__["PlannerTaskSource"](graph);
        }
        else if (this.dataSource === TasksSource.todo) {
            return new _task_sources__WEBPACK_IMPORTED_MODULE_7__["TodoTaskSource"](graph);
        }
        else {
            return null;
        }
    }
    getPlanTitle(planId) {
        if (!planId) {
            return this.res.BASE_SELF_ASSIGNED;
        }
        else if (planId === this.res.PLANS_SELF_ASSIGNED) {
            return this.res.PLANS_SELF_ASSIGNED;
        }
        else {
            return (this._groups.find(plan => plan.id === planId) || {
                title: this.res.PLAN_NOT_FOUND
            }).title;
        }
    }
    getFolderName(bucketId) {
        if (!bucketId) {
            return this.res.BUCKETS_SELF_ASSIGNED;
        }
        return (this._folders.find(buck => buck.id === bucketId) || {
            name: this.res.BUCKET_NOT_FOUND
        }).name;
    }
    isTaskInSelectedGroupFilter(task) {
        return (task.topParentId === this._currentGroup ||
            (!this._currentGroup && this.getTaskSource().isAssignedToMe(task, this._me.id)));
    }
    isTaskInSelectedFolderFilter(task) {
        return task.immediateParentId === this._currentFolder || !this._currentFolder;
    }
    dateToInputValue(date) {
        if (date) {
            return new Date(date.getTime() - date.getTimezoneOffset() * 60000).toISOString().split('T')[0];
        }
        return null;
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'read-only', type: Boolean }),
    __metadata("design:type", Boolean)
], MgtTasks.prototype, "readOnly", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'data-source',
        converter: (value, type) => {
            value = value.toLowerCase();
            return TasksSource[value] || TasksSource.planner;
        }
    }),
    __metadata("design:type", Number)
], MgtTasks.prototype, "dataSource", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'target-id', type: String }),
    __metadata("design:type", String)
], MgtTasks.prototype, "targetId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'target-bucket-id', type: String }),
    __metadata("design:type", String)
], MgtTasks.prototype, "targetBucketId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'initial-id', type: String }),
    __metadata("design:type", String)
], MgtTasks.prototype, "initialId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'initial-bucket-id', type: String }),
    __metadata("design:type", String)
], MgtTasks.prototype, "initialBucketId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'hide-header', type: Boolean }),
    __metadata("design:type", Boolean)
], MgtTasks.prototype, "hideHeader", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'hide-options', type: Boolean }),
    __metadata("design:type", Boolean)
], MgtTasks.prototype, "hideOptions", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'group-id', type: String }),
    __metadata("design:type", String)
], MgtTasks.prototype, "groupId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Boolean)
], MgtTasks.prototype, "_isNewTaskVisible", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Boolean)
], MgtTasks.prototype, "_newTaskBeingAdded", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", String)
], MgtTasks.prototype, "_newTaskName", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Date)
], MgtTasks.prototype, "_newTaskDueDate", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", String)
], MgtTasks.prototype, "_newTaskGroupId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", String)
], MgtTasks.prototype, "_newTaskFolderId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Array)
], MgtTasks.prototype, "_groups", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Array)
], MgtTasks.prototype, "_folders", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Array)
], MgtTasks.prototype, "_tasks", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Array)
], MgtTasks.prototype, "_hiddenTasks", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Array)
], MgtTasks.prototype, "_loadingTasks", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Boolean)
], MgtTasks.prototype, "_inTaskLoad", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Boolean)
], MgtTasks.prototype, "_hasDoneInitialLoad", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", Boolean)
], MgtTasks.prototype, "_todoDefaultSet", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", String)
], MgtTasks.prototype, "_currentGroup", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])(),
    __metadata("design:type", String)
], MgtTasks.prototype, "_currentFolder", void 0);
MgtTasks = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-tasks'),
    __metadata("design:paramtypes", [])
], MgtTasks);

//# sourceMappingURL=mgt-tasks.js.map

/***/ }),

/***/ "s8CV":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/cache/AccessTokenValue.js ***!
  \*******************************************************************************************************/
/*! exports provided: AccessTokenValue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccessTokenValue", function() { return AccessTokenValue; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 */
var AccessTokenValue = /** @class */ (function () {
    function AccessTokenValue(accessToken, idToken, expiresIn, homeAccountIdentifier) {
        this.accessToken = accessToken;
        this.idToken = idToken;
        this.expiresIn = expiresIn;
        this.homeAccountIdentifier = homeAccountIdentifier;
    }
    return AccessTokenValue;
}());

//# sourceMappingURL=AccessTokenValue.js.map

/***/ }),

/***/ "sI9G":
/*!***************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-get/mgt-get.js ***!
  \***************************************************************************************/
/*! exports provided: ResponseType, MgtGet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResponseType", function() { return ResponseType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtGet", function() { return MgtGet; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _graph_graph_photos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../graph/graph.photos */ "xch7");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Enumeration to define what types of query are available
 *
 * @export
 * @enum {string}
 */
var ResponseType;
(function (ResponseType) {
    /**
     * Fetches a call as JSON
     */
    ResponseType["json"] = "json";
    /**
     * Fetches a call as image
     */
    ResponseType["image"] = "image";
})(ResponseType || (ResponseType = {}));
/**
 * Definition of cache structure
 */
const cacheSchema = {
    name: 'responses',
    stores: {
        responses: {}
    },
    version: 1
};
/**
 * Defines the expiration time
 */
const getResponseInvalidationTime = (currentInvalidationPeriod) => currentInvalidationPeriod ||
    _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["CacheService"].config.response.invalidationPeriod ||
    _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["CacheService"].config.defaultInvalidationPeriod;
/**
 * Whether the response store is enabled
 */
const responseCacheEnabled = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["CacheService"].config.response.isEnabled && _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["CacheService"].config.isEnabled;
/**
 * Name of the response store name
 */
const responsesStore = 'responses';
/**
 * Custom element for making Microsoft Graph get queries
 *
 * @fires dataChange - Fired when data changes
 *
 * @export
 * @class mgt-get
 * @extends {MgtTemplatedComponent}
 */
let MgtGet = class MgtGet extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["MgtTemplatedComponent"] {
    constructor() {
        super(...arguments);
        /**
         * The scopes to request
         *
         * @type {string[]}
         * @memberof MgtGet
         */
        this.scopes = [];
        /**
         * Api version to use for request
         *
         * @type {string}
         * @memberof MgtGet
         */
        this.version = 'v1.0';
        /**
         * Type of response
         * Default = json
         * Supported values = json, image
         *
         * @type {ResponseType}
         * @memberof MgtGet
         */
        this.type = ResponseType.json;
        /**
         * Maximum number of pages to get for the resource
         * default = 3
         * if <= 0, all pages will be fetched
         *
         * @type {number}
         * @memberof MgtGet
         */
        this.maxPages = 3;
        /**
         * Number of milliseconds to poll the delta API and
         * update the response. Set to positive value to enable
         *
         * @type {number}
         * @memberof MgtGet
         */
        this.pollingRate = 0;
        /**
         * Enables cache on the response from the specified resource
         * default = false
         *
         * @type {boolean}
         * @memberof MgtGet
         */
        this.cacheEnabled = false;
        /**
         * Invalidation period of the cache for the responses in milliseconds
         *
         * @type {number}
         * @memberof MgtGet
         */
        this.cacheInvalidationPeriod = 0;
        this.isPolling = false;
        this.isRefreshing = false;
    }
    /**
     * Synchronizes property values when attributes change.
     *
     * @param {*} name
     * @param {*} oldValue
     * @param {*} newValue
     * @memberof MgtPersonCard
     */
    attributeChangedCallback(name, oldval, newval) {
        super.attributeChangedCallback(name, oldval, newval);
        this.requestStateUpdate();
    }
    /**
     * Refresh the data
     *
     * @param {boolean} [hardRefresh=false]
     * if false (default), the component will only update if the data changed
     * if true, the data will be first cleared and reloaded completely
     * @memberof MgtGet
     */
    refresh(hardRefresh = false) {
        this.isRefreshing = true;
        this.requestStateUpdate(hardRefresh);
        this.isRefreshing = false;
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        if (this.isLoadingState && !this.isPolling) {
            return this.renderTemplate('loading', null);
        }
        else if (this.error) {
            return this.renderTemplate('error', this.error);
            // tslint:disable-next-line: no-string-literal
        }
        else if (this.hasTemplate('value') && this.response && this.response.value) {
            let valueContent;
            if (Array.isArray(this.response.value)) {
                let loading = null;
                if (this.isLoadingState && !this.isPolling) {
                    loading = this.renderTemplate('loading', null);
                }
                valueContent = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          ${this.response.value.map(v => this.renderTemplate('value', v, v.id))} ${loading}
        `;
            }
            else {
                valueContent = this.renderTemplate('value', this.response);
            }
            // tslint:disable-next-line: no-string-literal
            if (this.hasTemplate('default')) {
                const defaultContent = this.renderTemplate('default', this.response);
                // tslint:disable-next-line: no-string-literal
                if (this.templates['value'].templateOrder > this.templates['default'].templateOrder) {
                    return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            ${defaultContent}${valueContent}
          `;
                }
                else {
                    return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            ${valueContent}${defaultContent}
          `;
                }
            }
            else {
                return valueContent;
            }
        }
        else if (this.response) {
            return this.renderTemplate('default', this.response) || lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
        }
        else {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
        }
    }
    /**
     * load state into the component.
     *
     * @protected
     * @returns
     * @memberof MgtGet
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["Providers"].globalProvider;
            this.error = null;
            if (!provider || provider.state !== _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["ProviderState"].SignedIn) {
                return;
            }
            if (this.resource) {
                try {
                    let cache;
                    const key = `${this.version}${this.resource}`;
                    let response = null;
                    if (this.shouldRetrieveCache()) {
                        cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["CacheService"].getCache(cacheSchema, responsesStore);
                        const result = responseCacheEnabled() ? yield cache.getValue(key) : null;
                        if (result && getResponseInvalidationTime(this.cacheInvalidationPeriod) > Date.now() - result.timeCached) {
                            response = JSON.parse(result.response);
                        }
                    }
                    if (!response) {
                        let uri = this.resource;
                        let isDeltaLink = false;
                        // if we had a response earlier with a delta link, use it instead
                        if (this.response && this.response['@odata.deltaLink']) {
                            uri = this.response['@odata.deltaLink'];
                            isDeltaLink = true;
                        }
                        else {
                            isDeltaLink = new URL(uri, 'https://graph.microsoft.com').pathname.endsWith('delta');
                        }
                        const graph = provider.graph.forComponent(this);
                        let request = graph.api(uri).version(this.version);
                        if (this.scopes && this.scopes.length) {
                            request = request.middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["prepScopes"])(...this.scopes));
                        }
                        if (this.type === ResponseType.json) {
                            response = yield request.get();
                            if (isDeltaLink && this.response && Array.isArray(this.response.value) && Array.isArray(response.value)) {
                                response.value = this.response.value.concat(response.value);
                            }
                            if (!this.isPolling && !Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["equals"])(this.response, response)) {
                                this.response = response;
                            }
                            // get more pages if there are available
                            if (response && Array.isArray(response.value) && response['@odata.nextLink']) {
                                let pageCount = 1;
                                let page = response;
                                while ((pageCount < this.maxPages || this.maxPages <= 0 || (isDeltaLink && this.pollingRate)) &&
                                    page &&
                                    page['@odata.nextLink']) {
                                    pageCount++;
                                    const nextResource = page['@odata.nextLink'].split(this.version)[1];
                                    page = yield graph.client
                                        .api(nextResource)
                                        .version(this.version)
                                        .get();
                                    if (page && page.value && page.value.length) {
                                        page.value = response.value.concat(page.value);
                                        response = page;
                                        if (!this.isPolling) {
                                            this.response = response;
                                        }
                                    }
                                }
                            }
                        }
                        else {
                            if (this.resource.indexOf('/photo/$value') === -1) {
                                throw new Error('Only /photo/$value endpoints support the image type');
                            }
                            // Sanitizing the resource to ensure getPhotoForResource gets the right format
                            const sanitizedResource = this.resource.replace('/photo/$value', '');
                            const photoResponse = yield Object(_graph_graph_photos__WEBPACK_IMPORTED_MODULE_1__["getPhotoForResource"])(graph, sanitizedResource, this.scopes);
                            if (photoResponse) {
                                response = {
                                    image: photoResponse.photo
                                };
                            }
                        }
                        if (this.shouldUpdateCache() && response) {
                            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["CacheService"].getCache(cacheSchema, responsesStore);
                            cache.putValue(key, { response: JSON.stringify(response) });
                        }
                    }
                    if (!Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["equals"])(this.response, response)) {
                        this.response = response;
                    }
                }
                catch (e) {
                    this.error = e;
                }
                if (this.response) {
                    this.error = null;
                    if (this.pollingRate) {
                        setTimeout(() => __awaiter(this, void 0, void 0, function* () {
                            this.isPolling = true;
                            yield this.loadState();
                            this.isPolling = false;
                        }), this.pollingRate);
                    }
                }
            }
            else {
                this.response = null;
            }
            this.fireCustomEvent('dataChange', { response: this.response, error: this.error });
        });
    }
    shouldRetrieveCache() {
        return responseCacheEnabled() && this.cacheEnabled && !(this.isRefreshing || this.isPolling);
    }
    shouldUpdateCache() {
        return responseCacheEnabled() && this.cacheEnabled;
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'resource',
        reflect: true,
        type: String
    }),
    __metadata("design:type", String)
], MgtGet.prototype, "resource", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'scopes',
        converter: (value, type) => {
            return value ? value.toLowerCase().split(',') : null;
        },
        reflect: true
    }),
    __metadata("design:type", Array)
], MgtGet.prototype, "scopes", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'version',
        reflect: true,
        type: String
    }),
    __metadata("design:type", String)
], MgtGet.prototype, "version", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'type',
        reflect: true,
        type: ResponseType
    }),
    __metadata("design:type", String)
], MgtGet.prototype, "type", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'max-pages',
        reflect: true,
        type: Number
    }),
    __metadata("design:type", Number)
], MgtGet.prototype, "maxPages", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'polling-rate',
        reflect: true,
        type: Number
    }),
    __metadata("design:type", Number)
], MgtGet.prototype, "pollingRate", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'cache-enabled',
        reflect: true,
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtGet.prototype, "cacheEnabled", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'cache-invalidation-period',
        reflect: true,
        type: Number
    }),
    __metadata("design:type", Number)
], MgtGet.prototype, "cacheInvalidationPeriod", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: false }),
    __metadata("design:type", Object)
], MgtGet.prototype, "response", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: false }),
    __metadata("design:type", Object)
], MgtGet.prototype, "error", void 0);
MgtGet = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-get')
], MgtGet);

//# sourceMappingURL=mgt-get.js.map

/***/ }),

/***/ "sJXD":
/*!**********************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/equals.js ***!
  \**********************************************************************/
/*! exports provided: equals, arraysAreEqual */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "equals", function() { return equals; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arraysAreEqual", function() { return arraysAreEqual; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * Crude implementation of equivalence between the two specified arguments.
 *
 * The primary intent of this function is for comparing data contexts, which
 * are expected to be object literals with potentially nested structures and
 * where leaf values are primitives.
 */
function equals(o1, o2) {
    return equalsInternal(o1, o2, new Set());
}
/**
 * Not exposed as it would undesirably leak implementation detail (`refs` argument).
 *
 * The `refs` argument is used to avoid infinite recursion due to circular references.
 *
 * @see equals
 */
function equalsInternal(o1, o2, refs) {
    const o1Label = Object.prototype.toString.call(o1);
    const o2Label = Object.prototype.toString.call(o2);
    if (o1Label === o2Label && o1Label === '[object Object]' && !refs.has(o1)) {
        refs.add(o1);
        for (const k in o1) {
            if (!equalsInternal(o1[k], o2[k], refs)) {
                return false;
            }
        }
        for (const k in o2) {
            if (!o1.hasOwnProperty(k)) {
                return false;
            }
        }
        return true;
    }
    if (o1Label === o2Label && o1Label === '[object Array]' && !refs.has(o1)) {
        refs.add(o1);
        if (o1.length !== o2.length) {
            return false;
        }
        for (let i = 0; i < o1.length; i++) {
            if (!equalsInternal(o1[i], o2[i], refs)) {
                return false;
            }
        }
        return true;
    }
    // Everything else requires strict equality (e.g. primitives, functions, dates)
    return o1 === o2;
}
/**
 * Compares two arrays if the elements are equals
 * Should be used for arrays of primitive types
 *
 * @export
 * @template T the type of the elements in the array (should be primitive)
 * @param {T[]} arr1
 * @param {T[]} arr2
 * @returns true if both arrays contain the same items or if both arrays are null or empty
 */
function arraysAreEqual(arr1, arr2) {
    if (arr1 === arr2) {
        return true;
    }
    if (!arr1 || !arr2) {
        return false;
    }
    if (arr1.length !== arr2.length) {
        return false;
    }
    if (arr1.length === 0) {
        return true;
    }
    const setArr1 = new Set(arr1);
    for (const i of arr2) {
        if (!setArr1.has(i)) {
            return false;
        }
    }
    return true;
}
//# sourceMappingURL=equals.js.map

/***/ }),

/***/ "sQma":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/authority/AuthorityFactory.js ***!
  \***********************************************************************************************************/
/*! exports provided: AuthorityFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AuthorityFactory", function() { return AuthorityFactory; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Authority__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Authority */ "Si2r");
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StringUtils */ "k+Uk");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "SRUK");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */

/**
 * @hidden
 */



var AuthorityFactory = /** @class */ (function () {
    function AuthorityFactory() {
    }
    AuthorityFactory.saveMetadataFromNetwork = function (authorityInstance, telemetryManager, correlationId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var metadata;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, authorityInstance.resolveEndpointsAsync(telemetryManager, correlationId)];
                    case 1:
                        metadata = _a.sent();
                        this.metadataMap.set(authorityInstance.CanonicalAuthority, metadata);
                        return [2 /*return*/, metadata];
                }
            });
        });
    };
    AuthorityFactory.getMetadata = function (authorityUrl) {
        return this.metadataMap.get(authorityUrl);
    };
    AuthorityFactory.saveMetadataFromConfig = function (authorityUrl, authorityMetadataJson) {
        try {
            if (authorityMetadataJson) {
                var parsedMetadata = JSON.parse(authorityMetadataJson);
                if (!parsedMetadata.authorization_endpoint || !parsedMetadata.end_session_endpoint || !parsedMetadata.issuer) {
                    throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__["ClientConfigurationError"].createInvalidAuthorityMetadataError();
                }
                this.metadataMap.set(authorityUrl, {
                    AuthorizationEndpoint: parsedMetadata.authorization_endpoint,
                    EndSessionEndpoint: parsedMetadata.end_session_endpoint,
                    Issuer: parsedMetadata.issuer
                });
            }
        }
        catch (e) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__["ClientConfigurationError"].createInvalidAuthorityMetadataError();
        }
    };
    /**
     * Create an authority object of the correct type based on the url
     * Performs basic authority validation - checks to see if the authority is of a valid type (eg aad, b2c)
     */
    AuthorityFactory.CreateInstance = function (authorityUrl, validateAuthority, authorityMetadata) {
        if (_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__["StringUtils"].isEmpty(authorityUrl)) {
            return null;
        }
        if (authorityMetadata) {
            // todo: log statements
            this.saveMetadataFromConfig(authorityUrl, authorityMetadata);
        }
        return new _Authority__WEBPACK_IMPORTED_MODULE_1__["Authority"](authorityUrl, validateAuthority, this.metadataMap.get(authorityUrl));
    };
    AuthorityFactory.metadataMap = new Map();
    return AuthorityFactory;
}());

//# sourceMappingURL=AuthorityFactory.js.map

/***/ }),

/***/ "sVHX":
/*!********************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-files/mgt-person-card-files.js ***!
  \********************************************************************************************************************************************/
/*! exports provided: MgtPersonCardFiles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtPersonCardFiles", function() { return MgtPersonCardFiles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../BasePersonCardSection */ "8z1x");
/* harmony import */ var _styles_fluent_icons__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../styles/fluent-icons */ "EKcv");
/* harmony import */ var _utils_SvgHelper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../utils/SvgHelper */ "FPR2");
/* harmony import */ var _utils_Utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../utils/Utils */ "vQVX");
/* harmony import */ var _mgt_person_card_files_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mgt-person-card-files-css */ "l9ev");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./strings */ "I2eE");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







/**
 * The files subsection of the person card
 *
 * @export
 * @class MgtPersonCardProfile
 * @extends {MgtTemplatedComponent}
 */
let MgtPersonCardFiles = class MgtPersonCardFiles extends _BasePersonCardSection__WEBPACK_IMPORTED_MODULE_1__["BasePersonCardSection"] {
    constructor(files) {
        super();
        this._files = files;
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_person_card_files_css__WEBPACK_IMPORTED_MODULE_5__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_6__["strings"];
    }
    /**
     * The name for display in the overview section.
     *
     * @readonly
     * @type {string}
     * @memberof MgtPersonCardFiles
     */
    get displayName() {
        return this.strings.filesSectionTitle;
    }
    /**
     * Reset any state in the section
     *
     * @protected
     * @memberof MgtPersonCardFiles
     */
    clearState() { }
    /**
     * Render the icon for display in the navigation ribbon.
     *
     * @returns {TemplateResult}
     * @memberof MgtPersonCardFiles
     */
    renderIcon() {
        return Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_3__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_3__["SvgIcon"].Files);
    }
    /**
     * Render the compact view
     *
     * @returns {TemplateResult}
     * @memberof MgtPersonCardFiles
     */
    renderCompactView() {
        let contentTemplate;
        if (this.isLoadingState) {
            contentTemplate = this.renderLoading();
        }
        else if (!this._files || !this._files.length) {
            contentTemplate = this.renderNoData();
        }
        else {
            contentTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        ${this._files.slice(0, 3).map(file => this.renderFile(file))}
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root compact" dir=${this.direction}>
        ${contentTemplate}
      </div>
    `;
    }
    /**
     * Render the full view
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCardFiles
     */
    renderFullView() {
        let contentTemplate;
        if (this.isLoadingState) {
            contentTemplate = this.renderLoading();
        }
        else if (!this._files || !this._files.length) {
            contentTemplate = this.renderNoData();
        }
        else {
            contentTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        ${this._files.map(file => this.renderFile(file))}
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root" dir=${this.direction}>
        <div class="title">${this.strings.filesSectionTitle}</div>
        ${contentTemplate}
      </div>
    `;
    }
    /**
     * Render a file item
     *
     * @protected
     * @param {IFile} file
     * @returns {TemplateResult}
     * @memberof MgtPersonCardFiles
     */
    renderFile(file) {
        const lastModifiedTemplate = file.lastShared
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <div class="file__last-modified">
            ${this.strings.sharedTextSubtitle} ${Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_4__["getRelativeDisplayDate"])(new Date(file.lastShared.sharedDateTime))}
          </div>
        `
            : null;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="file" @click=${e => this.handleFileClick(file)}>
        <div class="file__icon">
          <img src=${Object(_styles_fluent_icons__WEBPACK_IMPORTED_MODULE_2__["getFileTypeIconUri"])(file.resourceVisualization.type, 48, 'svg')} />
        </div>
        <div class="file__details">
          <div class="file__name">${file.resourceVisualization.title}</div>
          ${lastModifiedTemplate}
        </div>
      </div>
    `;
    }
    handleFileClick(file) {
        if (file.resourceReference && file.resourceReference.webUrl) {
            window.open(file.resourceReference.webUrl, '_blank');
        }
    }
};
MgtPersonCardFiles = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-person-card-files'),
    __metadata("design:paramtypes", [Array])
], MgtPersonCardFiles);

//# sourceMappingURL=mgt-person-card-files.js.map

/***/ }),

/***/ "sivJ":
/*!**********************************************************!*\
  !*** ./node_modules/lit-element/lib/updating-element.js ***!
  \**********************************************************/
/*! exports provided: defaultConverter, notEqual, UpdatingElement */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defaultConverter", function() { return defaultConverter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "notEqual", function() { return notEqual; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UpdatingElement", function() { return UpdatingElement; });
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
var _a;
/**
 * Use this module if you want to create your own base class extending
 * [[UpdatingElement]].
 * @packageDocumentation
 */
/*
 * When using Closure Compiler, JSCompiler_renameProperty(property, object) is
 * replaced at compile time by the munged name for object[property]. We cannot
 * alias this function, so we have to use a small shim that has the same
 * behavior when not compiling.
 */
window.JSCompiler_renameProperty =
    (prop, _obj) => prop;
const defaultConverter = {
    toAttribute(value, type) {
        switch (type) {
            case Boolean:
                return value ? '' : null;
            case Object:
            case Array:
                // if the value is `null` or `undefined` pass this through
                // to allow removing/no change behavior.
                return value == null ? value : JSON.stringify(value);
        }
        return value;
    },
    fromAttribute(value, type) {
        switch (type) {
            case Boolean:
                return value !== null;
            case Number:
                return value === null ? null : Number(value);
            case Object:
            case Array:
                return JSON.parse(value);
        }
        return value;
    }
};
/**
 * Change function that returns true if `value` is different from `oldValue`.
 * This method is used as the default for a property's `hasChanged` function.
 */
const notEqual = (value, old) => {
    // This ensures (old==NaN, value==NaN) always returns false
    return old !== value && (old === old || value === value);
};
const defaultPropertyDeclaration = {
    attribute: true,
    type: String,
    converter: defaultConverter,
    reflect: false,
    hasChanged: notEqual
};
const STATE_HAS_UPDATED = 1;
const STATE_UPDATE_REQUESTED = 1 << 2;
const STATE_IS_REFLECTING_TO_ATTRIBUTE = 1 << 3;
const STATE_IS_REFLECTING_TO_PROPERTY = 1 << 4;
/**
 * The Closure JS Compiler doesn't currently have good support for static
 * property semantics where "this" is dynamic (e.g.
 * https://github.com/google/closure-compiler/issues/3177 and others) so we use
 * this hack to bypass any rewriting by the compiler.
 */
const finalized = 'finalized';
/**
 * Base element class which manages element properties and attributes. When
 * properties change, the `update` method is asynchronously called. This method
 * should be supplied by subclassers to render updates as desired.
 * @noInheritDoc
 */
class UpdatingElement extends HTMLElement {
    constructor() {
        super();
        this.initialize();
    }
    /**
     * Returns a list of attributes corresponding to the registered properties.
     * @nocollapse
     */
    static get observedAttributes() {
        // note: piggy backing on this to ensure we're finalized.
        this.finalize();
        const attributes = [];
        // Use forEach so this works even if for/of loops are compiled to for loops
        // expecting arrays
        this._classProperties.forEach((v, p) => {
            const attr = this._attributeNameForProperty(p, v);
            if (attr !== undefined) {
                this._attributeToPropertyMap.set(attr, p);
                attributes.push(attr);
            }
        });
        return attributes;
    }
    /**
     * Ensures the private `_classProperties` property metadata is created.
     * In addition to `finalize` this is also called in `createProperty` to
     * ensure the `@property` decorator can add property metadata.
     */
    /** @nocollapse */
    static _ensureClassProperties() {
        // ensure private storage for property declarations.
        if (!this.hasOwnProperty(JSCompiler_renameProperty('_classProperties', this))) {
            this._classProperties = new Map();
            // NOTE: Workaround IE11 not supporting Map constructor argument.
            const superProperties = Object.getPrototypeOf(this)._classProperties;
            if (superProperties !== undefined) {
                superProperties.forEach((v, k) => this._classProperties.set(k, v));
            }
        }
    }
    /**
     * Creates a property accessor on the element prototype if one does not exist
     * and stores a PropertyDeclaration for the property with the given options.
     * The property setter calls the property's `hasChanged` property option
     * or uses a strict identity check to determine whether or not to request
     * an update.
     *
     * This method may be overridden to customize properties; however,
     * when doing so, it's important to call `super.createProperty` to ensure
     * the property is setup correctly. This method calls
     * `getPropertyDescriptor` internally to get a descriptor to install.
     * To customize what properties do when they are get or set, override
     * `getPropertyDescriptor`. To customize the options for a property,
     * implement `createProperty` like this:
     *
     * static createProperty(name, options) {
     *   options = Object.assign(options, {myOption: true});
     *   super.createProperty(name, options);
     * }
     *
     * @nocollapse
     */
    static createProperty(name, options = defaultPropertyDeclaration) {
        // Note, since this can be called by the `@property` decorator which
        // is called before `finalize`, we ensure storage exists for property
        // metadata.
        this._ensureClassProperties();
        this._classProperties.set(name, options);
        // Do not generate an accessor if the prototype already has one, since
        // it would be lost otherwise and that would never be the user's intention;
        // Instead, we expect users to call `requestUpdate` themselves from
        // user-defined accessors. Note that if the super has an accessor we will
        // still overwrite it
        if (options.noAccessor || this.prototype.hasOwnProperty(name)) {
            return;
        }
        const key = typeof name === 'symbol' ? Symbol() : `__${name}`;
        const descriptor = this.getPropertyDescriptor(name, key, options);
        if (descriptor !== undefined) {
            Object.defineProperty(this.prototype, name, descriptor);
        }
    }
    /**
     * Returns a property descriptor to be defined on the given named property.
     * If no descriptor is returned, the property will not become an accessor.
     * For example,
     *
     *   class MyElement extends LitElement {
     *     static getPropertyDescriptor(name, key, options) {
     *       const defaultDescriptor =
     *           super.getPropertyDescriptor(name, key, options);
     *       const setter = defaultDescriptor.set;
     *       return {
     *         get: defaultDescriptor.get,
     *         set(value) {
     *           setter.call(this, value);
     *           // custom action.
     *         },
     *         configurable: true,
     *         enumerable: true
     *       }
     *     }
     *   }
     *
     * @nocollapse
     */
    static getPropertyDescriptor(name, key, options) {
        return {
            // tslint:disable-next-line:no-any no symbol in index
            get() {
                return this[key];
            },
            set(value) {
                const oldValue = this[name];
                this[key] = value;
                this
                    .requestUpdateInternal(name, oldValue, options);
            },
            configurable: true,
            enumerable: true
        };
    }
    /**
     * Returns the property options associated with the given property.
     * These options are defined with a PropertyDeclaration via the `properties`
     * object or the `@property` decorator and are registered in
     * `createProperty(...)`.
     *
     * Note, this method should be considered "final" and not overridden. To
     * customize the options for a given property, override `createProperty`.
     *
     * @nocollapse
     * @final
     */
    static getPropertyOptions(name) {
        return this._classProperties && this._classProperties.get(name) ||
            defaultPropertyDeclaration;
    }
    /**
     * Creates property accessors for registered properties and ensures
     * any superclasses are also finalized.
     * @nocollapse
     */
    static finalize() {
        // finalize any superclasses
        const superCtor = Object.getPrototypeOf(this);
        if (!superCtor.hasOwnProperty(finalized)) {
            superCtor.finalize();
        }
        this[finalized] = true;
        this._ensureClassProperties();
        // initialize Map populated in observedAttributes
        this._attributeToPropertyMap = new Map();
        // make any properties
        // Note, only process "own" properties since this element will inherit
        // any properties defined on the superClass, and finalization ensures
        // the entire prototype chain is finalized.
        if (this.hasOwnProperty(JSCompiler_renameProperty('properties', this))) {
            const props = this.properties;
            // support symbols in properties (IE11 does not support this)
            const propKeys = [
                ...Object.getOwnPropertyNames(props),
                ...(typeof Object.getOwnPropertySymbols === 'function') ?
                    Object.getOwnPropertySymbols(props) :
                    []
            ];
            // This for/of is ok because propKeys is an array
            for (const p of propKeys) {
                // note, use of `any` is due to TypeSript lack of support for symbol in
                // index types
                // tslint:disable-next-line:no-any no symbol in index
                this.createProperty(p, props[p]);
            }
        }
    }
    /**
     * Returns the property name for the given attribute `name`.
     * @nocollapse
     */
    static _attributeNameForProperty(name, options) {
        const attribute = options.attribute;
        return attribute === false ?
            undefined :
            (typeof attribute === 'string' ?
                attribute :
                (typeof name === 'string' ? name.toLowerCase() : undefined));
    }
    /**
     * Returns true if a property should request an update.
     * Called when a property value is set and uses the `hasChanged`
     * option for the property if present or a strict identity check.
     * @nocollapse
     */
    static _valueHasChanged(value, old, hasChanged = notEqual) {
        return hasChanged(value, old);
    }
    /**
     * Returns the property value for the given attribute value.
     * Called via the `attributeChangedCallback` and uses the property's
     * `converter` or `converter.fromAttribute` property option.
     * @nocollapse
     */
    static _propertyValueFromAttribute(value, options) {
        const type = options.type;
        const converter = options.converter || defaultConverter;
        const fromAttribute = (typeof converter === 'function' ? converter : converter.fromAttribute);
        return fromAttribute ? fromAttribute(value, type) : value;
    }
    /**
     * Returns the attribute value for the given property value. If this
     * returns undefined, the property will *not* be reflected to an attribute.
     * If this returns null, the attribute will be removed, otherwise the
     * attribute will be set to the value.
     * This uses the property's `reflect` and `type.toAttribute` property options.
     * @nocollapse
     */
    static _propertyValueToAttribute(value, options) {
        if (options.reflect === undefined) {
            return;
        }
        const type = options.type;
        const converter = options.converter;
        const toAttribute = converter && converter.toAttribute ||
            defaultConverter.toAttribute;
        return toAttribute(value, type);
    }
    /**
     * Performs element initialization. By default captures any pre-set values for
     * registered properties.
     */
    initialize() {
        this._updateState = 0;
        this._updatePromise =
            new Promise((res) => this._enableUpdatingResolver = res);
        this._changedProperties = new Map();
        this._saveInstanceProperties();
        // ensures first update will be caught by an early access of
        // `updateComplete`
        this.requestUpdateInternal();
    }
    /**
     * Fixes any properties set on the instance before upgrade time.
     * Otherwise these would shadow the accessor and break these properties.
     * The properties are stored in a Map which is played back after the
     * constructor runs. Note, on very old versions of Safari (<=9) or Chrome
     * (<=41), properties created for native platform properties like (`id` or
     * `name`) may not have default values set in the element constructor. On
     * these browsers native properties appear on instances and therefore their
     * default value will overwrite any element default (e.g. if the element sets
     * this.id = 'id' in the constructor, the 'id' will become '' since this is
     * the native platform default).
     */
    _saveInstanceProperties() {
        // Use forEach so this works even if for/of loops are compiled to for loops
        // expecting arrays
        this.constructor
            ._classProperties.forEach((_v, p) => {
            if (this.hasOwnProperty(p)) {
                const value = this[p];
                delete this[p];
                if (!this._instanceProperties) {
                    this._instanceProperties = new Map();
                }
                this._instanceProperties.set(p, value);
            }
        });
    }
    /**
     * Applies previously saved instance properties.
     */
    _applyInstanceProperties() {
        // Use forEach so this works even if for/of loops are compiled to for loops
        // expecting arrays
        // tslint:disable-next-line:no-any
        this._instanceProperties.forEach((v, p) => this[p] = v);
        this._instanceProperties = undefined;
    }
    connectedCallback() {
        // Ensure first connection completes an update. Updates cannot complete
        // before connection.
        this.enableUpdating();
    }
    enableUpdating() {
        if (this._enableUpdatingResolver !== undefined) {
            this._enableUpdatingResolver();
            this._enableUpdatingResolver = undefined;
        }
    }
    /**
     * Allows for `super.disconnectedCallback()` in extensions while
     * reserving the possibility of making non-breaking feature additions
     * when disconnecting at some point in the future.
     */
    disconnectedCallback() {
    }
    /**
     * Synchronizes property values when attributes change.
     */
    attributeChangedCallback(name, old, value) {
        if (old !== value) {
            this._attributeToProperty(name, value);
        }
    }
    _propertyToAttribute(name, value, options = defaultPropertyDeclaration) {
        const ctor = this.constructor;
        const attr = ctor._attributeNameForProperty(name, options);
        if (attr !== undefined) {
            const attrValue = ctor._propertyValueToAttribute(value, options);
            // an undefined value does not change the attribute.
            if (attrValue === undefined) {
                return;
            }
            // Track if the property is being reflected to avoid
            // setting the property again via `attributeChangedCallback`. Note:
            // 1. this takes advantage of the fact that the callback is synchronous.
            // 2. will behave incorrectly if multiple attributes are in the reaction
            // stack at time of calling. However, since we process attributes
            // in `update` this should not be possible (or an extreme corner case
            // that we'd like to discover).
            // mark state reflecting
            this._updateState = this._updateState | STATE_IS_REFLECTING_TO_ATTRIBUTE;
            if (attrValue == null) {
                this.removeAttribute(attr);
            }
            else {
                this.setAttribute(attr, attrValue);
            }
            // mark state not reflecting
            this._updateState = this._updateState & ~STATE_IS_REFLECTING_TO_ATTRIBUTE;
        }
    }
    _attributeToProperty(name, value) {
        // Use tracking info to avoid deserializing attribute value if it was
        // just set from a property setter.
        if (this._updateState & STATE_IS_REFLECTING_TO_ATTRIBUTE) {
            return;
        }
        const ctor = this.constructor;
        // Note, hint this as an `AttributeMap` so closure clearly understands
        // the type; it has issues with tracking types through statics
        // tslint:disable-next-line:no-unnecessary-type-assertion
        const propName = ctor._attributeToPropertyMap.get(name);
        if (propName !== undefined) {
            const options = ctor.getPropertyOptions(propName);
            // mark state reflecting
            this._updateState = this._updateState | STATE_IS_REFLECTING_TO_PROPERTY;
            this[propName] =
                // tslint:disable-next-line:no-any
                ctor._propertyValueFromAttribute(value, options);
            // mark state not reflecting
            this._updateState = this._updateState & ~STATE_IS_REFLECTING_TO_PROPERTY;
        }
    }
    /**
     * This protected version of `requestUpdate` does not access or return the
     * `updateComplete` promise. This promise can be overridden and is therefore
     * not free to access.
     */
    requestUpdateInternal(name, oldValue, options) {
        let shouldRequestUpdate = true;
        // If we have a property key, perform property update steps.
        if (name !== undefined) {
            const ctor = this.constructor;
            options = options || ctor.getPropertyOptions(name);
            if (ctor._valueHasChanged(this[name], oldValue, options.hasChanged)) {
                if (!this._changedProperties.has(name)) {
                    this._changedProperties.set(name, oldValue);
                }
                // Add to reflecting properties set.
                // Note, it's important that every change has a chance to add the
                // property to `_reflectingProperties`. This ensures setting
                // attribute + property reflects correctly.
                if (options.reflect === true &&
                    !(this._updateState & STATE_IS_REFLECTING_TO_PROPERTY)) {
                    if (this._reflectingProperties === undefined) {
                        this._reflectingProperties = new Map();
                    }
                    this._reflectingProperties.set(name, options);
                }
            }
            else {
                // Abort the request if the property should not be considered changed.
                shouldRequestUpdate = false;
            }
        }
        if (!this._hasRequestedUpdate && shouldRequestUpdate) {
            this._updatePromise = this._enqueueUpdate();
        }
    }
    /**
     * Requests an update which is processed asynchronously. This should
     * be called when an element should update based on some state not triggered
     * by setting a property. In this case, pass no arguments. It should also be
     * called when manually implementing a property setter. In this case, pass the
     * property `name` and `oldValue` to ensure that any configured property
     * options are honored. Returns the `updateComplete` Promise which is resolved
     * when the update completes.
     *
     * @param name {PropertyKey} (optional) name of requesting property
     * @param oldValue {any} (optional) old value of requesting property
     * @returns {Promise} A Promise that is resolved when the update completes.
     */
    requestUpdate(name, oldValue) {
        this.requestUpdateInternal(name, oldValue);
        return this.updateComplete;
    }
    /**
     * Sets up the element to asynchronously update.
     */
    async _enqueueUpdate() {
        this._updateState = this._updateState | STATE_UPDATE_REQUESTED;
        try {
            // Ensure any previous update has resolved before updating.
            // This `await` also ensures that property changes are batched.
            await this._updatePromise;
        }
        catch (e) {
            // Ignore any previous errors. We only care that the previous cycle is
            // done. Any error should have been handled in the previous update.
        }
        const result = this.performUpdate();
        // If `performUpdate` returns a Promise, we await it. This is done to
        // enable coordinating updates with a scheduler. Note, the result is
        // checked to avoid delaying an additional microtask unless we need to.
        if (result != null) {
            await result;
        }
        return !this._hasRequestedUpdate;
    }
    get _hasRequestedUpdate() {
        return (this._updateState & STATE_UPDATE_REQUESTED);
    }
    get hasUpdated() {
        return (this._updateState & STATE_HAS_UPDATED);
    }
    /**
     * Performs an element update. Note, if an exception is thrown during the
     * update, `firstUpdated` and `updated` will not be called.
     *
     * You can override this method to change the timing of updates. If this
     * method is overridden, `super.performUpdate()` must be called.
     *
     * For instance, to schedule updates to occur just before the next frame:
     *
     * ```
     * protected async performUpdate(): Promise<unknown> {
     *   await new Promise((resolve) => requestAnimationFrame(() => resolve()));
     *   super.performUpdate();
     * }
     * ```
     */
    performUpdate() {
        // Abort any update if one is not pending when this is called.
        // This can happen if `performUpdate` is called early to "flush"
        // the update.
        if (!this._hasRequestedUpdate) {
            return;
        }
        // Mixin instance properties once, if they exist.
        if (this._instanceProperties) {
            this._applyInstanceProperties();
        }
        let shouldUpdate = false;
        const changedProperties = this._changedProperties;
        try {
            shouldUpdate = this.shouldUpdate(changedProperties);
            if (shouldUpdate) {
                this.update(changedProperties);
            }
            else {
                this._markUpdated();
            }
        }
        catch (e) {
            // Prevent `firstUpdated` and `updated` from running when there's an
            // update exception.
            shouldUpdate = false;
            // Ensure element can accept additional updates after an exception.
            this._markUpdated();
            throw e;
        }
        if (shouldUpdate) {
            if (!(this._updateState & STATE_HAS_UPDATED)) {
                this._updateState = this._updateState | STATE_HAS_UPDATED;
                this.firstUpdated(changedProperties);
            }
            this.updated(changedProperties);
        }
    }
    _markUpdated() {
        this._changedProperties = new Map();
        this._updateState = this._updateState & ~STATE_UPDATE_REQUESTED;
    }
    /**
     * Returns a Promise that resolves when the element has completed updating.
     * The Promise value is a boolean that is `true` if the element completed the
     * update without triggering another update. The Promise result is `false` if
     * a property was set inside `updated()`. If the Promise is rejected, an
     * exception was thrown during the update.
     *
     * To await additional asynchronous work, override the `_getUpdateComplete`
     * method. For example, it is sometimes useful to await a rendered element
     * before fulfilling this Promise. To do this, first await
     * `super._getUpdateComplete()`, then any subsequent state.
     *
     * @returns {Promise} The Promise returns a boolean that indicates if the
     * update resolved without triggering another update.
     */
    get updateComplete() {
        return this._getUpdateComplete();
    }
    /**
     * Override point for the `updateComplete` promise.
     *
     * It is not safe to override the `updateComplete` getter directly due to a
     * limitation in TypeScript which means it is not possible to call a
     * superclass getter (e.g. `super.updateComplete.then(...)`) when the target
     * language is ES5 (https://github.com/microsoft/TypeScript/issues/338).
     * This method should be overridden instead. For example:
     *
     *   class MyElement extends LitElement {
     *     async _getUpdateComplete() {
     *       await super._getUpdateComplete();
     *       await this._myChild.updateComplete;
     *     }
     *   }
     */
    _getUpdateComplete() {
        return this._updatePromise;
    }
    /**
     * Controls whether or not `update` should be called when the element requests
     * an update. By default, this method always returns `true`, but this can be
     * customized to control when to update.
     *
     * @param _changedProperties Map of changed properties with old values
     */
    shouldUpdate(_changedProperties) {
        return true;
    }
    /**
     * Updates the element. This method reflects property values to attributes.
     * It can be overridden to render and keep updated element DOM.
     * Setting properties inside this method will *not* trigger
     * another update.
     *
     * @param _changedProperties Map of changed properties with old values
     */
    update(_changedProperties) {
        if (this._reflectingProperties !== undefined &&
            this._reflectingProperties.size > 0) {
            // Use forEach so this works even if for/of loops are compiled to for
            // loops expecting arrays
            this._reflectingProperties.forEach((v, k) => this._propertyToAttribute(k, this[k], v));
            this._reflectingProperties = undefined;
        }
        this._markUpdated();
    }
    /**
     * Invoked whenever the element is updated. Implement to perform
     * post-updating tasks via DOM APIs, for example, focusing an element.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * @param _changedProperties Map of changed properties with old values
     */
    updated(_changedProperties) {
    }
    /**
     * Invoked when the element is first updated. Implement to perform one time
     * work on the element after update.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * @param _changedProperties Map of changed properties with old values
     */
    firstUpdated(_changedProperties) {
    }
}
_a = finalized;
/**
 * Marks class as having finished creating properties.
 */
UpdatingElement[_a] = true;
//# sourceMappingURL=updating-element.js.map

/***/ }),

/***/ "srwK":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-tasks/mgt-tasks-css.js ***!
  \***********************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}.mgt-light{--task-border:2px solid #e1dfdd;--task-complete-border:2px dotted #e1dfdd;--task-new-add-button-disabled-background:#edebe9;--task-icon-color:#000000}.mgt-dark{--task-border:2px solid #797775;--task-complete-border:2px dotted #797775;--task-new-add-button-disabled-background:#4f4f4f;--task-icon-color:#ffffff}:host{font-family:var(--default-font-family);display:flex;flex-direction:column;background-color:var(--background-color-sub1,#faf9f8);padding:var(--tasks-padding,12px);color:var(--color-sub1,#323130)}:host .TaskIcon{font-family:FabricMDL2Icons;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .Header{padding:var(--tasks-header-padding,0);margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .Header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .Header select{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}:host .Header select::-ms-expand{display:none}:host .Header .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .Header .AddBar{display:flex}:host .Header .AddBar .AddBarItem{flex:1 1 auto}:host .Header .NewTaskDue{display:flex}:host .Header .NewTaskDue input{flex:1 1 auto;background-color:var(--background-color-sub1,#faf9f8)}:host .Header .TitleCont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .Header .NewTaskButton{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}:host .Header .NewTaskButton span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .Header .NewTaskButton .TaskIcon{margin-right:8px}:host .Header .NewTaskButton.hidden{visibility:hidden}:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .Task{position:relative;margin:var(--task-margin,0 0 18px 0);padding:var(--task-padding,0 0 0 0);background-color:var(--tasks-background-color,var(--background-color,#fff));border:var(--task-border,2px solid #e1dfdd)}:host .Task .TaskContent{display:flex}:host .Task .TaskContent .Divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskContent .TaskDetailsContainer{flex:1;display:grid;display:-ms-grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--color-sub2,#797775));font-size:12px;font-weight:600;white-space:nowrap;margin-bottom:12px}:host .Task .TaskContent .TaskDetailsContainer .TaskDetail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{color:var(--task-title-color,var(--title-color-subtitle,#323130));font-size:14px;font-weight:600;grid-row:1;-ms-grid-row:1;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .Task .TaskContent .TaskDetailsContainer .TaskGroup{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer .TaskBucket{min-height:24px;grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer .TaskDue{justify-content:flex-end;align-items:flex-start;grid-row:4;-ms-grid-row:4;grid-column:1/3;-ms-grid-column:1;-ms-grid-column-span:2}:host .Task .TaskContent .TaskDetailsContainer.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .Task .TaskContent .TaskDetailsContainer.tablet.NoPlan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDetail{margin:4px 24px 6px 0}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskTitle{grid-row:1;-ms-grid-row:1;grid-column:1/5;-ms-grid-column:1;-ms-grid-column-span:4}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskGroup{grid-row:2;-ms-grid-row:2;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskBucket{grid-row:2;-ms-grid-row:2;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskAssignee{grid-row:2;-ms-grid-row:2;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.tablet .TaskDue{justify-content:flex-start;align-items:center;grid-row:2;-ms-grid-row:2;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .Task .TaskContent .TaskDetailsContainer.desktop.NoPlan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDetail{margin:0 24px 0 0}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskTitle{padding:0;grid-row:1;-ms-grid-row:1;grid-column:1;-ms-grid-column:1}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskGroup{min-height:61px;grid-row:1;-ms-grid-row:1;grid-column:2;-ms-grid-column:2}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskBucket{grid-row:1;-ms-grid-row:1;grid-column:3;-ms-grid-column:3}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskAssignee{grid-row:1;-ms-grid-row:1;grid-column:4;-ms-grid-column:4}:host .Task .TaskContent .TaskDetailsContainer.desktop .TaskDue{justify-content:flex-start;align-items:center;grid-row:1;-ms-grid-row:1;grid-column:5;-ms-grid-column:5}:host .Task .TaskContent .TaskDetailsContainer svg{vertical-align:middle;margin-right:4px}:host .Task .TaskContent .TaskDetailsContainer svg path{fill:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer select,:host .Task .TaskContent .TaskDetailsContainer span{vertical-align:middle}:host .Task .TaskContent .TaskDetailsContainer .TaskIcon{color:#797775;margin-right:8px}:host .Task .TaskContent .TaskDetailsContainer mgt-people{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:16px}:host .Task .TaskContent .TaskDetailsContainer mgt-person{display:inline-block}:host .Task .TaskContent .TaskDetailsContainer .Picker{background-color:var(--background-color-sub1,#faf9f8);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--color-sub2,#797775))}:host .Task .TaskContent .TaskDetailsContainer .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}:host .Task .TaskContent .TaskDetailsContainer input,:host .Task .TaskContent .TaskDetailsContainer select{color:var(--task-detail-color,var(--color-sub2,#797775));font-size:.9em;background-color:var(--background-color-sub1,#faf9f8)}:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer.Complete .TaskCheck{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .Task .TaskCheckContainer.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task .TaskCheckContainer .TaskCheck{font-family:FabricMDL2Icons;font-size:12px;display:inline-block;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-icon-color,#000);display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Task .TaskCheckContainer .TaskCheck.Loading .TaskCheckContent{animation:rotateIcon 2s infinite linear}:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;margin:16px 8px 0 0}:host .Task.ReadOnly .TaskCheckContainer{cursor:default}:host .Task.Complete{background:var(--task-complete-background,var(--background-color-sub1,#faf9f8));border:var(--task-complete-border,2px dotted #e1dfdd)}:host .Task.Complete .TaskContent .TaskDetailsContainer .TaskTitle{text-decoration:line-through;color:var(--color-sub3,#979593)}:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .Task.NewTask .SelfAssign{display:none}:host .Task.NewTask .AssignTo{border:0;background:0 0}:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:'\uE739'}:host .Task.NewTask .FakeCheckBox~:checked{font-family:FabricMDL2Icons;content:'\uE73A'}:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .Task.NewTask .TaskContent .TaskDetailsContainer{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{display:flex}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--background-color-sub1,#faf9f8)}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskGroup{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskBucket{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskDue{margin:8px 16px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .NewTaskAssignee{margin:8px 16px;min-width:80px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select{font-family:var(--default-font-family);font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;padding:4px}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:hover,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:hover{border-bottom:1px solid #106ebe}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:active{border-bottom:1px solid #005a9e}:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input:focus,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select:focus{border-bottom:1px solid #0078d4}:host .Task.NewTask .TaskAddButtonContainer{flex:0 0 auto;display:flex}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{height:100%;max-width:50px;min-width:50px;flex:1 1 auto;justify-content:center;align-items:center;display:flex;cursor:pointer}:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{color:#fff;background:var(--task-new-add-button-background,#0078d4)}:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{font-family:var(--default-font-family, "Segoe UI");font-size:14px;font-weight:600;color:var(--task-new-cancel-button-color,var(--color-sub1,#323130));margin:0 12px 0 32px}:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{background:var(--task-new-add-button-disabled-background,#eaeaea);cursor:default}:host .Task.LoadingTask .TaskCheckContainer{cursor:default}:host .Task.LoadingTask .TaskDetails{display:flex}:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;max-width:400px;height:20px;margin-right:20px!important}:host .Task.LoadingTask .TaskDetail{margin-right:12px;display:flex;flex-direction:row;align-items:center}:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] mgt-arrow-options{--arrow-options-left:auto}[dir=rtl] mgt-dot-options{--dot-options-translateX:translateX(60px)}[dir=rtl] .TaskDetails{margin-right:14px!important}[dir=rtl] .TaskIcon{margin-left:8px}[dir=rtl] .TaskDetail svg{margin-left:4px}
`
];
//# sourceMappingURL=mgt-tasks-css.js.map

/***/ }),

/***/ "tFPJ":
/*!******************************************!*\
  !*** ./node_modules/lit-html/lib/dom.js ***!
  \******************************************/
/*! exports provided: isCEPolyfill, reparentNodes, removeNodes */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isCEPolyfill", function() { return isCEPolyfill; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "reparentNodes", function() { return reparentNodes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeNodes", function() { return removeNodes; });
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * True if the custom elements polyfill is in use.
 */
const isCEPolyfill = typeof window !== 'undefined' &&
    window.customElements != null &&
    window.customElements.polyfillWrapFlushCallback !==
        undefined;
/**
 * Reparents nodes, starting from `start` (inclusive) to `end` (exclusive),
 * into another container (could be the same container), before `before`. If
 * `before` is null, it appends the nodes to the container.
 */
const reparentNodes = (container, start, end = null, before = null) => {
    while (start !== end) {
        const n = start.nextSibling;
        container.insertBefore(start, before);
        start = n;
    }
};
/**
 * Removes nodes, starting from `start` (inclusive) to `end` (exclusive), from
 * `container`.
 */
const removeNodes = (container, start, end = null) => {
    while (start !== end) {
        const n = start.nextSibling;
        container.removeChild(start);
        start = n;
    }
};
//# sourceMappingURL=dom.js.map

/***/ }),

/***/ "tIC7":
/*!*******************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/GraphRequest.js ***!
  \*******************************************************************************/
/*! exports provided: GraphRequest */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphRequest", function() { return GraphRequest; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _GraphErrorHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./GraphErrorHandler */ "Vb7E");
/* harmony import */ var _GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./GraphRequestUtil */ "7eED");
/* harmony import */ var _GraphResponseHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./GraphResponseHandler */ "GewD");
/* harmony import */ var _middleware_MiddlewareControl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./middleware/MiddlewareControl */ "/M1i");
/* harmony import */ var _RequestMethod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./RequestMethod */ "wmib");
/* harmony import */ var _ResponseType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ResponseType */ "G+40");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */







/**
 * @class
 * A Class representing GraphRequest
 */
class GraphRequest {
    /* tslint:enable: variable-name */
    /**
     * @public
     * @constructor
     * Creates an instance of GraphRequest
     * @param {HTTPClient} httpClient - The HTTPClient instance
     * @param {ClientOptions} config - The options for making request
     * @param {string} path - A path string
     */
    constructor(httpClient, config, path) {
        /**
         * @private
         * Parses the path string and creates URLComponents out of it
         * @param {string} path - The request path string
         * @returns Nothing
         */
        this.parsePath = (path) => {
            // Strips out the base of the url if they passed in
            if (path.indexOf("https://") !== -1) {
                path = path.replace("https://", "");
                // Find where the host ends
                const endOfHostStrPos = path.indexOf("/");
                if (endOfHostStrPos !== -1) {
                    // Parse out the host
                    this.urlComponents.host = "https://" + path.substring(0, endOfHostStrPos);
                    // Strip the host from path
                    path = path.substring(endOfHostStrPos + 1, path.length);
                }
                // Remove the following version
                const endOfVersionStrPos = path.indexOf("/");
                if (endOfVersionStrPos !== -1) {
                    // Parse out the version
                    this.urlComponents.version = path.substring(0, endOfVersionStrPos);
                    // Strip version from path
                    path = path.substring(endOfVersionStrPos + 1, path.length);
                }
            }
            // Strip out any leading "/"
            if (path.charAt(0) === "/") {
                path = path.substr(1);
            }
            const queryStrPos = path.indexOf("?");
            if (queryStrPos === -1) {
                // No query string
                this.urlComponents.path = path;
            }
            else {
                this.urlComponents.path = path.substr(0, queryStrPos);
                // Capture query string into oDataQueryParams and otherURLQueryParams
                const queryParams = path.substring(queryStrPos + 1, path.length).split("&");
                for (const queryParam of queryParams) {
                    this.parseQueryParameter(queryParam);
                }
            }
        };
        this.httpClient = httpClient;
        this.config = config;
        this.urlComponents = {
            host: this.config.baseUrl,
            version: this.config.defaultVersion,
            oDataQueryParams: {},
            otherURLQueryParams: {},
            otherURLQueryOptions: [],
        };
        this._headers = {};
        this._options = {};
        this._middlewareOptions = [];
        this.parsePath(path);
    }
    /**
     * @private
     * Adds the query parameter as comma separated values
     * @param {string} propertyName - The name of a property
     * @param {string|string[]} propertyValue - The vale of a property
     * @param {IArguments} additionalProperties - The additional properties
     * @returns Nothing
     */
    addCsvQueryParameter(propertyName, propertyValue, additionalProperties) {
        // If there are already $propertyName value there, append a ","
        this.urlComponents.oDataQueryParams[propertyName] = this.urlComponents.oDataQueryParams[propertyName] ? this.urlComponents.oDataQueryParams[propertyName] + "," : "";
        let allValues = [];
        if (additionalProperties.length > 1 && typeof propertyValue === "string") {
            allValues = Array.prototype.slice.call(additionalProperties);
        }
        else if (typeof propertyValue === "string") {
            allValues.push(propertyValue);
        }
        else {
            allValues = allValues.concat(propertyValue);
        }
        this.urlComponents.oDataQueryParams[propertyName] += allValues.join(",");
    }
    /**
     * @private
     * Builds the full url from the URLComponents to make a request
     * @returns The URL string that is qualified to make a request to graph endpoint
     */
    buildFullUrl() {
        const url = Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["urlJoin"])([this.urlComponents.host, this.urlComponents.version, this.urlComponents.path]) + this.createQueryString();
        if (this.config.debugLogging) {
            console.log(url); // tslint:disable-line: no-console
        }
        return url;
    }
    /**
     * @private
     * Builds the query string from the URLComponents
     * @returns The Constructed query string
     */
    createQueryString() {
        // Combining query params from oDataQueryParams and otherURLQueryParams
        const urlComponents = this.urlComponents;
        const query = [];
        if (Object.keys(urlComponents.oDataQueryParams).length !== 0) {
            for (const property in urlComponents.oDataQueryParams) {
                if (urlComponents.oDataQueryParams.hasOwnProperty(property)) {
                    query.push(property + "=" + urlComponents.oDataQueryParams[property]);
                }
            }
        }
        if (Object.keys(urlComponents.otherURLQueryParams).length !== 0) {
            for (const property in urlComponents.otherURLQueryParams) {
                if (urlComponents.otherURLQueryParams.hasOwnProperty(property)) {
                    query.push(property + "=" + urlComponents.otherURLQueryParams[property]);
                }
            }
        }
        if (urlComponents.otherURLQueryOptions.length !== 0) {
            for (const str of urlComponents.otherURLQueryOptions) {
                query.push(str);
            }
        }
        return query.length > 0 ? "?" + query.join("&") : "";
    }
    /**
     * @private
     * Parses the query parameters to set the urlComponents property of the GraphRequest object
     * @param {string|KeyValuePairObjectStringNumber} queryDictionaryOrString - The query parameter
     * @returns The same GraphRequest instance that is being called with
     */
    parseQueryParameter(queryDictionaryOrString) {
        if (typeof queryDictionaryOrString === "string") {
            if (queryDictionaryOrString.charAt(0) === "?") {
                queryDictionaryOrString = queryDictionaryOrString.substring(1);
            }
            if (queryDictionaryOrString.indexOf("&") !== -1) {
                const queryParams = queryDictionaryOrString.split("&");
                for (const str of queryParams) {
                    this.parseQueryParamenterString(str);
                }
            }
            else {
                this.parseQueryParamenterString(queryDictionaryOrString);
            }
        }
        else if (queryDictionaryOrString.constructor === Object) {
            for (const key in queryDictionaryOrString) {
                if (queryDictionaryOrString.hasOwnProperty(key)) {
                    this.setURLComponentsQueryParamater(key, queryDictionaryOrString[key]);
                }
            }
        }
        return this;
    }
    /**
     * @private
     * Parses the query parameter of string type to set the urlComponents property of the GraphRequest object
     * @param {string} queryParameter - the query parameters
     * returns nothing
     */
    parseQueryParamenterString(queryParameter) {
        /* The query key-value pair must be split on the first equals sign to avoid errors in parsing nested query parameters.
                 Example-> "/me?$expand=home($select=city)" */
        if (this.isValidQueryKeyValuePair(queryParameter)) {
            const indexOfFirstEquals = queryParameter.indexOf("=");
            const paramKey = queryParameter.substring(0, indexOfFirstEquals);
            const paramValue = queryParameter.substring(indexOfFirstEquals + 1);
            this.setURLComponentsQueryParamater(paramKey, paramValue);
        }
        else {
            /* Push values which are not of key-value structure.
            Example-> Handle an invalid input->.query(test), .query($select($select=name)) and let the Graph API respond with the error in the URL*/
            this.urlComponents.otherURLQueryOptions.push(queryParameter);
        }
    }
    /**
     * @private
     * Sets values into the urlComponents property of GraphRequest object.
     * @param {string} paramKey - the query parameter key
     * @param {string} paramValue - the query paramter value
     * @returns nothing
     */
    setURLComponentsQueryParamater(paramKey, paramValue) {
        if (_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["oDataQueryNames"].indexOf(paramKey) !== -1) {
            const currentValue = this.urlComponents.oDataQueryParams[paramKey];
            const isValueAppendable = currentValue && (paramKey === "$expand" || paramKey === "$select" || paramKey === "$orderby");
            this.urlComponents.oDataQueryParams[paramKey] = isValueAppendable ? currentValue + "," + paramValue : paramValue;
        }
        else {
            this.urlComponents.otherURLQueryParams[paramKey] = paramValue;
        }
    }
    /**
     * @private
     * Check if the query parameter string has a valid key-value structure
     * @param {string} queryString - the query parameter string. Example -> "name=value"
     * #returns true if the query string has a valid key-value structure else false
     */
    isValidQueryKeyValuePair(queryString) {
        const indexofFirstEquals = queryString.indexOf("=");
        if (indexofFirstEquals === -1) {
            return false;
        }
        const indexofOpeningParanthesis = queryString.indexOf("(");
        if (indexofOpeningParanthesis !== -1 && queryString.indexOf("(") < indexofFirstEquals) {
            // Example -> .query($select($expand=true));
            return false;
        }
        return true;
    }
    /**
     * @private
     * Updates the custom headers and options for a request
     * @param {FetchOptions} options - The request options object
     * @returns Nothing
     */
    updateRequestOptions(options) {
        const optionsHeaders = Object.assign({}, options.headers);
        if (this.config.fetchOptions !== undefined) {
            const fetchOptions = Object.assign({}, this.config.fetchOptions);
            Object.assign(options, fetchOptions);
            if (typeof this.config.fetchOptions.headers !== undefined) {
                options.headers = Object.assign({}, this.config.fetchOptions.headers);
            }
        }
        Object.assign(options, this._options);
        if (options.headers !== undefined) {
            Object.assign(optionsHeaders, options.headers);
        }
        Object.assign(optionsHeaders, this._headers);
        options.headers = optionsHeaders;
    }
    /**
     * @private
     * @async
     * Adds the custom headers and options to the request and makes the HTTPClient send request call
     * @param {RequestInfo} request - The request url string or the Request object value
     * @param {FetchOptions} options - The options to make a request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the response content
     */
    send(request, options, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            let rawResponse;
            const middlewareControl = new _middleware_MiddlewareControl__WEBPACK_IMPORTED_MODULE_4__["MiddlewareControl"](this._middlewareOptions);
            this.updateRequestOptions(options);
            try {
                const context = yield this.httpClient.sendRequest({
                    request,
                    options,
                    middlewareControl,
                });
                rawResponse = context.response;
                const response = yield _GraphResponseHandler__WEBPACK_IMPORTED_MODULE_3__["GraphResponseHandler"].getResponse(rawResponse, this._responseType, callback);
                return response;
            }
            catch (error) {
                let statusCode;
                if (typeof rawResponse !== "undefined") {
                    statusCode = rawResponse.status;
                }
                const gError = yield _GraphErrorHandler__WEBPACK_IMPORTED_MODULE_1__["GraphErrorHandler"].getError(error, statusCode, callback);
                throw gError;
            }
        });
    }
    /**
     * @private
     * Checks if the content-type is present in the _headers property. If not present, defaults the content-type to application/json
     * @param none
     * @returns nothing
     */
    setHeaderContentType() {
        if (!this._headers) {
            this.header("Content-Type", "application/json");
            return;
        }
        const headerKeys = Object.keys(this._headers);
        for (const headerKey of headerKeys) {
            if (headerKey.toLowerCase() === "content-type") {
                return;
            }
        }
        // Default the content-type to application/json in case the content-type is not present in the header
        this.header("Content-Type", "application/json");
    }
    /**
     * @public
     * Sets the custom header for a request
     * @param {string} headerKey - A header key
     * @param {string} headerValue - A header value
     * @returns The same GraphRequest instance that is being called with
     */
    header(headerKey, headerValue) {
        this._headers[headerKey] = headerValue;
        return this;
    }
    /**
     * @public
     * Sets the custom headers for a request
     * @param {KeyValuePairObjectStringNumber | HeadersInit} headers - The request headers
     * @returns The same GraphRequest instance that is being called with
     */
    headers(headers) {
        for (const key in headers) {
            if (headers.hasOwnProperty(key)) {
                this._headers[key] = headers[key];
            }
        }
        return this;
    }
    /**
     * @public
     * Sets the option for making a request
     * @param {string} key - The key value
     * @param {any} value - The value
     * @returns The same GraphRequest instance that is being called with
     */
    option(key, value) {
        this._options[key] = value;
        return this;
    }
    /**
     * @public
     * Sets the options for making a request
     * @param {{ [key: string]: any }} options - The options key value pair
     * @returns The same GraphRequest instance that is being called with
     */
    options(options) {
        for (const key in options) {
            if (options.hasOwnProperty(key)) {
                this._options[key] = options[key];
            }
        }
        return this;
    }
    /**
     * @public
     * Sets the middleware options for a request
     * @param {MiddlewareOptions[]} options - The array of middleware options
     * @returns The same GraphRequest instance that is being called with
     */
    middlewareOptions(options) {
        this._middlewareOptions = options;
        return this;
    }
    /**
     * @public
     * Sets the api endpoint version for a request
     * @param {string} version - The version value
     * @returns The same GraphRequest instance that is being called with
     */
    version(version) {
        this.urlComponents.version = version;
        return this;
    }
    /**
     * @public
     * Sets the api endpoint version for a request
     * @param {ResponseType} responseType - The response type value
     * @returns The same GraphRequest instance that is being called with
     */
    responseType(responseType) {
        this._responseType = responseType;
        return this;
    }
    /**
     * @public
     * To add properties for select OData Query param
     * @param {string|string[]} properties - The Properties value
     * @returns The same GraphRequest instance that is being called with, after adding the properties for $select query
     */
    /*
     * Accepts .select("displayName,birthday")
     *     and .select(["displayName", "birthday"])
     *     and .select("displayName", "birthday")
     *
     */
    select(properties) {
        this.addCsvQueryParameter("$select", properties, arguments);
        return this;
    }
    /**
     * @public
     * To add properties for expand OData Query param
     * @param {string|string[]} properties - The Properties value
     * @returns The same GraphRequest instance that is being called with, after adding the properties for $expand query
     */
    expand(properties) {
        this.addCsvQueryParameter("$expand", properties, arguments);
        return this;
    }
    /**
     * @public
     * To add properties for orderby OData Query param
     * @param {string|string[]} properties - The Properties value
     * @returns The same GraphRequest instance that is being called with, after adding the properties for $orderby query
     */
    orderby(properties) {
        this.addCsvQueryParameter("$orderby", properties, arguments);
        return this;
    }
    /**
     * @public
     * To add query string for filter OData Query param. The request URL accepts only one $filter Odata Query option and its value is set to the most recently passed filter query string.
     * @param {string} filterStr - The filter query string
     * @returns The same GraphRequest instance that is being called with, after adding the $filter query
     */
    filter(filterStr) {
        this.urlComponents.oDataQueryParams.$filter = filterStr;
        return this;
    }
    /**
     * @public
     * To add criterion for search OData Query param. The request URL accepts only one $search Odata Query option and its value is set to the most recently passed search criterion string.
     * @param {string} searchStr - The search criterion string
     * @returns The same GraphRequest instance that is being called with, after adding the $search query criteria
     */
    search(searchStr) {
        this.urlComponents.oDataQueryParams.$search = searchStr;
        return this;
    }
    /**
     * @public
     * To add number for top OData Query param. The request URL accepts only one $top Odata Query option and its value is set to the most recently passed number value.
     * @param {number} n - The number value
     * @returns The same GraphRequest instance that is being called with, after adding the number for $top query
     */
    top(n) {
        this.urlComponents.oDataQueryParams.$top = n;
        return this;
    }
    /**
     * @public
     * To add number for skip OData Query param. The request URL accepts only one $skip Odata Query option and its value is set to the most recently passed number value.
     * @param {number} n - The number value
     * @returns The same GraphRequest instance that is being called with, after adding the number for the $skip query
     */
    skip(n) {
        this.urlComponents.oDataQueryParams.$skip = n;
        return this;
    }
    /**
     * @public
     * To add token string for skipToken OData Query param. The request URL accepts only one $skipToken Odata Query option and its value is set to the most recently passed token value.
     * @param {string} token - The token value
     * @returns The same GraphRequest instance that is being called with, after adding the token string for $skipToken query option
     */
    skipToken(token) {
        this.urlComponents.oDataQueryParams.$skipToken = token;
        return this;
    }
    /**
     * @public
     * To add boolean for count OData Query param. The URL accepts only one $count Odata Query option and its value is set to the most recently passed boolean value.
     * @param {boolean} isCount - The count boolean
     * @returns The same GraphRequest instance that is being called with, after adding the boolean value for the $count query option
     */
    count(isCount = false) {
        this.urlComponents.oDataQueryParams.$count = isCount.toString();
        return this;
    }
    /**
     * @public
     * Appends query string to the urlComponent
     * @param {string|KeyValuePairObjectStringNumber} queryDictionaryOrString - The query value
     * @returns The same GraphRequest instance that is being called with, after appending the query string to the url component
     */
    /*
     * Accepts .query("displayName=xyz")
     *     and .select({ name: "value" })
     */
    query(queryDictionaryOrString) {
        return this.parseQueryParameter(queryDictionaryOrString);
    }
    /**
     * @public
     * @async
     * Makes a http request with GET method
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the get response
     */
    get(callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].GET,
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes a http request with POST method
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the post response
     */
    post(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].POST,
                body: Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["serializeContent"])(content),
            };
            const className = content && content.constructor && content.constructor.name;
            if (className === "FormData") {
                // Content-Type headers should not be specified in case the of FormData type content
                options.headers = {};
            }
            else {
                this.setHeaderContentType();
                options.headers = this._headers;
            }
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Alias for Post request call
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the post response
     */
    create(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.post(content, callback);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes http request with PUT method
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the put response
     */
    put(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            this.setHeaderContentType();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].PUT,
                body: Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["serializeContent"])(content),
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes http request with PATCH method
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the patch response
     */
    patch(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            this.setHeaderContentType();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].PATCH,
                body: Object(_GraphRequestUtil__WEBPACK_IMPORTED_MODULE_2__["serializeContent"])(content),
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Alias for PATCH request
     * @param {any} content - The content that needs to be sent with the request
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the patch response
     */
    update(content, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.patch(content, callback);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes http request with DELETE method
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the delete response
     */
    delete(callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].DELETE,
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Alias for delete request call
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the delete response
     */
    del(callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                return yield this.delete(callback);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes a http request with GET method to read response as a stream.
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the getStream response
     */
    getStream(callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].GET,
            };
            this.responseType(_ResponseType__WEBPACK_IMPORTED_MODULE_6__["ResponseType"].STREAM);
            try {
                const stream = yield this.send(url, options, callback);
                return stream;
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * @async
     * Makes a http request with GET method to read response as a stream.
     * @param {any} stream - The stream instance
     * @param {GraphRequestCallback} [callback] - The callback function to be called in response with async call
     * @returns A promise that resolves to the putStream response
     */
    putStream(stream, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const url = this.buildFullUrl();
            const options = {
                method: _RequestMethod__WEBPACK_IMPORTED_MODULE_5__["RequestMethod"].PUT,
                headers: {
                    "Content-Type": "application/octet-stream",
                },
                body: stream,
            };
            try {
                const response = yield this.send(url, options, callback);
                return response;
            }
            catch (error) {
                throw error;
            }
        });
    }
}
//# sourceMappingURL=GraphRequest.js.map

/***/ }),

/***/ "tPKz":
/*!****************************************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/sections/mgt-person-card-contact/mgt-person-card-contact-css.js ***!
  \****************************************************************************************************************************************************/
/*! exports provided: styles */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "styles", function() { return styles; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
// THIS FILE IS AUTO GENERATED
// ANY CHANGES WILL BE LOST DURING BUILD
// MODIFY THE .SCSS FILE INSTEAD

/**
 * exports lit-element css
 * @export styles
 */
const styles = [
    lit_element__WEBPACK_IMPORTED_MODULE_0__["css"] `
:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;--default-font-family:'Segoe UI','Segoe UI Web (West European)','Segoe UI',-apple-system,BlinkMacSystemFont,Roboto,'Helvetica Neue',sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:'\\\E70D'}.ms-Icon--ChevronUp::before{content:'\\\E70E'}.ms-Icon--Contact::before{content:'\\\E77B'}.ms-Icon--AddFriend::before{content:'\\\E8FA'}.ms-Icon--OutlookLogoInverse::before{content:'\\\EB6D'}.mgt-light{--color:#000000;--color-sub1:#323130;--color-sub2:#797775;--color-sub3:#979593;--background-color:#ffffff;--background-color--hover:#edebe9;--background-color--active:#e1dfdd;--background-color-sub1:#faf9f8;--background-color-sub2:#f3f2f1;--box-shadow:0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132);--box-shadow-color:rgba(0, 0, 0, 0.092);--icon-color:#605e5c;--tab-line-color:#edebe9;--tab-line-color--hover:#979593;--tab-background-color--hover:#edebe9;--title-color-main:#000000;--title-color-subtitle:#323130;--title-color-sub2:#797775;--line-seperator-color:#edebe9;--placeholder-color:#605e5c;--placeholder-color--focus:#323130;--input-background-color:#ffffff;--input-background-color--hover:#edebe9;--input-border:2px solid #605e5c;--input-border-top:2px solid #605e5c;--input-border-right:2px solid #605e5c;--input-border-bottom:2px solid #605e5c;--input-border-left:2px solid #605e5c;--input-border-color--hover:#323130;--input-border-color--focus:#0078d4;--list-background-color:#ffffff}.mgt-dark{--color:#ffffff;--color-sub1:#f3f2f1;--color-sub2:#c8c6c4;--color-sub3:#979593;--background-color:#000000;--background-color--hover:#323130;--background-color--active:#4f4f4f;--background-color-sub1:#161514;--background-color-sub2:#4f4f4f;--box-shadow:0 5px 14px 0 rgba(0, 0, 0, 0.8);--box-shadow-color:black;--icon-color:#797775;--tab-line-color:#3b3a39;--tab-line-color--hover:#979593;--tab-background-color--hover:#323130;--title-color-main:#ffffff;--title-color-subtitle:#f3f2f1;--title-color-sub2:#c8c6c4;--line-seperator-color:#3b3a39;--placeholder-color:#797775;--placeholder-color--focus:#f3f2f1;--input-background-color:#000000;--input-background-color--hover:#323130;--input-border:2px solid #8a8886;--input-border-top:2px solid #8a8886;--input-border-right:2px solid #8a8886;--input-border-bottom:2px solid #8a8886;--input-border-left:2px solid #8a8886;--input-border-color--hover:#a19f9d;--input-border-color--focus:#0078d4;--list-background-color:#161514}:host{position:relative;user-select:none}:host .root{padding:20px 0}:host .root .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,#323130);margin:0 20px 12px 20px}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--title-color-sub2,#797775);line-height:20px}:host .root .part .part__details .part__value{grid-column:2;color:var(--color-sub1,#323130);font-size:14px;font-weight:400}:host .root .part .part__details .part__value .part__link{color:#0078d4;font-family:var(--default-font-family);font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:#004578}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--background-color-sub2,#f3f2f1);visibility:hidden;display:flex;align-items:center;justify-content:center}:host .root .part .part__copy svg{fill:var(--color-sub1,#323130);cursor:pointer}:host .root .part:hover{background-color:var(--background-color--hover,#edebe9);cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}
`
];
//# sourceMappingURL=mgt-person-card-contact-css.js.map

/***/ }),

/***/ "tekO":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/telemetry/TelemetryConstants.js ***!
  \*************************************************************************************************************/
/*! exports provided: EVENT_NAME_PREFIX, EVENT_NAME_KEY, START_TIME_KEY, ELAPSED_TIME_KEY, TELEMETRY_BLOB_EVENT_NAMES, TENANT_PLACEHOLDER */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_NAME_PREFIX", function() { return EVENT_NAME_PREFIX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVENT_NAME_KEY", function() { return EVENT_NAME_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "START_TIME_KEY", function() { return START_TIME_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ELAPSED_TIME_KEY", function() { return ELAPSED_TIME_KEY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TELEMETRY_BLOB_EVENT_NAMES", function() { return TELEMETRY_BLOB_EVENT_NAMES; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TENANT_PLACEHOLDER", function() { return TENANT_PLACEHOLDER; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
var EVENT_NAME_PREFIX = "msal.";
var EVENT_NAME_KEY = "event_name";
var START_TIME_KEY = "start_time";
var ELAPSED_TIME_KEY = "elapsed_time";
var TELEMETRY_BLOB_EVENT_NAMES = {
    MsalCorrelationIdConstStrKey: "Microsoft.MSAL.correlation_id",
    ApiTelemIdConstStrKey: "msal.api_telem_id",
    ApiIdConstStrKey: "msal.api_id",
    BrokerAppConstStrKey: "Microsoft_MSAL_broker_app",
    CacheEventCountConstStrKey: "Microsoft_MSAL_cache_event_count",
    HttpEventCountTelemetryBatchKey: "Microsoft_MSAL_http_event_count",
    IdpConstStrKey: "Microsoft_MSAL_idp",
    IsSilentTelemetryBatchKey: "",
    IsSuccessfulConstStrKey: "Microsoft_MSAL_is_successful",
    ResponseTimeConstStrKey: "Microsoft_MSAL_response_time",
    TenantIdConstStrKey: "Microsoft_MSAL_tenant_id",
    UiEventCountTelemetryBatchKey: "Microsoft_MSAL_ui_event_count"
};
// This is used to replace the real tenant in telemetry info
var TENANT_PLACEHOLDER = "<tenant>";
//# sourceMappingURL=TelemetryConstants.js.map

/***/ }),

/***/ "tjEs":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/RequestUtils.js ***!
  \*********************************************************************************************/
/*! exports provided: RequestUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RequestUtils", function() { return RequestUtils; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Constants */ "vFME");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "ovzL");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ScopeSet */ "mb9z");
/* harmony import */ var _StringUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./StringUtils */ "Ft/c");
/* harmony import */ var _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./CryptoUtils */ "qD3l");
/* harmony import */ var _TimeUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TimeUtils */ "h916");
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../error/ClientAuthError */ "859E");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */








/**
 * @hidden
 */
var RequestUtils = /** @class */ (function () {
    function RequestUtils() {
    }
    /**
     * @ignore
     *
     * @param request
     * @param isLoginCall
     * @param cacheStorage
     * @param clientId
     *
     * validates all request parameters and generates a consumable request object
     */
    RequestUtils.validateRequest = function (request, isLoginCall, clientId, interactionType) {
        // Throw error if request is empty for acquire * calls
        if (!isLoginCall && !request) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createEmptyRequestError();
        }
        var scopes;
        var extraQueryParameters;
        if (request) {
            // if extraScopesToConsent is passed in loginCall, append them to the login request; Validate and filter scopes (the validate function will throw if validation fails)
            scopes = isLoginCall ? _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].appendScopes(request.scopes, request.extraScopesToConsent) : request.scopes;
            _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].validateInputScope(scopes, !isLoginCall);
            scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].translateClientIdIfSingleScope(scopes, clientId);
            // validate prompt parameter
            this.validatePromptParameter(request.prompt);
            // validate extraQueryParameters
            extraQueryParameters = this.validateEQParameters(request.extraQueryParameters, request.claimsRequest);
            // validate claimsRequest
            this.validateClaimsRequest(request.claimsRequest);
        }
        // validate and generate state and correlationId
        var state = this.validateAndGenerateState(request && request.state, interactionType);
        var correlationId = this.validateAndGenerateCorrelationId(request && request.correlationId);
        var validatedRequest = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, request, { extraQueryParameters: extraQueryParameters,
            scopes: scopes,
            state: state,
            correlationId: correlationId });
        return validatedRequest;
    };
    /**
     * @ignore
     *
     * Utility to test if valid prompt value is passed in the request
     * @param request
     */
    RequestUtils.validatePromptParameter = function (prompt) {
        if (prompt) {
            if ([_Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].LOGIN, _Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].SELECT_ACCOUNT, _Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].CONSENT, _Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].NONE].indexOf(prompt) < 0) {
                throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createInvalidPromptError(prompt);
            }
        }
    };
    /**
     * @ignore
     *
     * Removes unnecessary or duplicate query parameters from extraQueryParameters
     * @param request
     */
    RequestUtils.validateEQParameters = function (extraQueryParameters, claimsRequest) {
        var eQParams = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, extraQueryParameters);
        if (!eQParams) {
            return null;
        }
        if (claimsRequest) {
            // this.logger.warning("Removed duplicate claims from extraQueryParameters. Please use either the claimsRequest field OR pass as extraQueryParameter - not both.");
            delete eQParams[_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].claims];
        }
        _Constants__WEBPACK_IMPORTED_MODULE_1__["BlacklistedEQParams"].forEach(function (param) {
            if (eQParams[param]) {
                // this.logger.warning("Removed duplicate " + param + " from extraQueryParameters. Please use the " + param + " field in request object.");
                delete eQParams[param];
            }
        });
        return eQParams;
    };
    /**
     * @ignore
     *
     * Validates the claims passed in request is a JSON
     * TODO: More validation will be added when the server team tells us how they have actually implemented claims
     * @param claimsRequest
     */
    RequestUtils.validateClaimsRequest = function (claimsRequest) {
        if (!claimsRequest) {
            return;
        }
        try {
            JSON.parse(claimsRequest);
        }
        catch (e) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createClaimsRequestParsingError(e);
        }
    };
    /**
     * @ignore
     *
     * generate unique state per request
     * @param userState User-provided state value
     * @returns State string include library state and user state
     */
    RequestUtils.validateAndGenerateState = function (userState, interactionType) {
        return !_StringUtils__WEBPACK_IMPORTED_MODULE_4__["StringUtils"].isEmpty(userState) ? "" + RequestUtils.generateLibraryState(interactionType) + _Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + userState : RequestUtils.generateLibraryState(interactionType);
    };
    /**
     * Generates the state value used by the library.
     *
     * @returns Base64 encoded string representing the state
     */
    RequestUtils.generateLibraryState = function (interactionType) {
        var stateObject = {
            id: _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].createNewGuid(),
            ts: _TimeUtils__WEBPACK_IMPORTED_MODULE_6__["TimeUtils"].now(),
            method: interactionType
        };
        var stateString = JSON.stringify(stateObject);
        return _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].base64Encode(stateString);
    };
    /**
     * Decodes the state value into a StateObject
     *
     * @param state State value returned in the request
     * @returns Parsed values from the encoded state value
     */
    RequestUtils.parseLibraryState = function (state) {
        var libraryState = decodeURIComponent(state).split(_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter)[0];
        if (_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].isGuid(libraryState)) {
            // If state is guid, assume timestamp is now and is redirect, as redirect should be only method where this can happen.
            return {
                id: libraryState,
                ts: _TimeUtils__WEBPACK_IMPORTED_MODULE_6__["TimeUtils"].now(),
                method: _Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].interactionTypeRedirect
            };
        }
        try {
            var stateString = _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].base64Decode(libraryState);
            var stateObject = JSON.parse(stateString);
            return stateObject;
        }
        catch (e) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_7__["ClientAuthError"].createInvalidStateError(state, null);
        }
    };
    /**
     * @ignore
     *
     * validate correlationId and generate if not valid or not set by the user
     * @param correlationId
     */
    RequestUtils.validateAndGenerateCorrelationId = function (correlationId) {
        // validate user set correlationId or set one for the user if null
        if (correlationId && !_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].isGuid(correlationId)) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createInvalidCorrelationIdError();
        }
        return _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].isGuid(correlationId) ? correlationId : _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].createNewGuid();
    };
    /**
     * Create a request signature
     * @param request
     */
    RequestUtils.createRequestSignature = function (request) {
        return "" + request.scopes.join(" ").toLowerCase() + _Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + request.authority;
    };
    return RequestUtils;
}());

//# sourceMappingURL=RequestUtils.js.map

/***/ }),

/***/ "tjlA":
/*!**************************************!*\
  !*** ./node_modules/buffer/index.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(global) {/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */



var base64 = __webpack_require__(/*! base64-js */ "H7XF")
var ieee754 = __webpack_require__(/*! ieee754 */ "kVK+")
var isArray = __webpack_require__(/*! isarray */ "49sm")

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "yLpj")))

/***/ }),

/***/ "tpmt":
/*!*********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/graph/graph.presence.js ***!
  \*********************************************************************************/
/*! exports provided: getUserPresence, getUsersPresenceByPeople */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUserPresence", function() { return getUserPresence; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUsersPresenceByPeople", function() { return getUsersPresenceByPeople; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

/**
 * Definition of cache structure
 */
const cacheSchema = {
    name: 'presence',
    stores: {
        presence: {}
    },
    version: 1
};
/**
 * Defines the expiration time
 */
const getPresenceInvalidationTime = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.presence.invalidationPeriod || _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.defaultInvalidationPeriod;
/**
 * Whether the groups store is enabled
 */
const presenceCacheEnabled = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.presence.isEnabled && _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.isEnabled;
/**
 * async promise, allows developer to get user presense
 *
 * @returns {Promise<Presence>}
 * @param {IGraph} graph
 * @param {string} userId - id for the user or null for current signed in user
 * @memberof BetaGraph
 */
function getUserPresence(graph, userId) {
    return __awaiter(this, void 0, void 0, function* () {
        const betaGraph = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["BetaGraph"].fromGraph(graph);
        let cache;
        if (presenceCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, 'presence');
            const presence = yield cache.getValue(userId || 'me');
            if (presence && getPresenceInvalidationTime() > Date.now() - presence.timeCached) {
                return JSON.parse(presence.presence);
            }
        }
        const scopes = userId ? ['presence.read.all'] : ['presence.read'];
        const resource = userId ? `/users/${userId}/presence` : '/me/presence';
        const result = yield betaGraph
            .api(resource)
            .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(...scopes))
            .get();
        if (presenceCacheEnabled()) {
            cache.putValue(userId || 'me', { presence: JSON.stringify(result) });
        }
        return result;
    });
}
/**
 * async promise, allows developer to get person presense by providing array of IDynamicPerson
 *
 * @returns {}
 * @memberof BetaGraph
 */
function getUsersPresenceByPeople(graph, people) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!people || people.length === 0) {
            return {};
        }
        const betaGraph = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["BetaGraph"].fromGraph(graph);
        const peoplePresence = {};
        const peoplePresenceToQuery = [];
        const scopes = ['presence.read.all'];
        let cache;
        if (presenceCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, 'presence');
        }
        for (const person of people) {
            if (person !== '' && person.id) {
                const id = person.id;
                peoplePresence[id] = null;
                let presence;
                if (presenceCacheEnabled()) {
                    presence = yield cache.getValue(id);
                }
                if (presenceCacheEnabled() &&
                    presence &&
                    getPresenceInvalidationTime() > Date.now() - (yield presence).timeCached) {
                    peoplePresence[id] = JSON.parse(presence.presence);
                }
                else {
                    peoplePresenceToQuery.push(id);
                }
            }
        }
        try {
            if (peoplePresenceToQuery.length > 0) {
                const presenceResult = yield betaGraph
                    .api(`/communications/getPresencesByUserId`)
                    .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(...scopes))
                    .post({
                    ids: peoplePresenceToQuery
                });
                for (const r of presenceResult.value) {
                    peoplePresence[r.id] = r;
                    if (presenceCacheEnabled()) {
                        cache.putValue(r.id, { presence: JSON.stringify(r) });
                    }
                }
            }
            return peoplePresence;
        }
        catch (_) {
            try {
                /**
                 * individual calls to getUserPresence as fallback
                 * must filter out the contacts, which will either 404 or have PresenceUnknown response
                 * caching will be handled by getUserPresence
                 */
                const response = yield Promise.all(people
                    .filter(person => person &&
                    person.id &&
                    !peoplePresence[person.id] &&
                    'personType' in person &&
                    person.personType.subclass === 'OrganizationUser')
                    .map(person => getUserPresence(betaGraph, person.id)));
                for (const r of response) {
                    peoplePresence[r.id] = r;
                }
                return peoplePresence;
            }
            catch (_) {
                return null;
            }
        }
    });
}
//# sourceMappingURL=graph.presence.js.map

/***/ }),

/***/ "u6ad":
/*!******************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/ChaosHandler.js ***!
  \******************************************************************************************/
/*! exports provided: ChaosHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChaosHandler", function() { return ChaosHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MiddlewareControl */ "/M1i");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MiddlewareUtil */ "z+g4");
/* harmony import */ var _options_ChaosHandlerData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./options/ChaosHandlerData */ "FmRC");
/* harmony import */ var _options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./options/ChaosHandlerOptions */ "DOGG");
/* harmony import */ var _options_ChaosStrategy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./options/ChaosStrategy */ "nT0M");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */






/**
 * Class representing ChaosHandler
 * @class
 * Class
 * @implements Middleware
 */
class ChaosHandler {
    /**
     * @public
     * @constructor
     * To create an instance of Testing Handler
     * @param {ChaosHandlerOptions} [options = new ChaosHandlerOptions()] - The testing handler options instance
     * @param manualMap - The Map passed by user containing url-statusCode info
     * @returns An instance of Testing Handler
     */
    constructor(options = new _options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["ChaosHandlerOptions"](), manualMap) {
        this.options = options;
        this.manualMap = manualMap;
    }
    /**
     * Generates responseHeader
     * @private
     * @param {number} statusCode - the status code to be returned for the request
     * @param {string} requestID - request id
     * @param {string} requestDate - date of the request
     * @returns response Header
     */
    createResponseHeaders(statusCode, requestID, requestDate) {
        const responseHeader = new Headers();
        responseHeader.append("Cache-Control", "no-store");
        responseHeader.append("request-id", requestID);
        responseHeader.append("client-request-id", requestID);
        responseHeader.append("x-ms-ags-diagnostic", "");
        responseHeader.append("Date", requestDate);
        responseHeader.append("Strict-Transport-Security", "");
        if (statusCode === 429) {
            // throttling case has to have a timeout scenario
            responseHeader.append("retry-after", "300");
        }
        return responseHeader;
    }
    /**
     * Generates responseBody
     * @private
     * @param {number} statusCode - the status code to be returned for the request
     * @param {string} statusMessage - the status message to be returned for the request
     * @param {string} requestID - request id
     * @param {string} requestDate - date of the request
     * @param {any?} requestBody - the request body to be returned for the request
     * @returns response body
     */
    createResponseBody(statusCode, statusMessage, requestID, requestDate, responseBody) {
        if (responseBody) {
            return responseBody;
        }
        let body;
        if (statusCode >= 400) {
            const codeMessage = _options_ChaosHandlerData__WEBPACK_IMPORTED_MODULE_3__["httpStatusCode"][statusCode];
            const errMessage = statusMessage;
            body = {
                error: {
                    code: codeMessage,
                    message: errMessage,
                    innerError: {
                        "request-id": requestID,
                        date: requestDate,
                    },
                },
            };
        }
        else {
            body = {};
        }
        return body;
    }
    /**
     * creates a response
     * @private
     * @param {ChaosHandlerOptions} ChaosHandlerOptions - The ChaosHandlerOptions object
     * @param {Context} context - Contains the context of the request
     */
    createResponse(chaosHandlerOptions, context) {
        try {
            let responseBody;
            let responseHeader;
            let requestID;
            let requestDate;
            const requestURL = context.request;
            requestID = Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_2__["generateUUID"])();
            requestDate = new Date();
            responseHeader = this.createResponseHeaders(chaosHandlerOptions.statusCode, requestID, requestDate.toString());
            responseBody = this.createResponseBody(chaosHandlerOptions.statusCode, chaosHandlerOptions.statusMessage, requestID, requestDate.toString(), chaosHandlerOptions.responseBody);
            const init = { url: requestURL, status: chaosHandlerOptions.statusCode, statusText: chaosHandlerOptions.statusMessage, headers: responseHeader };
            context.response = new Response(responseBody, init);
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * Decides whether to send the request to the graph or not
     * @private
     * @param {ChaosHandlerOptions} chaosHandlerOptions - A ChaosHandlerOptions object
     * @param {Context} context - Contains the context of the request
     * @returns nothing
     */
    sendRequest(chaosHandlerOptions, context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                this.setStatusCode(chaosHandlerOptions, context.request, context.options.method);
                if (!chaosHandlerOptions.statusCode) {
                    yield this.nextMiddleware.execute(context);
                }
                else {
                    this.createResponse(chaosHandlerOptions, context);
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * Fetches a random status code for the RANDOM mode from the predefined array
     * @private
     * @param {string} requestMethod - the API method for the request
     * @returns a random status code from a given set of status codes
     */
    getRandomStatusCode(requestMethod) {
        try {
            const statusCodeArray = _options_ChaosHandlerData__WEBPACK_IMPORTED_MODULE_3__["methodStatusCode"][requestMethod];
            return statusCodeArray[Math.floor(Math.random() * statusCodeArray.length)];
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * To fetch the relative URL out of the complete URL using a predefined regex pattern
     * @private
     * @param {string} urlMethod - the complete URL
     * @returns the string as relative URL
     */
    getRelativeURL(urlMethod) {
        const pattern = /https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;
        let relativeURL;
        if (pattern.exec(urlMethod) !== null) {
            relativeURL = pattern.exec(urlMethod)[1];
        }
        return relativeURL;
    }
    /**
     * To fetch the status code from the map(if needed), then returns response by calling createResponse
     * @private
     * @param {ChaosHandlerOptions} ChaosHandlerOptions - The ChaosHandlerOptions object
     * @param {string} requestURL - the URL for the request
     * @param {string} requestMethod - the API method for the request
     */
    setStatusCode(chaosHandlerOptions, requestURL, requestMethod) {
        try {
            if (chaosHandlerOptions.chaosStrategy === _options_ChaosStrategy__WEBPACK_IMPORTED_MODULE_5__["ChaosStrategy"].MANUAL) {
                if (chaosHandlerOptions.statusCode === undefined) {
                    // manual mode with no status code, can be a global level or request level without statusCode
                    const relativeURL = this.getRelativeURL(requestURL);
                    if (this.manualMap.get(relativeURL) !== undefined) {
                        // checking Manual Map for exact match
                        if (this.manualMap.get(relativeURL).get(requestMethod) !== undefined) {
                            chaosHandlerOptions.statusCode = this.manualMap.get(relativeURL).get(requestMethod);
                        }
                        // else statusCode would be undefined
                    }
                    else {
                        // checking for regex match if exact match doesn't work
                        this.manualMap.forEach((value, key) => {
                            const regexURL = new RegExp(key + "$");
                            if (regexURL.test(relativeURL)) {
                                if (this.manualMap.get(key).get(requestMethod) !== undefined) {
                                    chaosHandlerOptions.statusCode = this.manualMap.get(key).get(requestMethod);
                                }
                                // else statusCode would be undefined
                            }
                        });
                    }
                    // Case of redirection or request url not in map ---> statusCode would be undefined
                }
            }
            else {
                // Handling the case of Random here
                if (Math.floor(Math.random() * 100) < chaosHandlerOptions.chaosPercentage) {
                    chaosHandlerOptions.statusCode = this.getRandomStatusCode(requestMethod);
                }
                // else statusCode would be undefined
            }
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * To get the options for execution of the middleware
     * @private
     * @param {Context} context - The context object
     * @returns options for middleware execution
     */
    getOptions(context) {
        let options;
        if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_1__["MiddlewareControl"]) {
            options = context.middlewareControl.getMiddlewareOptions(_options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["ChaosHandlerOptions"]);
        }
        if (typeof options === "undefined") {
            options = Object.assign(new _options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["ChaosHandlerOptions"](), this.options);
        }
        return options;
    }
    /**
     * To execute the current middleware
     * @public
     * @async
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const chaosHandlerOptions = this.getOptions(context);
                return yield this.sendRequest(chaosHandlerOptions, context);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
//# sourceMappingURL=ChaosHandler.js.map

/***/ }),

/***/ "u7Q3":
/*!**********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/LocalizationHelper.js ***!
  \**********************************************************************************/
/*! exports provided: LocalizationHelper */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LocalizationHelper", function() { return LocalizationHelper; });
/* harmony import */ var _EventDispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EventDispatcher */ "kDYw");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * Helper class for Localization
 *
 *
 * @export
 * @class LocalizationHelper
 */
class LocalizationHelper {
    static get strings() {
        return this._strings;
    }
    /**
     * Set strings to be localized
     *
     * @static
     * @memberof LocalizationHelper
     */
    static set strings(value) {
        this._strings = value;
        this._stringsEventDispatcher.fire(null);
    }
    /**
     * returns body dir attribute to determine rtl or ltr
     *
     * @static
     * @returns {string} dir
     * @memberof LocalizationHelper
     */
    static getDocumentDirection() {
        return document.body.getAttribute('dir') || document.documentElement.getAttribute('dir');
    }
    /**
     * Fires event when LocalizationHelper changes state
     *
     * @static
     * @param {EventHandler<ProvidersChangedState>} event
     * @memberof LocalizationHelper
     */
    static onStringsUpdated(event) {
        this._stringsEventDispatcher.add(event);
    }
    static removeOnStringsUpdated(event) {
        this._stringsEventDispatcher.remove(event);
    }
    static onDirectionUpdated(event) {
        this._directionEventDispatcher.add(event);
        this.initDirection();
    }
    static removeOnDirectionUpdated(event) {
        this._directionEventDispatcher.remove(event);
    }
    /**
     * Checks for direction setup and adds mutationObserver
     *
     * @private
     * @static
     * @returns
     * @memberof LocalizationHelper
     */
    static initDirection() {
        if (this._isDirectionInit) {
            return;
        }
        this._isDirectionInit = true;
        this.mutationObserver = new MutationObserver(mutations => {
            mutations.forEach(mutation => {
                if (mutation.attributeName == 'dir') {
                    this._directionEventDispatcher.fire(null);
                }
            });
        });
        const options = { attributes: true, attributeFilter: ['dir'] };
        this.mutationObserver.observe(document.body, options);
        this.mutationObserver.observe(document.documentElement, options);
    }
    /**
     * Provided helper method to determine localized or defaultString for specific string is returned
     *
     * @static updateStringsForTag
     * @param {string} tagName
     * @param  stringsObj
     * @returns
     * @memberof LocalizationHelper
     */
    static updateStringsForTag(tagName, stringObj) {
        tagName = tagName.toLowerCase();
        if (tagName.startsWith('mgt-')) {
            tagName = tagName.substring(4);
        }
        if (this._strings && stringObj) {
            //check for top level strings, applied per component, overridden by specific component def
            for (let prop of Object.entries(stringObj)) {
                if (this._strings[prop[0]]) {
                    stringObj[prop[0]] = this._strings[prop[0]];
                }
            }
            //strings defined component specific
            if (this._strings['_components'] && this._strings['_components'][tagName]) {
                let strings = this._strings['_components'][tagName];
                for (let key of Object.keys(strings)) {
                    if (stringObj[key]) {
                        stringObj[key] = strings[key];
                    }
                }
            }
        }
        return stringObj;
    }
}
LocalizationHelper._stringsEventDispatcher = new _EventDispatcher__WEBPACK_IMPORTED_MODULE_0__["EventDispatcher"]();
LocalizationHelper._directionEventDispatcher = new _EventDispatcher__WEBPACK_IMPORTED_MODULE_0__["EventDispatcher"]();
LocalizationHelper._isDirectionInit = false;
//# sourceMappingURL=LocalizationHelper.js.map

/***/ }),

/***/ "umkM":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/RequestMethod.js ***!
  \********************************************************************************************************************/
/*! exports provided: RequestMethod */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RequestMethod", function() { return RequestMethod; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @enum
 * Enum for RequestMethods
 * @property {string} GET - The get request type
 * @property {string} PATCH - The patch request type
 * @property {string} POST - The post request type
 * @property {string} PUT - The put request type
 * @property {string} DELETE - The delete request type
 */
var RequestMethod;
(function (RequestMethod) {
    RequestMethod["GET"] = "GET";
    RequestMethod["PATCH"] = "PATCH";
    RequestMethod["POST"] = "POST";
    RequestMethod["PUT"] = "PUT";
    RequestMethod["DELETE"] = "DELETE";
})(RequestMethod || (RequestMethod = {}));
//# sourceMappingURL=RequestMethod.js.map

/***/ }),

/***/ "v0JY":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/ChaosHandler.js ***!
  \******************************************************************************************************************************/
/*! exports provided: ChaosHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChaosHandler", function() { return ChaosHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MiddlewareControl */ "ocZF");
/* harmony import */ var _MiddlewareUtil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MiddlewareUtil */ "kM4i");
/* harmony import */ var _options_ChaosHandlerData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./options/ChaosHandlerData */ "CKcM");
/* harmony import */ var _options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./options/ChaosHandlerOptions */ "lgJW");
/* harmony import */ var _options_ChaosStrategy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./options/ChaosStrategy */ "WJ2Y");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */






/**
 * Class representing ChaosHandler
 * @class
 * Class
 * @implements Middleware
 */
class ChaosHandler {
    /**
     * @public
     * @constructor
     * To create an instance of Testing Handler
     * @param {ChaosHandlerOptions} [options = new ChaosHandlerOptions()] - The testing handler options instance
     * @param manualMap - The Map passed by user containing url-statusCode info
     * @returns An instance of Testing Handler
     */
    constructor(options = new _options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["ChaosHandlerOptions"](), manualMap) {
        this.options = options;
        this.manualMap = manualMap;
    }
    /**
     * Generates responseHeader
     * @private
     * @param {number} statusCode - the status code to be returned for the request
     * @param {string} requestID - request id
     * @param {string} requestDate - date of the request
     * @returns response Header
     */
    createResponseHeaders(statusCode, requestID, requestDate) {
        const responseHeader = new Headers();
        responseHeader.append("Cache-Control", "no-store");
        responseHeader.append("request-id", requestID);
        responseHeader.append("client-request-id", requestID);
        responseHeader.append("x-ms-ags-diagnostic", "");
        responseHeader.append("Date", requestDate);
        responseHeader.append("Strict-Transport-Security", "");
        if (statusCode === 429) {
            // throttling case has to have a timeout scenario
            responseHeader.append("retry-after", "300");
        }
        return responseHeader;
    }
    /**
     * Generates responseBody
     * @private
     * @param {number} statusCode - the status code to be returned for the request
     * @param {string} statusMessage - the status message to be returned for the request
     * @param {string} requestID - request id
     * @param {string} requestDate - date of the request
     * @param {any?} requestBody - the request body to be returned for the request
     * @returns response body
     */
    createResponseBody(statusCode, statusMessage, requestID, requestDate, responseBody) {
        if (responseBody) {
            return responseBody;
        }
        let body;
        if (statusCode >= 400) {
            const codeMessage = _options_ChaosHandlerData__WEBPACK_IMPORTED_MODULE_3__["httpStatusCode"][statusCode];
            const errMessage = statusMessage;
            body = {
                error: {
                    code: codeMessage,
                    message: errMessage,
                    innerError: {
                        "request-id": requestID,
                        date: requestDate,
                    },
                },
            };
        }
        else {
            body = {};
        }
        return body;
    }
    /**
     * creates a response
     * @private
     * @param {ChaosHandlerOptions} ChaosHandlerOptions - The ChaosHandlerOptions object
     * @param {Context} context - Contains the context of the request
     */
    createResponse(chaosHandlerOptions, context) {
        try {
            let responseBody;
            let responseHeader;
            let requestID;
            let requestDate;
            const requestURL = context.request;
            requestID = Object(_MiddlewareUtil__WEBPACK_IMPORTED_MODULE_2__["generateUUID"])();
            requestDate = new Date();
            responseHeader = this.createResponseHeaders(chaosHandlerOptions.statusCode, requestID, requestDate.toString());
            responseBody = this.createResponseBody(chaosHandlerOptions.statusCode, chaosHandlerOptions.statusMessage, requestID, requestDate.toString(), chaosHandlerOptions.responseBody);
            const init = { url: requestURL, status: chaosHandlerOptions.statusCode, statusText: chaosHandlerOptions.statusMessage, headers: responseHeader };
            context.response = new Response(responseBody, init);
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * Decides whether to send the request to the graph or not
     * @private
     * @param {ChaosHandlerOptions} chaosHandlerOptions - A ChaosHandlerOptions object
     * @param {Context} context - Contains the context of the request
     * @returns nothing
     */
    sendRequest(chaosHandlerOptions, context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                this.setStatusCode(chaosHandlerOptions, context.request, context.options.method);
                if (!chaosHandlerOptions.statusCode) {
                    yield this.nextMiddleware.execute(context);
                }
                else {
                    this.createResponse(chaosHandlerOptions, context);
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * Fetches a random status code for the RANDOM mode from the predefined array
     * @private
     * @param {string} requestMethod - the API method for the request
     * @returns a random status code from a given set of status codes
     */
    getRandomStatusCode(requestMethod) {
        try {
            const statusCodeArray = _options_ChaosHandlerData__WEBPACK_IMPORTED_MODULE_3__["methodStatusCode"][requestMethod];
            return statusCodeArray[Math.floor(Math.random() * statusCodeArray.length)];
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * To fetch the relative URL out of the complete URL using a predefined regex pattern
     * @private
     * @param {string} urlMethod - the complete URL
     * @returns the string as relative URL
     */
    getRelativeURL(urlMethod) {
        const pattern = /https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;
        let relativeURL;
        if (pattern.exec(urlMethod) !== null) {
            relativeURL = pattern.exec(urlMethod)[1];
        }
        return relativeURL;
    }
    /**
     * To fetch the status code from the map(if needed), then returns response by calling createResponse
     * @private
     * @param {ChaosHandlerOptions} ChaosHandlerOptions - The ChaosHandlerOptions object
     * @param {string} requestURL - the URL for the request
     * @param {string} requestMethod - the API method for the request
     */
    setStatusCode(chaosHandlerOptions, requestURL, requestMethod) {
        try {
            if (chaosHandlerOptions.chaosStrategy === _options_ChaosStrategy__WEBPACK_IMPORTED_MODULE_5__["ChaosStrategy"].MANUAL) {
                if (chaosHandlerOptions.statusCode === undefined) {
                    // manual mode with no status code, can be a global level or request level without statusCode
                    const relativeURL = this.getRelativeURL(requestURL);
                    if (this.manualMap.get(relativeURL) !== undefined) {
                        // checking Manual Map for exact match
                        if (this.manualMap.get(relativeURL).get(requestMethod) !== undefined) {
                            chaosHandlerOptions.statusCode = this.manualMap.get(relativeURL).get(requestMethod);
                        }
                        // else statusCode would be undefined
                    }
                    else {
                        // checking for regex match if exact match doesn't work
                        this.manualMap.forEach((value, key) => {
                            const regexURL = new RegExp(key + "$");
                            if (regexURL.test(relativeURL)) {
                                if (this.manualMap.get(key).get(requestMethod) !== undefined) {
                                    chaosHandlerOptions.statusCode = this.manualMap.get(key).get(requestMethod);
                                }
                                // else statusCode would be undefined
                            }
                        });
                    }
                    // Case of redirection or request url not in map ---> statusCode would be undefined
                }
            }
            else {
                // Handling the case of Random here
                if (Math.floor(Math.random() * 100) < chaosHandlerOptions.chaosPercentage) {
                    chaosHandlerOptions.statusCode = this.getRandomStatusCode(requestMethod);
                }
                // else statusCode would be undefined
            }
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * To get the options for execution of the middleware
     * @private
     * @param {Context} context - The context object
     * @returns options for middleware execution
     */
    getOptions(context) {
        let options;
        if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_1__["MiddlewareControl"]) {
            options = context.middlewareControl.getMiddlewareOptions(_options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["ChaosHandlerOptions"]);
        }
        if (typeof options === "undefined") {
            options = Object.assign(new _options_ChaosHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["ChaosHandlerOptions"](), this.options);
        }
        return options;
    }
    /**
     * To execute the current middleware
     * @public
     * @async
     * @param {Context} context - The context object of the request
     * @returns A Promise that resolves to nothing
     */
    execute(context) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                const chaosHandlerOptions = this.getOptions(context);
                return yield this.sendRequest(chaosHandlerOptions, context);
            }
            catch (error) {
                throw error;
            }
        });
    }
    /**
     * @public
     * To set the next middleware in the chain
     * @param {Middleware} next - The middleware instance
     * @returns Nothing
     */
    setNext(next) {
        this.nextMiddleware = next;
    }
}
//# sourceMappingURL=ChaosHandler.js.map

/***/ }),

/***/ "v0vZ":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/error/InteractionRequiredAuthError.js ***!
  \*************************************************************************************************************/
/*! exports provided: InteractionRequiredAuthErrorMessage, InteractionRequiredAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractionRequiredAuthErrorMessage", function() { return InteractionRequiredAuthErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractionRequiredAuthError", function() { return InteractionRequiredAuthError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _ServerError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ServerError */ "53Y/");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var InteractionRequiredAuthErrorMessage = {
    interactionRequired: {
        code: "interaction_required"
    },
    consentRequired: {
        code: "consent_required"
    },
    loginRequired: {
        code: "login_required"
    },
};
/**
 * Error thrown when the user is required to perform an interactive token request.
 */
var InteractionRequiredAuthError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](InteractionRequiredAuthError, _super);
    function InteractionRequiredAuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "InteractionRequiredAuthError";
        Object.setPrototypeOf(_this, InteractionRequiredAuthError.prototype);
        return _this;
    }
    InteractionRequiredAuthError.isInteractionRequiredError = function (errorString) {
        var interactionRequiredCodes = [
            InteractionRequiredAuthErrorMessage.interactionRequired.code,
            InteractionRequiredAuthErrorMessage.consentRequired.code,
            InteractionRequiredAuthErrorMessage.loginRequired.code
        ];
        return errorString && interactionRequiredCodes.indexOf(errorString) > -1;
    };
    InteractionRequiredAuthError.createLoginRequiredAuthError = function (errorDesc) {
        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.loginRequired.code, errorDesc);
    };
    InteractionRequiredAuthError.createInteractionRequiredAuthError = function (errorDesc) {
        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.interactionRequired.code, errorDesc);
    };
    InteractionRequiredAuthError.createConsentRequiredAuthError = function (errorDesc) {
        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.consentRequired.code, errorDesc);
    };
    return InteractionRequiredAuthError;
}(_ServerError__WEBPACK_IMPORTED_MODULE_1__["ServerError"]));

//# sourceMappingURL=InteractionRequiredAuthError.js.map

/***/ }),

/***/ "vFME":
/*!******************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/utils/Constants.js ***!
  \******************************************************************************************/
/*! exports provided: Constants, ServerHashParamKeys, ResponseTypes, TemporaryCacheKeys, PersistentCacheKeys, ErrorCacheKeys, DEFAULT_AUTHORITY, AAD_INSTANCE_DISCOVERY_ENDPOINT, WELL_KNOWN_SUFFIX, SSOTypes, BlacklistedEQParams, NetworkRequestType, PromptState, FramePrefix, libraryVersion */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Constants", function() { return Constants; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerHashParamKeys", function() { return ServerHashParamKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResponseTypes", function() { return ResponseTypes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TemporaryCacheKeys", function() { return TemporaryCacheKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PersistentCacheKeys", function() { return PersistentCacheKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ErrorCacheKeys", function() { return ErrorCacheKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DEFAULT_AUTHORITY", function() { return DEFAULT_AUTHORITY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AAD_INSTANCE_DISCOVERY_ENDPOINT", function() { return AAD_INSTANCE_DISCOVERY_ENDPOINT; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WELL_KNOWN_SUFFIX", function() { return WELL_KNOWN_SUFFIX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SSOTypes", function() { return SSOTypes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlacklistedEQParams", function() { return BlacklistedEQParams; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NetworkRequestType", function() { return NetworkRequestType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PromptState", function() { return PromptState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FramePrefix", function() { return FramePrefix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "libraryVersion", function() { return libraryVersion; });
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */
/**
 * @hidden
 * Constants
 */
var Constants = /** @class */ (function () {
    function Constants() {
    }
    Object.defineProperty(Constants, "libraryName", {
        get: function () { return "Msal.js"; } // used in telemetry sdkName
        ,
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "claims", {
        get: function () { return "claims"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "clientId", {
        get: function () { return "clientId"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "adalIdToken", {
        get: function () { return "adal.idtoken"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "cachePrefix", {
        get: function () { return "msal"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "scopes", {
        get: function () { return "scopes"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "no_account", {
        get: function () { return "NO_ACCOUNT"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "upn", {
        get: function () { return "upn"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "domain_hint", {
        get: function () { return "domain_hint"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "prompt_select_account", {
        get: function () { return "&prompt=select_account"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "prompt_none", {
        get: function () { return "&prompt=none"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "prompt", {
        get: function () { return "prompt"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "response_mode_fragment", {
        get: function () { return "&response_mode=fragment"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "resourceDelimiter", {
        get: function () { return "|"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "cacheDelimiter", {
        get: function () { return "."; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "popUpWidth", {
        get: function () { return this._popUpWidth; },
        set: function (width) {
            this._popUpWidth = width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "popUpHeight", {
        get: function () { return this._popUpHeight; },
        set: function (height) {
            this._popUpHeight = height;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "login", {
        get: function () { return "LOGIN"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "renewToken", {
        get: function () { return "RENEW_TOKEN"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "unknown", {
        get: function () { return "UNKNOWN"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "ADFS", {
        get: function () { return "adfs"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "homeAccountIdentifier", {
        get: function () { return "homeAccountIdentifier"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "common", {
        get: function () { return "common"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "openidScope", {
        get: function () { return "openid"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "profileScope", {
        get: function () { return "profile"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "oidcScopes", {
        get: function () { return [this.openidScope, this.profileScope]; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "interactionTypeRedirect", {
        get: function () { return "redirectInteraction"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "interactionTypePopup", {
        get: function () { return "popupInteraction"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "interactionTypeSilent", {
        get: function () { return "silentInteraction"; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Constants, "inProgress", {
        get: function () { return "inProgress"; },
        enumerable: true,
        configurable: true
    });
    Constants._popUpWidth = 483;
    Constants._popUpHeight = 600;
    return Constants;
}());

/**
 * Keys in the hashParams
 */
var ServerHashParamKeys;
(function (ServerHashParamKeys) {
    ServerHashParamKeys["SCOPE"] = "scope";
    ServerHashParamKeys["STATE"] = "state";
    ServerHashParamKeys["ERROR"] = "error";
    ServerHashParamKeys["ERROR_DESCRIPTION"] = "error_description";
    ServerHashParamKeys["ACCESS_TOKEN"] = "access_token";
    ServerHashParamKeys["ID_TOKEN"] = "id_token";
    ServerHashParamKeys["EXPIRES_IN"] = "expires_in";
    ServerHashParamKeys["SESSION_STATE"] = "session_state";
    ServerHashParamKeys["CLIENT_INFO"] = "client_info";
})(ServerHashParamKeys || (ServerHashParamKeys = {}));
/**
 * @hidden
 * @ignore
 * response_type from OpenIDConnect
 * References: https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html & https://tools.ietf.org/html/rfc6749#section-4.2.1
 *
 */
var ResponseTypes = {
    id_token: "id_token",
    token: "token",
    id_token_token: "id_token token"
};
/**
 * @hidden
 * CacheKeys for MSAL
 */
var TemporaryCacheKeys;
(function (TemporaryCacheKeys) {
    TemporaryCacheKeys["AUTHORITY"] = "authority";
    TemporaryCacheKeys["ACQUIRE_TOKEN_ACCOUNT"] = "acquireTokenAccount";
    TemporaryCacheKeys["SESSION_STATE"] = "session.state";
    TemporaryCacheKeys["STATE_LOGIN"] = "state.login";
    TemporaryCacheKeys["STATE_ACQ_TOKEN"] = "state.acquireToken";
    TemporaryCacheKeys["STATE_RENEW"] = "state.renew";
    TemporaryCacheKeys["NONCE_IDTOKEN"] = "nonce.idtoken";
    TemporaryCacheKeys["LOGIN_REQUEST"] = "login.request";
    TemporaryCacheKeys["RENEW_STATUS"] = "token.renew.status";
    TemporaryCacheKeys["URL_HASH"] = "urlHash";
    TemporaryCacheKeys["INTERACTION_STATUS"] = "interaction_status";
    TemporaryCacheKeys["REDIRECT_REQUEST"] = "redirect_request";
})(TemporaryCacheKeys || (TemporaryCacheKeys = {}));
var PersistentCacheKeys;
(function (PersistentCacheKeys) {
    PersistentCacheKeys["IDTOKEN"] = "idtoken";
    PersistentCacheKeys["CLIENT_INFO"] = "client.info";
})(PersistentCacheKeys || (PersistentCacheKeys = {}));
var ErrorCacheKeys;
(function (ErrorCacheKeys) {
    ErrorCacheKeys["LOGIN_ERROR"] = "login.error";
    ErrorCacheKeys["ERROR"] = "error";
    ErrorCacheKeys["ERROR_DESC"] = "error.description";
})(ErrorCacheKeys || (ErrorCacheKeys = {}));
var DEFAULT_AUTHORITY = "https://login.microsoftonline.com/common/";
var AAD_INSTANCE_DISCOVERY_ENDPOINT = DEFAULT_AUTHORITY + "/discovery/instance?api-version=1.1&authorization_endpoint=";
var WELL_KNOWN_SUFFIX = ".well-known/openid-configuration";
/**
 * @hidden
 * SSO Types - generated to populate hints
 */
var SSOTypes;
(function (SSOTypes) {
    SSOTypes["ACCOUNT"] = "account";
    SSOTypes["SID"] = "sid";
    SSOTypes["LOGIN_HINT"] = "login_hint";
    SSOTypes["ORGANIZATIONS"] = "organizations";
    SSOTypes["ID_TOKEN"] = "id_token";
    SSOTypes["ACCOUNT_ID"] = "accountIdentifier";
    SSOTypes["HOMEACCOUNT_ID"] = "homeAccountIdentifier";
})(SSOTypes || (SSOTypes = {}));
/**
 * @hidden
 */
var BlacklistedEQParams = [
    SSOTypes.SID,
    SSOTypes.LOGIN_HINT
];
var NetworkRequestType = {
    GET: "GET",
    POST: "POST"
};
/**
 * we considered making this "enum" in the request instead of string, however it looks like the allowed list of
 * prompt values kept changing over past couple of years. There are some undocumented prompt values for some
 * internal partners too, hence the choice of generic "string" type instead of the "enum"
 * @hidden
 */
var PromptState = {
    LOGIN: "login",
    SELECT_ACCOUNT: "select_account",
    CONSENT: "consent",
    NONE: "none"
};
/**
 * Frame name prefixes for the hidden iframe created in silent frames
 */
var FramePrefix = {
    ID_TOKEN_FRAME: "msalIdTokenFrame",
    TOKEN_FRAME: "msalRenewFrame"
};
/**
 * MSAL JS Library Version
 */
function libraryVersion() {
    return "1.4.4";
}
//# sourceMappingURL=Constants.js.map

/***/ }),

/***/ "vJwf":
/*!************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/HTTPClientFactory.js ***!
  \************************************************************************************/
/*! exports provided: HTTPClientFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(process) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTPClientFactory", function() { return HTTPClientFactory; });
/* harmony import */ var _HTTPClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./HTTPClient */ "Hj1S");
/* harmony import */ var _middleware_AuthenticationHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./middleware/AuthenticationHandler */ "RsRP");
/* harmony import */ var _middleware_HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./middleware/HTTPMessageHandler */ "nWAj");
/* harmony import */ var _middleware_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./middleware/options/RedirectHandlerOptions */ "FDgl");
/* harmony import */ var _middleware_options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./middleware/options/RetryHandlerOptions */ "q5Kr");
/* harmony import */ var _middleware_RedirectHandler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./middleware/RedirectHandler */ "k/fM");
/* harmony import */ var _middleware_RetryHandler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./middleware/RetryHandler */ "Rtth");
/* harmony import */ var _middleware_TelemetryHandler__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./middleware/TelemetryHandler */ "FGIY");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @module HTTPClientFactory
 */








/**
 * @private
 * To check whether the environment is node or not
 * @returns A boolean representing the environment is node or not
 */
const isNodeEnvironment = () => {
    return typeof process === "object" && "function" === "function";
};
/**
 * @class
 * Class representing HTTPClientFactory
 */
class HTTPClientFactory {
    /**
     * @public
     * @static
     * Creates HTTPClient with default middleware chain
     * @param {AuthenticationProvider} authProvider - The authentication provider instance
     * @returns A HTTPClient instance
     *
     * NOTE: These are the things that we need to remember while doing modifications in the below default pipeline.
     * 		* HTTPMessageHander should be the last one in the middleware pipeline, because this makes the actual network call of the request
     * 		* TelemetryHandler should be the one prior to the last middleware in the chain, because this is the one which actually collects and appends the usage flag and placing this handler 	*		  before making the actual network call ensures that the usage of all features are recorded in the flag.
     * 		* The best place for AuthenticationHandler is in the starting of the pipeline, because every other handler might have to work for multiple times for a request but the auth token for
     * 		  them will remain same. For example, Retry and Redirect handlers might be working multiple times for a request based on the response but their auth token would remain same.
     */
    static createWithAuthenticationProvider(authProvider) {
        const authenticationHandler = new _middleware_AuthenticationHandler__WEBPACK_IMPORTED_MODULE_1__["AuthenticationHandler"](authProvider);
        const retryHandler = new _middleware_RetryHandler__WEBPACK_IMPORTED_MODULE_6__["RetryHandler"](new _middleware_options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_4__["RetryHandlerOptions"]());
        const telemetryHandler = new _middleware_TelemetryHandler__WEBPACK_IMPORTED_MODULE_7__["TelemetryHandler"]();
        const httpMessageHandler = new _middleware_HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_2__["HTTPMessageHandler"]();
        authenticationHandler.setNext(retryHandler);
        if (isNodeEnvironment()) {
            const redirectHandler = new _middleware_RedirectHandler__WEBPACK_IMPORTED_MODULE_5__["RedirectHandler"](new _middleware_options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_3__["RedirectHandlerOptions"]());
            retryHandler.setNext(redirectHandler);
            redirectHandler.setNext(telemetryHandler);
        }
        else {
            retryHandler.setNext(telemetryHandler);
        }
        telemetryHandler.setNext(httpMessageHandler);
        return HTTPClientFactory.createWithMiddleware(authenticationHandler);
    }
    /**
     * @public
     * @static
     * Creates a middleware chain with the given one
     * @property {...Middleware} middleware - The first middleware of the middleware chain or a sequence of all the Middleware handlers
     * @returns A HTTPClient instance
     */
    static createWithMiddleware(...middleware) {
        // Middleware should not empty or undefined. This is check is present in the HTTPClient constructor.
        return new _HTTPClient__WEBPACK_IMPORTED_MODULE_0__["HTTPClient"](...middleware);
    }
}
//# sourceMappingURL=HTTPClientFactory.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../process/browser.js */ "8oxB")))

/***/ }),

/***/ "vQVX":
/*!************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/utils/Utils.js ***!
  \************************************************************************/
/*! exports provided: getRelativeDisplayDate, delay, getShortDateString, getMonthString, getDayOfWeekString, getDaysInMonth, getDateFromMonthYear, debounce, blobToBase64, extractEmailAddress */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getRelativeDisplayDate", function() { return getRelativeDisplayDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "delay", function() { return delay; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getShortDateString", function() { return getShortDateString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getMonthString", function() { return getMonthString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDayOfWeekString", function() { return getDayOfWeekString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDaysInMonth", function() { return getDaysInMonth; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDateFromMonthYear", function() { return getDateFromMonthYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "debounce", function() { return debounce; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "blobToBase64", function() { return blobToBase64; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extractEmailAddress", function() { return extractEmailAddress; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
function getRelativeDisplayDate(date) {
    const now = new Date();
    // Today -> 5:23 PM
    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    if (date >= today) {
        return date.toLocaleString('default', {
            hour: 'numeric',
            minute: 'numeric'
        });
    }
    // This week -> Sun 3:04 PM
    const sunday = new Date(today);
    sunday.setDate(now.getDate() - now.getDay());
    if (date >= sunday) {
        return date.toLocaleString('default', {
            hour: 'numeric',
            minute: 'numeric',
            weekday: 'short'
        });
    }
    // Last two week -> Sun 8/2
    const lastTwoWeeks = new Date(sunday);
    lastTwoWeeks.setDate(sunday.getDate() - 7);
    if (date >= lastTwoWeeks) {
        return date.toLocaleString('default', {
            day: 'numeric',
            month: 'numeric',
            weekday: 'short'
        });
    }
    // More than two weeks ago -> 8/1/2020
    return date.toLocaleString('default', {
        day: 'numeric',
        month: 'numeric',
        year: 'numeric'
    });
}
/**
 * returns a promise that resolves after specified time
 * @param time in milliseconds
 */
function delay(ms) {
    return new Promise(resolve => {
        setTimeout(resolve, ms);
    });
}
/**
 * returns month and day
 *
 * @export
 * @param {Date} date
 * @returns
 */
function getShortDateString(date) {
    const month = date.getMonth();
    const day = date.getDate();
    return `${getMonthString(month)} ${day}`;
}
/**
 * returns month string based on number
 *
 * @export
 * @param {number} month
 * @returns {string}
 */
function getMonthString(month) {
    switch (month) {
        case 0:
            return 'January';
        case 1:
            return 'February';
        case 2:
            return 'March';
        case 3:
            return 'April';
        case 4:
            return 'May';
        case 5:
            return 'June';
        case 6:
            return 'July';
        case 7:
            return 'August';
        case 8:
            return 'September';
        case 9:
            return 'October';
        case 10:
            return 'November';
        case 11:
            return 'December';
        default:
            return 'Month';
    }
}
/**
 * returns day of week string based on number
 * where 0 === Sunday
 *
 * @export
 * @param {number} day
 * @returns {string}
 */
function getDayOfWeekString(day) {
    switch (day) {
        case 0:
            return 'Sunday';
        case 1:
            return 'Monday';
        case 2:
            return 'Tuesday';
        case 3:
            return 'Wednesday';
        case 4:
            return 'Thursday';
        case 5:
            return 'Friday';
        case 6:
            return 'Saturday';
        default:
            return 'Day';
    }
}
/**
 * retrieve the days in the month provided by number
 *
 * @export
 * @param {number} monthNum
 * @returns {number}
 */
function getDaysInMonth(monthNum) {
    switch (monthNum) {
        case 1:
            return 28;
        case 3:
        case 5:
        case 8:
        case 10:
        default:
            return 30;
        case 0:
        case 2:
        case 4:
        case 6:
        case 7:
        case 9:
        case 11:
            return 31;
    }
}
/**
 * returns serialized date from month number and year number
 *
 * @export
 * @param {number} month
 * @param {number} year
 * @returns
 */
function getDateFromMonthYear(month, year) {
    const yearStr = year + '';
    let monthStr = month + '';
    if (monthStr.length < 2) {
        monthStr = '0' + monthStr;
    }
    return new Date(`${yearStr}-${monthStr}-1T12:00:00-${new Date().getTimezoneOffset() / 60}`);
}
/**
 * ensures one call at a time
 *
 * @export
 * @param {*} func
 * @param {*} time
 * @returns
 */
function debounce(func, time) {
    let timeout;
    return function () {
        const functionCall = () => func.apply(this, arguments);
        clearTimeout(timeout);
        timeout = setTimeout(functionCall, time);
    };
}
/**
 * converts a blob to base64 encoding
 *
 * @param {Blob} blob
 * @returns {Promise<string>}
 */
function blobToBase64(blob) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onerror = reject;
        reader.onload = _ => {
            resolve(reader.result);
        };
        reader.readAsDataURL(blob);
    });
}
/**
 * extracts an email address from a string
 *
 * @param {string} emailString
 * @returns {string}
 */
function extractEmailAddress(emailString) {
    if (emailString.startsWith('[')) {
        return emailString.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString();
    }
    else
        return emailString;
}
//# sourceMappingURL=Utils.js.map

/***/ }),

/***/ "vhOk":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/error/InteractionRequiredAuthError.js ***!
  \*******************************************************************************************************************/
/*! exports provided: InteractionRequiredAuthErrorMessage, InteractionRequiredAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractionRequiredAuthErrorMessage", function() { return InteractionRequiredAuthErrorMessage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InteractionRequiredAuthError", function() { return InteractionRequiredAuthError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _ServerError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ServerError */ "+xZ/");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var InteractionRequiredAuthErrorMessage = {
    interactionRequired: {
        code: "interaction_required"
    },
    consentRequired: {
        code: "consent_required"
    },
    loginRequired: {
        code: "login_required"
    },
};
/**
 * Error thrown when the user is required to perform an interactive token request.
 */
var InteractionRequiredAuthError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](InteractionRequiredAuthError, _super);
    function InteractionRequiredAuthError(errorCode, errorMessage) {
        var _this = _super.call(this, errorCode, errorMessage) || this;
        _this.name = "InteractionRequiredAuthError";
        Object.setPrototypeOf(_this, InteractionRequiredAuthError.prototype);
        return _this;
    }
    InteractionRequiredAuthError.isInteractionRequiredError = function (errorString) {
        var interactionRequiredCodes = [
            InteractionRequiredAuthErrorMessage.interactionRequired.code,
            InteractionRequiredAuthErrorMessage.consentRequired.code,
            InteractionRequiredAuthErrorMessage.loginRequired.code
        ];
        return errorString && interactionRequiredCodes.indexOf(errorString) > -1;
    };
    InteractionRequiredAuthError.createLoginRequiredAuthError = function (errorDesc) {
        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.loginRequired.code, errorDesc);
    };
    InteractionRequiredAuthError.createInteractionRequiredAuthError = function (errorDesc) {
        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.interactionRequired.code, errorDesc);
    };
    InteractionRequiredAuthError.createConsentRequiredAuthError = function (errorDesc) {
        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.consentRequired.code, errorDesc);
    };
    return InteractionRequiredAuthError;
}(_ServerError__WEBPACK_IMPORTED_MODULE_1__["ServerError"]));

//# sourceMappingURL=InteractionRequiredAuthError.js.map

/***/ }),

/***/ "wJ6+":
/*!************************************************!*\
  !*** ./lib/webparts/spfxMgt/SpfxMgtWebPart.js ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _microsoft_sp_property_pane__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/sp-property-pane */ "26ea");
/* harmony import */ var _microsoft_sp_property_pane__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_property_pane__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _microsoft_sp_webpart_base__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/sp-webpart-base */ "br4S");
/* harmony import */ var _microsoft_sp_webpart_base__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_microsoft_sp_webpart_base__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var SpfxMgtWebPartStrings__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! SpfxMgtWebPartStrings */ "BKw3");
/* harmony import */ var SpfxMgtWebPartStrings__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(SpfxMgtWebPartStrings__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _microsoft_mgt__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @microsoft/mgt */ "nVLA");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};




var SpfxMgtWebPart = /** @class */ (function (_super) {
    __extends(SpfxMgtWebPart, _super);
    function SpfxMgtWebPart() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpfxMgtWebPart.prototype.onInit = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                _microsoft_mgt__WEBPACK_IMPORTED_MODULE_3__["Providers"].globalProvider = new _microsoft_mgt__WEBPACK_IMPORTED_MODULE_3__["SharePointProvider"](this.context);
                return [2 /*return*/];
            });
        });
    };
    SpfxMgtWebPart.prototype.render = function () {
        this.domElement.innerHTML = "\n    <mgt-person person-query=\"me\" show-name show-email></mgt-person>\n    <mgt-agenda></mgt-agenda>\n    <mgt-people></mgt-people>\n    <mgt-person-card person-query=\"me\"></mgt-person-card>\n    <mgt-todo></mgt-todo>\n    <mgt-teams-channel-picker></mgt-teams-channel-picker>\n    <button class=\"button\">Get SelectedChannel</button>\n    <div class=\"output\"></div>  \n   ";
        this._setButtonEventHandlers();
    };
    SpfxMgtWebPart.prototype._setButtonEventHandlers = function () {
        var webPart = this;
        document.querySelector('.button').addEventListener('click', function (_) {
            var picker = document.querySelector('mgt-teams-channel-picker');
            var output = document.querySelector('.output');
            output.innerHTML = "<b>channel:</b> " + picker;
        });
    };
    //protected get dataVersion(): Version {
    //return Version.parse('1.0');
    // }
    SpfxMgtWebPart.prototype.getPropertyPaneConfiguration = function () {
        return {
            pages: [
                {
                    header: {
                        description: SpfxMgtWebPartStrings__WEBPACK_IMPORTED_MODULE_2__["PropertyPaneDescription"]
                    },
                    groups: [
                        {
                            groupName: SpfxMgtWebPartStrings__WEBPACK_IMPORTED_MODULE_2__["BasicGroupName"],
                            groupFields: [
                                Object(_microsoft_sp_property_pane__WEBPACK_IMPORTED_MODULE_0__["PropertyPaneTextField"])('description', {
                                    label: SpfxMgtWebPartStrings__WEBPACK_IMPORTED_MODULE_2__["DescriptionFieldLabel"]
                                })
                            ]
                        }
                    ]
                }
            ]
        };
    };
    return SpfxMgtWebPart;
}(_microsoft_sp_webpart_base__WEBPACK_IMPORTED_MODULE_1__["BaseClientSideWebPart"]));
/* harmony default export */ __webpack_exports__["default"] = (SpfxMgtWebPart);


/***/ }),

/***/ "wLax":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/@microsoft/microsoft-graph-client/lib/es/GraphResponseHandler.js ***!
  \***************************************************************************************************************************/
/*! exports provided: DocumentType, GraphResponseHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentType", function() { return DocumentType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GraphResponseHandler", function() { return GraphResponseHandler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _ResponseType__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ResponseType */ "LrMb");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */


/**
 * @enum
 * Enum for document types
 * @property {string} TEXT_HTML - The text/html content type
 * @property {string} TEXT_XML - The text/xml content type
 * @property {string} APPLICATION_XML - The application/xml content type
 * @property {string} APPLICATION_XHTML - The application/xhml+xml content type
 */
var DocumentType;
(function (DocumentType) {
    DocumentType["TEXT_HTML"] = "text/html";
    DocumentType["TEXT_XML"] = "text/xml";
    DocumentType["APPLICATION_XML"] = "application/xml";
    DocumentType["APPLICATION_XHTML"] = "application/xhtml+xml";
})(DocumentType || (DocumentType = {}));
/**
 * @enum
 * Enum for Content types
 * @property {string} TEXT_PLAIN - The text/plain content type
 * @property {string} APPLICATION_JSON - The application/json content type
 */
var ContentType;
(function (ContentType) {
    ContentType["TEXT_PLAIN"] = "text/plain";
    ContentType["APPLICATION_JSON"] = "application/json";
})(ContentType || (ContentType = {}));
/**
 * @enum
 * Enum for Content type regex
 * @property {string} DOCUMENT - The regex to match document content types
 * @property {string} IMAGE - The regex to match image content types
 */
var ContentTypeRegexStr;
(function (ContentTypeRegexStr) {
    ContentTypeRegexStr["DOCUMENT"] = "^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$";
    ContentTypeRegexStr["IMAGE"] = "^image\\/.+";
})(ContentTypeRegexStr || (ContentTypeRegexStr = {}));
/**
 * @class
 * Class for GraphResponseHandler
 */
class GraphResponseHandler {
    /**
     * @private
     * @static
     * To parse Document response
     * @param {Response} rawResponse - The response object
     * @param {DocumentType} type - The type to which the document needs to be parsed
     * @returns A promise that resolves to a document content
     */
    static parseDocumentResponse(rawResponse, type) {
        try {
            if (typeof DOMParser !== "undefined") {
                return new Promise((resolve, reject) => {
                    rawResponse.text().then((xmlString) => {
                        try {
                            const parser = new DOMParser();
                            const xmlDoc = parser.parseFromString(xmlString, type);
                            resolve(xmlDoc);
                        }
                        catch (error) {
                            reject(error);
                        }
                    });
                });
            }
            else {
                return Promise.resolve(rawResponse.body);
            }
        }
        catch (error) {
            throw error;
        }
    }
    /**
     * @private
     * @static
     * @async
     * To convert the native Response to response content
     * @param {Response} rawResponse - The response object
     * @param {ResponseType} [responseType] - The response type value
     * @returns A promise that resolves to the converted response content
     */
    static convertResponse(rawResponse, responseType) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            if (rawResponse.status === 204) {
                // NO CONTENT
                return Promise.resolve();
            }
            let responseValue;
            try {
                switch (responseType) {
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].ARRAYBUFFER:
                        responseValue = yield rawResponse.arrayBuffer();
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].BLOB:
                        responseValue = yield rawResponse.blob();
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].DOCUMENT:
                        responseValue = yield GraphResponseHandler.parseDocumentResponse(rawResponse, DocumentType.TEXT_XML);
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].JSON:
                        responseValue = yield rawResponse.json();
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].STREAM:
                        responseValue = yield Promise.resolve(rawResponse.body);
                        break;
                    case _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].TEXT:
                        responseValue = yield rawResponse.text();
                        break;
                    default:
                        const contentType = rawResponse.headers.get("Content-type");
                        if (contentType !== null) {
                            const mimeType = contentType.split(";")[0];
                            if (new RegExp(ContentTypeRegexStr.DOCUMENT).test(mimeType)) {
                                responseValue = yield GraphResponseHandler.parseDocumentResponse(rawResponse, mimeType);
                            }
                            else if (new RegExp(ContentTypeRegexStr.IMAGE).test(mimeType)) {
                                responseValue = rawResponse.blob();
                            }
                            else if (mimeType === ContentType.TEXT_PLAIN) {
                                responseValue = yield rawResponse.text();
                            }
                            else if (mimeType === ContentType.APPLICATION_JSON) {
                                responseValue = yield rawResponse.json();
                            }
                            else {
                                responseValue = Promise.resolve(rawResponse.body);
                            }
                        }
                        else {
                            /**
                             * RFC specification {@link https://tools.ietf.org/html/rfc7231#section-3.1.1.5} says:
                             *  A sender that generates a message containing a payload body SHOULD
                             *  generate a Content-Type header field in that message unless the
                             *  intended media type of the enclosed representation is unknown to the
                             *  sender.  If a Content-Type header field is not present, the recipient
                             *  MAY either assume a media type of "application/octet-stream"
                             *  ([RFC2046], Section 4.5.1) or examine the data to determine its type.
                             *
                             *  So assuming it as a stream type so returning the body.
                             */
                            responseValue = Promise.resolve(rawResponse.body);
                        }
                        break;
                }
            }
            catch (error) {
                throw error;
            }
            return responseValue;
        });
    }
    /**
     * @public
     * @static
     * @async
     * To get the parsed response
     * @param {Response} rawResponse - The response object
     * @param {ResponseType} [responseType] - The response type value
     * @param {GraphRequestCallback} [callback] - The graph request callback function
     * @returns The parsed response
     */
    static getResponse(rawResponse, responseType, callback) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                if (responseType === _ResponseType__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].RAW) {
                    return Promise.resolve(rawResponse);
                }
                else {
                    const response = yield GraphResponseHandler.convertResponse(rawResponse, responseType);
                    if (rawResponse.ok) {
                        // Status Code 2XX
                        if (typeof callback === "function") {
                            callback(null, response);
                        }
                        else {
                            return response;
                        }
                    }
                    else {
                        // NOT OK Response
                        throw response;
                    }
                }
            }
            catch (error) {
                throw error;
            }
        });
    }
}
//# sourceMappingURL=GraphResponseHandler.js.map

/***/ }),

/***/ "wmha":
/*!*********************************************!*\
  !*** ./node_modules/lit-html/lib/render.js ***!
  \*********************************************/
/*! exports provided: parts, render */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parts", function() { return parts; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony import */ var _dom_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom.js */ "tFPJ");
/* harmony import */ var _parts_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./parts.js */ "XI78");
/* harmony import */ var _template_factory_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./template-factory.js */ "PqmH");
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */



const parts = new WeakMap();
/**
 * Renders a template result or other value to a container.
 *
 * To update a container with new values, reevaluate the template literal and
 * call `render` with the new result.
 *
 * @param result Any value renderable by NodePart - typically a TemplateResult
 *     created by evaluating a template tag like `html` or `svg`.
 * @param container A DOM parent to render to. The entire contents are either
 *     replaced, or efficiently updated if the same result type was previous
 *     rendered there.
 * @param options RenderOptions for the entire render tree rendered to this
 *     container. Render options must *not* change between renders to the same
 *     container, as those changes will not effect previously rendered DOM.
 */
const render = (result, container, options) => {
    let part = parts.get(container);
    if (part === undefined) {
        Object(_dom_js__WEBPACK_IMPORTED_MODULE_0__["removeNodes"])(container, container.firstChild);
        parts.set(container, part = new _parts_js__WEBPACK_IMPORTED_MODULE_1__["NodePart"](Object.assign({ templateFactory: _template_factory_js__WEBPACK_IMPORTED_MODULE_2__["templateFactory"] }, options)));
        part.appendInto(container);
    }
    part.setValue(result);
    part.commit();
};
//# sourceMappingURL=render.js.map

/***/ }),

/***/ "wmib":
/*!********************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/RequestMethod.js ***!
  \********************************************************************************/
/*! exports provided: RequestMethod */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RequestMethod", function() { return RequestMethod; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * @enum
 * Enum for RequestMethods
 * @property {string} GET - The get request type
 * @property {string} PATCH - The patch request type
 * @property {string} POST - The post request type
 * @property {string} PUT - The put request type
 * @property {string} DELETE - The delete request type
 */
var RequestMethod;
(function (RequestMethod) {
    RequestMethod["GET"] = "GET";
    RequestMethod["PATCH"] = "PATCH";
    RequestMethod["POST"] = "POST";
    RequestMethod["PUT"] = "PUT";
    RequestMethod["DELETE"] = "DELETE";
})(RequestMethod || (RequestMethod = {}));
//# sourceMappingURL=RequestMethod.js.map

/***/ }),

/***/ "x9B3":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/options/TelemetryHandlerOptions.js ***!
  \*************************************************************************************************************/
/*! exports provided: FeatureUsageFlag, TelemetryHandlerOptions */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FeatureUsageFlag", function() { return FeatureUsageFlag; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TelemetryHandlerOptions", function() { return TelemetryHandlerOptions; });
/* harmony import */ var _MiddlewareControl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../MiddlewareControl */ "/M1i");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @enum
 * @property {number} NONE - The hexadecimal flag value for nothing enabled
 * @property {number} REDIRECT_HANDLER_ENABLED - The hexadecimal flag value for redirect handler enabled
 * @property {number} RETRY_HANDLER_ENABLED - The hexadecimal flag value for retry handler enabled
 * @property {number} AUTHENTICATION_HANDLER_ENABLED - The hexadecimal flag value for the authentication handler enabled
 */
var FeatureUsageFlag;
(function (FeatureUsageFlag) {
    FeatureUsageFlag[FeatureUsageFlag["NONE"] = 0] = "NONE";
    FeatureUsageFlag[FeatureUsageFlag["REDIRECT_HANDLER_ENABLED"] = 1] = "REDIRECT_HANDLER_ENABLED";
    FeatureUsageFlag[FeatureUsageFlag["RETRY_HANDLER_ENABLED"] = 2] = "RETRY_HANDLER_ENABLED";
    FeatureUsageFlag[FeatureUsageFlag["AUTHENTICATION_HANDLER_ENABLED"] = 4] = "AUTHENTICATION_HANDLER_ENABLED";
})(FeatureUsageFlag || (FeatureUsageFlag = {}));
/**
 * @class
 * @implements MiddlewareOptions
 * Class for TelemetryHandlerOptions
 */
class TelemetryHandlerOptions {
    constructor() {
        /**
         * @private
         * A member to hold the OR of feature usage flags
         */
        this.featureUsage = FeatureUsageFlag.NONE;
    }
    /**
     * @public
     * @static
     * To update the feature usage in the context object
     * @param {Context} context - The request context object containing middleware options
     * @param {FeatureUsageFlag} flag - The flag value
     * @returns nothing
     */
    static updateFeatureUsageFlag(context, flag) {
        let options;
        if (context.middlewareControl instanceof _MiddlewareControl__WEBPACK_IMPORTED_MODULE_0__["MiddlewareControl"]) {
            options = context.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions);
        }
        else {
            context.middlewareControl = new _MiddlewareControl__WEBPACK_IMPORTED_MODULE_0__["MiddlewareControl"]();
        }
        if (typeof options === "undefined") {
            options = new TelemetryHandlerOptions();
            context.middlewareControl.setMiddlewareOptions(TelemetryHandlerOptions, options);
        }
        options.setFeatureUsage(flag);
    }
    /**
     * @private
     * To set the feature usage flag
     * @param {FeatureUsageFlag} flag - The flag value
     * @returns nothing
     */
    setFeatureUsage(flag) {
        /* tslint:disable: no-bitwise */
        this.featureUsage = this.featureUsage | flag;
        /* tslint:enable: no-bitwise */
    }
    /**
     * @public
     * To get the feature usage
     * @returns A feature usage flag as hexadecimal string
     */
    getFeatureUsage() {
        return this.featureUsage.toString(16);
    }
}
//# sourceMappingURL=TelemetryHandlerOptions.js.map

/***/ }),

/***/ "xCGj":
/*!***********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/MiddlewareFactory.js ***!
  \***********************************************************************************************/
/*! exports provided: MiddlewareFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(process) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MiddlewareFactory", function() { return MiddlewareFactory; });
/* harmony import */ var _AuthenticationHandler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AuthenticationHandler */ "RsRP");
/* harmony import */ var _HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./HTTPMessageHandler */ "nWAj");
/* harmony import */ var _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./options/RedirectHandlerOptions */ "FDgl");
/* harmony import */ var _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./options/RetryHandlerOptions */ "q5Kr");
/* harmony import */ var _RedirectHandler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./RedirectHandler */ "k/fM");
/* harmony import */ var _RetryHandler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./RetryHandler */ "Rtth");
/* harmony import */ var _TelemetryHandler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TelemetryHandler */ "FGIY");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */







/**
 * @private
 * To check whether the environment is node or not
 * @returns A boolean representing the environment is node or not
 */
const isNodeEnvironment = () => {
    return typeof process === "object" && "function" === "function";
};
/**
 * @class
 * Class containing function(s) related to the middleware pipelines.
 */
class MiddlewareFactory {
    /**
     * @public
     * @static
     * Returns the default middleware chain an array with the  middleware handlers
     * @param {AuthenticationProvider} authProvider - The authentication provider instance
     * @returns an array of the middleware handlers of the default middleware chain
     */
    static getDefaultMiddlewareChain(authProvider) {
        const middleware = [];
        const authenticationHandler = new _AuthenticationHandler__WEBPACK_IMPORTED_MODULE_0__["AuthenticationHandler"](authProvider);
        const retryHandler = new _RetryHandler__WEBPACK_IMPORTED_MODULE_5__["RetryHandler"](new _options_RetryHandlerOptions__WEBPACK_IMPORTED_MODULE_3__["RetryHandlerOptions"]());
        const telemetryHandler = new _TelemetryHandler__WEBPACK_IMPORTED_MODULE_6__["TelemetryHandler"]();
        const httpMessageHandler = new _HTTPMessageHandler__WEBPACK_IMPORTED_MODULE_1__["HTTPMessageHandler"]();
        middleware.push(authenticationHandler);
        middleware.push(retryHandler);
        if (isNodeEnvironment()) {
            const redirectHandler = new _RedirectHandler__WEBPACK_IMPORTED_MODULE_4__["RedirectHandler"](new _options_RedirectHandlerOptions__WEBPACK_IMPORTED_MODULE_2__["RedirectHandlerOptions"]());
            middleware.push(redirectHandler);
        }
        middleware.push(telemetryHandler);
        middleware.push(httpMessageHandler);
        return middleware;
    }
}
//# sourceMappingURL=MiddlewareFactory.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../../process/browser.js */ "8oxB")))

/***/ }),

/***/ "xHUi":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-people-picker/mgt-people-picker.js ***!
  \***********************************************************************************************************/
/*! exports provided: GroupType, PersonType, MgtPeoplePicker */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtPeoplePicker", function() { return MgtPeoplePicker; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var lit_html_directives_repeat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lit-html/directives/repeat */ "2Fb8");
/* harmony import */ var _graph_graph_groups__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../graph/graph.groups */ "Pd+Y");
/* harmony import */ var _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../graph/graph.people */ "r/Dn");
/* harmony import */ var _graph_graph_user__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../graph/graph.user */ "0Vrk");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _styles_style_helper__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../styles/style-helper */ "XyBC");
/* harmony import */ var _sub_components_mgt_spinner_mgt_spinner__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sub-components/mgt-spinner/mgt-spinner */ "Jics");
/* harmony import */ var _utils_Utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../utils/Utils */ "vQVX");
/* harmony import */ var _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../mgt-person/mgt-person */ "lBzc");
/* harmony import */ var _PersonCardInteraction__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../PersonCardInteraction */ "Y6V/");
/* harmony import */ var _mgt_people_picker_css__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./mgt-people-picker-css */ "j1fA");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./strings */ "N+A/");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GroupType", function() { return _graph_graph_groups__WEBPACK_IMPORTED_MODULE_3__["GroupType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PersonType", function() { return _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"]; });

/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
















/**
 * Web component used to search for people from the Microsoft Graph
 *
 * @export
 * @class MgtPicker
 * @extends {MgtTemplatedComponent}
 *
 * @fires selectionChanged - Fired when selection changes
 *
 * @cssprop --color - {Color} Default font color
 *
 * @cssprop --input-border - {String} Input section entire border
 * @cssprop --input-border-top - {String} Input section border top only
 * @cssprop --input-border-right - {String} Input section border right only
 * @cssprop --input-border-bottom - {String} Input section border bottom only
 * @cssprop --input-border-left - {String} Input section border left only
 * @cssprop --input-background-color - {Color} Input section background color
 * @cssprop --input-border-color--hover - {Color} Input border hover color
 * @cssprop --input-border-color--focus - {Color} Input border focus color
 *
 * @cssprop --selected-person-background-color - {Color} Selected person background color
 *
 * @cssprop --dropdown-background-color - {Color} Background color of dropdown area
 * @cssprop --dropdown-item-hover-background - {Color} Background color of person during hover
 *
 * @cssprop --placeholder-color--focus - {Color} Color of placeholder text during focus state
 * @cssprop --placeholder-color - {Color} Color of placeholder text
 *
 */
let MgtPeoplePicker = class MgtPeoplePicker extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["MgtTemplatedComponent"] {
    constructor() {
        super();
        this._type = _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].person;
        this._groupType = _graph_graph_groups__WEBPACK_IMPORTED_MODULE_3__["GroupType"].any;
        // tracking of user arrow key input for selection
        this._arrowSelectionCount = 0;
        this._isFocused = false;
        this._showLoading = true;
        this._groupId = null;
        this.userInput = '';
        this.showMax = 6;
        this.selectedPeople = [];
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * user the `css` tag function.
     */
    static get styles() {
        return _mgt_people_picker_css__WEBPACK_IMPORTED_MODULE_12__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_13__["strings"];
    }
    /**
     * Gets the flyout element
     *
     * @protected
     * @type {MgtFlyout}
     * @memberof MgtLogin
     */
    get flyout() {
        return this.renderRoot.querySelector('.flyout');
    }
    /**
     * Gets the input element
     *
     * @protected
     * @type {MgtFlyout}
     * @memberof MgtLogin
     */
    get input() {
        return this.renderRoot.querySelector('.search-box__input');
    }
    /**
     * value determining if search is filtered to a group.
     * @type {string}
     */
    get groupId() {
        return this._groupId;
    }
    set groupId(value) {
        if (this._groupId === value) {
            return;
        }
        this._groupId = value;
        this.requestStateUpdate(true);
    }
    /**
     * value determining if search is filtered to a group.
     * @type {PersonType}
     */
    get type() {
        return this._type;
    }
    set type(value) {
        if (this._type === value) {
            return;
        }
        this._type = value;
        this.requestStateUpdate(true);
    }
    /**
     * type of group to search for - requires personType to be
     * set to "Group" or "All"
     * @type {GroupType}
     */
    get groupType() {
        return this._groupType;
    }
    set groupType(value) {
        if (this._groupType === value) {
            return;
        }
        this._groupType = value;
        this.requestStateUpdate(true);
    }
    /**
     * Focuses the input element when focus is called
     *
     * @param {FocusOptions} [options]
     * @memberof MgtPeoplePicker
     */
    focus(options) {
        this.gainedFocus();
        if (!this.input) {
            return;
        }
        this.input.focus(options);
        this.input.select();
    }
    /**
     * Queries the microsoft graph for a user based on the user id and adds them to the selectedPeople array
     *
     * @param {[string]} an array of user ids to add to selectedPeople
     * @returns {Promise<void>}
     * @memberof MgtPeoplePicker
     */
    selectUsersById(userIds) {
        return __awaiter(this, void 0, void 0, function* () {
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["Providers"].globalProvider;
            const graph = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["Providers"].globalProvider.graph;
            if (provider && provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["ProviderState"].SignedIn) {
                // tslint:disable-next-line: forin
                for (const id in userIds) {
                    try {
                        const personDetails = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_5__["getUser"])(graph, userIds[id]);
                        this.addPerson(personDetails);
                        // tslint:disable-next-line: no-empty
                    }
                    catch (e) { }
                }
            }
        });
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return a lit-html TemplateResult.
     * Setting properties inside this method will not trigger the element to update.
     * @returns {TemplateResult}
     * @memberof MgtPeoplePicker
     */
    render() {
        const defaultTemplate = this.renderTemplate('default', { people: this._foundPeople });
        if (defaultTemplate) {
            return defaultTemplate;
        }
        const selectedPeopleTemplate = this.renderSelectedPeople(this.selectedPeople);
        const inputTemplate = this.renderInput();
        const flyoutTemplate = this.renderFlyout(inputTemplate);
        const inputClasses = {
            focused: this._isFocused,
            'people-picker': true
        };
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div dir=${this.direction} class=${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(inputClasses)} @click=${e => this.focus(e)}>
        <div class="selected-list">
          ${selectedPeopleTemplate} ${flyoutTemplate}
        </div>
      </div>
    `;
    }
    /**
     * Request to reload the state.
     * Use reload instead of load to ensure loading events are fired.
     *
     * @protected
     * @memberof MgtBaseComponent
     */
    requestStateUpdate(force) {
        if (force) {
            this._groupPeople = null;
            this._foundPeople = null;
            this.selectedPeople = [];
        }
        return super.requestStateUpdate(force);
    }
    /**
     * Render the input text box.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPeoplePicker
     */
    renderInput() {
        const hasSelectedPeople = !!this.selectedPeople.length;
        const placeholder = this.placeholder ? this.placeholder : this.strings.inputPlaceholderText;
        const selectionMode = this.selectionMode ? this.selectionMode : 'multiple';
        const inputClasses = {
            'search-box': true,
            'search-box-start': hasSelectedPeople
        };
        if (selectionMode === 'single' && this.selectedPeople.length >= 1) {
            this.lostFocus();
            return null;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(inputClasses)}">
        <input
          id="people-picker-input"
          class="search-box__input"
          type="text"
          placeholder=${placeholder}
          label="people-picker-input"
          aria-label="people-picker-input"
          role="input"
          @keydown="${this.onUserKeyDown}"
          @keyup="${this.onUserKeyUp}"
          @blur=${this.lostFocus}
          @click=${this.handleFlyout}
        />
      </div>
    `;
    }
    /**
     * Render the selected people tokens.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPeoplePicker
     */
    renderSelectedPeople(selectedPeople) {
        selectedPeople = selectedPeople || this.selectedPeople;
        if (!this.selectedPeople || !this.selectedPeople.length) {
            return null;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      ${selectedPeople.slice(0, selectedPeople.length).map(person => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="selected-list__person-wrapper">
              ${this.renderTemplate('selected-person', { person }, `selected-${person.id}`) ||
            this.renderSelectedPerson(person)}

              <div class="selected-list__person-wrapper__overflow">
                <div class="selected-list__person-wrapper__overflow__gradient"></div>
                <div
                  class="selected-list__person-wrapper__overflow__close-icon"
                  @click="${e => this.removePerson(person, e)}"
                >
                  \uE711
                </div>
              </div>
            </div>
          `)}
    `;
    }
    /**
     * Render the flyout chrome.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPeoplePicker
     */
    renderFlyout(anchor) {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <mgt-flyout light-dismiss class="flyout">
        ${anchor}
        <div slot="flyout" class="flyout-root">
          ${this.renderFlyoutContent()}
        </div>
      </mgt-flyout>
    `;
    }
    /**
     * Render the appropriate state in the results flyout.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPeoplePicker
     */
    renderFlyoutContent() {
        if (this.isLoadingState || this._showLoading) {
            return this.renderLoading();
        }
        let people = this._foundPeople;
        if (!people || people.length === 0 || this.showMax === 0) {
            return this.renderNoData();
        }
        // clears focus
        for (const person of people) {
            person.isFocused = false;
        }
        people = people.slice(0, this.showMax);
        people[0].isFocused = true;
        return this.renderSearchResults(people);
    }
    /**
     * Render the loading state.
     *
     * @protected
     * @returns
     * @memberof MgtPeoplePicker
     */
    renderLoading() {
        return (this.renderTemplate('loading', null) ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `);
    }
    /**
     * Render the state when no results are found for the search query.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPeoplePicker
     */
    renderNoData() {
        return (this.renderTemplate('error', null) ||
            this.renderTemplate('no-data', null) ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="message-parent">
          <div label="search-error-text" aria-label="We didn't find any matches." class="search-error-text">
            ${this.strings.noResultsFound}
          </div>
        </div>
      `);
    }
    /**
     * Render the list of search results.
     *
     * @protected
     * @param {IDynamicPerson[]} people
     * @returns
     * @memberof MgtPeoplePicker
     */
    renderSearchResults(people) {
        people = people || this._foundPeople;
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="people-list">
        ${Object(lit_html_directives_repeat__WEBPACK_IMPORTED_MODULE_2__["repeat"])(people, person => person.id, person => {
            const listPersonClasses = {
                focused: person.isFocused,
                'list-person': true
            };
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
              <li class="${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(listPersonClasses)}" @click="${e => this.onPersonClick(person)}">
                ${this.renderPersonResult(person)}
              </li>
            `;
        })}
      </div>
    `;
    }
    /**
     * Render an individual person search result.
     *
     * @protected
     * @param {IDynamicPerson} person
     * @returns {TemplateResult}
     * @memberof MgtPeoplePicker
     */
    renderPersonResult(person) {
        const user = person;
        const subTitle = user.jobTitle || user.mail;
        const classes = {
            'people-person-job-title': true,
            uppercase: !!user.jobTitle
        };
        return (this.renderTemplate('person', { person }, person.id) ||
            lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <mgt-person .personDetails=${person} .fetchImage=${true}></mgt-person>
        <div class="people-person-text-area" id="${person.displayName}">
          ${this.renderHighlightText(person)}
          <span class="${Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])(classes)}">${subTitle}</span>
        </div>
      `);
    }
    /**
     * Render an individual selected person token.
     *
     * @protected
     * @param {IDynamicPerson} person
     * @returns {TemplateResult}
     * @memberof MgtPeoplePicker
     */
    renderSelectedPerson(person) {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <mgt-person
        class="selected-list__person-wrapper__person"
        .personDetails=${person}
        .fetchImage=${true}
        .view=${_mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_10__["PersonViewType"].oneline}
        .personCardInteraction=${_PersonCardInteraction__WEBPACK_IMPORTED_MODULE_11__["PersonCardInteraction"].click}
      ></mgt-person>
    `;
    }
    /**
     * Async query to Graph for members of group if determined by developer.
     * set's `this.groupPeople` to those members.
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            let people = this.people;
            const input = this.userInput.toLowerCase();
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["Providers"].globalProvider;
            if (!people && provider && provider.state === _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_6__["ProviderState"].SignedIn) {
                const graph = provider.graph.forComponent(this);
                if (!input.length && this._isFocused) {
                    if (this.defaultPeople) {
                        people = this.defaultPeople;
                    }
                    else {
                        if (this.groupId) {
                            if (this._groupPeople === null) {
                                try {
                                    this._groupPeople = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_5__["findGroupMembers"])(graph, null, this.groupId, this.showMax, this.type, this.transitiveSearch);
                                }
                                catch (_) {
                                    this._groupPeople = [];
                                }
                            }
                            people = this._groupPeople || [];
                        }
                        else if (this.type === _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].person || this.type === _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].any) {
                            people = yield Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["getPeople"])(graph);
                        }
                        else if (this.type === _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].group) {
                            const groups = (yield Object(_graph_graph_groups__WEBPACK_IMPORTED_MODULE_3__["findGroups"])(graph, '', this.showMax, this.groupType)) || [];
                            people = groups;
                        }
                        this.defaultPeople = people;
                    }
                }
                this._showLoading = false;
                if (this.defaultSelectedUserIds && !this.selectedPeople.length && !this.defaultSelectedUsers) {
                    this.defaultSelectedUsers = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_5__["getUsersForUserIds"])(graph, this.defaultSelectedUserIds);
                    this.selectedPeople = [...this.defaultSelectedUsers];
                    this.requestUpdate();
                    this.fireCustomEvent('selectionChanged', this.selectedPeople);
                }
                if (input) {
                    people = [];
                    if (this.groupId) {
                        people =
                            (yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_5__["findGroupMembers"])(graph, input, this.groupId, this.showMax, this.type, this.transitiveSearch)) || [];
                    }
                    else {
                        if (this.type === _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].person || this.type === _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].any) {
                            try {
                                people = (yield Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["findPeople"])(graph, input, this.showMax)) || [];
                            }
                            catch (e) {
                                // nop
                            }
                            if (people.length < this.showMax) {
                                try {
                                    const users = (yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_5__["findUsers"])(graph, input, this.showMax)) || [];
                                    // make sure only unique people
                                    const peopleIds = new Set(people.map(p => p.id));
                                    for (const user of users) {
                                        if (!peopleIds.has(user.id)) {
                                            people.push(user);
                                        }
                                    }
                                }
                                catch (e) {
                                    // nop
                                }
                            }
                        }
                        if ((this.type === _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].group || this.type === _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].any) && people.length < this.showMax) {
                            let groups = [];
                            try {
                                groups = (yield Object(_graph_graph_groups__WEBPACK_IMPORTED_MODULE_3__["findGroups"])(graph, input, this.showMax, this.groupType)) || [];
                                people = people.concat(groups);
                            }
                            catch (e) {
                                // nop
                            }
                        }
                    }
                }
            }
            //people = this.getUniquePeople(people);
            this._foundPeople = this.filterPeople(people);
        });
    }
    /**
     * Hide the results flyout.
     *
     * @protected
     * @memberof MgtPeoplePicker
     */
    hideFlyout() {
        const flyout = this.flyout;
        if (flyout) {
            flyout.close();
        }
    }
    /**
     * Show the results flyout.
     *
     * @protected
     * @memberof MgtPeoplePicker
     */
    showFlyout() {
        const flyout = this.flyout;
        if (flyout) {
            flyout.open();
        }
    }
    /**
     * Removes person from selected people
     * @param person - person and details pertaining to user selected
     */
    removePerson(person, e) {
        e.stopPropagation();
        const filteredPersonArr = this.selectedPeople.filter(p => {
            return p.id !== person.id;
        });
        this.selectedPeople = filteredPersonArr;
        this.loadState();
        this.fireCustomEvent('selectionChanged', this.selectedPeople);
    }
    /**
     * Tracks when user selects person from picker
     * @param person - contains details pertaining to selected user
     * @param event - tracks user event
     */
    addPerson(person) {
        if (person) {
            this.clearInput();
            const duplicatePeople = this.selectedPeople.filter(p => {
                if (!person.id) {
                    return p.displayName === person.displayName;
                }
                return p.id === person.id;
            });
            if (duplicatePeople.length === 0) {
                this.selectedPeople = [...this.selectedPeople, person];
                this.fireCustomEvent('selectionChanged', this.selectedPeople);
                this.loadState();
                this._foundPeople = [];
            }
        }
    }
    clearInput() {
        this.input.value = '';
        this.userInput = '';
    }
    handleFlyout() {
        // handles hiding control if default people have no more selections available
        const peopleLeft = this.filterPeople(this.defaultPeople);
        let shouldShow = true;
        if (peopleLeft && peopleLeft.length === 0) {
            shouldShow = false;
        }
        if (shouldShow) {
            window.requestAnimationFrame(() => {
                // Mouse is focused on input
                this.showFlyout();
            });
        }
    }
    gainedFocus() {
        this._isFocused = true;
        if (this.input) {
            this.input.focus();
        }
        this._showLoading = true;
        this.loadState();
    }
    lostFocus() {
        this._isFocused = false;
        this.requestUpdate();
    }
    renderHighlightText(person) {
        let first = '';
        let last = '';
        let highlight = '';
        const displayName = person.displayName;
        const highlightLocation = displayName.toLowerCase().indexOf(this.userInput.toLowerCase());
        if (highlightLocation !== -1) {
            const userInputLength = this.userInput.length;
            // no location
            if (highlightLocation === 0) {
                // highlight is at the beginning of sentence
                first = '';
                highlight = displayName.slice(0, userInputLength);
                last = displayName.slice(userInputLength, displayName.length);
            }
            else if (highlightLocation === displayName.length) {
                // highlight is at end of the sentence
                first = displayName.slice(0, highlightLocation);
                highlight = displayName.slice(highlightLocation, displayName.length);
                last = '';
            }
            else {
                // highlight is in middle of sentence
                first = displayName.slice(0, highlightLocation);
                highlight = displayName.slice(highlightLocation, highlightLocation + userInputLength);
                last = displayName.slice(highlightLocation + userInputLength, displayName.length);
            }
        }
        else {
            first = person.displayName;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div>
        <span class="people-person-text">${first}</span
        ><span class="people-person-text highlight-search-text">${highlight}</span
        ><span class="people-person-text">${last}</span>
      </div>
    `;
    }
    /**
     * Adds debounce method for set delay on user input
     */
    onUserKeyUp(event) {
        if (event.keyCode === 40 || event.keyCode === 39 || event.keyCode === 38 || event.keyCode === 37) {
            // keyCodes capture: down arrow (40), right arrow (39), up arrow (38) and left arrow (37)
            return;
        }
        const input = event.target;
        if (event.code === 'Escape') {
            this.clearInput();
            this._foundPeople = [];
        }
        else if (event.code === 'Backspace' && this.userInput.length === 0 && this.selectedPeople.length > 0) {
            // remove last person in selected list
            this.selectedPeople = this.selectedPeople.splice(0, this.selectedPeople.length - 1);
            this.loadState();
            this.hideFlyout();
            // fire selected people changed event
            this.fireCustomEvent('selectionChanged', this.selectedPeople);
        }
        else {
            this.userInput = input.value;
            this.handleUserSearch();
        }
    }
    onPersonClick(person) {
        this.addPerson(person);
        this.hideFlyout();
        if (!this.input) {
            return;
        }
        this.input.focus();
        this._isFocused = true;
        this.hideFlyout();
        if (this.selectionMode === 'single') {
            return;
        }
    }
    /**
     * Tracks event on user input in search
     * @param input - input text
     */
    handleUserSearch() {
        if (!this._debouncedSearch) {
            this._debouncedSearch = Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_9__["debounce"])(() => __awaiter(this, void 0, void 0, function* () {
                const loadingTimeout = setTimeout(() => {
                    this._showLoading = true;
                }, 50);
                yield this.loadState();
                clearTimeout(loadingTimeout);
                this._showLoading = false;
                this.showFlyout();
                this._arrowSelectionCount = 0;
            }), 400);
        }
        this._debouncedSearch();
    }
    /**
     * Tracks event on user search (keydown)
     * @param event - event tracked on user input (keydown)
     */
    onUserKeyDown(event) {
        if (!this.flyout.isOpen) {
            return;
        }
        if (event.keyCode === 40 || event.keyCode === 38) {
            // keyCodes capture: down arrow (40) and up arrow (38)
            this.handleArrowSelection(event);
            if (this.input.value.length > 0) {
                event.preventDefault();
            }
        }
        if (event.keyCode === 9 || event.keyCode === 13) {
            // keyCodes capture: tab (9) and enter (13)
            if (this._foundPeople.length) {
                this.fireCustomEvent('blur');
                event.preventDefault();
            }
            this.addPerson(this._foundPeople[this._arrowSelectionCount]);
            this.hideFlyout();
            event.target.value = '';
        }
    }
    /**
     * Tracks user key selection for arrow key selection of people
     * @param event - tracks user key selection
     */
    handleArrowSelection(event) {
        if (this._foundPeople.length) {
            // update arrow count
            if (event.keyCode === 38) {
                // up arrow
                if (this._arrowSelectionCount > 0) {
                    this._arrowSelectionCount--;
                }
                else {
                    this._arrowSelectionCount = 0;
                }
            }
            if (event.keyCode === 40) {
                // down arrow
                if (this._arrowSelectionCount + 1 !== this._foundPeople.length &&
                    this._arrowSelectionCount + 1 < this.showMax) {
                    this._arrowSelectionCount++;
                }
                else {
                    this._arrowSelectionCount = 0;
                }
            }
            const peopleList = this.renderRoot.querySelector('.people-list');
            // reset background color
            if (peopleList) {
                // tslint:disable-next-line: prefer-for-of
                for (let i = 0; i < peopleList.children.length; i++) {
                    peopleList.children[i].classList.remove('focused');
                }
            }
            // set selected background
            peopleList.children[this._arrowSelectionCount].classList.add('focused');
        }
    }
    /**
     * Filters people searched from already selected people
     * @param people - array of people returned from query to Graph
     */
    filterPeople(people) {
        // check if people need to be updated
        // ensuring people list is displayed
        // find ids from selected people
        if (people) {
            const idFilter = this.selectedPeople.map(el => {
                return el.id ? el.id : el.displayName;
            });
            // filter id's
            const filtered = people.filter((person) => {
                if (person.id) {
                    return idFilter.indexOf(person.id) === -1;
                }
                else {
                    return idFilter.indexOf(person.displayName) === -1;
                }
            });
            return filtered;
        }
    }
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: 'group-id' }),
    __metadata("design:type", String),
    __metadata("design:paramtypes", [Object])
], MgtPeoplePicker.prototype, "groupId", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'type',
        converter: (value, type) => {
            value = value.toLowerCase();
            if (!value || value.length === 0) {
                return _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].any;
            }
            if (typeof _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"][value] === 'undefined') {
                return _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"].any;
            }
            else {
                return _graph_graph_people__WEBPACK_IMPORTED_MODULE_4__["PersonType"][value];
            }
        }
    }),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], MgtPeoplePicker.prototype, "type", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'group-type',
        converter: (value, type) => {
            if (!value || value.length === 0) {
                return _graph_graph_groups__WEBPACK_IMPORTED_MODULE_3__["GroupType"].any;
            }
            const values = value.split(',');
            const groupTypes = [];
            for (let v of values) {
                v = v.trim();
                if (typeof _graph_graph_groups__WEBPACK_IMPORTED_MODULE_3__["GroupType"][v] !== 'undefined') {
                    groupTypes.push(_graph_graph_groups__WEBPACK_IMPORTED_MODULE_3__["GroupType"][v]);
                }
            }
            if (groupTypes.length === 0) {
                return _graph_graph_groups__WEBPACK_IMPORTED_MODULE_3__["GroupType"].any;
            }
            // tslint:disable-next-line:no-bitwise
            return groupTypes.reduce((a, c) => a | c);
        }
    }),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Object])
], MgtPeoplePicker.prototype, "groupType", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'transitive-search',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtPeoplePicker.prototype, "transitiveSearch", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'people',
        type: Object
    }),
    __metadata("design:type", Array)
], MgtPeoplePicker.prototype, "people", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'show-max',
        type: Number
    }),
    __metadata("design:type", Number)
], MgtPeoplePicker.prototype, "showMax", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'selected-people',
        type: Array
    }),
    __metadata("design:type", Array)
], MgtPeoplePicker.prototype, "selectedPeople", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'default-selected-user-ids',
        converter: value => {
            return value.split(',').map(v => v.trim());
        },
        type: String
    }),
    __metadata("design:type", Array)
], MgtPeoplePicker.prototype, "defaultSelectedUserIds", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'placeholder',
        type: String
    }),
    __metadata("design:type", String)
], MgtPeoplePicker.prototype, "placeholder", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'selection-mode',
        type: String
    }),
    __metadata("design:type", String)
], MgtPeoplePicker.prototype, "selectionMode", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({ attribute: false }),
    __metadata("design:type", Boolean)
], MgtPeoplePicker.prototype, "_showLoading", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["internalProperty"])(),
    __metadata("design:type", Object)
], MgtPeoplePicker.prototype, "_isFocused", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["internalProperty"])(),
    __metadata("design:type", Array)
], MgtPeoplePicker.prototype, "_foundPeople", void 0);
MgtPeoplePicker = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-people-picker'),
    __metadata("design:paramtypes", [])
], MgtPeoplePicker);

//# sourceMappingURL=mgt-people-picker.js.map

/***/ }),

/***/ "xch7":
/*!*******************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/graph/graph.photos.js ***!
  \*******************************************************************************/
/*! exports provided: getPhotoInvalidationTime, photosCacheEnabled, getPhotoForResource, getContactPhoto, getUserPhoto, myPhoto, getPersonImage, getPhotoFromCache, storePhotoInCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPhotoInvalidationTime", function() { return getPhotoInvalidationTime; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "photosCacheEnabled", function() { return photosCacheEnabled; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPhotoForResource", function() { return getPhotoForResource; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getContactPhoto", function() { return getContactPhoto; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUserPhoto", function() { return getUserPhoto; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "myPhoto", function() { return myPhoto; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPersonImage", function() { return getPersonImage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPhotoFromCache", function() { return getPhotoFromCache; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "storePhotoInCache", function() { return storePhotoInCache; });
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @microsoft/microsoft-graph-client */ "XZ4c");
/* harmony import */ var _utils_Utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/Utils */ "vQVX");
/* harmony import */ var _graph_people__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./graph.people */ "r/Dn");
/* harmony import */ var _graph_user__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./graph.user */ "0Vrk");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





/**
 * defines the structure of the cache
 */
const cacheSchema = {
    name: 'photos',
    stores: {
        contacts: {},
        users: {}
    },
    version: 1
};
/**
 * Defines expiration time
 */
const getPhotoInvalidationTime = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.photos.invalidationPeriod || _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.defaultInvalidationPeriod;
/**
 * Whether photo store is enabled
 */
const photosCacheEnabled = () => _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.photos.isEnabled && _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].config.isEnabled;
/**
 * Name of the users store name
 */
const userStore = 'users';
/**
 * Name of the contacts store name
 */
const contactStore = 'contacts';
/**
 * retrieves a photo for the specified resource.
 *
 * @param {string} resource
 * @param {string[]} scopes
 * @returns {Promise<string>}
 */
function getPhotoForResource(graph, resource, scopes) {
    return __awaiter(this, void 0, void 0, function* () {
        try {
            const response = (yield graph
                .api(`${resource}/photo/$value`)
                .responseType(_microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_1__["ResponseType"].RAW)
                .middlewareOptions(Object(_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["prepScopes"])(...scopes))
                .get());
            if (response.status === 404) {
                // 404 means the resource does not have a photo
                // we still want to cache that state
                // so we return an object that can be cached
                return { eTag: null, photo: null };
            }
            else if (!response.ok) {
                return null;
            }
            const eTag = response.headers.get('eTag');
            const blob = yield Object(_utils_Utils__WEBPACK_IMPORTED_MODULE_2__["blobToBase64"])(yield response.blob());
            return { eTag, photo: blob };
        }
        catch (e) {
            return null;
        }
    });
}
/**
 * async promise, returns Graph photos associated with contacts of the logged in user
 * @param contactId
 * @returns {Promise<string>}
 * @memberof Graph
 */
function getContactPhoto(graph, contactId) {
    return __awaiter(this, void 0, void 0, function* () {
        let cache;
        let photoDetails;
        if (photosCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, contactStore);
            photoDetails = yield cache.getValue(contactId);
            if (photoDetails && getPhotoInvalidationTime() > Date.now() - photoDetails.timeCached) {
                return photoDetails.photo;
            }
        }
        photoDetails = yield getPhotoForResource(graph, `me/contacts/${contactId}`, ['contacts.read']);
        if (photosCacheEnabled() && photoDetails) {
            cache.putValue(contactId, photoDetails);
        }
        return photoDetails ? photoDetails.photo : null;
    });
}
/**
 * async promise, returns Graph photo associated with provided userId
 * @param userId
 * @returns {Promise<string>}
 * @memberof Graph
 */
function getUserPhoto(graph, userId) {
    return __awaiter(this, void 0, void 0, function* () {
        let cache;
        let photoDetails;
        if (photosCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, userStore);
            photoDetails = yield cache.getValue(userId);
            if (photoDetails && getPhotoInvalidationTime() > Date.now() - photoDetails.timeCached) {
                return photoDetails.photo;
            }
            else if (photoDetails) {
                // there is a photo in the cache, but it's stale
                try {
                    const response = yield graph.api(`users/${userId}/photo`).get();
                    if (response &&
                        (response['@odata.mediaEtag'] !== photoDetails.eTag ||
                            (response['@odata.mediaEtag'] === null && response.eTag === null))) {
                        // set photoDetails to null so that photo gets pulled from the graph later
                        photoDetails = null;
                    }
                }
                catch (_a) {
                    return null;
                }
            }
        }
        // if there is a photo in the cache, we got here because it was stale
        photoDetails = photoDetails || (yield getPhotoForResource(graph, `users/${userId}`, ['user.readbasic.all']));
        if (photosCacheEnabled() && photoDetails) {
            cache.putValue(userId, photoDetails);
        }
        return photoDetails ? photoDetails.photo : null;
    });
}
/**
 * async promise, returns Graph photo associated with the logged in user
 * @returns {Promise<string>}
 * @memberof Graph
 */
function myPhoto(graph) {
    return __awaiter(this, void 0, void 0, function* () {
        let cache;
        let photoDetails;
        if (photosCacheEnabled()) {
            cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, userStore);
            photoDetails = yield cache.getValue('me');
            if (photoDetails && getPhotoInvalidationTime() > Date.now() - photoDetails.timeCached) {
                return photoDetails.photo;
            }
        }
        try {
            const response = yield graph.api(`me/photo`).get();
            if (response &&
                (response['@odata.mediaEtag'] !== photoDetails.eTag ||
                    (response['@odata.mediaEtag'] === null && response.eTag === null))) {
                photoDetails = null;
            }
        }
        catch (_a) {
            return null;
        }
        photoDetails = photoDetails || (yield getPhotoForResource(graph, 'me', ['user.read']));
        if (photosCacheEnabled()) {
            cache.putValue('me', photoDetails || {});
        }
        return photoDetails ? photoDetails.photo : null;
    });
}
/**
 * async promise, loads image of user
 *
 * @export
 */
function getPersonImage(graph, person, useContactsApis = true) {
    return __awaiter(this, void 0, void 0, function* () {
        // handle if contact
        if ('personType' in person && person.personType.subclass === 'PersonalContact') {
            if (useContactsApis) {
                // if person is a contact, look for them and their photo in contact api
                const email = Object(_graph_people__WEBPACK_IMPORTED_MODULE_3__["getEmailFromGraphEntity"])(person);
                const contact = yield Object(_graph_people__WEBPACK_IMPORTED_MODULE_3__["findContactsByEmail"])(graph, email);
                if (contact && contact.length && contact[0].id) {
                    return yield getContactPhoto(graph, contact[0].id);
                }
            }
            return null;
        }
        // handle if user
        if (person.userPrincipalName || person.id) {
            // try to find a user by userPrincipalName
            const id = person.userPrincipalName || person.id;
            return yield getUserPhoto(graph, id);
        }
        // else assume id is for user and try to get photo
        if (person.id) {
            const image = yield getUserPhoto(graph, person.id);
            if (image) {
                return image;
            }
        }
        // let's try to find a person by the email
        const email = Object(_graph_people__WEBPACK_IMPORTED_MODULE_3__["getEmailFromGraphEntity"])(person);
        if (email) {
            // try to find user
            const users = yield Object(_graph_user__WEBPACK_IMPORTED_MODULE_4__["findUsers"])(graph, email, 1);
            if (users && users.length) {
                return yield getUserPhoto(graph, users[0].id);
            }
            // if no user, try to find a contact
            if (useContactsApis) {
                const contacts = yield Object(_graph_people__WEBPACK_IMPORTED_MODULE_3__["findContactsByEmail"])(graph, email);
                if (contacts && contacts.length) {
                    return yield getContactPhoto(graph, contacts[0].id);
                }
            }
        }
        return null;
    });
}
/**
 * checks if user has a photo in the cache
 * @param userId
 * @returns {CachePhoto}
 * @memberof Graph
 */
function getPhotoFromCache(userId, storeName) {
    return __awaiter(this, void 0, void 0, function* () {
        const cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, storeName);
        const item = yield cache.getValue(userId);
        return item;
    });
}
/**
 * checks if user has a photo in the cache
 * @param userId
 * @returns {void}
 * @memberof Graph
 */
function storePhotoInCache(userId, storeName, value) {
    return __awaiter(this, void 0, void 0, function* () {
        const cache = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_0__["CacheService"].getCache(cacheSchema, storeName);
        cache.putValue(userId, value);
    });
}
//# sourceMappingURL=graph.photos.js.map

/***/ }),

/***/ "yEX1":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-msal-provider/node_modules/msal/lib-es6/utils/RequestUtils.js ***!
  \***************************************************************************************************/
/*! exports provided: RequestUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RequestUtils", function() { return RequestUtils; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Constants */ "/pXG");
/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../error/ClientConfigurationError */ "SRUK");
/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ScopeSet */ "aX9C");
/* harmony import */ var _StringUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./StringUtils */ "k+Uk");
/* harmony import */ var _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./CryptoUtils */ "RDZQ");
/* harmony import */ var _TimeUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TimeUtils */ "JUi9");
/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../error/ClientAuthError */ "n82g");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */








/**
 * @hidden
 */
var RequestUtils = /** @class */ (function () {
    function RequestUtils() {
    }
    /**
     * @ignore
     *
     * @param request
     * @param isLoginCall
     * @param cacheStorage
     * @param clientId
     *
     * validates all request parameters and generates a consumable request object
     */
    RequestUtils.validateRequest = function (request, isLoginCall, clientId, interactionType) {
        // Throw error if request is empty for acquire * calls
        if (!isLoginCall && !request) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createEmptyRequestError();
        }
        var scopes;
        var extraQueryParameters;
        if (request) {
            // if extraScopesToConsent is passed in loginCall, append them to the login request; Validate and filter scopes (the validate function will throw if validation fails)
            scopes = isLoginCall ? _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].appendScopes(request.scopes, request.extraScopesToConsent) : request.scopes;
            _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].validateInputScope(scopes, !isLoginCall);
            scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_3__["ScopeSet"].translateClientIdIfSingleScope(scopes, clientId);
            // validate prompt parameter
            this.validatePromptParameter(request.prompt);
            // validate extraQueryParameters
            extraQueryParameters = this.validateEQParameters(request.extraQueryParameters, request.claimsRequest);
            // validate claimsRequest
            this.validateClaimsRequest(request.claimsRequest);
        }
        // validate and generate state and correlationId
        var state = this.validateAndGenerateState(request && request.state, interactionType);
        var correlationId = this.validateAndGenerateCorrelationId(request && request.correlationId);
        var validatedRequest = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, request, { extraQueryParameters: extraQueryParameters,
            scopes: scopes,
            state: state,
            correlationId: correlationId });
        return validatedRequest;
    };
    /**
     * @ignore
     *
     * Utility to test if valid prompt value is passed in the request
     * @param request
     */
    RequestUtils.validatePromptParameter = function (prompt) {
        if (prompt) {
            if ([_Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].LOGIN, _Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].SELECT_ACCOUNT, _Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].CONSENT, _Constants__WEBPACK_IMPORTED_MODULE_1__["PromptState"].NONE].indexOf(prompt) < 0) {
                throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createInvalidPromptError(prompt);
            }
        }
    };
    /**
     * @ignore
     *
     * Removes unnecessary or duplicate query parameters from extraQueryParameters
     * @param request
     */
    RequestUtils.validateEQParameters = function (extraQueryParameters, claimsRequest) {
        var eQParams = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, extraQueryParameters);
        if (!eQParams) {
            return null;
        }
        if (claimsRequest) {
            // this.logger.warning("Removed duplicate claims from extraQueryParameters. Please use either the claimsRequest field OR pass as extraQueryParameter - not both.");
            delete eQParams[_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].claims];
        }
        _Constants__WEBPACK_IMPORTED_MODULE_1__["BlacklistedEQParams"].forEach(function (param) {
            if (eQParams[param]) {
                // this.logger.warning("Removed duplicate " + param + " from extraQueryParameters. Please use the " + param + " field in request object.");
                delete eQParams[param];
            }
        });
        return eQParams;
    };
    /**
     * @ignore
     *
     * Validates the claims passed in request is a JSON
     * TODO: More validation will be added when the server team tells us how they have actually implemented claims
     * @param claimsRequest
     */
    RequestUtils.validateClaimsRequest = function (claimsRequest) {
        if (!claimsRequest) {
            return;
        }
        try {
            JSON.parse(claimsRequest);
        }
        catch (e) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createClaimsRequestParsingError(e);
        }
    };
    /**
     * @ignore
     *
     * generate unique state per request
     * @param userState User-provided state value
     * @returns State string include library state and user state
     */
    RequestUtils.validateAndGenerateState = function (userState, interactionType) {
        return !_StringUtils__WEBPACK_IMPORTED_MODULE_4__["StringUtils"].isEmpty(userState) ? "" + RequestUtils.generateLibraryState(interactionType) + _Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + userState : RequestUtils.generateLibraryState(interactionType);
    };
    /**
     * Generates the state value used by the library.
     *
     * @returns Base64 encoded string representing the state
     */
    RequestUtils.generateLibraryState = function (interactionType) {
        var stateObject = {
            id: _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].createNewGuid(),
            ts: _TimeUtils__WEBPACK_IMPORTED_MODULE_6__["TimeUtils"].now(),
            method: interactionType
        };
        var stateString = JSON.stringify(stateObject);
        return _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].base64Encode(stateString);
    };
    /**
     * Decodes the state value into a StateObject
     *
     * @param state State value returned in the request
     * @returns Parsed values from the encoded state value
     */
    RequestUtils.parseLibraryState = function (state) {
        var libraryState = decodeURIComponent(state).split(_Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter)[0];
        if (_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].isGuid(libraryState)) {
            // If state is guid, assume timestamp is now and is redirect, as redirect should be only method where this can happen.
            return {
                id: libraryState,
                ts: _TimeUtils__WEBPACK_IMPORTED_MODULE_6__["TimeUtils"].now(),
                method: _Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].interactionTypeRedirect
            };
        }
        try {
            var stateString = _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].base64Decode(libraryState);
            var stateObject = JSON.parse(stateString);
            return stateObject;
        }
        catch (e) {
            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_7__["ClientAuthError"].createInvalidStateError(state, null);
        }
    };
    /**
     * @ignore
     *
     * validate correlationId and generate if not valid or not set by the user
     * @param correlationId
     */
    RequestUtils.validateAndGenerateCorrelationId = function (correlationId) {
        // validate user set correlationId or set one for the user if null
        if (correlationId && !_CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].isGuid(correlationId)) {
            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_2__["ClientConfigurationError"].createInvalidCorrelationIdError();
        }
        return _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].isGuid(correlationId) ? correlationId : _CryptoUtils__WEBPACK_IMPORTED_MODULE_5__["CryptoUtils"].createNewGuid();
    };
    /**
     * Create a request signature
     * @param request
     */
    RequestUtils.createRequestSignature = function (request) {
        return "" + request.scopes.join(" ").toLowerCase() + _Constants__WEBPACK_IMPORTED_MODULE_1__["Constants"].resourceDelimiter + request.authority;
    };
    return RequestUtils;
}());

//# sourceMappingURL=RequestUtils.js.map

/***/ }),

/***/ "yFaD":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/components/mgt-person-card/mgt-person-card.js ***!
  \*******************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtPersonCard", function() { return MgtPersonCard; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lit-html/directives/class-map */ "4qtV");
/* harmony import */ var _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @microsoft/mgt-element */ "KTOQ");
/* harmony import */ var _graph_graph_people__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../graph/graph.people */ "r/Dn");
/* harmony import */ var _graph_graph_photos__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../graph/graph.photos */ "xch7");
/* harmony import */ var _graph_graph_user__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../graph/graph.user */ "0Vrk");
/* harmony import */ var _utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/SvgHelper */ "FPR2");
/* harmony import */ var _graph_graph_presence__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../graph/graph.presence */ "tpmt");
/* harmony import */ var _mgt_person_card_graph__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./mgt-person-card.graph */ "aAxo");
/* harmony import */ var _mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../mgt-person/mgt-person */ "lBzc");
/* harmony import */ var _mgt_person_card_css__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./mgt-person-card-css */ "SZAC");
/* harmony import */ var _sections_mgt_person_card_contact_mgt_person_card_contact__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./sections/mgt-person-card-contact/mgt-person-card-contact */ "6Pc0");
/* harmony import */ var _sections_mgt_person_card_files_mgt_person_card_files__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./sections/mgt-person-card-files/mgt-person-card-files */ "sVHX");
/* harmony import */ var _sections_mgt_person_card_messages_mgt_person_card_messages__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./sections/mgt-person-card-messages/mgt-person-card-messages */ "L8Mc");
/* harmony import */ var _sections_mgt_person_card_organization_mgt_person_card_organization__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./sections/mgt-person-card-organization/mgt-person-card-organization */ "hT1+");
/* harmony import */ var _sections_mgt_person_card_profile_mgt_person_card_profile__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./sections/mgt-person-card-profile/mgt-person-card-profile */ "gX3d");
/* harmony import */ var _strings__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./strings */ "19uc");
/* harmony import */ var _sub_components_mgt_spinner_mgt_spinner__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../sub-components/mgt-spinner/mgt-spinner */ "Jics");
/* harmony import */ var _mgt_person_card_types__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./mgt-person-card.types */ "cjdc");
/* harmony import */ var _mgt_person_card_types__WEBPACK_IMPORTED_MODULE_18___default = /*#__PURE__*/__webpack_require__.n(_mgt_person_card_types__WEBPACK_IMPORTED_MODULE_18__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _mgt_person_card_types__WEBPACK_IMPORTED_MODULE_18__) if(["MgtPersonCard","default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _mgt_person_card_types__WEBPACK_IMPORTED_MODULE_18__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var MgtPersonCard_1;



















/**
 * Web Component used to show detailed data for a person in the Microsoft Graph
 *
 * @export
 * @class MgtPersonCard
 * @extends {MgtTemplatedComponent}
 *
 * @cssprop --person-card-display-name-font-size - {Length} Font size of display name title
 * @cssprop --person-card-display-name-color - {Color} Color of display name font
 * @cssprop --person-card-title-font-size - {Length} Font size of title
 * @cssprop --person-card-title-color - {Color} Color of title
 * @cssprop --person-card-subtitle-font-size - {Length} Font size of subtitle
 * @cssprop --person-card-subtitle-color - {Color} Color of subttitle
 * @cssprop --person-card-details-title-font-size - {Length} Font size additional details title
 * @cssprop --person-card-details-title-color- {Color} Color of additional details title
 * @cssprop --person-card-details-item-font-size - {Length} Font size items in additional details section
 * @cssprop --person-card-details-item-color - {Color} Color of items in additional details section
 * @cssprop --person-card-background-color - {Color} Color of person card background
 */
let MgtPersonCard = MgtPersonCard_1 = class MgtPersonCard extends _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["MgtTemplatedComponent"] {
    constructor() {
        super();
        this._chatInput = '';
        this._currentSection = null;
        this._history = [];
        this.sections = [];
    }
    /**
     * Array of styles to apply to the element. The styles should be defined
     * using the `css` tag function.
     */
    static get styles() {
        return _mgt_person_card_css__WEBPACK_IMPORTED_MODULE_10__["styles"];
    }
    get strings() {
        return _strings__WEBPACK_IMPORTED_MODULE_16__["strings"];
    }
    /**
     * Get the scopes required for the person card
     * The scopes depend on what sections are shown
     *
     * Use the `MgtPersonCard.config` object to configure
     * what sections are shown
     *
     * @static
     * @return {*}  {string[]}
     * @memberof MgtPersonCard
     */
    static getScopes() {
        const scopes = [];
        if (this.config.sections.files) {
            scopes.push('Sites.Read.All');
        }
        if (this.config.sections.mailMessages) {
            scopes.push('Mail.ReadBasic');
        }
        if (this.config.sections.organization) {
            scopes.push('User.Read.All');
            if (typeof this.config.sections.organization !== 'boolean' && this.config.sections.organization.showWorksWith) {
                scopes.push('People.Read.All');
            }
        }
        if (this.config.sections.profile) {
            scopes.push('User.Read.All');
        }
        if (this.config.useContactApis) {
            scopes.push('Contacts.Read');
        }
        if (scopes.indexOf('User.Read.All') < 0) {
            // at minimum, we need these scopes
            scopes.push('User.ReadBasic.All');
            scopes.push('User.Read');
        }
        if (scopes.indexOf('People.Read.All') < 0) {
            // at minimum, we need these scopes
            scopes.push('People.Read');
        }
        // return unique
        return [...new Set(scopes)];
    }
    /**
     * Global configuration object for
     * all person card components
     *
     * @static
     * @type {MgtPersonCardConfig}
     * @memberof MgtPersonCard
     */
    static get config() {
        return this._config;
    }
    /**
     * Set the person details to render
     *
     * @type {IDynamicPerson}
     * @memberof MgtPersonCard
     */
    get personDetails() {
        return this._personDetails;
    }
    set personDetails(value) {
        if (this._personDetails === value) {
            return;
        }
        this._personDetails = value;
        this.personImage = null;
        this.requestStateUpdate();
    }
    get internalPersonDetails() {
        return (this.state && this.state.person) || this.personDetails;
    }
    /**
     * Synchronizes property values when attributes change.
     *
     * @param {*} name
     * @param {*} oldValue
     * @param {*} newValue
     * @memberof MgtPersonCard
     */
    attributeChangedCallback(name, oldValue, newValue) {
        super.attributeChangedCallback(name, oldValue, newValue);
        if (oldValue === newValue) {
            return;
        }
        switch (name) {
            case 'person-query':
            case 'user-id':
                this.personDetails = null;
                this.requestStateUpdate();
                break;
        }
    }
    /**
     * Navigate the card to a different person.
     *
     * @protected
     * @memberof MgtPersonCard
     */
    navigate(person) {
        this._history.push({
            personDetails: this.personDetails,
            personImage: this.getImage(),
            state: this.state
        });
        this._personDetails = person;
        this.state = null;
        this.personImage = null;
        this._currentSection = null;
        this.sections = [];
        this.requestStateUpdate();
    }
    /**
     * Navigate the card back to the previous person
     *
     * @returns {void}
     * @memberof MgtPersonCard
     */
    goBack() {
        if (!this._history || !this._history.length) {
            return;
        }
        const historyState = this._history.pop();
        this._currentSection = null;
        this.state = historyState.state;
        this._personDetails = historyState.state;
        this.personImage = historyState.personImage;
        this.loadSections();
    }
    /**
     * Navigate the card back to first person and clear history
     *
     * @returns {void}
     * @memberof MgtPersonCard
     */
    clearHistory() {
        this._currentSection = null;
        if (!this._history || !this._history.length) {
            return;
        }
        const historyState = this._history[0];
        this._history = [];
        this.state = historyState.state;
        this._personDetails = historyState.state;
        this.personImage = historyState.personImage;
        this.loadSections();
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
        // Handle no data
        if (!this.internalPersonDetails) {
            return this.renderNoData();
        }
        const person = this.internalPersonDetails;
        const image = this.getImage();
        // Check for a default template.
        // tslint:disable-next-line: no-string-literal
        if (this.hasTemplate('default')) {
            return this.renderTemplate('default', {
                person: this.internalPersonDetails,
                personImage: image
            });
        }
        const navigationTemplate = this._history && this._history.length
            ? lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
            <div class="nav">
              <div class="nav__back" @click=${() => this.goBack()}>${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].Back)}</div>
            </div>
          `
            : null;
        // Check for a person-details template
        let personDetailsTemplate = this.renderTemplate('person-details', {
            person: this.internalPersonDetails,
            personImage: image
        });
        if (!personDetailsTemplate) {
            const personTemplate = this.renderPerson();
            const contactIconsTemplate = this.renderContactIcons(person);
            personDetailsTemplate = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        ${personTemplate} ${contactIconsTemplate}
      `;
        }
        const expandedDetailsTemplate = this.isExpanded ? this.renderExpandedDetails() : this.renderExpandedDetailsButton();
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="root" dir=${this.direction}>
        ${navigationTemplate}
        <div class="person-details-container">${personDetailsTemplate}</div>
        <div class="expanded-details-container">${expandedDetailsTemplate}</div>
      </div>
    `;
    }
    /**
     * Render the state when no data is available.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCard
     */
    renderNoData() {
        return this.renderTemplate('no-data', null) || lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] ``;
    }
    /**
     * Render a display image for the person.
     *
     * @protected
     * @param {*} image
     * @memberof MgtPersonCard
     */
    renderPerson() {
        const avatarSize = 'large';
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <mgt-person
        class="person-image"
        .personDetails=${this.internalPersonDetails}
        .personImage=${this.getImage()}
        .personPresence=${this.personPresence}
        .showPresence=${this.showPresence}
        .avatarSize=${avatarSize}
        .view=${_mgt_person_mgt_person__WEBPACK_IMPORTED_MODULE_9__["PersonViewType"].threelines}
        .line2Property=${'jobTitle'}
        .line3Property=${'department'}
      ></mgt-person>
    `;
    }
    /**
     * Render person subtitle.
     *
     * @protected
     * @param {IDynamicPerson} person
     * @returns {TemplateResult}
     * @memberof MgtPersonCard
     */
    renderPersonSubtitle(person) {
        person = person || this.internalPersonDetails;
        if (!person.department) {
            return;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="department">${person.department}</div>
    `;
    }
    /**
     * Render the various icons for contacting the person.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCard
     */
    renderContactIcons(person) {
        if (this.isExpanded) {
            return;
        }
        person = person || this.internalPersonDetails;
        const userPerson = person;
        // Email
        let email;
        if (Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_3__["getEmailFromGraphEntity"])(person)) {
            email = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="icon" @click=${() => this.emailUser()}>
          ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].SmallEmail)}
          <span>${this.strings.sendEmailLinkSubtitle}</span>
        </div>
      `;
        }
        // Chat
        let chat;
        if (userPerson.userPrincipalName) {
            chat = lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="icon" @click=${() => this.chatUser()}>
          ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].SmallChat)}
          <span>${this.strings.startChatLinkSubtitle}</span>
        </div>
      `;
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="base-icons">
        ${email} ${chat}
      </div>
    `;
    }
    /**
     * Render the button used to expand the expanded details.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCard
     */
    renderExpandedDetailsButton() {
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="expanded-details-button" @click=${() => this.showExpandedDetails()}>
        ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].ExpandDown)}
      </div>
    `;
    }
    /**
     * Render expanded details.
     *
     * @protected
     * @param {IDynamicPerson} [person]
     * @returns {TemplateResult}
     * @memberof MgtPersonCard
     */
    renderExpandedDetails(person) {
        if (!this.state && this.isStateLoading) {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="loading">
          <mgt-spinner></mgt-spinner>
        </div>
      `;
        }
        person = person || this.internalPersonDetails;
        const sectionNavTemplate = this.renderSectionNavigation();
        const currentSectionTemplate = this.renderCurrentSection();
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="section-nav">
        ${sectionNavTemplate}
      </div>
      <div class="section-host" @wheel=${(e) => this.handleSectionScroll(e)}>
        ${currentSectionTemplate}
      </div>
    `;
    }
    /**
     * Render the navigation ribbon for subsections
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCard
     */
    renderSectionNavigation() {
        if (!this.sections || (this.sections.length < 2 && !this.hasTemplate('additional-details'))) {
            return;
        }
        const currentSectionIndex = this._currentSection ? this.sections.indexOf(this._currentSection) : -1;
        const navIcons = this.sections.map((section, i, a) => {
            const classes = Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({
                active: i === currentSectionIndex,
                'section-nav__icon': true
            });
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <button class=${classes} @click=${() => this.updateCurrentSection(section)}>${section.renderIcon()}</button>
      `;
        });
        const overviewClasses = Object(lit_html_directives_class_map__WEBPACK_IMPORTED_MODULE_1__["classMap"])({
            active: currentSectionIndex === -1,
            'section-nav__icon': true
        });
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <button class=${overviewClasses} @click=${() => this.updateCurrentSection(null)}>
        ${Object(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["getSvg"])(_utils_SvgHelper__WEBPACK_IMPORTED_MODULE_6__["SvgIcon"].Overview)}
      </button>
      ${navIcons}
    `;
    }
    /**
     * Render the default section with compact views for each subsection.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCard
     */
    renderOverviewSection() {
        const compactTemplates = this.sections.map(section => lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        <div class="section">
          <div class="section__header">
            <div class="section__title">${section.displayName}</div>
            <a class="section__show-more" @click=${() => this.updateCurrentSection(section)}
              >${this.strings.showMoreSectionButton}</a
            >
          </div>
          <div class="section__content">${section.asCompactView()}</div>
        </div>
      `);
        const additionalDetails = this.renderTemplate('additional-details', {
            person: this.internalPersonDetails,
            personImage: this.getImage(),
            state: this.state
        });
        if (additionalDetails) {
            compactTemplates.splice(1, 0, lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
          <div class="section">
            <div class="additional-details">${additionalDetails}</div>
          </div>
        `);
        }
        // To be included when support for direct messaging is added
        // ${this.internalPersonDetails.id !== this._me.id && MgtPersonCard.config.isSendMessageVisible
        //   ? html`
        //       <div class="quick-message">
        //         <input
        //           type="text"
        //           class="quick-message__input"
        //           placeholder="Message ${this.internalPersonDetails.displayName}"
        //           .value=${this._chatInput}
        //           @input=${(e: Event) => {
        //             this._chatInput = (e.target as HTMLInputElement).value;
        //           }}
        //         />
        //         <button class="quick-message__send" @click=${() => this.sendQuickMessage()}>
        //           ${getSvg(SvgIcon.Send)}
        //         </button>
        //       </div>
        //     `
        //   : null}
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      <div class="sections">
        ${compactTemplates}
      </div>
    `;
    }
    /**
     * Render the actively selected section.
     *
     * @protected
     * @returns {TemplateResult}
     * @memberof MgtPersonCard
     */
    renderCurrentSection() {
        if ((!this.sections || !this.sections.length) && !this.hasTemplate('additional-details')) {
            return;
        }
        if (this.sections.length === 1 && !this.hasTemplate('additional-details')) {
            return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
        ${this.sections[0].asFullView()}
      `;
        }
        if (!this._currentSection) {
            return this.renderOverviewSection();
        }
        return lit_element__WEBPACK_IMPORTED_MODULE_0__["html"] `
      ${this._currentSection.asFullView()}
    `;
    }
    /**
     * load state into the component
     *
     * @protected
     * @returns
     * @memberof MgtPersonCard
     */
    loadState() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.state) {
                return;
            }
            if (!this.personDetails && this.inheritDetails) {
                // User person details inherited from parent tree
                let parent = this.parentElement;
                while (parent && parent.tagName !== 'MGT-PERSON') {
                    parent = parent.parentElement;
                }
                if (parent && parent.personDetails) {
                    this.personDetails = parent.personDetails;
                    this.personImage = parent.personImage;
                }
            }
            const provider = _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["Providers"].globalProvider;
            // check if user is signed in
            if (!provider || provider.state !== _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["ProviderState"].SignedIn) {
                return;
            }
            const graph = provider.graph.forComponent(this);
            this.isStateLoading = true;
            if (!this._me) {
                this._me = yield _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["Providers"].me();
            }
            // check if personDetail already populated
            if (this.personDetails) {
                const user = this.personDetails;
                const id = user.userPrincipalName || user.id;
                // if we have an id but no email, we should get data from the graph
                // in some graph calls, the user object does not contain the email
                if (id && !Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_3__["getEmailFromGraphEntity"])(user)) {
                    const person = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_5__["getUserWithPhoto"])(graph, id);
                    this.personDetails = person;
                    this.personImage = this.getImage();
                }
            }
            else if (this.userId || this.personQuery === 'me') {
                // Use userId or 'me' query to get the person and image
                const person = yield Object(_graph_graph_user__WEBPACK_IMPORTED_MODULE_5__["getUserWithPhoto"])(graph, this.userId);
                this.personDetails = person;
                this.personImage = this.getImage();
            }
            else if (this.personQuery) {
                // Use the personQuery to find our person.
                const people = yield Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_3__["findPeople"])(graph, this.personQuery, 1);
                if (people && people.length) {
                    this.personDetails = people[0];
                    Object(_graph_graph_photos__WEBPACK_IMPORTED_MODULE_4__["getPersonImage"])(graph, this.personDetails, MgtPersonCard_1.config.useContactApis).then(image => {
                        if (image) {
                            this.personDetails.personImage = image;
                            this.personImage = image;
                        }
                    });
                }
            }
            // populate presence
            const defaultPresence = {
                activity: 'Offline',
                availability: 'Offline',
                id: null
            };
            if (!this.personPresence && this.showPresence) {
                try {
                    if (this.personDetails && this.personDetails.id) {
                        Object(_graph_graph_presence__WEBPACK_IMPORTED_MODULE_7__["getUserPresence"])(graph, this.personDetails.id).then(presence => {
                            this.personPresence = presence;
                        });
                    }
                    else {
                        this.personPresence = defaultPresence;
                    }
                }
                catch (_) {
                    // set up a default Presence in case beta api changes or getting error code
                    this.personPresence = defaultPresence;
                }
            }
            this.state = yield Object(_mgt_person_card_graph__WEBPACK_IMPORTED_MODULE_8__["getPersonCardGraphData"])(graph, this.personDetails, this._me === this.personDetails.id, MgtPersonCard_1.config);
            this.loadSections();
            this.isStateLoading = false;
        });
    }
    /**
     * Send a chat message to the user from the quick message input.
     *
     * @protected
     * @returns {void}
     * @memberof MgtPersonCard
     */
    sendQuickMessage() {
        const message = this._chatInput.trim();
        if (!message || !message.length) {
            return;
        }
        this.chatUser(message);
    }
    /**
     * Use the mailto: protocol to initiate a new email to the user.
     *
     * @protected
     * @memberof MgtPersonCard
     */
    emailUser() {
        const user = this.internalPersonDetails;
        if (user) {
            const email = Object(_graph_graph_people__WEBPACK_IMPORTED_MODULE_3__["getEmailFromGraphEntity"])(user);
            if (email) {
                window.open('mailto:' + email, '_blank');
            }
        }
    }
    /**
     * Use the tel: protocol to initiate a new call to the user.
     *
     * @protected
     * @memberof MgtPersonCard
     */
    callUser() {
        const user = this.personDetails;
        const person = this.personDetails;
        if (user && user.businessPhones && user.businessPhones.length) {
            const phone = user.businessPhones[0];
            if (phone) {
                window.open('tel:' + phone, '_blank');
            }
        }
        else if (person && person.phones && person.phones.length) {
            const businessPhones = this.getPersonBusinessPhones(person);
            const phone = businessPhones[0];
            if (phone) {
                window.open('tel:' + phone, '_blank');
            }
        }
    }
    /**
     * Initiate a chat message to the user via deeplink.
     *
     * @protected
     * @memberof MgtPersonCard
     */
    chatUser(message = null) {
        const user = this.personDetails;
        if (user && user.userPrincipalName) {
            const users = user.userPrincipalName;
            let url = `https://teams.microsoft.com/l/chat/0/0?users=${users}`;
            if (message && message.length) {
                url += `&message=${message}`;
            }
            const openWindow = () => window.open(url, '_blank');
            if (_microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["TeamsHelper"].isAvailable) {
                _microsoft_mgt_element__WEBPACK_IMPORTED_MODULE_2__["TeamsHelper"].executeDeepLink(url, (status) => {
                    if (!status) {
                        openWindow();
                    }
                });
            }
            else {
                openWindow();
            }
        }
    }
    /**
     * Display the expanded details panel.
     *
     * @protected
     * @memberof MgtPersonCard
     */
    showExpandedDetails() {
        const root = this.renderRoot.querySelector('.root');
        if (root && root.animate) {
            // play back
            root.animate([
                {
                    height: 'auto',
                    transformOrigin: 'top left'
                },
                {
                    height: 'auto',
                    transformOrigin: 'top left'
                }
            ], {
                duration: 1000,
                easing: 'ease-in-out',
                fill: 'both'
            });
        }
        this.isExpanded = true;
        this.fireCustomEvent('expanded', null, true);
    }
    loadSections() {
        this.sections = [];
        if (!this.internalPersonDetails) {
            return;
        }
        const contactSections = new _sections_mgt_person_card_contact_mgt_person_card_contact__WEBPACK_IMPORTED_MODULE_11__["MgtPersonCardContact"](this.internalPersonDetails);
        if (contactSections.hasData) {
            this.sections.push(contactSections);
        }
        if (!this.state) {
            return;
        }
        const { person, directReports, messages, files, profile } = this.state;
        if (MgtPersonCard_1.config.sections.organization &&
            ((person && person.manager) || (directReports && directReports.length))) {
            this.sections.push(new _sections_mgt_person_card_organization_mgt_person_card_organization__WEBPACK_IMPORTED_MODULE_14__["MgtPersonCardOrganization"](this.state, this._me));
        }
        if (MgtPersonCard_1.config.sections.mailMessages && messages && messages.length) {
            this.sections.push(new _sections_mgt_person_card_messages_mgt_person_card_messages__WEBPACK_IMPORTED_MODULE_13__["MgtPersonCardMessages"](messages));
        }
        if (MgtPersonCard_1.config.sections.files && files && files.length) {
            this.sections.push(new _sections_mgt_person_card_files_mgt_person_card_files__WEBPACK_IMPORTED_MODULE_12__["MgtPersonCardFiles"](files));
        }
        if (MgtPersonCard_1.config.sections.profile && profile) {
            const profileSection = new _sections_mgt_person_card_profile_mgt_person_card_profile__WEBPACK_IMPORTED_MODULE_15__["MgtPersonCardProfile"](profile);
            if (profileSection.hasData) {
                this.sections.push(profileSection);
            }
        }
    }
    getImage() {
        if (this.personImage) {
            return this.personImage;
        }
        const person = this.personDetails;
        return person && person.personImage ? person.personImage : null;
    }
    getPersonBusinessPhones(person) {
        const phones = person.phones;
        const businessPhones = [];
        for (const p of phones) {
            if (p.type === 'business') {
                businessPhones.push(p.number);
            }
        }
        return businessPhones;
    }
    updateCurrentSection(section) {
        const sectionHost = this.renderRoot.querySelector('.section-host');
        sectionHost.scrollTop = 0;
        this._currentSection = section;
        this.requestUpdate();
    }
    handleSectionScroll(e) {
        const target = this.renderRoot.querySelector('.section-host');
        if (target) {
            if (!(e.deltaY < 0 && target.scrollTop === 0) &&
                !(e.deltaY > 0 && target.clientHeight + target.scrollTop >= target.scrollHeight - 1)) {
                e.stopPropagation();
            }
        }
    }
};
MgtPersonCard._config = {
    sections: {
        files: true,
        mailMessages: true,
        organization: { showWorksWith: true },
        profile: true
    },
    useContactApis: true
};
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-details',
        type: Object
    }),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], MgtPersonCard.prototype, "personDetails", null);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-query'
    }),
    __metadata("design:type", String)
], MgtPersonCard.prototype, "personQuery", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'user-id'
    }),
    __metadata("design:type", String)
], MgtPersonCard.prototype, "userId", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-image',
        type: String
    }),
    __metadata("design:type", String)
], MgtPersonCard.prototype, "personImage", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'fetch-image',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtPersonCard.prototype, "fetchImage", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'is-expanded',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtPersonCard.prototype, "isExpanded", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'inherit-details',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtPersonCard.prototype, "inheritDetails", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'show-presence',
        type: Boolean
    }),
    __metadata("design:type", Boolean)
], MgtPersonCard.prototype, "showPresence", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["property"])({
        attribute: 'person-presence',
        type: Object
    }),
    __metadata("design:type", Object)
], MgtPersonCard.prototype, "personPresence", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["internalProperty"])(),
    __metadata("design:type", Object)
], MgtPersonCard.prototype, "state", void 0);
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["internalProperty"])(),
    __metadata("design:type", Boolean)
], MgtPersonCard.prototype, "isStateLoading", void 0);
MgtPersonCard = MgtPersonCard_1 = __decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["customElement"])('mgt-person-card'),
    __metadata("design:paramtypes", [])
], MgtPersonCard);

//# sourceMappingURL=mgt-person-card.js.map

/***/ }),

/***/ "yFpm":
/*!***************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-components/dist/es6/utils/WindowSegmentHelpers.js ***!
  \***************************************************************************************/
/*! exports provided: isWindowSegmentAware, getSegmentAwareWindow */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isWindowSegmentAware", function() { return isWindowSegmentAware; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSegmentAwareWindow", function() { return getSegmentAwareWindow; });
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
/**
 * Responds whether or not the Window object supports the Window Segments Enumeration API.
 *
 * @export
 * @returns {boolean}
 */
function isWindowSegmentAware() {
    return window.getWindowSegments !== undefined;
}
/**
 * Returns an ISegmentAwareWindow instance of the Window object, or null if the API is not supported.
 *
 * @export
 * @returns {ISegmentAwareWindow}
 */
function getSegmentAwareWindow() {
    return isWindowSegmentAware() ? window : null;
}
//# sourceMappingURL=WindowSegmentHelpers.js.map

/***/ }),

/***/ "yJyd":
/*!*********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/Logger.js ***!
  \*********************************************************************************/
/*! exports provided: LogLevel, Logger */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LogLevel", function() { return LogLevel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Logger", function() { return Logger; });
/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/StringUtils */ "Ft/c");
/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ "vFME");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */


var LogLevel;
(function (LogLevel) {
    LogLevel[LogLevel["Error"] = 0] = "Error";
    LogLevel[LogLevel["Warning"] = 1] = "Warning";
    LogLevel[LogLevel["Info"] = 2] = "Info";
    LogLevel[LogLevel["Verbose"] = 3] = "Verbose";
})(LogLevel || (LogLevel = {}));
var Logger = /** @class */ (function () {
    function Logger(localCallback, options) {
        if (options === void 0) { options = {}; }
        /**
         * @hidden
         */
        this.level = LogLevel.Info;
        var _a = options.correlationId, correlationId = _a === void 0 ? "" : _a, _b = options.level, level = _b === void 0 ? LogLevel.Info : _b, _c = options.piiLoggingEnabled, piiLoggingEnabled = _c === void 0 ? false : _c;
        this.localCallback = localCallback;
        this.correlationId = correlationId;
        this.level = level;
        this.piiLoggingEnabled = piiLoggingEnabled;
    }
    /**
     * @hidden
     */
    Logger.prototype.logMessage = function (logLevel, logMessage, containsPii) {
        if ((logLevel > this.level) || (!this.piiLoggingEnabled && containsPii)) {
            return;
        }
        var timestamp = new Date().toUTCString();
        var log;
        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_0__["StringUtils"].isEmpty(this.correlationId)) {
            log = timestamp + ":" + this.correlationId + "-" + Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["libraryVersion"])() + "-" + LogLevel[logLevel] + (containsPii ? "-pii" : "") + " " + logMessage;
        }
        else {
            log = timestamp + ":" + Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__["libraryVersion"])() + "-" + LogLevel[logLevel] + (containsPii ? "-pii" : "") + " " + logMessage;
        }
        this.executeCallback(logLevel, log, containsPii);
    };
    /**
     * @hidden
     */
    Logger.prototype.executeCallback = function (level, message, containsPii) {
        if (this.localCallback) {
            this.localCallback(level, message, containsPii);
        }
    };
    /**
     * @hidden
     */
    Logger.prototype.error = function (message) {
        this.logMessage(LogLevel.Error, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.errorPii = function (message) {
        this.logMessage(LogLevel.Error, message, true);
    };
    /**
     * @hidden
     */
    Logger.prototype.warning = function (message) {
        this.logMessage(LogLevel.Warning, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.warningPii = function (message) {
        this.logMessage(LogLevel.Warning, message, true);
    };
    /**
     * @hidden
     */
    Logger.prototype.info = function (message) {
        this.logMessage(LogLevel.Info, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.infoPii = function (message) {
        this.logMessage(LogLevel.Info, message, true);
    };
    /**
     * @hidden
     */
    Logger.prototype.verbose = function (message) {
        this.logMessage(LogLevel.Verbose, message, false);
    };
    /**
     * @hidden
     */
    Logger.prototype.verbosePii = function (message) {
        this.logMessage(LogLevel.Verbose, message, true);
    };
    Logger.prototype.isPiiLoggingEnabled = function () {
        return this.piiLoggingEnabled;
    };
    return Logger;
}());

//# sourceMappingURL=Logger.js.map

/***/ }),

/***/ "yLpj":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ "yLtT":
/*!****************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/utils/GraphHelpers.js ***!
  \****************************************************************************/
/*! exports provided: prepScopes, chainMiddleware */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prepScopes", function() { return prepScopes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "chainMiddleware", function() { return chainMiddleware; });
/* harmony import */ var _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @microsoft/microsoft-graph-client */ "9F8r");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * creates an AuthenticationHandlerOptions from scopes array that
 * can be used in the Graph sdk middleware chain
 *
 * @export
 * @param {...string[]} scopes
 * @returns
 */
function prepScopes(...scopes) {
    const authProviderOptions = {
        scopes
    };
    return [new _microsoft_microsoft_graph_client__WEBPACK_IMPORTED_MODULE_0__["AuthenticationHandlerOptions"](undefined, authProviderOptions)];
}
/**
 * Helper method to chain Middleware when instantiating new Client
 *
 * @param {...Middleware[]} middleware
 * @returns {Middleware}
 */
function chainMiddleware(...middleware) {
    const rootMiddleware = middleware[0];
    let current = rootMiddleware;
    for (let i = 1; i < middleware.length; ++i) {
        const next = middleware[i];
        if (current.setNext) {
            current.setNext(next);
        }
        current = next;
    }
    return rootMiddleware;
}
//# sourceMappingURL=GraphHelpers.js.map

/***/ }),

/***/ "yMgu":
/*!*******************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/BetaGraph.js ***!
  \*******************************************************************/
/*! exports provided: BetaGraph */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BetaGraph", function() { return BetaGraph; });
/* harmony import */ var _Graph__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Graph */ "WOkV");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * The version of the Graph to use for making requests.
 */
const GRAPH_VERSION = 'beta';
/**
 * BetaGraph
 *
 * @export
 * @class BetaGraph
 * @extends {BetaGraph}
 */
class BetaGraph extends _Graph__WEBPACK_IMPORTED_MODULE_0__["Graph"] {
    /**
     * get a BetaGraph instance based on an existing IGraph implementation.
     *
     * @static
     * @param {Graph} graph
     * @returns {BetaGraph}
     * @memberof BetaGraph
     */
    static fromGraph(graph) {
        const betaGraph = new BetaGraph(graph.client);
        betaGraph.setComponent(graph.componentName);
        return betaGraph;
    }
    constructor(client, version = GRAPH_VERSION) {
        super(client, version);
    }
    /**
     * Returns a new instance of the Graph using the same
     * client within the context of the provider.
     *
     * @param {Element} component
     * @returns {BetaGraph}
     * @memberof BetaGraph
     */
    forComponent(component) {
        const graph = new BetaGraph(this.client);
        this.setComponent(component);
        return graph;
    }
}
//# sourceMappingURL=BetaGraph.js.map

/***/ }),

/***/ "yuSj":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/telemetry/TelemetryUtils.js ***!
  \***************************************************************************************************/
/*! exports provided: scrubTenantFromUri, hashPersonalIdentifier, prependEventNamePrefix, supportsBrowserPerformance, endBrowserPerformanceMeasurement, startBrowserPerformanceMeasurement */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "scrubTenantFromUri", function() { return scrubTenantFromUri; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hashPersonalIdentifier", function() { return hashPersonalIdentifier; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prependEventNamePrefix", function() { return prependEventNamePrefix; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "supportsBrowserPerformance", function() { return supportsBrowserPerformance; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "endBrowserPerformanceMeasurement", function() { return endBrowserPerformanceMeasurement; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "startBrowserPerformanceMeasurement", function() { return startBrowserPerformanceMeasurement; });
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TelemetryConstants */ "3gM8");
/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/CryptoUtils */ "qD3l");
/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/UrlUtils */ "8P3k");
/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../authority/Authority */ "43Tr");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var scrubTenantFromUri = function (uri) {
    var url = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_2__["UrlUtils"].GetUrlComponents(uri);
    // validate trusted host
    if (_authority_Authority__WEBPACK_IMPORTED_MODULE_3__["Authority"].isAdfs(uri)) {
        /**
         * returning what was passed because the library needs to work with uris that are non
         * AAD trusted but passed by users such as B2C or others.
         * HTTP Events for instance can take a url to the open id config endpoint
         */
        return uri;
    }
    var pathParams = url.PathSegments;
    if (pathParams && pathParams.length >= 2) {
        var tenantPosition = pathParams[1] === "tfp" ? 2 : 1;
        if (tenantPosition < pathParams.length) {
            pathParams[tenantPosition] = _TelemetryConstants__WEBPACK_IMPORTED_MODULE_0__["TENANT_PLACEHOLDER"];
        }
    }
    return url.Protocol + "//" + url.HostNameAndPort + "/" + pathParams.join("/");
};
var hashPersonalIdentifier = function (valueToHash) {
    /*
     * TODO sha256 this
     * Current test runner is being funny with node libs that are webpacked anyway
     * need a different solution
     */
    return _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_1__["CryptoUtils"].base64Encode(valueToHash);
};
var prependEventNamePrefix = function (suffix) { return "" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_0__["EVENT_NAME_PREFIX"] + (suffix || ""); };
var supportsBrowserPerformance = function () { return !!(typeof window !== "undefined" &&
    "performance" in window &&
    window.performance.mark &&
    window.performance.measure); };
var endBrowserPerformanceMeasurement = function (measureName, startMark, endMark) {
    if (supportsBrowserPerformance()) {
        window.performance.mark(endMark);
        window.performance.measure(measureName, startMark, endMark);
        window.performance.clearMeasures(measureName);
        window.performance.clearMarks(startMark);
        window.performance.clearMarks(endMark);
    }
};
var startBrowserPerformanceMeasurement = function (startMark) {
    if (supportsBrowserPerformance()) {
        window.performance.mark(startMark);
    }
};
//# sourceMappingURL=TelemetryUtils.js.map

/***/ }),

/***/ "z+g4":
/*!********************************************************************************************!*\
  !*** ./node_modules/@microsoft/microsoft-graph-client/lib/es/middleware/MiddlewareUtil.js ***!
  \********************************************************************************************/
/*! exports provided: generateUUID, getRequestHeader, setRequestHeader, appendRequestHeader, cloneRequestWithNewUrl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateUUID", function() { return generateUUID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getRequestHeader", function() { return getRequestHeader; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setRequestHeader", function() { return setRequestHeader; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "appendRequestHeader", function() { return appendRequestHeader; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cloneRequestWithNewUrl", function() { return cloneRequestWithNewUrl; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

/**
 * @constant
 * To generate the UUID
 * @returns The UUID string
 */
const generateUUID = () => {
    let uuid = "";
    for (let j = 0; j < 32; j++) {
        if (j === 8 || j === 12 || j === 16 || j === 20) {
            uuid += "-";
        }
        uuid += Math.floor(Math.random() * 16).toString(16);
    }
    return uuid;
};
/**
 * @constant
 * To get the request header from the request
 * @param {RequestInfo} request - The request object or the url string
 * @param {FetchOptions|undefined} options - The request options object
 * @param {string} key - The header key string
 * @returns A header value for the given key from the request
 */
const getRequestHeader = (request, options, key) => {
    let value = null;
    if (typeof Request !== "undefined" && request instanceof Request) {
        value = request.headers.get(key);
    }
    else if (typeof options !== "undefined" && options.headers !== undefined) {
        if (typeof Headers !== "undefined" && options.headers instanceof Headers) {
            value = options.headers.get(key);
        }
        else if (options.headers instanceof Array) {
            const headers = options.headers;
            for (let i = 0, l = headers.length; i < l; i++) {
                if (headers[i][0] === key) {
                    value = headers[i][1];
                    break;
                }
            }
        }
        else if (options.headers[key] !== undefined) {
            value = options.headers[key];
        }
    }
    return value;
};
/**
 * @constant
 * To set the header value to the given request
 * @param {RequestInfo} request - The request object or the url string
 * @param {FetchOptions|undefined} options - The request options object
 * @param {string} key - The header key string
 * @param {string } value - The header value string
 * @returns Nothing
 */
const setRequestHeader = (request, options, key, value) => {
    if (typeof Request !== "undefined" && request instanceof Request) {
        request.headers.set(key, value);
    }
    else if (typeof options !== "undefined") {
        if (options.headers === undefined) {
            options.headers = new Headers({
                [key]: value,
            });
        }
        else {
            if (typeof Headers !== "undefined" && options.headers instanceof Headers) {
                options.headers.set(key, value);
            }
            else if (options.headers instanceof Array) {
                let i = 0;
                const l = options.headers.length;
                for (; i < l; i++) {
                    const header = options.headers[i];
                    if (header[0] === key) {
                        header[1] = value;
                        break;
                    }
                }
                if (i === l) {
                    options.headers.push([key, value]);
                }
            }
            else {
                Object.assign(options.headers, { [key]: value });
            }
        }
    }
};
/**
 * @constant
 * To append the header value to the given request
 * @param {RequestInfo} request - The request object or the url string
 * @param {FetchOptions|undefined} options - The request options object
 * @param {string} key - The header key string
 * @param {string } value - The header value string
 * @returns Nothing
 */
const appendRequestHeader = (request, options, key, value) => {
    if (typeof Request !== "undefined" && request instanceof Request) {
        request.headers.append(key, value);
    }
    else if (typeof options !== "undefined") {
        if (options.headers === undefined) {
            options.headers = new Headers({
                [key]: value,
            });
        }
        else {
            if (typeof Headers !== "undefined" && options.headers instanceof Headers) {
                options.headers.append(key, value);
            }
            else if (options.headers instanceof Array) {
                options.headers.push([key, value]);
            }
            else if (options.headers === undefined) {
                options.headers = { [key]: value };
            }
            else if (options.headers[key] === undefined) {
                options.headers[key] = value;
            }
            else {
                options.headers[key] += `, ${value}`;
            }
        }
    }
};
/**
 * @constant
 * To clone the request with the new url
 * @param {string} url - The new url string
 * @param {Request} request - The request object
 * @returns A promise that resolves to request object
 */
const cloneRequestWithNewUrl = (newUrl, request) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](undefined, void 0, void 0, function* () {
    const body = request.headers.get("Content-Type") ? yield request.blob() : yield Promise.resolve(undefined);
    const { method, headers, referrer, referrerPolicy, mode, credentials, cache, redirect, integrity, keepalive, signal } = request;
    return new Request(newUrl, { method, headers, body, referrer, referrerPolicy, mode, credentials, cache, redirect, integrity, keepalive, signal });
});
//# sourceMappingURL=MiddlewareUtil.js.map

/***/ }),

/***/ "z4C7":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/node_modules/msal/lib-es6/telemetry/DefaultEvent.js ***!
  \*************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TelemetryConstants */ "3gM8");
/* harmony import */ var _TelemetryEvent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TelemetryEvent */ "ZwGo");
/* harmony import */ var _TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TelemetryUtils */ "yuSj");
/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */




var DefaultEvent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DefaultEvent, _super);
    // TODO Platform Type
    function DefaultEvent(platform, correlationId, clientId, eventCount) {
        var _this = _super.call(this, Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("default_event"), correlationId, "DefaultEvent") || this;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("client_id")] = clientId;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("sdk_plaform")] = platform.sdk;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("sdk_version")] = platform.sdkVersion;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("application_name")] = platform.applicationName;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("application_version")] = platform.applicationVersion;
        _this.event[Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("effective_connection_speed")] = platform.networkInformation && platform.networkInformation.connectionSpeed;
        _this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].UiEventCountTelemetryBatchKey] = _this.getEventCount(Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("ui_event"), eventCount);
        _this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].HttpEventCountTelemetryBatchKey] = _this.getEventCount(Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("http_event"), eventCount);
        _this.event["" + _TelemetryConstants__WEBPACK_IMPORTED_MODULE_1__["TELEMETRY_BLOB_EVENT_NAMES"].CacheEventCountConstStrKey] = _this.getEventCount(Object(_TelemetryUtils__WEBPACK_IMPORTED_MODULE_3__["prependEventNamePrefix"])("cache_event"), eventCount);
        return _this;
        // / Device id?
    }
    DefaultEvent.prototype.getEventCount = function (eventName, eventCount) {
        if (!eventCount[eventName]) {
            return 0;
        }
        return eventCount[eventName];
    };
    return DefaultEvent;
}(_TelemetryEvent__WEBPACK_IMPORTED_MODULE_2__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (DefaultEvent);
//# sourceMappingURL=DefaultEvent.js.map

/***/ }),

/***/ "zoxn":
/*!**********************************************************************************!*\
  !*** ./node_modules/@microsoft/mgt-element/dist/es6/components/baseComponent.js ***!
  \**********************************************************************************/
/*! exports provided: ComponentMediaQuery, MgtBaseComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComponentMediaQuery", function() { return ComponentMediaQuery; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MgtBaseComponent", function() { return MgtBaseComponent; });
/* harmony import */ var lit_element__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lit-element */ "CQbg");
/* harmony import */ var _providers_Providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../providers/Providers */ "Viiq");
/* harmony import */ var _utils_LocalizationHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/LocalizationHelper */ "u7Q3");
/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */
var __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (undefined && undefined.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Defines media query based on component width
 *
 * @export
 * @enum {string}
 */
var ComponentMediaQuery;
(function (ComponentMediaQuery) {
    /**
     * devices with width < 768
     */
    ComponentMediaQuery["mobile"] = "";
    /**
     * devices with width < 1200
     */
    ComponentMediaQuery["tablet"] = "tablet";
    /**
     * devices with width > 1200
     */
    ComponentMediaQuery["desktop"] = "desktop";
})(ComponentMediaQuery || (ComponentMediaQuery = {}));
/**
 * BaseComponent extends LitElement adding mgt specific features to all components
 *
 * @export  MgtBaseComponent
 * @abstract
 * @class MgtBaseComponent
 * @extends {LitElement}
 */
class MgtBaseComponent extends lit_element__WEBPACK_IMPORTED_MODULE_0__["LitElement"] {
    constructor() {
        super();
        /**
         * Gets or sets the direction of the component
         *
         * @protected
         * @memberof MgtBaseComponent
         */
        this.direction = 'ltr';
        /**
         * determines if login component is in loading state
         * @type {boolean}
         */
        this._isLoadingState = false;
        this._isFirstUpdated = false;
        this.handleLocalizationChanged = this.handleLocalizationChanged.bind(this);
        this.handleDirectionChanged = this.handleDirectionChanged.bind(this);
        this.handleDirectionChanged();
        this.handleLocalizationChanged();
    }
    /**
     * Gets the ComponentMediaQuery of the component
     *
     * @readonly
     * @type {MgtElement.ComponentMediaQuery}
     * @memberof MgtBaseComponent
     */
    get mediaQuery() {
        if (this.offsetWidth < 768) {
            return ComponentMediaQuery.mobile;
        }
        else if (this.offsetWidth < 1200) {
            return ComponentMediaQuery.tablet;
        }
        else {
            return ComponentMediaQuery.desktop;
        }
    }
    /**
     * A flag to check if the component is loading data state.
     *
     * @protected
     * @memberof MgtBaseComponent
     */
    get isLoadingState() {
        return this._isLoadingState;
    }
    /**
     * A flag to check if the component has updated once.
     *
     * @readonly
     * @protected
     * @type {boolean}
     * @memberof MgtBaseComponent
     */
    get isFirstUpdated() {
        return this._isFirstUpdated;
    }
    /**
     * returns component strings
     *
     * @readonly
     * @protected
     * @memberof MgtBaseComponent
     */
    get strings() {
        return {};
    }
    /**
     * Invoked each time the custom element is appended into a document-connected element
     *
     * @memberof MgtBaseComponent
     */
    connectedCallback() {
        super.connectedCallback();
        _utils_LocalizationHelper__WEBPACK_IMPORTED_MODULE_2__["LocalizationHelper"].onStringsUpdated(this.handleLocalizationChanged);
        _utils_LocalizationHelper__WEBPACK_IMPORTED_MODULE_2__["LocalizationHelper"].onDirectionUpdated(this.handleDirectionChanged);
    }
    /**
     * Invoked each time the custom element is removed from a document-connected element
     *
     * @memberof MgtBaseComponent
     */
    disconnectedCallback() {
        super.disconnectedCallback();
        _utils_LocalizationHelper__WEBPACK_IMPORTED_MODULE_2__["LocalizationHelper"].removeOnStringsUpdated(this.handleLocalizationChanged);
        _utils_LocalizationHelper__WEBPACK_IMPORTED_MODULE_2__["LocalizationHelper"].removeOnDirectionUpdated(this.handleDirectionChanged);
    }
    /**
     * Invoked when the element is first updated. Implement to perform one time
     * work on the element after update.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * @param _changedProperties Map of changed properties with old values
     */
    firstUpdated(changedProperties) {
        super.firstUpdated(changedProperties);
        this._isFirstUpdated = true;
        _providers_Providers__WEBPACK_IMPORTED_MODULE_1__["Providers"].onProviderUpdated(() => this.requestStateUpdate());
        this.requestStateUpdate();
    }
    /**
     * load state into the component.
     * Override this function to provide additional loading logic.
     */
    loadState() {
        return Promise.resolve();
    }
    /**
     * helps facilitate creation of events across components
     *
     * @protected
     * @param {string} eventName
     * @param {*} [detail]
     * @param {boolean} [bubbles=false]
     * @param {boolean} [cancelable=false]
     * @return {*}  {boolean}
     * @memberof MgtBaseComponent
     */
    fireCustomEvent(eventName, detail, bubbles = false, cancelable = false) {
        const event = new CustomEvent(eventName, {
            bubbles,
            cancelable,
            detail
        });
        return this.dispatchEvent(event);
    }
    /**
     * Invoked whenever the element is updated. Implement to perform
     * post-updating tasks via DOM APIs, for example, focusing an element.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * * @param changedProperties Map of changed properties with old values
     */
    updated(changedProperties) {
        super.updated(changedProperties);
        const event = new CustomEvent('updated', {
            bubbles: true,
            cancelable: true
        });
        this.dispatchEvent(event);
    }
    /**
     * Request to reload the state.
     * Use reload instead of load to ensure loading events are fired.
     *
     * @protected
     * @memberof MgtBaseComponent
     */
    requestStateUpdate(force = false) {
        return __awaiter(this, void 0, void 0, function* () {
            // the component is still bootstraping - wait until first updated
            if (!this._isFirstUpdated) {
                return;
            }
            // Wait for the current load promise to complete (unless forced).
            if (this.isLoadingState && !force) {
                yield this._currentLoadStatePromise;
            }
            const loadStatePromise = new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {
                try {
                    this.setLoadingState(true);
                    this.fireCustomEvent('loadingInitiated');
                    yield this.loadState();
                    this.setLoadingState(false);
                    this.fireCustomEvent('loadingCompleted');
                    resolve();
                }
                catch (e) {
                    this.setLoadingState(false);
                    this.fireCustomEvent('loadingFailed');
                    reject(e);
                }
            }));
            // Return the load state promise.
            // If loading + forced, chain the promises.
            return (this._currentLoadStatePromise =
                this.isLoadingState && !!this._currentLoadStatePromise && force
                    ? this._currentLoadStatePromise.then(() => loadStatePromise)
                    : loadStatePromise);
        });
    }
    setLoadingState(value) {
        if (this._isLoadingState === value) {
            return;
        }
        this._isLoadingState = value;
        this.requestUpdate('isLoadingState');
    }
    handleLocalizationChanged() {
        _utils_LocalizationHelper__WEBPACK_IMPORTED_MODULE_2__["LocalizationHelper"].updateStringsForTag(this.tagName, this.strings);
        this.requestUpdate();
    }
    handleDirectionChanged() {
        this.direction = _utils_LocalizationHelper__WEBPACK_IMPORTED_MODULE_2__["LocalizationHelper"].getDocumentDirection();
    }
}
__decorate([
    Object(lit_element__WEBPACK_IMPORTED_MODULE_0__["internalProperty"])(),
    __metadata("design:type", Object)
], MgtBaseComponent.prototype, "direction", void 0);
//# sourceMappingURL=baseComponent.js.map

/***/ })

/******/ })});;
//# sourceMappingURL=spfx-mgt-web-part.js.map